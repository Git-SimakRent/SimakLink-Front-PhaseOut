import{x as Zt,d as P,g as me,ao as ei,$ as f,t as ve,h as Wi,f as Ui,W as ti,e as g,a as O,K as ii,p as et,Q as ji,ak as Vi,a8 as X,o as Q,J as ri,a3 as mt,i as ni,m as re,u as ae,ai as si,aH as ai,D as Gi,ad as qi,a1 as U,L as Xi,V as oi,r as Qi,bh as Yi,bi as Ji,F as Zi,a5 as vt,bj as er,I as tr,az as ir,z as rr,a$ as nr,bk as sr,aR as ar,bl as or,C as pt,aU as lr,bm as gt,T as tt,ac as It,bn as cr}from"./index.94f86987.js";import{ae as oe,$ as F,W as v,aI as pe,ap as hr,a5 as li,aS as it,a0 as E,az as De,a8 as G,T as b,a6 as rt,ay as We,ak as Se,a9 as R,a7 as B,Z as x,aB as V,a1 as Y,aN as Ue,as as ur,U as m,af as L,ab as J,bs as ci,aG as dr,Y as St,ah as yt,aA as _r,bP as de,aL as Le,aO as hi,bQ as Ct,aJ as je,aH as ue,bE as fr,ai as mr,bu as vr,bx as ge}from"./entry.f47474d7.js";import{_ as pr,s as ee}from"./resize_observer.3c2fa9a2.js";var gr=Zt.add,ui="DEVEXTREME_XHR_ERROR_UNLOAD",Ir=function(e){return[e[0],e.length<3?"=":String(e[1]).toLowerCase(),e.length<2?!0:e[e.length-1]]},Ve=function(e){return Array.isArray(e)||(e=[e]),oe(e,function(t){var i={selector:F(t)||typeof t=="string"?t:t.getter||t.field||t.selector,desc:!!(t.desc||String(t.dir).charAt(0).toLowerCase()==="d")};return t.compare&&(i.compare=t.compare),i})},Sr=function(){var e={timeout:"Network connection timeout",error:"Unspecified network error",parsererror:"Unexpected server response"},t;return gr(function(){var i=me();P.listen(i,"beforeunload",function(){t=!0})}),function(i,r){return t?ui:i.status<400?function(n){var s=e[n];return s||n}(r):i.statusText}}(),yr={count:{seed:0,step:function(e){return 1+e}},sum:{seed:0,step:function(e,t){return e+t}},min:{step:function(e,t){return t<e?t:e}},max:{step:function(e,t){return t>e?t:e}},avg:{seed:[0,0],step:function(e,t){return[e[0]+t,e[1]+1]},finalize:function(e){return e[1]?e[0]/e[1]:NaN}}},Cr=function(){var e=0,t;return{obtain:function(){e===0&&(t=new v),e++},release:function(){e--,e<1&&t.resolve()},promise:function(){var i=e===0?new v().resolve():t;return i.promise()},reset:function(){e=0,t&&t.resolve()}}}();function br(e){return/^(and|&&|&)$/i.test(e)}var nt=function(e,t,i){if(Array.isArray(e)){for(var r=oe(t,function(a,o){return o}),n,s=0;s<r.length;s++)if(n=r[s],!pe(t[n],i[n],{strict:!1}))return!1;return!0}return pe(t,i,{strict:!1})},Er=function(e){return e[0]==="!"&&Array.isArray(e[1])},xr=function(e){return e==="and"||e==="or"},Or=function(e){var t=e[0],i=e[1];return!!(Array.isArray(t)||F(t)&&(Array.isArray(i)||F(i)||xr(i)))},ne=function(){var e=new v;return e.resolve.apply(e,arguments).promise()},di=function(){var e=new v;return e.reject.apply(e,arguments).promise()};function Ar(e,t){var i;return function(){return i||(i=setTimeout(()=>{i=void 0,e.call(this)},F(t)?t():t)),i}}function Dr(e,t){var i=[],r=Ar(function(){e.call(this,i),i=[]},t);return function(n){return Array.isArray(n)&&i.push(...n),r.call(this,i)}}var A=hr(li.ERROR_MESSAGES,{E4000:"[DevExpress.data]: {0}",E4001:"Unknown aggregating function is detected: '{0}'",E4002:"Unsupported OData protocol version is used",E4003:"Unknown filter operation is used: {0}",E4004:"The thenby() method is called before the sortby() method",E4005:"Store requires a key expression for this operation",E4006:"ArrayStore 'data' option must be an array",E4007:"Compound keys cannot be auto-generated",E4008:"Attempt to insert an item with a duplicated key",E4009:"Data item cannot be found",E4010:"CustomStore does not support creating queries",E4011:"Custom Store method is not implemented or is not a function: {0}",E4012:"Custom Store method returns an invalid value: {0}",E4013:"Local Store requires the 'name' configuration option is specified",E4014:"Unknown data type is specified for ODataStore: {0}",E4015:"Unknown entity name or alias is used: {0}",E4016:"The compileSetter(expr) method is called with 'self' passed as a parameter",E4017:"Keys cannot be modified",E4018:"The server has returned a non-numeric value in a response to an item count request",E4019:"Mixing of group operators inside a single group of filter expression is not allowed",E4020:"Unknown store type is detected: {0}",E4021:"The server response does not provide the totalCount value",E4022:"The server response does not provide the groupCount value",E4023:"Could not parse the following XML: {0}",E4024:"String function {0} cannot be used with the data field {1} of type {2}.",W4000:"Data returned from the server has an incorrect structure",W4001:'The {0} field is listed in both "keyType" and "fieldTypes". The value of "fieldTypes" is used.',W4002:"Data loading has failed for some cells due to the following error: {0}"}),Lr=null,st=function(e){var t;(t=Lr)===null||t===void 0||t(e)};function Tr(e,t){for(var i,r=typeof t=="string"?t.split():t.slice();r.length;)if(i=r.shift(),i in e)return!0;return!1}function _i(e,t,i,r){var n,s;if(r){for(var a=0;a<t.length;a++)if(n=t[a].items||t[a].collapsedItems||[],s=_i(e,n||[],i,r-1),s)return s}else if(ye(e,t,i)>=0)return t}function wr(e,t,i,r){return r?_i(e,t,i,r)||[]:t}function Rr(e,t){if(e.key()&&(!t._dataByKeyMap||t._dataByKeyMapLength!==t.length)){for(var i={},r=t.length,n=0;n<r;n++)i[JSON.stringify(e.keyOf(t[n]))]=t[n];t._dataByKeyMap=i,t._dataByKeyMapLength=r}}function Br(e,t){if(e._dataByKeyMap)return e._dataByKeyMap[JSON.stringify(t)]}function Fr(e,t){return e._dataByKeyMap?e._dataByKeyMap[JSON.stringify(t)]:!0}function fi(e,t,i){e._dataByKeyMap&&(e._dataByKeyMap[JSON.stringify(t)]=i,e._dataByKeyMapLength+=i?1:-1)}function mi(e,t,i){i=i||new WeakMap;var r=e?Object.create(Object.getPrototypeOf(e)):{};e&&i.set(e,r);var n=Se({},e);it(r,n,!0,!0);for(var s in n){var a=n[s],o=t==null?void 0:t[s];R(a)&&!G(a)&&R(o)&&!i.has(a)&&(r[s]=mi(a,o,i))}for(var c in r){var l=r[c];R(l)&&i.has(l)&&(r[c]=i.get(l))}return r}function Hr(e,t){var i=mi(e,t);return it(i,t,!0,!0)}function at(e){var{keyInfo:t,data:i,changes:r,groupCount:n,useInsertIndex:s,immutable:a,disableCache:o,logError:c,skipCopying:l}=e,h=a===!0?[...i]:i;return r.forEach(u=>{var d=u.type==="insert"?h:wr(t,h,u.key,n);switch(!o&&Rr(t,d),u.type){case"update":vi(t,d,u.key,u.data,!0,a,c);break;case"insert":pi(t,d,u.data,s&&E(u.index)?u.index:-1,!0,c,l);break;case"remove":gi(t,d,u.key,!0,c)}}),h}function Te(e,t,i){return e?t&&A.log(i):di(A.Error(i))}function vi(e,t,i,r,n,s,a){var o,c=e.key();if(c){if(Tr(r,c)&&!nt(c,i,e.keyOf(r)))return Te(n,a,"E4017");if(o=Br(t,i),!o){var l=ye(e,t,i);if(l<0)return Te(n,a,"E4009");if(o=t[l],s===!0&&E(o)){var h=Hr(o,r);return t[l]=h,!n&&ne(h,i)}}}else o=i;if(it(o,r,!0),!n)return De().useLegacyStoreResult?ne(i,r):ne(o,i)}function pi(e,t,i,r,n,s,a){var o,c=e.key(),l=G(i)&&!a?b({},i):i;if(c){if(o=e.keyOf(l),o===void 0||typeof o=="object"&&rt(o)){if(Array.isArray(c))throw A.Error("E4007");o=l[c]=String(new We)}else if(t[ye(e,t,o)]!==void 0)return Te(n,s,"E4008")}else o=l;if(r>=0?t.splice(r,0,l):t.push(l),fi(t,o,l),!n)return ne(De().useLegacyStoreResult?i:l,o)}function gi(e,t,i,r,n){var s=ye(e,t,i);if(s>-1&&(t.splice(s,1),fi(t,i,null)),r){if(s<0)return Te(r,n,"E4009")}else return ne(i)}function ye(e,t,i){var r=e.key();if(!Fr(t,i))return-1;for(var n=0,s=t.length;n<s;n++)if(nt(r,e.keyOf(t[n]),i))return n;return-1}var Ce=B.inherit({toArray:function(){var e=[];for(this.reset();this.next();)e.push(this.current());return e},countable:function(){return!1}}),ot=Ce.inherit({ctor:function(e){this.array=e,this.index=-1},next:function(){return this.index+1<this.array.length?(this.index++,!0):!1},current:function(){return this.array[this.index]},reset:function(){this.index=-1},toArray:function(){return this.array.slice(0)},countable:function(){return!0},count:function(){return this.array.length}}),Re=Ce.inherit({ctor:function(e){this.iter=e},next:function(){return this.iter.next()},current:function(){return this.iter.current()},reset:function(){return this.iter.reset()}}),Fe=Re.inherit({ctor:function(e,t){this.callBase(e),this.index=-1,this.mapper=t},current:function(){return this.mapper(this.callBase(),this.index)},next:function(){var e=this.callBase();return e&&this.index++,e}}),Mr=function(e,t,i){return Y(e)&&Y(t)&&(i!=null&&i.locale||i!=null&&i.collatorOptions)?new Intl.Collator((i==null?void 0:i.locale)||void 0,(i==null?void 0:i.collatorOptions)||void 0).compare(e,t):(e=Ue(e,!1,i),t=Ue(t,!1,i),e===null&&t!==null?-1:e!==null&&t===null||e===void 0&&t!==void 0?1:e!==void 0&&t===void 0||e<t?-1:e>t?1:0)},Ge=Ce.inherit({ctor:function(e,t,i,r){this.langParams=e.langParams,e instanceof Fe||(e=new Fe(e,this._wrap),e.langParams=this.langParams),this.iter=e,this.rules=[{getter:t,desc:i,compare:r,langParams:this.langParams}]},thenBy:function(e,t,i){var r=new Ge(this.sortedIter||this.iter,e,t,i);return this.sortedIter||(r.rules=this.rules.concat(r.rules)),r},next:function(){return this._ensureSorted(),this.sortedIter.next()},current:function(){return this._ensureSorted(),this.sortedIter.current()},reset:function(){delete this.sortedIter},countable:function(){return this.sortedIter||this.iter.countable()},count:function(){return this.sortedIter?this.sortedIter.count():this.iter.count()},_ensureSorted:function(){var e=this;e.sortedIter||(x(e.rules,function(){this.getter=V(this.getter)}),e.sortedIter=new Fe(new ot(this.iter.toArray().sort(function(t,i){return e._compare(t,i)})),e._unwrap))},_wrap:function(e,t){return{index:t,value:e}},_unwrap:function(e){return e.value},_getDefaultCompare:e=>(t,i)=>Mr(t,i,e),_compare:function(e,t){var i=e.index,r=t.index;if(e=e.value,t=t.value,e===t)return i-r;for(var n=0,s=this.rules.length;n<s;n++){var a=this.rules[n],o=a.getter(e),c=a.getter(t),l=a.compare||this._getDefaultCompare(a.langParams),h=l(o,c);if(h)return a.desc?-h:h}return i-r}}),qe=function(){var e={},t=n=>Ue(n,!1,e),i=function(n){var s;return E(n)?(s=e)!==null&&s!==void 0&&s.locale?n.toLocaleString(e.locale):n.toString():""};function r(n,s,a){return function(o){o=t(n(o));var c=function(l){return l===""||l===0||l===!1}(s)?o===s:o==s;return a&&(c=!c),c}}return function(n,s){return e=s||{},F(n)?n:Or(n)?function(a){var o=[],c=!1,l=!1;return x(a,function(){if(Array.isArray(this)||F(this)){if(o.length>1&&c!==l)throw new A.Error("E4019");o.push(qe(this,e)),c=l,l=!0}else l=br(this)}),function(h){for(var u=c,d=0;d<o.length;d++)if(o[d](h)!==c){u=!c;break}return u}}(n):Er(n)?function(a){var o=a[0],c=qe(a[1],e);if(o==="!")return function(l){return!c(l)};throw A.Error("E4003",o)}(n):function(a){a=Ir(a);var o=V(a[0]),c=a[1],l=a[2];l=t(l);var h=(u,d)=>(u=t(o(u)),(l==null||u==null)&&l!==u?!1:d(u,l));switch(c.toLowerCase()){case"=":return r(o,l);case"<>":return r(o,l,!0);case">":return u=>h(u,(d,_)=>d>_);case"<":return u=>h(u,(d,_)=>d<_);case">=":return u=>h(u,(d,_)=>d>=_);case"<=":return u=>h(u,(d,_)=>d<=_);case"startswith":return function(u){return t(i(o(u))).indexOf(l)===0};case"endswith":return function(u){var d=t(i(o(u))),_=i(l);if(d.length<_.length)return!1;var p=d.lastIndexOf(l);return p!==-1&&p===d.length-l.length};case"contains":return function(u){return t(i(o(u))).indexOf(l)>-1};case"notcontains":return function(u){return t(i(o(u))).indexOf(l)===-1}}throw A.Error("E4003",c)}(n)}}(),Pr=Re.inherit({ctor:function(e,t){this.callBase(e),this.langParams=e.langParams,this.criteria=qe(t,this.langParams)},next:function(){for(;this.iter.next();)if(this.criteria(this.current()))return!0;return!1}}),Kr=Ce.inherit({ctor:function(e,t){this.iter=e,this.getter=t},next:function(){return this._ensureGrouped(),this.groupedIter.next()},current:function(){return this._ensureGrouped(),this.groupedIter.current()},reset:function(){delete this.groupedIter},countable:function(){return!!this.groupedIter},count:function(){return this.groupedIter.count()},_ensureGrouped:function(){if(!this.groupedIter){var e={},t=[],i=this.iter,r=V(this.getter);for(i.reset();i.next();){var n=i.current(),s=r(n);s in e?e[s].push(n):(e[s]=[n],t.push(s))}this.groupedIter=new ot(oe(t,function(a){return{key:a,items:e[a]}}))}}}),Nr=Re.inherit({ctor:function(e,t){this.callBase(e),this.getter=V(t)},current:function(){return this.getter(this.callBase())},countable:function(){return this.iter.countable()},count:function(){return this.iter.count()}}),kr=Re.inherit({ctor:function(e,t,i){this.callBase(e),this.skip=Math.max(0,t),this.take=Math.max(0,i),this.pos=0},next:function(){if(this.pos>=this.skip+this.take)return!1;for(;this.pos<this.skip&&this.iter.next();)this.pos++;return this.pos++,this.iter.next()},reset:function(){this.callBase(),this.pos=0},countable:function(){return this.iter.countable()},count:function(){return Math.min(this.iter.count()-this.skip,this.take)}}),Be=function e(t,i){i=i||{},t instanceof Ce||(t=new ot(t)),i.langParams&&(t.langParams=i.langParams);var r=function(l){var h=i.errorHandler;h&&h(l),st(l)},n=function(l){var h=new v().fail(r),u,d=l.step,_=l.finalize;try{t.reset(),"seed"in l?u=l.seed:u=t.next()?t.current():NaN;for(var p=u;t.next();)p=d(p,t.current());h.resolve(_?_(p):p)}catch(y){h.reject(y)}return h.promise()},s=function(l){return n(yr[l])},a=function(l){return!F(l)&&!Array.isArray(l)&&(l=[].slice.call(arguments)),c(new Nr(t,l))},o=function(l){return a(V(l))};function c(l){return e(l,i)}return{toArray:function(){return t.toArray()},enumerate:function(){var l=new v().fail(r);try{l.resolve(t.toArray())}catch(h){l.reject(h)}return l.promise()},setLangParams(l){t.langParams=l},sortBy:function(l,h,u){return c(new Ge(t,l,h,u))},thenBy:function(l,h,u){if(t instanceof Ge)return c(t.thenBy(l,h,u));throw A.Error("E4004")},filter:function(l){return Array.isArray(l)||(l=[].slice.call(arguments)),c(new Pr(t,l))},slice:function(l,h){return h===void 0&&(h=Number.MAX_VALUE),c(new kr(t,l,h))},select:a,groupBy:function(l){return c(new Kr(t,l))},aggregate:function(l,h,u){return arguments.length<2?n({step:arguments[0]}):n({seed:l,step:h,finalize:u})},count:function(){if(t.countable()){var l=new v().fail(r);try{l.resolve(t.count())}catch(h){l.reject(h)}return l.promise()}return s("count")},sum:function(l){return l?o(l).sum():s("sum")},min:function(l){return l?o(l).min():s("min")},max:function(l){return l?o(l).max():s("max")},avg:function(l){return l?o(l).avg():s("avg")}}};function lt(e,t){return e=e.groupBy(t[0].selector),t.length>1&&(e=e.select(function(i){return b({},i,{items:lt(Be(i.items),t.slice(1)).toArray()})})),e}function Ii(e,t){var i=[];return x(e,function(r,n){var s=ur(t,function(a){return n.selector===a.selector});s.length<1&&i.push(n)}),i.concat(t)}function $r(e,t,i){var r;t=t||{};var n=t.filter;if((r=t)!==null&&r!==void 0&&r.langParams){var s,a;(s=(a=e).setLangParams)===null||s===void 0||s.call(a,t.langParams)}if(n&&(e=e.filter(n)),i)return e;var o=t.sort,c=t.select,l=t.group,h=t.skip,u=t.take;return l&&(l=Ve(l),l.keepInitialKeyOrder=!!t.group.keepInitialKeyOrder),(o||l)&&(o=Ve(o||[]),l&&!l.keepInitialKeyOrder&&(o=Ii(l,o)),x(o,function(d){e=e[d?"thenBy":"sortBy"](this.selector,this.desc,this.compare)})),c&&(e=e.select(c)),l&&(e=lt(e,l)),(u||h)&&(e=e.slice(h||0,u)),e}const Xe={multiLevelGroup:lt,arrangeSortingInfo:Ii,queryByOptions:$r};var ce=B.abstract,bt=Xe.queryByOptions,Qe={},j=B.inherit({_langParams:{},ctor:function(e){var t=this;e=e||{},this._eventsStrategy=new ei(this),x(["onLoaded","onLoading","onInserted","onInserting","onUpdated","onUpdating","onPush","onRemoved","onRemoving","onModified","onModifying"],function(i,r){r in e&&t.on(r.slice(2).toLowerCase(),e[r])}),this._key=e.key,this._errorHandler=e.errorHandler,this._useDefaultSearch=!0},_clearCache:m,_customLoadOptions:function(){return null},key:function(){return this._key},keyOf:function(e){return this._keyGetter||(this._keyGetter=V(this.key())),this._keyGetter(e)},_requireKey:function(){if(!this.key())throw A.Error("E4005")},load:function(e){var t=this;return e=e||{},this._eventsStrategy.fireEvent("loading",[e]),this._withLock(this._loadImpl(e)).done(function(i){t._eventsStrategy.fireEvent("loaded",[i,e])})},_loadImpl:function(e){return rt(this._langParams)||(e=e||{},e._langParams=Se({},this._langParams,e._langParams)),bt(this.createQuery(e),e).enumerate()},_withLock:function(e){var t=new v;return e.done(function(){var i=this,r=arguments;Cr.promise().done(function(){t.resolveWith(i,r)})}).fail(function(){t.rejectWith(this,arguments)}),t},createQuery:ce,totalCount:function(e){return this._totalCountImpl(e)},_totalCountImpl:function(e){return bt(this.createQuery(e),e,!0).count()},byKey:function(e,t){return this._addFailHandlers(this._withLock(this._byKeyImpl(e,t)))},_byKeyImpl:ce,insert:function(e){var t=this;return t._eventsStrategy.fireEvent("modifying"),t._eventsStrategy.fireEvent("inserting",[e]),t._addFailHandlers(t._insertImpl(e).done(function(i,r){t._eventsStrategy.fireEvent("inserted",[i,r]),t._eventsStrategy.fireEvent("modified")}))},_insertImpl:ce,update:function(e,t){var i=this;return i._eventsStrategy.fireEvent("modifying"),i._eventsStrategy.fireEvent("updating",[e,t]),i._addFailHandlers(i._updateImpl(e,t).done(function(){i._eventsStrategy.fireEvent("updated",[e,t]),i._eventsStrategy.fireEvent("modified")}))},_updateImpl:ce,push:function(e){var t={changes:e,waitFor:[]};this._eventsStrategy.fireEvent("beforePushAggregation",[t]),L(...t.waitFor).done(()=>{this._pushImpl(e),this._eventsStrategy.fireEvent("beforePush",[{changes:e}]),this._eventsStrategy.fireEvent("push",[e])})},_pushImpl:m,remove:function(e){var t=this;return t._eventsStrategy.fireEvent("modifying"),t._eventsStrategy.fireEvent("removing",[e]),t._addFailHandlers(t._removeImpl(e).done(function(i){t._eventsStrategy.fireEvent("removed",[i]),t._eventsStrategy.fireEvent("modified")}))},_removeImpl:ce,_addFailHandlers:function(e){return e.fail(this._errorHandler).fail(st)},on(e,t){return this._eventsStrategy.on(e,t),this},off(e,t){return this._eventsStrategy.off(e,t),this}});j.create=function(e,t){if(!(e in Qe))throw A.Error("E4020",e);return new Qe[e](t)};j.registerClass=function(e,t){return t&&(Qe[t]=e),e};j.inherit=function(e){return function(t,i){var r=e.apply(this,[t]);return j.registerClass(r,i),r}}(j.inherit);var Si="totalCount",Ye="load",yi="byKey",Et="insert",xt="update",Ot="remove";function se(e){return e&&F(e.then)}function Z(e){return new v().resolve(e).promise()}function _e(e,t){if(!F(t))throw A.Error("E4011",e)}function Ci(e){throw A.Error("E4012",e)}function q(e){function t(i){var r=i[0],n=i[1];return!r||!r.getResponseHeader?null:Sr(r,n)}return function(i){var r;i instanceof Error?r=i:r=new Error(t(arguments)||i&&String(i)||"Unknown error"),r.message!==ui&&e.reject(r)}}function bi(e,t){var i=e._loadFunc,r;return _e(Ye,i),r=i.apply(e,[t]),Array.isArray(r)?r=Z(r):r==null?r=Z([]):se(r)||Ci(Ye),J(r)}function zr(e,t){var i=e._totalCountFunc,r;if(!F(i))throw A.Error("E4021");return r=i.apply(e,[t]),se(r)||(r=Number(r),isFinite(r)||Ci(Si),r=Z(r)),J(r)}function Wr(e,t,i){var r=e._byKeyFunc,n;return _e(yi,r),n=r.apply(e,[t,i]),se(n)||(n=Z(n)),J(n)}function Ei(e,t,i,r){if(t.__rawData)r(t.__rawData);else{var n=t.__rawDataPromise||bi(t,i);t._cacheRawData&&(t.__rawDataPromise=n),n.always(function(){delete t.__rawDataPromise}).done(function(s){t._cacheRawData&&(t.__rawData=s),r(s)}).fail(q(e))}}function At(e,t,i,r){i=i||{};var n={};"userData"in i&&(n.userData=i.userData),Ei(e,t,n,function(s){var a=Be(s,{errorHandler:t._errorHandler}),o,c,l=[],h,u;r||(o=Xe.queryByOptions(a,i),o===a?h=s.slice(0):l.push(o.enumerate().done(function(d){h=d}))),(i.requireTotalCount||r)&&(c=Xe.queryByOptions(a,i,!0),c===a?u=s.length:l.push(c.count().done(function(d){u=d}))),L.apply(f,l).done(function(){r?e.resolve(u):i.requireTotalCount?e.resolve(h,{totalCount:u}):e.resolve(h)}).fail(function(d){e.reject(d)})})}function Ur(e,t,i){Ei(e,t,{},function(r){for(var n=t.key(),s,a=0,o=r.length;a<o;a++)if(s=r[a],nt(n,t.keyOf(r[a]),i)){e.resolve(s);return}e.reject(A.Error("E4009"))})}var ct=j.inherit({ctor:function(e){e=e||{},this.callBase(e),this._useDefaultSearch=!!e.useDefaultSearch||e.loadMode==="raw",this._loadMode=e.loadMode,this._cacheRawData=e.cacheRawData!==!1,this._loadFunc=e[Ye],this._totalCountFunc=e[Si],this._byKeyFunc=e[yi],this._insertFunc=e[Et],this._updateFunc=e[xt],this._removeFunc=e[Ot]},_clearCache(){delete this.__rawData},createQuery:function(){throw A.Error("E4010")},clearRawDataCache:function(){this._clearCache()},_totalCountImpl:function(e){var t=new v;return this._loadMode==="raw"&&!this._totalCountFunc?At(t,this,e,!0):(zr(this,e).done(function(i){t.resolve(Number(i))}).fail(q(t)),t=this._addFailHandlers(t)),t.promise()},_pushImpl:function(e){this.__rawData&&at({keyInfo:this,data:this.__rawData,changes:e})},_loadImpl:function(e){var t=new v;return this._loadMode==="raw"?At(t,this,e,!1):(bi(this,e).done(function(i,r){t.resolve(i,r)}).fail(q(t)),t=this._addFailHandlers(t)),t.promise()},_byKeyImpl:function(e,t){var i=new v;return this._byKeyViaLoad()?(this._requireKey(),Ur(i,this,e)):Wr(this,e,t).done(function(r){i.resolve(r)}).fail(q(i)),i.promise()},_byKeyViaLoad:function(){return this._loadMode==="raw"&&!this._byKeyFunc},_insertImpl:function(e){var t=this,i=t._insertFunc,r,n=new v;return _e(Et,i),r=i.apply(t,[e]),se(r)||(r=Z(r)),J(r).done(function(s){De().useLegacyStoreResult?n.resolve(e,s):n.resolve(s||e,t.keyOf(s))}).fail(q(n)),n.promise()},_updateImpl:function(e,t){var i=this._updateFunc,r,n=new v;return _e(xt,i),r=i.apply(this,[e,t]),se(r)||(r=Z(r)),J(r).done(function(s){De().useLegacyStoreResult?n.resolve(e,t):n.resolve(s||t,e)}).fail(q(n)),n.promise()},_removeImpl:function(e){var t=this._removeFunc,i,r=new v;return _e(Ot,t),i=t.apply(this,[e]),se(i)||(i=Z()),J(i).done(function(){r.resolve(e)}).fail(q(r)),r.promise()}});function jr(e){var t=[],i=!1;function r(){for(;t.length;){i=!0;var n=t.shift(),s=n();if(s!==void 0){if(s.then){L(s).always(r);return}throw li.Error("E0015")}}i=!1}return{add:function(n,s){e?(t[0]&&s&&s(t[0]),t=[n]):t.push(n),i||r()},busy:function(){return i}}}var Vr=me(),Gr={getXhr:function(){return new Vr.XMLHttpRequest}};const qr=ci(Gr);var ht=me(),fe="success",He="error",Xr="timeout",Qr="nocontent",Yr="parsererror",Jr=function(e){return 200<=e&&e<300},Zr=function(e){return e!==204},en=function(e){var t=[];for(var i in e){var r=e[i];r!==void 0&&(r===null&&(r=""),typeof r=="function"&&(r=r()),t.push(encodeURIComponent(i)+"="+encodeURIComponent(r)))}return t.join("&")},xi=function(e){var t=P.createElement("script");for(var i in e)t[i]=e[i];return t},Oi=function(e){e.parentNode.removeChild(e)},Ai=function(e){return P.getHead().appendChild(e)},Dt=function(e){var t=xi({text:e});Ai(t),Oi(t)},tn=function(e){var t=xi({src:e});return new Promise(function(i,r){var n={load:i,error:r},s=function(o){n[o.type](),Oi(t)};for(var a in n)P.listen(t,a,s);Ai(t)})},rn=function(e){var t=e.dataType||"*",i="text/javascript, application/javascript, application/ecmascript, application/x-ecmascript",r={"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript",jsonp:i,script:i};return dr(r,e.accepts,!0),r[t]?r[t]+(t!=="*"?", */*; q=0.01":""):r["*"]},nn=function(e){var t;return e.data&&!e.upload&&ut(e)!=="GET"&&(t="application/x-www-form-urlencoded;charset=utf-8"),e.contentType||t},sn=function(e){return e.responseType&&e.responseType!=="text"||typeof e.responseText!="string"?e.response:e.responseText},an=function(e,t,i){var r=sn(t);switch(i){case"jsonp":Dt(r);break;case"script":Dt(r),e.resolve(r,fe,t);break;case"json":try{e.resolve(JSON.parse(r),fe,t)}catch(n){e.reject(t,Yr,n)}break;default:e.resolve(r,fe,t)}},on=function(e){if(!ve())return!0;var t=!1,i=P.createElement("a"),r=P.createElement("a");i.href=ht.location.href;try{r.href=e,r.href=r.href,t=i.protocol+"//"+i.host!=r.protocol+"//"+r.host}catch{t=!0}return t},ln=function(e,t){return e&&setTimeout(function(){t.customStatus=Xr,t.abort()},e)},cn=function(e){if(e.dataType==="jsonp"){var t=Math.random().toString().replace(/\D/g,""),i=e.jsonpCallback||"dxCallback"+Date.now()+"_"+t,r=e.jsonp||"callback";return e.data=e.data||{},e.data[r]=i,i}},hn=function(e,t){var i=e.data,r=typeof i=="string",n=e.url||ht.location.href;return!r&&!e.cache&&(i=i||{},i._=Date.now()),i&&!e.upload&&(r||(i=en(i)),ut(e)==="GET"?(i!==""&&(n+=(n.indexOf("?")>-1?"&":"?")+i),i=null):t["Content-Type"]&&t["Content-Type"].indexOf("application/x-www-form-urlencoded")>-1&&(i=i.replace(/%20/g,"+"))),{url:n,parameters:i}};function ut(e){return(e.method||"GET").toUpperCase()}var un=function(e){var t=e.headers||{};return t["Content-Type"]=t["Content-Type"]||nn(e),t.Accept=t.Accept||rn(e),!e.crossDomain&&!t["X-Requested-With"]&&(t["X-Requested-With"]="XMLHttpRequest"),t},dn=function(e){var t=qr.getXhr(),i=new v,r=i.promise(),n=E(e.async)?e.async:!0,s=e.dataType,a=e.timeout||0,o;e.crossDomain=on(e.url);var c=s==="jsonp"||s==="script";e.cache===void 0&&(e.cache=!c);var l=cn(e),h=un(e),u=hn(e,h),d=u.url,_=u.parameters;if(l&&(ht[l]=function(I){i.resolve(I,fe,t)}),e.crossDomain&&c)return tn(d).then(function(){s!=="jsonp"&&i.resolve(null,fe,t)},function(){i.reject(t,He)}),r;if(e.crossDomain&&!("withCredentials"in t))return i.reject(t,He),r;if(t.open(ut(e),d,n,e.username,e.password),n&&(t.timeout=a,o=ln(a,t)),t.onreadystatechange=function(I){t.readyState===4&&(clearTimeout(o),Jr(t.status)?Zr(t.status)?an(i,t,s):i.resolve(null,Qr,t):i.reject(t,t.customStatus||He))},e.upload&&(t.upload.onprogress=e.upload.onprogress,t.upload.onloadstart=e.upload.onloadstart,t.upload.onabort=e.upload.onabort),e.xhrFields)for(var p in e.xhrFields)t[p]=e.xhrFields[p];e.responseType==="arraybuffer"&&(t.responseType=e.responseType);for(var y in h)Object.prototype.hasOwnProperty.call(h,y)&&E(h[y])&&t.setRequestHeader(y,h[y]);return e.beforeSend&&e.beforeSend(t),t.send(_),r.abort=function(){t.abort()},r};const _n=ci({sendRequest:dn}),fn={};var mn=function e(t,i,r){r=r||[],i=i||{};var n=function(o,c){return{name:o,args:c}},s=function(o){var c=new v,l,h,u,d,_,p=function(S){var C=i.errorHandler;C&&C(S),st(S),c.reject(S)};function y(S){switch(S.name){case"sortBy":return _=[S.args],!0;case"thenBy":if(!_)throw A.Error("E4004");return _.push(S.args),!0}return!1}try{l=i.adapter,F(l)||(l=fn[l]),h=l(i),u=[].concat(r).concat(o);var I=h.optimize;for(I&&I(u);u.length;){if(d=u[0],!y(d)){if(_){u.unshift(n("multiSort",[_])),_=null;continue}if(String(d.name)!=="enumerate"&&(!h[d.name]||h[d.name].apply(h,d.args)===!1))break}u.shift()}(function(){var S=u[0],C=[];S&&S.name==="multiSort"&&(u.shift(),x(S.args[0],function(){C.push(n(C.length?"thenBy":"sortBy",this))})),u=C.concat(u)})(),h.exec(t).done(function(S,C){if(!u.length)c.resolve(S,C);else{var T=Be(S,{errorHandler:i.errorHandler});x(u,function(){T=T[this.name].apply(T,this.args)}),T.done(c.resolve).fail(c.reject)}}).fail(p)}catch(S){p(S)}return c.promise()},a={};return x(["sortBy","thenBy","filter","slice","select","groupBy"],function(){var o=String(this);a[o]=function(){return e(t,i,r.concat(n(o,arguments)))}}),x(["count","min","max","sum","avg","aggregate","enumerate"],function(){var o=String(this);a[o]=function(){return s.call(this,n(o,arguments))}}),a},vn={array:Be,remote:mn},Ie=function(){var e=Array.isArray(arguments[0])?"array":"remote";return vn[e].apply(this,arguments)},pn=j.inherit({ctor:function(e){Array.isArray(e)?e={data:e}:e=e||{},this.callBase(e);var t=e.data;if(t&&!Array.isArray(t))throw A.Error("E4006");this._array=t||[]},createQuery:function(){return Ie(this._array,{errorHandler:this._errorHandler})},_byKeyImpl:function(e){var t=ye(this,this._array,e);return t===-1?di(A.Error("E4009")):ne(this._array[t])},_insertImpl:function(e){return pi(this,this._array,e)},_pushImpl:function(e){at({keyInfo:this,data:this._array,changes:e})},_updateImpl:function(e,t){return vi(this,this._array,e,t)},_removeImpl:function(e){return gi(this,this._array,e)},clear:function(){this._eventsStrategy.fireEvent("modifying"),this._array=[],this._eventsStrategy.fireEvent("modified")}},"array"),gn=["items"],Di="canceled",Lt=e=>e.state()==="pending",Tt=e=>{switch(e.length){case 0:return;case 1:return e[0]}return[].slice.call(e)},In=(e,t,i)=>oe(e,r=>{var n=pr(r,gn);return Se({},n,{items:Li(r.items,t-1,i)})}),Li=(e,t,i)=>Array.isArray(e)?t?In(e,t,i):oe(e,i):e,Sn=(e,t,i)=>{var r=i?Ve(i).length:0;return Li(e,r,t)},Ti=(e,t)=>{var i;return(i=e)!==null&&i!==void 0&&i.data&&(t=e,e=e.data),Array.isArray(e)||(e=[e]),{data:e,extra:t}},yn=e=>{var t={};return x(["useDefaultSearch","key","load","loadMode","cacheRawData","byKey","lookup","totalCount","insert","update","remove"],function(){t[this]=e[this],delete e[this]}),new ct(t)},Cn=e=>{var t=e.type;return delete e.type,j.create(t,e)},bn=(e,t)=>new ct({load:()=>_n.sendRequest({url:e,dataType:"json"}),loadMode:t==null?void 0:t.fromUrlLoadMode}),wi=(e,t)=>{var i;return typeof e=="string"&&(e={paginate:!1,store:bn(e,t)}),e===void 0&&(e=[]),Array.isArray(e)||e instanceof j?e={store:e}:e=b({},e),e.store===void 0&&(e.store=[]),i=e.store,"load"in e?i=yn(e):Array.isArray(i)?i=new pn(i):G(i)&&(i=Cn(b({},i))),e.store=i,e};class En{constructor(){this._counter=-1,this._deferreds={}}add(t){return this._counter++,this._deferreds[this._counter]=t,this._counter}remove(t){return delete this._deferreds[t]}cancel(t){return t in this._deferreds?(this._deferreds[t].reject(Di),!0):!1}cancelAll(){for(;this._counter>-1;)this.cancel(this._counter),this._counter--}}var Je=B.inherit({ctor(e){var t;e=wi(e),this._eventsStrategy=new ei(this,{syncStrategy:!0}),this._store=e.store,this._changedTime=0;var i=e.pushAggregationTimeout!==0;if(i){var r=e.pushAggregationTimeout===void 0?()=>5*this._changedTime:e.pushAggregationTimeout,n,s,a=Dr(o=>{n.resolve();var c=L(...s);c.done(()=>this._onPush(o)),s=void 0,n=void 0},r);this._onPushHandler=o=>{this._aggregationTimeoutId=a(o.changes),n||(n=new v),s=o.waitFor,o.waitFor.push(n.promise())},this._store.on("beforePushAggregation",this._onPushHandler)}else this._onPushHandler=o=>this._onPush(o),this._store.on("push",this._onPushHandler);this._storeLoadOptions=this._extractLoadOptions(e),this._mapFunc=e.map,this._postProcessFunc=e.postProcess,this._pageIndex=e.pageIndex!==void 0?e.pageIndex:0,this._pageSize=e.pageSize!==void 0?e.pageSize:20,this._loadingCount=0,this._loadQueue=this._createLoadQueue(),this._searchValue="searchValue"in e?e.searchValue:null,this._searchOperation=e.searchOperation||"contains",this._searchExpr=e.searchExpr,this._paginate=e.paginate,this._reshapeOnPush=(t=e.reshapeOnPush)!==null&&t!==void 0?t:!1,x(["onChanged","onLoadError","onLoadingChanged","onCustomizeLoadResult","onCustomizeStoreLoadOptions"],(o,c)=>{c in e&&this.on(c.substr(2,1).toLowerCase()+c.substr(3),e[c])}),this._operationManager=new En,this._init()},_init(){this._items=[],this._userData={},this._totalCount=-1,this._isLoaded=!1,E(this._paginate)||(this._paginate=!this.group()),this._isLastPage=!this._paginate},dispose(){var e;this._store.off("beforePushAggregation",this._onPushHandler),this._store.off("push",this._onPushHandler),this._eventsStrategy.dispose(),clearTimeout(this._aggregationTimeoutId),(e=this._delayedLoadTask)===null||e===void 0||e.abort(),this._operationManager.cancelAll(),delete this._store,delete this._items,delete this._delayedLoadTask,this._disposed=!0},_extractLoadOptions(e){var t={},i=["sort","filter","langParams","select","group","requireTotalCount"],r=this._store._customLoadOptions();return r&&(i=i.concat(r)),x(i,function(){t[this]=e[this]}),t},loadOptions(){return this._storeLoadOptions},items(){return this._items},pageIndex(e){if(!St(e))return this._pageIndex;this._pageIndex=e,this._isLastPage=!this._paginate},paginate(e){if(!yt(e))return this._paginate;this._paginate!==e&&(this._paginate=e,this.pageIndex(0))},pageSize(e){if(!St(e))return this._pageSize;this._pageSize=e},isLastPage(){return this._isLastPage},generateStoreLoadOptionAccessor(e){return t=>{var i=Tt(t);if(i===void 0)return this._storeLoadOptions[e];this._storeLoadOptions[e]=i}},sort(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.generateStoreLoadOptionAccessor("sort")(t)},filter(){var e=Tt(arguments);if(e===void 0)return this._storeLoadOptions.filter;this._storeLoadOptions.filter=e,this.pageIndex(0)},group(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.generateStoreLoadOptionAccessor("group")(t)},select(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.generateStoreLoadOptionAccessor("select")(t)},requireTotalCount(e){if(!yt(e))return this._storeLoadOptions.requireTotalCount;this._storeLoadOptions.requireTotalCount=e},searchValue(e){if(arguments.length<1)return this._searchValue;this._searchValue=e,this.pageIndex(0)},searchOperation(e){if(!Y(e))return this._searchOperation;this._searchOperation=e,this.pageIndex(0)},searchExpr(e){var t=arguments.length;if(t===0)return this._searchExpr;t>1&&(e=[].slice.call(arguments)),this._searchExpr=e,this.pageIndex(0)},store(){return this._store},key(){var e;return(e=this._store)===null||e===void 0?void 0:e.key()},totalCount(){return this._totalCount},isLoaded(){return this._isLoaded},isLoading(){return this._loadingCount>0},beginLoading(){this._changeLoadingCount(1)},endLoading(){this._changeLoadingCount(-1)},_createLoadQueue:()=>jr(),_changeLoadingCount(e){var t=this.isLoading();this._loadingCount+=e;var i=this.isLoading();t^i&&this._eventsStrategy.fireEvent("loadingChanged",[i])},_scheduleLoadCallbacks(e){this.beginLoading(),e.always(()=>{this.endLoading()})},_scheduleFailCallbacks(e){var t=this;e.fail(function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];r[0]!==Di&&t._eventsStrategy.fireEvent("loadError",r)})},_fireChanged(e){var t=new Date;this._eventsStrategy.fireEvent("changed",e),this._changedTime=new Date-t},_scheduleChangedCallbacks(e){e.done(()=>this._fireChanged())},loadSingle(e,t){var i=new v,r=this.key(),n=this._store,s=this._createStoreLoadOptions();return this._scheduleFailCallbacks(i),arguments.length<2&&(t=e,e=r),delete s.skip,delete s.group,delete s.refresh,delete s.pageIndex,delete s.searchString,(()=>e===r||n instanceof ct&&!n._byKeyViaLoad()?n.byKey(t,s):(s.take=1,s.filter=s.filter?[s.filter,[e,t]]:[e,t],n.load(s)))().fail(i.reject).done(a=>{var o=Array.isArray(a)&&!a.length;!E(a)||o?i.reject(new A.Error("E4009")):(Array.isArray(a)||(a=[a]),i.resolve(this._applyMapFunction(a)[0]))}),i.promise()},load(){var e=new v,t=()=>{if(!this._disposed&&Lt(e))return this._loadFromStore(i,e)};this._scheduleLoadCallbacks(e),this._scheduleFailCallbacks(e),this._scheduleChangedCallbacks(e);var i=this._createLoadOperation(e);return this._eventsStrategy.fireEvent("customizeStoreLoadOptions",[i]),this._loadQueue.add(()=>(typeof i.delay=="number"?this._delayedLoadTask=_r(t,i.delay):t(),e.promise())),e.promise({operationId:i.operationId})},_onPush(e){if(this._reshapeOnPush)this.load();else{var t={changes:e};this._eventsStrategy.fireEvent("changing",[t]);var i=this.group(),r=this.items(),n=0,s=this.paginate()||i?e.filter(a=>a.type==="update"):e;i&&(n=Array.isArray(i)?i.length:1),this._mapFunc&&s.forEach(a=>{a.type==="insert"&&(a.data=this._mapFunc(a.data))}),t.postProcessChanges&&(s=t.postProcessChanges(s)),at({keyInfo:this.store(),data:r,changes:s,groupCount:n,useInsertIndex:!0}),this._fireChanged([{changes:e}])}},_createLoadOperation(e){var t=this._operationManager.add(e),i=this._createStoreLoadOptions();return this._store&&!rt(i==null?void 0:i.langParams)&&(this._store._langParams=Se({},this._store._langParams,i.langParams)),e.always(()=>this._operationManager.remove(t)),{operationId:t,storeLoadOptions:i}},reload(){var e=this.store();return e._clearCache(),this._init(),this.load()},cancel(e){return this._operationManager.cancel(e)},cancelAll(){return this._operationManager.cancelAll()},_addSearchOptions(e){this._disposed||(this.store()._useDefaultSearch?this._addSearchFilter(e):(e.searchOperation=this._searchOperation,e.searchValue=this._searchValue,e.searchExpr=this._searchExpr))},_createStoreLoadOptions(){var e=b({},this._storeLoadOptions);return this._addSearchOptions(e),this._paginate&&this._pageSize&&(e.skip=this._pageIndex*this._pageSize,e.take=this._pageSize),e.userData=this._userData,e},_addSearchFilter(e){var t=this._searchValue,i=this._searchOperation,r=this._searchExpr,n=[];t&&(r||(r="this"),Array.isArray(r)||(r=[r]),x(r,function(s,a){n.length&&n.push("or"),n.push([a,i,t])}),e.filter?e.filter=[n,e.filter]:e.filter=n)},_loadFromStore(e,t){var i=(r,n)=>{if(!this._disposed&&Lt(t)){var s=b(Ti(r,n),e);this._eventsStrategy.fireEvent("customizeLoadResult",[s]),L(s.data).done(a=>{s.data=a,this._processStoreLoadResult(s,t)}).fail(t.reject)}};return e.data?new v().resolve(e.data).done(i):this.store().load(e.storeLoadOptions).done(i).fail(t.reject)},_processStoreLoadResult(e,t){var i=e.data,r=e.extra,n=e.storeLoadOptions,s=()=>(this._isLoaded=!0,this._totalCount=isFinite(r.totalCount)?r.totalCount:-1,t.resolve(i,r));this._disposed||(i=this._applyPostProcessFunction(this._applyMapFunction(i)),R(r)||(r={}),this._items=i,(!i.length||!this._paginate||this._pageSize&&i.length<this._pageSize)&&(this._isLastPage=!0),n.requireTotalCount&&!isFinite(r.totalCount)?this.store().totalCount(n).done(function(a){r.totalCount=a,s()}).fail(t.reject):s())},_applyMapFunction(e){return this._mapFunc?Sn(e,this._mapFunc,this.group()):e},_applyPostProcessFunction(e){return this._postProcessFunc?this._postProcessFunc(e):e},on(e,t){return this._eventsStrategy.on(e,t),this},off(e,t){return this._eventsStrategy.off(e,t),this}}),Oe=function(e,t){var i=t(e);if(R(i))try{return JSON.stringify(i)}catch{return i}return i},xn=function(e,t,i,r){var n=Oe(e,r);return t[i[n]]},On=function(e,t){if(e.length!==t.length)return!1;for(var i=0;i<t.length;i++)if(e[i]!==t[i])return!1;return!0},ks=function(e,t,i,r){var n={},s={},a=0,o=0,c=[];e.forEach(function(C,T){var le=Oe(C,i);n[le]=T}),t.forEach(function(C,T){var le=Oe(C,i);s[le]=T});for(var l=Math.max(e.length,t.length),h=0;h<l+a;h++){var u=t[h],d=h-a+o,_=e[d],p=!u||_&&!xn(_,t,s,i);if(p)_&&(c.push({type:"remove",key:i(_),index:h,oldItem:_}),o++,h--);else{var y=Oe(u,i),I=n[y],S=e[I];if(!S)a++,c.push({type:"insert",data:u,index:h});else if(I===d)r(S,u)||c.push({type:"update",data:u,key:i(u),index:h,oldItem:S});else return}}return c},An={load:()=>v().reject(),loadSingle:()=>v().reject(),loadFromStore:()=>v().reject(),loadNextPage:()=>v().reject(),loadOptions:m,userData:m,cancel:m,cancelAll:m,filter:m,addSearchFilter:m,group:m,paginate:m,pageSize:m,pageIndex:m,resetDataSourcePageIndex:m,totalCount:m,isLastPage:m,isLoading:m,isLoaded:m,searchValue:m,searchOperation:m,searchExpr:m,select:m,key:m,keyOf:m,store:m,items:m,applyMapFunction:m,getDataSource:m,reload:m,on:m,off:m};class Dn{constructor(t){if(!t)return An;this._dataSource=t}load(){return this._dataSource.load()}loadSingle(t,i){return arguments.length<2&&(i=t,t=this.key()),this._dataSource.loadSingle(t,i)}loadFromStore(t){return this.store().load(t)}loadNextPage(){return this.pageIndex(1+this.pageIndex()),this.load()}loadOptions(){return this._dataSource.loadOptions()}userData(){return this._dataSource._userData}cancel(t){this._dataSource.cancel(t)}cancelAll(){this._dataSource.cancelAll()}filter(t){return this._dataSource.filter(t)}addSearchFilter(t){this._dataSource._addSearchFilter(t)}group(t){return this._dataSource.group(t)}paginate(){return this._dataSource.paginate()}pageSize(){return this._dataSource._pageSize}pageIndex(t){return this._dataSource.pageIndex(t)}resetDataSourcePageIndex(){this.pageIndex()&&(this.pageIndex(0),this.load())}totalCount(){return this._dataSource.totalCount()}isLastPage(){return this._dataSource.isLastPage()||!this._dataSource._pageSize}isLoading(){return this._dataSource.isLoading()}isLoaded(){return this._dataSource.isLoaded()}searchValue(t){return arguments.length?this._dataSource.searchValue(t):this._dataSource.searchValue()}searchOperation(t){return this._dataSource.searchOperation(t)}searchExpr(t){return arguments.length?this._dataSource.searchExpr(t):this._dataSource.searchExpr()}select(){return this._dataSource.select(...arguments)}key(){return this._dataSource.key()}keyOf(t){return this.store().keyOf(t)}store(){return this._dataSource.store()}items(){return this._dataSource.items()}applyMapFunction(t){return this._dataSource._applyMapFunction(t)}getDataSource(){return this._dataSource||null}reload(){return this._dataSource.reload()}on(t,i){this._dataSource.on(t,i)}off(t,i){this._dataSource.off(t,i)}}var wt="_dataSourceOptions",Rt="_dataSourceChangedHandler",Bt="_dataSourceLoadErrorHandler",Ft="_dataSourceLoadingChangedHandler",Ht="_dataSourceFromUrlLoadMode",Mt="_getSpecificDataSourceOption",Pt="_normalizeDataSource",Ln={postCtor:function(){this.on("disposing",(function(){this._disposeDataSource()}).bind(this))},_refreshDataSource:function(){this._initDataSource(),this._loadDataSource()},_initDataSource:function(){var e=Mt in this?this[Mt]():this.option("dataSource"),t,i;this._disposeDataSource(),e&&(e instanceof Je?(this._isSharedDataSource=!0,this._dataSource=e):(t=wt in this?this[wt]():{},i=this._dataSourceType?this._dataSourceType():Je,e=wi(e,{fromUrlLoadMode:Ht in this&&this[Ht]()}),this._dataSource=new i(b(!0,{},t,e))),Pt in this&&(this._dataSource=this[Pt](this._dataSource)),this._addDataSourceHandlers(),this._initDataController())},_initDataController:function(){var e,t=(e=this.option)===null||e===void 0?void 0:e.call(this,"_dataController"),i=this._dataSource;t?this._dataController=t:this._dataController=new Dn(i)},_addDataSourceHandlers:function(){Rt in this&&this._addDataSourceChangeHandler(),Bt in this&&this._addDataSourceLoadErrorHandler(),Ft in this&&this._addDataSourceLoadingChangedHandler(),this._addReadyWatcher()},_addReadyWatcher:function(){this._dataSource.on("loadingChanged",(function(e){this._ready&&this._ready(!e)}).bind(this))},_addDataSourceChangeHandler:function(){var e=this._dataSource;this._proxiedDataSourceChangedHandler=(function(t){this[Rt](e.items(),t)}).bind(this),e.on("changed",this._proxiedDataSourceChangedHandler)},_addDataSourceLoadErrorHandler:function(){this._proxiedDataSourceLoadErrorHandler=this[Bt].bind(this),this._dataSource.on("loadError",this._proxiedDataSourceLoadErrorHandler)},_addDataSourceLoadingChangedHandler:function(){this._proxiedDataSourceLoadingChangedHandler=this[Ft].bind(this),this._dataSource.on("loadingChanged",this._proxiedDataSourceLoadingChangedHandler)},_loadDataSource:function(){var e=this._dataSource;e&&(e.isLoaded()?this._proxiedDataSourceChangedHandler&&this._proxiedDataSourceChangedHandler():e.load())},_loadSingle:function(e,t){return e=e==="this"?this._dataSource.key()||"this":e,this._dataSource.loadSingle(e,t)},_isLastPage:function(){return!this._dataSource||this._dataSource.isLastPage()||!this._dataSource._pageSize},_isDataSourceLoading:function(){return this._dataSource&&this._dataSource.isLoading()},_disposeDataSource:function(){this._dataSource&&(this._isSharedDataSource?(delete this._isSharedDataSource,this._proxiedDataSourceChangedHandler&&this._dataSource.off("changed",this._proxiedDataSourceChangedHandler),this._proxiedDataSourceLoadErrorHandler&&this._dataSource.off("loadError",this._proxiedDataSourceLoadErrorHandler),this._proxiedDataSourceLoadingChangedHandler&&this._dataSource.off("loadingChanged",this._proxiedDataSourceLoadingChangedHandler)):this._dataSource.dispose(),delete this._dataSource,delete this._proxiedDataSourceChangedHandler,delete this._proxiedDataSourceLoadErrorHandler,delete this._proxiedDataSourceLoadingChangedHandler)},getDataSource:function(){return this._dataSource||null}},Tn=B.abstract,wn=B.inherit({ctor:function(){this._finished=!0,this._stopped=!1,this._proxiedStepCore=this._stepCore.bind(this)},start:function(){this._stopped=!1,this._finished=!1,this._stepCore()},stop:function(){this._stopped=!0,Wi(this._stepAnimationFrame)},_stepCore:function(){if(this._isStopped()){this._stop();return}if(this._isFinished()){this._finished=!0,this._complete();return}this._step(),this._stepAnimationFrame=Ui(this._proxiedStepCore)},_step:Tn,_isFinished:m,_stop:m,_complete:m,_isStopped:function(){return this._stopped},inProgress:function(){return!(this._stopped||this._finished)}}),Ze="dxScrollbar",Ri="dx-scrollable-scrollbar",Kt="".concat(Ri,"-active"),Rn="dx-scrollable-scroll",Bn="dx-scrollable-scroll-content",Fn="dx-scrollbar-hoverable",Nt="horizontal",Hn=15,$={onScroll:"onScroll",onHover:"onHover",always:"always",never:"never"},ie=null,Bi=ti.inherit({_getDefaultOptions:function(){return b(this.callBase(),{direction:null,visible:!1,activeStateEnabled:!1,visibilityMode:$.onScroll,containerSize:0,contentSize:0,expandable:!0,scaleRatio:1})},_init:function(){this.callBase(),this._isHovered=!1},_initMarkup:function(){this._renderThumb(),this.callBase()},_render:function(){this.callBase(),this._renderDirection(),this._update(),this._attachPointerDownHandler(),this.option("hoverStateEnabled",this._isHoverMode()),this.$element().toggleClass(Fn,this.option("hoverStateEnabled"))},_renderThumb:function(){this._$thumb=f("<div>").addClass(Rn),f("<div>").addClass(Bn).appendTo(this._$thumb),this.$element().addClass(Ri).append(this._$thumb)},isThumb:function(e){return!!this.$element().find(e).length},_isHoverMode:function(){var e=this.option("visibilityMode");return(e===$.onHover||e===$.always)&&this.option("expandable")},_renderDirection:function(){var e=this.option("direction");this.$element().addClass("dx-scrollbar-"+e),this._dimension=e===Nt?"width":"height",this._prop=e===Nt?"left":"top"},_attachPointerDownHandler:function(){g.on(this._$thumb,O(et.down,Ze),this.feedbackOn.bind(this))},feedbackOn:function(){this.$element().addClass(Kt),ie=this},feedbackOff:function(){this.$element().removeClass(Kt),ie=null},cursorEnter:function(){this._isHovered=!0,this._needScrollbar()&&this.option("visible",!0)},cursorLeave:function(){this._isHovered=!1,this.option("visible",!1)},_renderDimensions:function(){this._$thumb.css({width:this.option("width"),height:this.option("height")})},_toggleVisibility:function(e){this.option("visibilityMode")===$.onScroll&&this._$thumb.css("opacity"),e=this._adjustVisibility(e),this.option().visible=e,this._$thumb.toggleClass("dx-state-invisible",!e)},_adjustVisibility:function(e){if(this._baseContainerToContentRatio&&!this._needScrollbar())return!1;switch(this.option("visibilityMode")){case $.onScroll:break;case $.onHover:e=e||!!this._isHovered;break;case $.never:e=!1;break;case $.always:e=!0}return e},moveTo:function(e){if(!this._isHidden()){G(e)&&(e=e[this._prop]||0);var t={};t[this._prop]=this._calculateScrollBarPosition(e),ii(this._$thumb,t)}},_calculateScrollBarPosition:function(e){return-e*this._thumbRatio},_update:function(){var e=Math.round(this.option("containerSize")),t=Math.round(this.option("contentSize")),i=Math.round(this.option("baseContainerSize")),r=Math.round(this.option("baseContentSize"));isNaN(i)&&(i=e,r=t),this._baseContainerToContentRatio=r?i/r:i,this._realContainerToContentRatio=t?e/t:e;var n=Math.round(Math.max(Math.round(e*this._realContainerToContentRatio),Hn));this._thumbRatio=(e-n)/(this.option("scaleRatio")*(t-e)),this.option(this._dimension,n/this.option("scaleRatio")),this.$element().css("display",this._needScrollbar()?"":"none")},_isHidden:function(){return this.option("visibilityMode")===$.never},_needScrollbar:function(){return!this._isHidden()&&this._baseContainerToContentRatio<1},containerToContentRatio:function(){return this._realContainerToContentRatio},_normalizeSize:function(e){return G(e)?e[this._dimension]||0:e},_clean:function(){this.callBase(),this===ie&&(ie=null),g.off(this._$thumb,"."+Ze)},_optionChanged:function(e){if(!this._isHidden())switch(e.name){case"containerSize":case"contentSize":this.option()[e.name]=this._normalizeSize(e.value),this._update();break;case"baseContentSize":case"baseContainerSize":this._update();break;case"visibilityMode":case"direction":this._invalidate();break;case"scaleRatio":this._update();break;default:this.callBase.apply(this,arguments)}},update:de(function(){this._adjustVisibility()&&this.option("visible",!0)})});Zt.add(function(){g.subscribeGlobal(P.getDocument(),O(et.up,Ze),function(){ie&&ie.feedbackOff()})});var Fi="dxSimulatedScrollable",Mn="dxScrollableStrategy",be=Fi+"Cursor",Me=Fi+"Keyboard",Pe="dx-scrollable-simulated",Pn="dx-scrollable-scrollbars-alwaysvisible",Kn="dx-scrollable-scrollbar",K="vertical",D="horizontal",we=.92,Hi=.5,Mi=1,Nn=Math.round(1e3/60),kn=40,$n=500,zn=Mi/5,Wn=400,Un=Wn/Nn,jn=(1-Math.pow(we,Un))/(1-we),z={PAGE_UP:"pageUp",PAGE_DOWN:"pageDown",END:"end",HOME:"home",LEFT:"leftArrow",UP:"upArrow",RIGHT:"rightArrow",DOWN:"downArrow",TAB:"tab"},Pi=wn.inherit({ctor:function(e){this.callBase(),this.scroller=e},VELOCITY_LIMIT:Mi,_isFinished:function(){return Math.abs(this.scroller._velocity)<=this.VELOCITY_LIMIT},_step:function(){this.scroller._scrollStep(this.scroller._velocity),this.scroller._velocity*=this._acceleration()},_acceleration:function(){return this.scroller._inBounds()?we:Hi},_complete:function(){this.scroller._scrollComplete()}}),Vn=Pi.inherit({VELOCITY_LIMIT:zn,_isFinished:function(){return this.scroller._crossBoundOnNextStep()||this.callBase()},_acceleration:function(){return we},_complete:function(){this.scroller._move(this.scroller._bounceLocation),this.callBase()}}),Gn=B.inherit({ctor:function(e){this._initOptions(e),this._initAnimators(),this._initScrollbar()},_initOptions:function(e){this._location=0,this._topReached=!1,this._bottomReached=!1,this._axis=e.direction===D?"x":"y",this._prop=e.direction===D?"left":"top",this._dimension=e.direction===D?"width":"height",this._scrollProp=e.direction===D?"scrollLeft":"scrollTop",x(e,(t,i)=>{this["_"+t]=i})},_initAnimators:function(){this._inertiaAnimator=new Pi(this),this._bounceAnimator=new Vn(this)},_initScrollbar:function(){this._scrollbar=new Bi(f("<div>").appendTo(this._$container),{direction:this._direction,visible:this._scrollByThumb,visibilityMode:this._visibilityModeNormalize(this._scrollbarVisible),expandable:this._scrollByThumb}),this._$scrollbar=this._scrollbar.$element()},_visibilityModeNormalize:function(e){return e===!0?"onScroll":e===!1?"never":e},_scrollStep:function(e){var t=this._location;this._location+=e,this._suppressBounce(),this._move(),!(Math.abs(t-this._location)<1)&&g.triggerHandler(this._$container,{type:"scroll"})},_suppressBounce:function(){this._bounceEnabled||this._inBounds(this._location)||(this._velocity=0,this._location=this._boundLocation())},_boundLocation:function(e){return e=e!==void 0?e:this._location,Math.max(Math.min(e,this._maxOffset),this._minOffset)},_move:function(e){this._location=e!==void 0?e*this._getScaleRatio():this._location,this._moveContent(),this._moveScrollbar()},_moveContent:function(){var e=this._location;this._$container[this._scrollProp](-e/this._getScaleRatio()),this._moveContentByTranslator(e)},_getScaleRatio:function(){if(ve()&&!this._scaleRatio){var e=this._$element.get(0),t=this._getRealDimension(e,this._dimension),i=this._getBaseDimension(e,this._dimension);this._scaleRatio=Math.round(t/i*100)/100}return this._scaleRatio||1},_getRealDimension:function(e,t){return Math.round(ji(e)[t])},_getBaseDimension:function(e,t){var i="offset"+Le(t);return e[i]},_moveContentByTranslator:function(e){var t,i=-this._maxScrollPropValue;if(e>0?t=e:e<=i?t=e-i:t=e%1,this._translateOffset!==t){var r={};if(r[this._prop]=t,this._translateOffset=t,t===0){Vi(this._$content);return}ii(this._$content,r)}},_moveScrollbar:function(){this._scrollbar.moveTo(this._location)},_scrollComplete:function(){this._inBounds()&&(this._hideScrollbar(),this._completeDeferred&&this._completeDeferred.resolve()),this._scrollToBounds()},_scrollToBounds:function(){this._inBounds()||(this._bounceAction(),this._setupBounce(),this._bounceAnimator.start())},_setupBounce:function(){var e=this._bounceLocation=this._boundLocation(),t=e-this._location;this._velocity=t/jn},_inBounds:function(e){return e=e!==void 0?e:this._location,this._boundLocation(e)===e},_crossBoundOnNextStep:function(){var e=this._location,t=e+this._velocity;return e<this._minOffset&&t>=this._minOffset||e>this._maxOffset&&t<=this._maxOffset},_initHandler:function(e){this._stopScrolling(),this._prepareThumbScrolling(e)},_stopScrolling:de(function(){this._hideScrollbar(),this._inertiaAnimator.stop(),this._bounceAnimator.stop()}),_prepareThumbScrolling:function(e){if(!X(e.originalEvent)){var t=f(e.originalEvent.target),i=this._isScrollbar(t);i&&this._moveToMouseLocation(e),this._thumbScrolling=i||this._isThumb(t),this._crossThumbScrolling=!this._thumbScrolling&&this._isAnyThumbScrolling(t),this._thumbScrolling&&this._scrollbar.feedbackOn()}},_isThumbScrollingHandler:function(e){return this._isThumb(e)},_moveToMouseLocation:function(e){var t=e["page"+this._axis.toUpperCase()]-this._$element.offset()[this._prop],i=this._location+t/this._containerToContentRatio()-Q(this._$container)/2;this._scrollStep(-Math.round(i))},_startHandler:function(){this._showScrollbar()},_moveHandler:function(e){this._crossThumbScrolling||(this._thumbScrolling&&(e[this._axis]=-Math.round(e[this._axis]/this._containerToContentRatio())),this._scrollBy(e))},_scrollBy:function(e){e=e[this._axis],this._inBounds()||(e*=Hi),this._scrollStep(e)},_scrollByHandler:function(e){this._scrollBy(e),this._scrollComplete()},_containerToContentRatio:function(){return this._scrollbar.containerToContentRatio()},_endHandler:function(e){return this._completeDeferred=new v,this._velocity=e[this._axis],this._inertiaHandler(),this._resetThumbScrolling(),this._completeDeferred.promise()},_inertiaHandler:function(){this._suppressInertia(),this._inertiaAnimator.start()},_suppressInertia:function(){(!this._inertiaEnabled||this._thumbScrolling)&&(this._velocity=0)},_resetThumbScrolling:function(){this._thumbScrolling=!1,this._crossThumbScrolling=!1},_stopHandler:function(){this._thumbScrolling&&this._scrollComplete(),this._resetThumbScrolling(),this._scrollToBounds()},_disposeHandler:function(){this._stopScrolling(),this._$scrollbar.remove()},_updateHandler:function(){this._update(),this._moveToBounds()},_update:function(){return this._stopScrolling(),hi(()=>{this._resetScaleRatio(),this._updateLocation(),this._updateBounds(),this._updateScrollbar(),je(()=>{this._moveScrollbar(),this._scrollbar.update()})})},_resetScaleRatio:function(){this._scaleRatio=null},_updateLocation:function(){this._location=(ri(this._$content)[this._prop]-this._$container[this._scrollProp]())*this._getScaleRatio()},_updateBounds:function(){this._maxOffset=this._getMaxOffset(),this._minOffset=this._getMinOffset()},_getMaxOffset:function(){return 0},_getMinOffset:function(){return this._maxScrollPropValue=Math.max(this._contentSize()-this._containerSize(),0),-this._maxScrollPropValue},_updateScrollbar:Ct(function(){var e=this._containerSize(),t=this._contentSize(),i=this._getBaseDimension(this._$container.get(0),this._dimension),r=this._getBaseDimension(this._$content.get(0),this._dimension);je(()=>{this._scrollbar.option({containerSize:e,contentSize:t,baseContainerSize:i,baseContentSize:r,scaleRatio:this._getScaleRatio()})})}),_moveToBounds:de(Ct(de(function(){var e=this._boundLocation(),t=e!==this._location;this._location=e,this._move(),t&&this._scrollAction()}))),_createActionsHandler:function(e){this._scrollAction=e.scroll,this._bounceAction=e.bounce},_showScrollbar:function(){this._scrollbar.option("visible",!0)},_hideScrollbar:function(){this._scrollbar.option("visible",!1)},_containerSize:function(){return this._getRealDimension(this._$container.get(0),this._dimension)},_contentSize:function(){var e=this._$content.css("overflow"+this._axis.toUpperCase())==="hidden",t=this._getRealDimension(this._$content.get(0),this._dimension);if(!e){var i=this._$content[0]["scroll"+Le(this._dimension)]*this._getScaleRatio();t=Math.max(i,t)}return t},_validateEvent:function(e){var t=f(e.originalEvent.target);return this._isThumb(t)||this._isScrollbar(t)},_isThumb:function(e){return this._scrollByThumb&&this._scrollbar.isThumb(e)},_isScrollbar:function(e){return this._scrollByThumb&&e&&e.is(this._$scrollbar)},_reachedMin:function(){return Math.round(this._location-this._minOffset)<=0},_reachedMax:function(){return Math.round(this._location-this._maxOffset)>=0},_cursorEnterHandler:function(){this._resetScaleRatio(),this._updateScrollbar(),this._scrollbar.cursorEnter()},_cursorLeaveHandler:function(){this._scrollbar.cursorLeave()},dispose:m}),H,te,qn=B.inherit({ctor:function(e){this._init(e)},_init:function(e){this._component=e,this._$element=e.$element(),this._$container=f(e.container()),this._$wrapper=e._$wrapper,this._$content=e.$content(),this.option=e.option.bind(e),this._createActionByOption=e._createActionByOption.bind(e),this._isLocked=e._isLocked.bind(e),this._isDirection=e._isDirection.bind(e),this._allowedDirection=e._allowedDirection.bind(e),this._getMaxOffset=e._getMaxOffset.bind(e)},render:function(){this._$element.addClass(Pe),this._createScrollers(),this.option("useKeyboard")&&this._$container.prop("tabIndex",0),this._attachKeyboardHandler(),this._attachCursorHandlers()},_createScrollers:function(){this._scrollers={},this._isDirection(D)&&this._createScroller(D),this._isDirection(K)&&this._createScroller(K),this._$element.toggleClass(Pn,this.option("showScrollbar")==="always")},_createScroller:function(e){this._scrollers[e]=new Gn(this._scrollerOptions(e))},_scrollerOptions:function(e){return{direction:e,$content:this._$content,$container:this._$container,$wrapper:this._$wrapper,$element:this._$element,scrollByThumb:this.option("scrollByThumb"),scrollbarVisible:this.option("showScrollbar"),bounceEnabled:this.option("bounceEnabled"),inertiaEnabled:this.option("inertiaEnabled"),isAnyThumbScrolling:this._isAnyThumbScrolling.bind(this)}},_applyScaleRatio:function(e){for(var t in this._scrollers){var i=this._getPropByDirection(t);if(E(e[i])){var r=this._scrollers[t];e[i]*=r._getScaleRatio()}}return e},_isAnyThumbScrolling:function(e){var t=!1;return this._eventHandler("isThumbScrolling",e).done(function(i,r){t=i||r}),t},handleInit:function(e){this._suppressDirections(e),this._eventForUserAction=e,this._eventHandler("init",e)},_suppressDirections:function(e){if(X(e.originalEvent)){this._prepareDirections(!0);return}this._prepareDirections(),this._eachScroller(function(t,i){var r=f(e.originalEvent.target),n=t._validateEvent(e)||this.option("scrollByContent")&&this._isContent(r);this._validDirections[i]=n})},_isContent:function(e){return!!e.closest(this._$element).length},_prepareDirections:function(e){e=e||!1,this._validDirections={},this._validDirections[D]=e,this._validDirections[K]=e},_eachScroller:function(e){e=e.bind(this),x(this._scrollers,function(t,i){e(i,t)})},handleStart:function(e){this._eventForUserAction=e,this._eventHandler("start").done(this._startAction)},_saveActive:function(){te=this},_resetActive:function(){te===this&&(te=null)},handleMove:function(e){if(this._isLocked()){e.cancel=!0,this._resetActive();return}this._saveActive(),e.preventDefault&&e.preventDefault(),this._adjustDistance(e,e.delta),this._eventForUserAction=e,this._eventHandler("move",e.delta)},_adjustDistance:function(e,t){t.x*=this._validDirections[D],t.y*=this._validDirections[K];var i=this._tryGetDevicePixelRatio();i&&X(e.originalEvent)&&(t.x=Math.round(t.x/i*100)/100,t.y=Math.round(t.y/i*100)/100)},_tryGetDevicePixelRatio:function(){if(ve())return me().devicePixelRatio},handleEnd:function(e){return this._resetActive(),this._refreshCursorState(e.originalEvent&&e.originalEvent.target),this._adjustDistance(e,e.velocity),this._eventForUserAction=e,this._eventHandler("end",e.velocity).done(this._endAction)},handleCancel:function(e){return this._resetActive(),this._eventForUserAction=e,this._eventHandler("end",{x:0,y:0})},handleStop:function(){this._resetActive(),this._eventHandler("stop")},handleScroll:function(){this._updateRtlConfig(),this._scrollAction()},_attachKeyboardHandler:function(){g.off(this._$element,".".concat(Me)),!this.option("disabled")&&this.option("useKeyboard")&&g.on(this._$element,O("keydown",Me),this._keyDownHandler.bind(this))},_keyDownHandler:function(e){if(clearTimeout(this._updateHandlerTimeout),this._updateHandlerTimeout=setTimeout(()=>{mt(e)===z.TAB&&this._eachScroller(i=>{i._updateHandler()})}),!!this._$container.is(P.getActiveElement(this._$container.get(0)))){var t=!0;switch(mt(e)){case z.DOWN:this._scrollByLine({y:1});break;case z.UP:this._scrollByLine({y:-1});break;case z.RIGHT:this._scrollByLine({x:1});break;case z.LEFT:this._scrollByLine({x:-1});break;case z.PAGE_DOWN:this._scrollByPage(1);break;case z.PAGE_UP:this._scrollByPage(-1);break;case z.HOME:this._scrollToHome();break;case z.END:this._scrollToEnd();break;default:t=!1}t&&(e.stopPropagation(),e.preventDefault())}},_scrollByLine:function(e){var t=this._tryGetDevicePixelRatio(),i=kn;t&&(i=Math.abs(i/t*100)/100),this.scrollBy({top:(e.y||0)*-i,left:(e.x||0)*-i})},_scrollByPage:function(e){var t=this._wheelProp(),i=this._dimensionByProp(t),r={},n=i==="width"?re:Q;r[t]=e*-n(this._$container),this.scrollBy(r)},_dimensionByProp:function(e){return e==="left"?"width":"height"},_getPropByDirection:function(e){return e===D?"left":"top"},_scrollToHome:function(){var e=this._wheelProp(),t={};t[e]=0,this._component.scrollTo(t)},_scrollToEnd:function(){var e=this._wheelProp(),t=this._dimensionByProp(e),i={},r=t==="width"?re:Q;i[e]=r(this._$content)-r(this._$container),this._component.scrollTo(i)},createActions:function(){this._startAction=this._createActionHandler("onStart"),this._endAction=this._createActionHandler("onEnd"),this._updateAction=this._createActionHandler("onUpdated"),this._createScrollerActions()},_createScrollerActions:function(){this._scrollAction=this._createActionHandler("onScroll"),this._bounceAction=this._createActionHandler("onBounce"),this._eventHandler("createActions",{scroll:this._scrollAction,bounce:this._bounceAction})},_createActionHandler:function(e){var t=this._createActionByOption(e);return()=>{t(b(this._createActionArgs(),arguments))}},_createActionArgs:function(){var{horizontal:e,vertical:t}=this._scrollers,i=this._getScrollOffset();return this._scrollOffset={top:t&&i.top,left:e&&i.left},{event:this._eventForUserAction,scrollOffset:this._scrollOffset,reachedLeft:e&&e._reachedMax(),reachedRight:e&&e._reachedMin(),reachedTop:t&&t._reachedMax(),reachedBottom:t&&t._reachedMin()}},_getScrollOffset(){return{top:-this.location().top,left:-this.location().left}},_eventHandler:function(e){var t=[].slice.call(arguments).slice(1),i=oe(this._scrollers,r=>r["_"+e+"Handler"].apply(r,t));return L.apply(f,i).promise()},location:function(){var e=ri(this._$content);return e.top-=this._$container.scrollTop(),e.left-=this._$container.scrollLeft(),e},disabledChanged:function(){this._attachCursorHandlers()},_attachCursorHandlers:function(){g.off(this._$element,".".concat(be)),!this.option("disabled")&&this._isHoverMode()&&(g.on(this._$element,O("mouseenter",be),this._cursorEnterHandler.bind(this)),g.on(this._$element,O("mouseleave",be),this._cursorLeaveHandler.bind(this)))},_isHoverMode:function(){return this.option("showScrollbar")==="onHover"},_cursorEnterHandler:function(e){e=e||{},e.originalEvent=e.originalEvent||{},!(te||e.originalEvent._hoverHandled)&&(H&&H._cursorLeaveHandler(),H=this,this._eventHandler("cursorEnter"),e.originalEvent._hoverHandled=!0)},_cursorLeaveHandler:function(e){H!==this||te===H||(this._eventHandler("cursorLeave"),H=null,this._refreshCursorState(e&&e.relatedTarget))},_refreshCursorState:function(e){if(!(!this._isHoverMode()&&(!e||te))){var t=f(e),i=t.closest(".".concat(Pe,":not(.dx-state-disabled)")),r=i.length&&i.data(Mn);H&&H!==r&&H._cursorLeaveHandler(),r&&r._cursorEnterHandler()}},update:function(){var e=this._eventHandler("update").done(this._updateAction);return L(e,hi(()=>{var t=this._allowedDirections();return je(()=>{var i=t.vertical?"pan-x":"";i=t.horizontal?"pan-y":i,i=t.vertical&&t.horizontal?"none":i,this._$container.css("touchAction",i)}),L().promise()}))},_allowedDirections:function(){var e=this.option("bounceEnabled"),t=this._scrollers[K],i=this._scrollers[D];return{vertical:t&&(t._minOffset<0||e),horizontal:i&&(i._minOffset<0||e)}},_updateBounds:function(){this._scrollers[D]&&this._scrollers[D]._updateBounds()},_isHorizontalAndRtlEnabled:function(){return this.option("rtlEnabled")&&this.option("direction")!==K},updateRtlPosition:function(e){if(e&&(this._rtlConfig={scrollRight:0,clientWidth:this._$container.get(0).clientWidth,windowPixelRatio:this._getWindowDevicePixelRatio()}),this._updateBounds(),this._isHorizontalAndRtlEnabled()){var t=this._getMaxOffset().left-this._rtlConfig.scrollRight;t<=0&&(t=0,this._rtlConfig.scrollRight=this._getMaxOffset().left),this._getScrollOffset().left!==t&&(this._rtlConfig.skipUpdating=!0,this._component.scrollTo({left:t}),this._rtlConfig.skipUpdating=!1)}},_updateRtlConfig:function(){if(this._isHorizontalAndRtlEnabled()&&!this._rtlConfig.skipUpdating){var{clientWidth:e,scrollLeft:t}=this._$container.get(0),i=this._getWindowDevicePixelRatio();this._rtlConfig.windowPixelRatio===i&&this._rtlConfig.clientWidth===e&&(this._rtlConfig.scrollRight=this._getMaxOffset().left-t),this._rtlConfig.clientWidth=e,this._rtlConfig.windowPixelRatio=i}},_getWindowDevicePixelRatio:function(){return ve()?me().devicePixelRatio:1},scrollBy:function(e){var t=this._scrollers[K],i=this._scrollers[D];t&&(e.top=t._boundLocation(e.top+t._location)-t._location),i&&(e.left=i._boundLocation(e.left+i._location)-i._location),this._prepareDirections(!0),this._startAction(),this._eventHandler("scrollBy",{x:e.left,y:e.top}),this._endAction(),this._updateRtlConfig()},validate:function(e){return X(e)&&ni(e)||this.option("disabled")?!1:this.option("bounceEnabled")?!0:X(e)?this._validateWheel(e):this._validateMove(e)},_validateWheel:function(e){var t=this._scrollers[this._wheelDirection(e)],i=t._reachedMin(),r=t._reachedMax(),n=!i||!r,s=!i&&!r,a=i&&e.delta>0,o=r&&e.delta<0,c=n&&(s||a||o);return c=c||this._validateWheelTimer!==void 0,c&&(clearTimeout(this._validateWheelTimer),this._validateWheelTimer=setTimeout(()=>{this._validateWheelTimer=void 0},$n)),c},_validateMove:function(e){return!this.option("scrollByContent")&&!f(e.target).closest(".".concat(Kn)).length?!1:this._allowedDirection()},getDirection:function(e){return X(e)?this._wheelDirection(e):this._allowedDirection()},_wheelProp:function(){return this._wheelDirection()===D?"left":"top"},_wheelDirection:function(e){switch(this.option("direction")){case D:return D;case K:return K;default:return e&&e.shiftKey?D:K}},dispose:function(){this._resetActive(),H===this&&(H=null),this._eventHandler("dispose"),this._detachEventHandlers(),this._$element.removeClass(Pe),this._eventForUserAction=null,clearTimeout(this._validateWheelTimer),clearTimeout(this._updateHandlerTimeout)},_detachEventHandlers:function(){g.off(this._$element,".".concat(be)),g.off(this._$container,".".concat(Me))}}),kt="dxNativeScrollable",Ke="dx-scrollable-native",Xn="dx-scrollable-scrollbar-simulated",Qn="dx-scrollable-scrollbars-hidden",he="vertical",Ee="horizontal",Yn=500,Jn=B.inherit({ctor:function(e){this._init(e)},_init:function(e){this._component=e,this._$element=e.$element(),this._$container=f(e.container()),this._$content=e.$content(),this._direction=e.option("direction"),this._useSimulatedScrollbar=e.option("useSimulatedScrollbar"),this.option=e.option.bind(e),this._createActionByOption=e._createActionByOption.bind(e),this._isLocked=e._isLocked.bind(e),this._isDirection=e._isDirection.bind(e),this._allowedDirection=e._allowedDirection.bind(e),this._getMaxOffset=e._getMaxOffset.bind(e),this._isRtlNativeStrategy=e._isRtlNativeStrategy.bind(e)},render:function(){var e=ae.real(),t=e.platform;this._$element.addClass(Ke).addClass(Ke+"-"+t).toggleClass(Qn,!this._isScrollbarVisible()),this._isScrollbarVisible()&&this._useSimulatedScrollbar&&this._renderScrollbars()},updateRtlPosition:function(e){e&&this.option("rtlEnabled")&&this._isScrollbarVisible()&&this._useSimulatedScrollbar&&this._moveScrollbars()},_renderScrollbars:function(){this._scrollbars={},this._hideScrollbarTimeout=0,this._$element.addClass(Xn),this._renderScrollbar(he),this._renderScrollbar(Ee)},_renderScrollbar:function(e){this._isDirection(e)&&(this._scrollbars[e]=new Bi(f("<div>").appendTo(this._$element),{direction:e,expandable:this._component.option("scrollByThumb")}))},handleInit:m,handleStart:m,handleMove:function(e){if(this._isLocked()){e.cancel=!0;return}this._allowedDirection()&&(e.originalEvent.isScrollingEvent=!0)},handleEnd:m,handleCancel:m,handleStop:m,_eachScrollbar:function(e){e=e.bind(this),x(this._scrollbars||{},function(t,i){e(i,t)})},createActions:function(){this._scrollAction=this._createActionByOption("onScroll"),this._updateAction=this._createActionByOption("onUpdated")},_createActionArgs:function(){var{left:e,top:t}=this.location();return{event:this._eventForUserAction,scrollOffset:this._getScrollOffset(),reachedLeft:this._isRtlNativeStrategy()?this._isReachedRight(-e):this._isReachedLeft(e),reachedRight:this._isRtlNativeStrategy()?this._isReachedLeft(-Math.abs(e)):this._isReachedRight(e),reachedTop:this._isDirection(he)?Math.round(t)>=0:void 0,reachedBottom:this._isDirection(he)?Math.round(Math.abs(t)-this._getMaxOffset().top)>=0:void 0}},_getScrollOffset:function(){var{top:e,left:t}=this.location();return{top:-e,left:this._normalizeOffsetLeft(-t)}},_normalizeOffsetLeft(e){return this._isRtlNativeStrategy()?this._getMaxOffset().left+e:e},_isReachedLeft:function(e){return this._isDirection(Ee)?Math.round(e)>=0:void 0},_isReachedRight:function(e){return this._isDirection(Ee)?Math.round(Math.abs(e)-this._getMaxOffset().left)>=0:void 0},_isScrollbarVisible:function(){var{showScrollbar:e}=this.option();return e!=="never"&&e!==!1},handleScroll:function(e){this._eventForUserAction=e,this._moveScrollbars(),this._scrollAction(this._createActionArgs())},_moveScrollbars:function(){var{top:e,left:t}=this._getScrollOffset();this._eachScrollbar(function(i){i.moveTo({top:-e,left:-t}),i.option("visible",!0)}),this._hideScrollbars()},_hideScrollbars:function(){clearTimeout(this._hideScrollbarTimeout),this._hideScrollbarTimeout=setTimeout((function(){this._eachScrollbar(function(e){e.option("visible",!1)})}).bind(this),Yn)},location:function(){return{left:-this._$container.scrollLeft(),top:-this._$container.scrollTop()}},disabledChanged:m,update:function(){this._update(),this._updateAction(this._createActionArgs())},_update:function(){this._updateDimensions(),this._updateScrollbars()},_updateDimensions:function(){this._containerSize={height:Q(this._$container),width:re(this._$container)},this._componentContentSize={height:Q(this._component.$content()),width:re(this._component.$content())},this._contentSize={height:Q(this._$content),width:re(this._$content)}},_updateScrollbars:function(){this._eachScrollbar(function(e,t){var i=t===he?"height":"width";e.option({containerSize:this._containerSize[i],contentSize:this._componentContentSize[i]}),e.update()})},_allowedDirections:function(){return{vertical:this._isDirection(he)&&this._contentSize.height>this._containerSize.height,horizontal:this._isDirection(Ee)&&this._contentSize.width>this._containerSize.width}},dispose:function(){var e=this._$element.get(0).className,t=new RegExp(Ke+"\\S*","g");t.test(e)&&this._$element.removeClass(e.match(t).join(" ")),g.off(this._$element,"."+kt),g.off(this._$container,"."+kt),this._removeScrollbars(),clearTimeout(this._hideScrollbarTimeout)},_removeScrollbars:function(){this._eachScrollbar(function(e){e.$element().remove()})},scrollBy:function(e){var t=this.location();this._$container.scrollTop(Math.round(-t.top-e.top)),this._$container.scrollLeft(Math.round(-t.left-e.left))},validate:function(e){return this.option("disabled")||X(e)&&this._isScrolledInMaxDirection(e)?!1:!!this._allowedDirection()},_isScrolledInMaxDirection(e){var t=this._$container.get(0),i;return e.delta>0?i=e.shiftKey?!t.scrollLeft:!t.scrollTop:e.shiftKey?i=t.scrollLeft>=this._getMaxOffset().left:i=t.scrollTop>=this._getMaxOffset().top,i},getDirection:function(){return this._allowedDirection()}}),Zn=function(){return[{device:function(){return!si},options:{useNative:!1}},{device:function(e){return!ae.isSimulator()&&ae.real().deviceType==="desktop"&&e.platform==="generic"},options:{bounceEnabled:!1,scrollByThumb:!0,scrollByContent:ai,showScrollbar:"onHover"}}]};function es(e,t){for(var i={left:0,top:0},r=t;(n=r)!==null&&n!==void 0&&n.offsetParent&&!r.classList.contains(e);){var n,s=r.offsetParent,a=r.getBoundingClientRect(),o=s.getBoundingClientRect();i.left+=a.left-o.left,i.top+=a.top-o.top,r=r.offsetParent}return i}var ts="vertical",$s="horizontal",zs="both",is="dx-scrollable-content";function rs(e,t,i,r,n){var s=Se({top:0,left:0,right:0,bottom:0},n),a=t===ts,o=a?"top":"left",c=a?"bottom":"right",l=a?"height":"width",h=i["offset".concat(Le(l))],u=i["client".concat(Le(l))],d=i.getBoundingClientRect()[l],_=e.getBoundingClientRect()[l],p=1;Math.abs(d-h)>1&&(p=d/h);var y=es(is,e)[o]/p,I=r[o],S=I-y+s[o],C=I-y-_/p+u-s[c];return S<=0&&C>=0?I:I-(Math.abs(S)>Math.abs(C)?C:S)}var k="dxScrollable",ns="dxScrollableStrategy",$t="dx-scrollable",ss="dx-scrollable-disabled",as="dx-scrollable-container",os="dx-scrollable-wrapper",zt="dx-scrollable-content",N="vertical",W="horizontal",Ne="both",Ki=Gi.inherit({_getDefaultOptions:function(){return b(this.callBase(),{disabled:!1,onScroll:null,direction:N,showScrollbar:"onScroll",useNative:!0,bounceEnabled:!0,scrollByContent:!0,scrollByThumb:!1,onUpdated:null,onStart:null,onEnd:null,onBounce:null,useSimulatedScrollbar:!1,useKeyboard:!0,inertiaEnabled:!0,updateManually:!1})},_defaultOptionsRules:function(){return this.callBase().concat(Zn(),[{device:function(){return si&&ae.real().platform==="android"&&!qi.mozilla},options:{useSimulatedScrollbar:!0}}])},_initOptions:function(e){this.callBase(e),"useSimulatedScrollbar"in e||this._setUseSimulatedScrollbar()},_setUseSimulatedScrollbar:function(){this.initialOption("useSimulatedScrollbar")||this.option("useSimulatedScrollbar",!this.option("useNative"))},_init:function(){this.callBase(),this._initScrollableMarkup(),this._locked=!1},_visibilityChanged:function(e){e?(this.update(),this._updateRtlPosition(),this._savedScrollOffset&&this.scrollTo(this._savedScrollOffset),delete this._savedScrollOffset):this._savedScrollOffset=this.scrollOffset()},_initScrollableMarkup:function(){var e=this.$element().addClass($t),t=this._$container=f("<div>").addClass(as),i=this._$wrapper=f("<div>").addClass(os),r=this._$content=f("<div>").addClass(zt);r.append(e.contents()).appendTo(t),t.appendTo(i),i.appendTo(e)},_dimensionChanged:function(){this.update(),this._updateRtlPosition()},_initMarkup:function(){this.callBase(),this._renderDirection()},_render:function(){this._renderStrategy(),this._attachEventHandlers(),this._renderDisabledState(),this._createActions(),this.update(),this.callBase(),this._updateRtlPosition(!0)},_updateRtlPosition:function(e){this._strategy.updateRtlPosition(e)},_getMaxOffset:function(){var{scrollWidth:e,clientWidth:t,scrollHeight:i,clientHeight:r}=f(this.container()).get(0);return{left:e-t,top:i-r}},_attachEventHandlers:function(){var e=this._strategy,t={getDirection:e.getDirection.bind(e),validate:this._validate.bind(this),isNative:this.option("useNative"),scrollTarget:this._$container};g.off(this._$wrapper,"."+k),g.on(this._$wrapper,O(ee.init,k),t,this._initHandler.bind(this)),g.on(this._$wrapper,O(ee.start,k),e.handleStart.bind(e)),g.on(this._$wrapper,O(ee.move,k),e.handleMove.bind(e)),g.on(this._$wrapper,O(ee.end,k),e.handleEnd.bind(e)),g.on(this._$wrapper,O(ee.cancel,k),e.handleCancel.bind(e)),g.on(this._$wrapper,O(ee.stop,k),e.handleStop.bind(e)),g.off(this._$container,"."+k),g.on(this._$container,O("scroll",k),e.handleScroll.bind(e))},_validate:function(e){return this._isLocked()?!1:(this._updateIfNeed(),this._moveIsAllowed(e))},_moveIsAllowed(e){return this._strategy.validate(e)},handleMove(e){this._strategy.handleMove(e)},_prepareDirections(e){this._strategy._prepareDirections(e)},_initHandler:function(){var e=this._strategy;e.handleInit.apply(e,arguments)},_renderDisabledState:function(){this.$element().toggleClass(ss,this.option("disabled")),this.option("disabled")?this._lock():this._unlock()},_renderDirection:function(){this.$element().removeClass("dx-scrollable-"+W).removeClass("dx-scrollable-"+N).removeClass("dx-scrollable-"+Ne).addClass("dx-scrollable-"+this.option("direction"))},_renderStrategy:function(){this._createStrategy(),this._strategy.render(),this.$element().data(ns,this._strategy)},_createStrategy:function(){this._strategy=this.option("useNative")?new Jn(this):new qn(this)},_createActions:function(){this._strategy&&this._strategy.createActions()},_clean:function(){this._strategy&&this._strategy.dispose()},_optionChanged:function(e){switch(e.name){case"onStart":case"onEnd":case"onUpdated":case"onScroll":case"onBounce":this._createActions();break;case"direction":this._resetInactiveDirection(),this._invalidate();break;case"useNative":this._setUseSimulatedScrollbar(),this._invalidate();break;case"inertiaEnabled":case"scrollByThumb":case"bounceEnabled":case"useKeyboard":case"showScrollbar":case"useSimulatedScrollbar":this._invalidate();break;case"disabled":this._renderDisabledState(),this._strategy&&this._strategy.disabledChanged();break;case"updateManually":case"scrollByContent":break;case"width":this.callBase(e),this._updateRtlPosition();break;default:this.callBase(e)}},_resetInactiveDirection:function(){var e=this._getInactiveProp();if(!(!e||!ve())){var t=this.scrollOffset();t[e]=0,this.scrollTo(t)}},_getInactiveProp:function(){var e=this.option("direction");if(e===N)return"left";if(e===W)return"top"},_location:function(){return this._strategy.location()},_normalizeLocation:function(e){if(G(e)){var t=ue(e.left,e.x),i=ue(e.top,e.y);return{left:E(t)?-t:void 0,top:E(i)?-i:void 0}}else{var r=this.option("direction");return{left:r!==N?-e:void 0,top:r!==W?-e:void 0}}},_isLocked:function(){return this._locked},_lock:function(){this._locked=!0},_unlock:function(){this.option("disabled")||(this._locked=!1)},_isDirection:function(e){var t=this.option("direction");return e===N?t!==W:e===W?t!==N:t===e},_updateAllowedDirection:function(){var e=this._strategy._allowedDirections();this._isDirection(Ne)&&e.vertical&&e.horizontal?this._allowedDirectionValue=Ne:this._isDirection(W)&&e.horizontal?this._allowedDirectionValue=W:this._isDirection(N)&&e.vertical?this._allowedDirectionValue=N:this._allowedDirectionValue=null},_allowedDirection:function(){return this._allowedDirectionValue},$content:function(){return this._$content},content:function(){return U(this._$content)},container:function(){return U(this._$container)},scrollOffset:function(){return this._strategy._getScrollOffset()},_isRtlNativeStrategy:function(){var{useNative:e,rtlEnabled:t}=this.option();return e&&t},scrollTop:function(){return this.scrollOffset().top},scrollLeft:function(){return this.scrollOffset().left},clientHeight:function(){return Q(this._$container)},scrollHeight:function(){return Xi(this.$content())},clientWidth:function(){return re(this._$container)},scrollWidth:function(){return oi(this.$content())},update:function(){if(this._strategy)return L(this._strategy.update()).done((function(){this._updateAllowedDirection()}).bind(this))},scrollBy:function(e){e=this._normalizeLocation(e),!(!e.top&&!e.left)&&(this._updateIfNeed(),this._strategy.scrollBy(e))},scrollTo:function(e){e=this._normalizeLocation(e),this._updateIfNeed();var t=this._location();this.option("useNative")||(e=this._strategy._applyScaleRatio(e),t=this._strategy._applyScaleRatio(t)),this._isRtlNativeStrategy()&&(t.left=t.left-this._getMaxOffset().left);var i=this._normalizeLocation({left:t.left-ue(e.left,t.left),top:t.top-ue(e.top,t.top)});!i.top&&!i.left||this._strategy.scrollBy(i)},scrollToElement:function(e,t){var i=f(e),r=this.$content().find(e).length,n=i.parents("."+$t).length-i.parents("."+zt).length===0;if(!(!r||!n)){var s={top:0,left:0},a=this.option("direction");a!==N&&(s.left=this.getScrollElementPosition(i,W,t)),a!==W&&(s.top=this.getScrollElementPosition(i,N,t)),this.scrollTo(s)}},getScrollElementPosition:function(e,t,i){var r=this.scrollOffset();return rs(e.get(0),t,f(this.container()).get(0),r,i)},_updateIfNeed:function(){this.option("updateManually")||this.update()},_useTemplates:function(){return!1},isRenovated:function(){return!!Ki.IS_RENOVATED_WIDGET}});Qi(k,Ki);var ls="dx-state-invisible",cs="dx-state-disabled",hs="dx-item-content-placeholder",us=function(e,t,i){var r=function(s){n!==s&&(i(s,n),n=s)},n;return{dispose:e(t,r),force:function(){r(t())}}},Ni=B.inherit({ctor:function(e,t,i){this._$element=e,this._options=t,this._rawData=i,Yi(e,this,this._dispose),this._render()},_render:function(){var e=f("<div>").addClass(hs);this._$element.append(e),this._watchers=[],this._renderWatchers()},_renderWatchers:function(){this._startWatcher("disabled",this._renderDisabled.bind(this)),this._startWatcher("visible",this._renderVisible.bind(this))},_startWatcher:function(e,t){var i=this._rawData,r=this._options.fieldGetter(e),n=us(this._options.watchMethod(),function(){return r(i)},(function(s,a){this._dirty=!0,t(s,a)}).bind(this));this._watchers.push(n)},setDataField:function(){if(this._dirty=!1,x(this._watchers,function(e,t){t.force()}),this._dirty)return!0},_renderDisabled:function(e,t){this._$element.toggleClass(cs,!!e),this._$element.attr("aria-disabled",!!e),this._updateOwnerFocus(e)},_updateOwnerFocus:function(e){var t=this._options.owner;t&&e&&t._resetItemFocus(this._$element)},_renderVisible:function(e,t){this._$element.toggleClass(ls,e!==void 0&&!e)},_dispose:function(){x(this._watchers,function(e,t){t.dispose()})}});Ni.getInstance=function(e){return Ji(e,this)};var Wt=Math.abs,dt="dxhold",ds=750,Ut=5,_s=Zi.inherit({start:function(e){this._startEventData=vt(e),this._startTimer(e)},_startTimer:function(e){var t="timeout"in this?this.timeout:ds;this._holdTimer=setTimeout((function(){this._requestAccept(e),this._fireEvent(dt,e,{target:e.target}),this._forgetAccept()}).bind(this),t)},move:function(e){this._touchWasMoved(e)&&this._cancel(e)},_touchWasMoved:function(e){var t=er(this._startEventData,vt(e));return Wt(t.x)>Ut||Wt(t.y)>Ut},end:function(){this._stopTimer()},_stopTimer:function(){clearTimeout(this._holdTimer)},cancel:function(){this._stopTimer()},dispose:function(){this._stopTimer()}});tr({emitter:_s,bubble:!0,events:[dt]});const ki={name:dt};var _t="dxContexMenu",fs=O("contextmenu",_t),ms=O(ki.name,_t),ft="dxcontextmenu",vs=B.inherit({setup:function(e){var t=f(e);g.on(t,fs,this._contextMenuHandler.bind(this)),(ai||ae.isSimulator())&&g.on(t,ms,this._holdHandler.bind(this))},_holdHandler:function(e){ir(e)&&!ae.isSimulator()||this._fireContextMenu(e)},_contextMenuHandler:function(e){this._fireContextMenu(e)},_fireContextMenu:function(e){return rr({type:ft,originalEvent:e})},teardown:function(e){g.off(e,"."+_t)}});nr(ft,new vs);var ps=ft,gs=function(e,t,i,r,n){var s,a=((o,c,l)=>c(()=>o,l))(e,t,function(o){if(s&&s(),fr(o)){n(o);return}s=function(c,l,h,u,d){var _={},p=h.slice(),y=h.map(function(I){var S=u[I];return l(S?()=>S(c):()=>c[I],function(C){if(_[I]=C,p.length){var T=p.indexOf(I);T>=0&&p.splice(T,1)}p.length||d(_)})});return function(){y.forEach(I=>I())}}(o,t,i,r,n)});return function(){s&&s(),a&&a()}};class Is extends sr{constructor(t,i,r,n){super(),this._render=t,this._fields=i,this._fieldsMap=n||{},this._watchMethod=r}_renderCore(t){var i=f(t.container),r=gs(t.model,this._watchMethod,this._fields,this._fieldsMap,n=>{i.empty(),this._render(i,n,t.model)});return g.on(i,ar,r),i.contents()}}var Ss="dx-collection",xe="dx-item",jt="-content",Vt="dx-item-content-placeholder",ys="dxItemData",Cs="dxItemIndex",bs="tmpl-",Es="dxItem",xs="dx-item-selected",Os="dx-item-response-wait",As="dx-empty-collection",Gt="dx-template-wrapper",Ds=/^([^.]+\[\d+\]\.)+([\w.]+)$/,Ls="item",ke="up",$e="down",qt="left",Xt="right",Ts="pageup",ws="pagedown",Qt="last",Yt="first",$i=ti.inherit({_activeStateUnit:"."+xe,_supportedKeys:function(){var e=function(t,i){ni(i)||(i.preventDefault(),i.stopPropagation(),this._moveFocus(t,i))};return b(this.callBase(),{space:function(t){t.preventDefault(),this._enterKeyHandler(t)},enter:this._enterKeyHandler,leftArrow:e.bind(this,qt),rightArrow:e.bind(this,Xt),upArrow:e.bind(this,ke),downArrow:e.bind(this,$e),pageUp:e.bind(this,ke),pageDown:e.bind(this,$e),home:e.bind(this,Yt),end:e.bind(this,Qt)})},_enterKeyHandler:function(e){var t=f(this.option("focusedElement"));if(t.length){var i=this._getItemData(t);i!=null&&i.onClick&&this._itemEventHandlerByHandler(t,i.onClick,{event:e}),this._itemClickHandler(b({},e,{target:t.get(0),currentTarget:t.get(0)}))}},_getDefaultOptions:function(){return b(this.callBase(),{selectOnFocus:!1,loopItemFocus:!0,items:[],itemTemplate:"item",onItemRendered:null,onItemClick:null,onItemHold:null,itemHoldTimeout:750,onItemContextMenu:null,onFocusedItemChanged:null,noDataText:mr.format("dxCollectionWidget-noDataText"),encodeNoDataText:!1,dataSource:null,_dataController:null,_itemAttributes:{},itemTemplateProperty:"template",focusOnSelectedItem:!0,focusedElement:null,displayExpr:void 0,disabledExpr:function(e){return e?e.disabled:void 0},visibleExpr:function(e){return e?e.visible:void 0}})},_init:function(){this._compileDisplayGetter(),this._initDataController(),this.callBase(),this._cleanRenderedItems(),this._refreshDataSource()},_compileDisplayGetter:function(){var e=this.option("displayExpr");this._displayGetter=e?V(this.option("displayExpr")):void 0},_initTemplates:function(){this._initItemsFromMarkup(),this._initDefaultItemTemplate(),this.callBase()},_getAnonymousTemplateName:function(){return Ls},_initDefaultItemTemplate:function(){var e=this._getFieldsMap();this._templateManager.addDefaultTemplates({item:new Is((function(t,i){G(i)?this._prepareDefaultItemTemplate(i,t):(e&&F(e.text)&&(i=e.text(i)),t.text(String(ue(i,""))))}).bind(this),this._getBindableFields(),this.option("integrationOptions.watchMethod"),e)})},_getBindableFields:function(){return["text","html"]},_getFieldsMap:function(){if(this._displayGetter)return{text:this._displayGetter}},_prepareDefaultItemTemplate:function(e,t){E(e.text)&&t.text(e.text),E(e.html)&&t.html(e.html)},_initItemsFromMarkup:function(){var e=or(this.$element(),Es);if(!(!e.length||this.option("items").length)){var t=e.map(i=>{var{element:r,options:n}=i,s=/\S/.test(r.innerHTML)&&!n.template;return s?n.template=this._prepareItemTemplate(r):f(r).remove(),n});this.option("items",t)}},_prepareItemTemplate:function(e){var t=bs+new We,i=f(e).detach().clone().removeAttr("data-options").addClass(Gt);return this._saveTemplate(t,i),t},_dataSourceOptions:function(){return{paginate:!1}},_cleanRenderedItems:function(){this._renderedItemsCount=0},_focusTarget:function(){return this.$element()},_focusInHandler:function(e){if(this.callBase.apply(this,arguments),!!this._isFocusTarget(e.target)){var t=f(this.option("focusedElement"));if(t.length)this._setFocusedItem(t);else{var i=this._getActiveItem();i.length&&this.option("focusedElement",U(i))}}},_focusOutHandler:function(){this.callBase.apply(this,arguments);var e=f(this.option("focusedElement"));this._updateFocusedItemState(e,!1)},_findActiveTarget(e){return e.find(this._activeStateUnit)},_getActiveItem:function(e){var t=f(this.option("focusedElement"));if(t.length)return t;var i=this.option("focusOnSelectedItem")?this.option("selectedIndex"):0,r=this._getActiveElement(),n=r.length-1;return i<0&&(i=e?n:0),r.eq(i)},_moveFocus:function(e){var t=this._getAvailableItems(),i;switch(e){case Ts:case ke:i=this._prevItem(t);break;case ws:case $e:i=this._nextItem(t);break;case Xt:i=this.option("rtlEnabled")?this._prevItem(t):this._nextItem(t);break;case qt:i=this.option("rtlEnabled")?this._nextItem(t):this._prevItem(t);break;case Yt:i=t.first();break;case Qt:i=t.last();break;default:return!1}i.length!==0&&this.option("focusedElement",U(i))},_getVisibleItems:function(e){return e=e||this._itemElements(),e.filter(":visible")},_getAvailableItems:function(e){return this._getVisibleItems(e)},_prevItem:function(e){var t=this._getActiveItem(),i=e.index(t),r=e.last(),n=f(e[i-1]),s=this.option("loopItemFocus");return n.length===0&&s&&(n=r),n},_nextItem:function(e){var t=this._getActiveItem(!0),i=e.index(t),r=e.first(),n=f(e[i+1]),s=this.option("loopItemFocus");return n.length===0&&s&&(n=r),n},_selectFocusedItem:function(e){this.selectItem(e)},_updateFocusedItemState:function(e,t,i){var r=f(e);r.length&&(this._refreshActiveDescendant(),this._refreshItemId(r,i),this._toggleFocusClass(t,r)),this._updateParentActiveDescendant()},_refreshActiveDescendant:function(e){this.setAria("activedescendant",E(this.option("focusedElement"))?this.getFocusedItemId():null,e)},_refreshItemId:function(e,t){!t&&this.option("focusedElement")?this.setAria("id",this.getFocusedItemId(),e):this.setAria("id",null,e)},_isDisabled:e=>e&&f(e).attr("aria-disabled")==="true",_setFocusedItem:function(e){if(!(!e||!e.length)){this._updateFocusedItemState(e,!0),this.onFocusedItemChanged(this.getFocusedItemId());var{selectOnFocus:t}=this.option(),i=this._isDisabled(e);t&&!i&&this._selectFocusedItem(e)}},_findItemElementByItem:function(e){var t=f(),i=this;return this.itemElements().each(function(){var r=f(this);if(r.data(i._itemDataKey())===e)return t=r,!1}),t},_getIndexByItem:function(e){return this.option("items").indexOf(e)},_itemOptionChanged:function(e,t,i,r){var n=this._findItemElementByItem(e);if(n.length){this.constructor.ItemClass.getInstance(n).setDataField(t,i)||this._refreshItem(n,e);var s=t==="disabled"&&i;s&&this._resetItemFocus(n)}},_resetItemFocus(e){e.is(this.option("focusedElement"))&&this.option("focusedElement",null)},_refreshItem:function(e){var t=this._getItemData(e),i=e.data(this._itemIndexKey());this._renderItem(this._renderedItemsCount+i,t,null,e)},_updateParentActiveDescendant:m,_optionChanged:function(e){if(e.name==="items"){var t=e.fullName.match(Ds);if(t&&t.length){var i=t[t.length-1],r=e.fullName.replace("."+i,""),n=this.option(r);this._itemOptionChanged(n,i,e.value,e.previousValue);return}}switch(e.name){case"items":case"_itemAttributes":case"itemTemplateProperty":case"useItemTextAsTitle":this._cleanRenderedItems(),this._invalidate();break;case"dataSource":this._refreshDataSource(),this._renderEmptyMessage();break;case"noDataText":case"encodeNoDataText":this._renderEmptyMessage();break;case"itemTemplate":this._invalidate();break;case"onItemRendered":this._createItemRenderAction();break;case"onItemClick":break;case"onItemHold":case"itemHoldTimeout":this._attachHoldEvent();break;case"onItemContextMenu":this._attachContextMenuEvent();break;case"onFocusedItemChanged":this.onFocusedItemChanged=this._createActionByOption("onFocusedItemChanged");break;case"selectOnFocus":case"loopItemFocus":case"focusOnSelectedItem":break;case"focusedElement":this._updateFocusedItemState(e.previousValue,!1,!0),this._setFocusedItem(f(e.value));break;case"displayExpr":this._compileDisplayGetter(),this._initDefaultItemTemplate(),this._invalidate();break;case"visibleExpr":case"disabledExpr":this._invalidate();break;default:this.callBase(e)}},_invalidate:function(){return this.option("focusedElement",null),this.callBase.apply(this,arguments)},_loadNextPage:function(){return this._expectNextPageLoading(),this._dataController.loadNextPage()},_expectNextPageLoading:function(){this._startIndexForAppendedItems=0},_expectLastItemLoading:function(){this._startIndexForAppendedItems=-1},_forgetNextPageLoading:function(){this._startIndexForAppendedItems=null},_dataSourceChangedHandler:function(e){var t=this.option("items");this._initialized&&t&&this._shouldAppendItems()?(this._renderedItemsCount=t.length,(!this._isLastPage()||this._startIndexForAppendedItems!==-1)&&(this.option().items=t.concat(e.slice(this._startIndexForAppendedItems))),this._forgetNextPageLoading(),this._refreshContent()):this.option("items",e.slice())},_refreshContent:function(){this._prepareContent(),this._renderContent()},_dataSourceLoadErrorHandler:function(){this._forgetNextPageLoading(),this.option("items",this.option("items"))},_shouldAppendItems:function(){return this._startIndexForAppendedItems!=null&&this._allowDynamicItemsAppend()},_allowDynamicItemsAppend:function(){return!1},_clean:function(){this._cleanFocusState(),this._cleanItemContainer(),this._inkRipple&&delete this._inkRipple,this._resetActiveState()},_cleanItemContainer:function(){f(this._itemContainer()).empty()},_dispose:function(){this.callBase(),clearTimeout(this._itemFocusTimeout)},_refresh:function(){this._cleanRenderedItems(),this.callBase.apply(this,arguments)},_itemContainer:function(){return this.$element()},_itemClass:function(){return xe},_itemContentClass:function(){return this._itemClass()+jt},_selectedItemClass:function(){return xs},_itemResponseWaitClass:function(){return Os},_itemSelector:function(){return"."+this._itemClass()},_itemDataKey:function(){return ys},_itemIndexKey:function(){return Cs},_itemElements:function(){return this._itemContainer().find(this._itemSelector())},_initMarkup:function(){this.callBase(),this.onFocusedItemChanged=this._createActionByOption("onFocusedItemChanged"),this.$element().addClass(Ss),this._prepareContent()},_prepareContent:de(function(){this._renderContentImpl()}),_renderContent:function(){this._fireContentReadyAction()},_render:function(){this.callBase(),this._attachClickEvent(),this._attachHoldEvent(),this._attachContextMenuEvent()},_getPointerEvent:()=>et.down,_attachClickEvent(){var e=this._itemSelector(),t=this._getPointerEvent(),i=O(pt,this.NAME),r=O(t,this.NAME),n=new lr(s=>{var{event:a}=s;this._itemPointerDownHandler(a)});g.off(this._itemContainer(),i,e),g.off(this._itemContainer(),r,e),g.on(this._itemContainer(),i,e,s=>this._itemClickHandler(s)),g.on(this._itemContainer(),r,e,s=>{n.execute({element:f(s.target),event:s})})},_itemClickHandler:function(e,t,i){this._itemDXEventHandler(e,"onItemClick",t,i)},_itemPointerDownHandler:function(e){this.option("focusStateEnabled")&&(this._itemFocusHandler=(function(){if(clearTimeout(this._itemFocusTimeout),this._itemFocusHandler=null,!e.isDefaultPrevented()){var t=f(e.target),i=t.closest(this._itemElements()),r=this._closestFocusable(t);i.length&&this._isFocusTarget(r==null?void 0:r.get(0))&&this.option("focusedElement",U(i))}}).bind(this),this._itemFocusTimeout=setTimeout(this._forcePointerDownFocus.bind(this)))},_closestFocusable:function(e){if(e.is(gt))return e;for(e=e.parent();e.length&&!P.isDocument(e.get(0))&&!P.isDocumentFragment(e.get(0));){if(e.is(gt))return e;e=e.parent()}},_forcePointerDownFocus:function(){this._itemFocusHandler&&this._itemFocusHandler()},_updateFocusState:function(){this.callBase.apply(this,arguments),this._forcePointerDownFocus()},_attachHoldEvent:function(){var e=this._itemContainer(),t=this._itemSelector(),i=O(ki.name,this.NAME);g.off(e,i,t),g.on(e,i,t,{timeout:this._getHoldTimeout()},this._itemHoldHandler.bind(this))},_getHoldTimeout:function(){return this.option("itemHoldTimeout")},_shouldFireHoldEvent:function(){return this.hasActionSubscription("onItemHold")},_itemHoldHandler:function(e){this._shouldFireHoldEvent()?this._itemDXEventHandler(e,"onItemHold"):e.cancel=!0},_attachContextMenuEvent:function(){var e=this._itemContainer(),t=this._itemSelector(),i=O(ps,this.NAME);g.off(e,i,t),g.on(e,i,t,this._itemContextMenuHandler.bind(this))},_shouldFireContextMenuEvent:function(){return this.hasActionSubscription("onItemContextMenu")},_itemContextMenuHandler:function(e){this._shouldFireContextMenuEvent()?this._itemDXEventHandler(e,"onItemContextMenu"):e.cancel=!0},_renderContentImpl:function(){var e=this.option("items")||[];this._renderedItemsCount?this._renderItems(e.slice(this._renderedItemsCount)):this._renderItems(e)},_renderItems:function(e){e.length&&x(e,(function(t,i){this._renderItem(this._renderedItemsCount+t,i)}).bind(this)),this._renderEmptyMessage()},_renderItem:function(e,t,i,r){var n,s=(n=e==null?void 0:e.item)!==null&&n!==void 0?n:e;i=i||this._itemContainer();var a=this._renderItemFrame(s,t,i,r);this._setElementData(a,t,s),a.attr(this.option("_itemAttributes")),this._attachItemClickEvent(t,a);var o=this._getItemContent(a),c=this._renderItemContent({index:s,itemData:t,container:U(o),contentClass:this._itemContentClass(),defaultTemplateName:this.option("itemTemplate")}),l=this;return L(c).done(function(h){l._postprocessRenderItem({itemElement:a,itemContent:h,itemData:t,itemIndex:s}),l._executeItemRenderAction(e,t,U(a))}),a},_getItemContent:function(e){var t=e.find("."+Vt);return t.removeClass(Vt),t},_attachItemClickEvent:function(e,t){!e||!e.onClick||g.on(t,pt,(function(i){this._itemEventHandlerByHandler(t,e.onClick,{event:i})}).bind(this))},_renderItemContent:function(e){var t=this._getItemTemplateName(e),i=this._getTemplate(t);this._addItemContentClasses(e);var r=f(this._createItemByTemplate(i,e));return r.hasClass(Gt)?this._renderItemContentByNode(e,r):e.container},_renderItemContentByNode:function(e,t){return f(e.container).replaceWith(t),e.container=U(t),this._addItemContentClasses(e),t},_addItemContentClasses:function(e){var t=[xe+jt,e.contentClass];f(e.container).addClass(t.join(" "))},_appendItemToContainer:function(e,t,i){t.appendTo(e)},_renderItemFrame:function(e,t,i,r){var n=f("<div>");if(new this.constructor.ItemClass(n,this._itemOptions(),t||{}),r&&r.length?r.replaceWith(n):this._appendItemToContainer.call(this,i,n,e),this.option("useItemTextAsTitle")){var s=this._displayGetter?this._displayGetter(t):t;n.attr("title",s)}return n},_itemOptions:function(){var e=this;return{watchMethod:function(){return e.option("integrationOptions.watchMethod")},owner:e,fieldGetter:function(t){var i=e.option(t+"Expr"),r=V(i);return r}}},_postprocessRenderItem:m,_executeItemRenderAction:function(e,t,i){this._getItemRenderAction()({itemElement:i,itemIndex:e,itemData:t})},_setElementData:function(e,t,i){e.addClass([xe,this._itemClass()].join(" ")).data(this._itemDataKey(),t).data(this._itemIndexKey(),i)},_createItemRenderAction:function(){return this._itemRenderAction=this._createActionByOption("onItemRendered",{element:this.element(),excludeValidators:["disabled","readOnly"],category:"rendering"})},_getItemRenderAction:function(){return this._itemRenderAction||this._createItemRenderAction()},_getItemTemplateName:function(e){var t=e.itemData,i=e.templateProperty||this.option("itemTemplateProperty"),r=t&&t[i];return r||e.defaultTemplateName},_createItemByTemplate:function(e,t){return e.render({model:t.itemData,container:t.container,index:t.index,onRendered:this._onItemTemplateRendered(e,t)})},_onItemTemplateRendered:function(){return m},_emptyMessageContainer:function(){return this._itemContainer()},_renderEmptyMessage:function(e){e=e||this.option("items");var t=this.option("noDataText"),i=!t||e&&e.length||this._dataController.isLoading();i&&this._$noData&&(this._$noData.remove(),this._$noData=null,this.setAria("label",void 0)),i||(this._$noData=this._$noData||f("<div>").addClass("dx-empty-message"),this._$noData.appendTo(this._emptyMessageContainer()),this.option("encodeNoDataText")?this._$noData.text(t):this._$noData.html(t)),this.$element().toggleClass(As,!i)},_itemDXEventHandler:function(e,t,i,r){this._itemEventHandler(e.target,t,b(i,{event:e}),r)},_itemEventHandler:function(e,t,i,r){var n=this._createActionByOption(t,b({validatingTargetName:"itemElement"},r));return this._itemEventHandlerImpl(e,n,i)},_itemEventHandlerByHandler:function(e,t,i,r){var n=this._createAction(t,b({validatingTargetName:"itemElement"},r));return this._itemEventHandlerImpl(e,n,i)},_itemEventHandlerImpl:function(e,t,i){var r=this._closestItemElement(f(e)),n=b({},i);return t(b(i,this._extendActionArgs(r),n))},_extendActionArgs:function(e){return{itemElement:U(e),itemIndex:this._itemElements().index(e),itemData:this._getItemData(e)}},_closestItemElement:function(e){return f(e).closest(this._itemSelector())},_getItemData:function(e){return f(e).data(this._itemDataKey())},_getSummaryItemsWidth:function(e,t){var i=0;return e&&x(e,function(r,n){i+=oi(n,t||!1)}),i},getFocusedItemId:function(){return this._focusedItemId||(this._focusedItemId="dx-"+new We),this._focusedItemId},itemElements:function(){return this._itemElements()},itemsContainer:function(){return this._itemContainer()}}).include(Ln);$i.ItemClass=Ni;var w=B.abstract,Rs=B.inherit({ctor:function(e){this._collectionWidget=e},getIndexByItemData:w,getItemDataByIndex:w,getKeysByItems:w,getItemsByKeys:w,itemsGetter:w,getKeyByIndex:function(e){var t=this._denormalizeItemIndex(e);return this.getKeysByItems([this.getItemDataByIndex(t)])[0]},_equalKeys:function(e,t){return this._collectionWidget._isKeySpecified()?pe(e,t):e===t},beginCache:function(){this._cache={}},endCache:function(){this._cache=null},getIndexByKey:w,getNormalizedIndex:function(e){return this._isNormalizedItemIndex(e)?e:this._isItemIndex(e)?this._normalizeItemIndex(e):this._isNode(e)?this._getNormalizedItemIndex(e):this._normalizeItemIndex(this.getIndexByItemData(e))},getIndex:function(e){return this._isNormalizedItemIndex(e)?this._denormalizeItemIndex(e):this._isItemIndex(e)?e:this._isNode(e)?this._denormalizeItemIndex(this._getNormalizedItemIndex(e)):this.getIndexByItemData(e)},getItemElement:function(e){if(this._isNormalizedItemIndex(e))return this._getItemByNormalizedIndex(e);if(this._isItemIndex(e))return this._getItemByNormalizedIndex(this._normalizeItemIndex(e));if(this._isNode(e))return f(e);var t=this._normalizeItemIndex(this.getIndexByItemData(e));return this._getItemByNormalizedIndex(t)},_isNode:e=>P.isNode(e&&vr(e)?e.get(0):e),deleteItemAtIndex:w,itemPlacementFunc:function(e,t){return this._itemsFromSameParent(e,t)&&e<t?"after":"before"},moveItemAtIndexToIndex:w,_isNormalizedItemIndex:function(e){return typeof e=="number"&&Math.round(e)===e},_isItemIndex:w,_getNormalizedItemIndex:w,_normalizeItemIndex:w,_denormalizeItemIndex:w,_getItemByNormalizedIndex:w,_itemsFromSameParent:w}),Bs=Rs.inherit({_getPlainItems:function(){return this._collectionWidget.option("items")||[]},getIndexByItemData:function(e){var t=this._collectionWidget.keyOf.bind(this._collectionWidget);return t?this.getIndexByKey(t(e)):this._getPlainItems().indexOf(e)},getItemDataByIndex:function(e){return this._getPlainItems()[e]},deleteItemAtIndex:function(e){this._getPlainItems().splice(e,1)},itemsGetter:function(){return this._getPlainItems()},getKeysByItems:function(e){var t=this._collectionWidget.keyOf.bind(this._collectionWidget),i=e;if(t){i=[];for(var r=0;r<e.length;r++)i.push(t(e[r]))}return i},getIndexByKey:function(e){var t=this._cache,i=t&&t.keys||this.getKeysByItems(this._getPlainItems());if(t&&!t.keys&&(t.keys=i),typeof e=="object"){for(var r=0,n=i.length;r<n;r++)if(this._equalKeys(e,i[r]))return r}else return i.indexOf(e);return-1},getItemsByKeys:function(e,t){return(t||e).slice()},moveItemAtIndexToIndex:function(e,t){var i=this._getPlainItems(),r=i[e];i.splice(e,1),i.splice(t,0,r)},_isItemIndex:function(e){return typeof e=="number"&&Math.round(e)===e},_getNormalizedItemIndex:function(e){return this._collectionWidget._itemElements().index(e)},_normalizeItemIndex:function(e){return e},_denormalizeItemIndex:function(e){return e},_getItemByNormalizedIndex:function(e){return e>-1?this._collectionWidget._itemElements().eq(e):null},_itemsFromSameParent:function(){return!0}});class zi{constructor(t){this.options=t,this._setOption("disabledItemKeys",[]),this._clearItemKeys()}_clearItemKeys(){this._setOption("addedItemKeys",[]),this._setOption("removedItemKeys",[]),this._setOption("removedItems",[]),this._setOption("addedItems",[])}validate(){}_setOption(t,i){this.options[t]=i}onSelectionChanged(){var t=this.options.addedItemKeys,i=this.options.removedItemKeys,r=this.options.addedItems,n=this.options.removedItems,s=this.options.selectedItems,a=this.options.selectedItemKeys,o=this.options.onSelectionChanged||m;this._clearItemKeys(),o({selectedItems:s,selectedItemKeys:a,addedItemKeys:t,removedItemKeys:i,addedItems:r,removedItems:n})}equalKeys(t,i){return this.options.equalByReference&&R(t)&&R(i)?t===i:pe(t,i)}getSelectableItems(t){return t.filter(function(i){return!(i!=null&&i.disabled)})}_clearSelection(t,i,r,n){return t=t||[],t=Array.isArray(t)?t:[t],this.validate(),this.selectedItemKeys(t,i,r,n)}_removeTemplateProperty(t){return Array.isArray(t)?t.map(i=>this._removeTemplateProperty(i)):(R(t)&&delete t.template,t)}_loadFilteredData(t,i,r,n){var s=encodeURI(JSON.stringify(this._removeTemplateProperty(t))).length,a=this.options.maxFilterLengthInRequest&&s>this.options.maxFilterLengthInRequest,o=new v,c={filter:a?void 0:t,select:a?this.options.dataFields():r||this.options.dataFields()};return t&&t.length===0?o.resolve([]):this.options.load(c).done(function(l){var h=G(l)?l.data:l;i&&!n?h=h.filter(i):a&&(h=Ie(h).filter(t).toArray()),o.resolve(h)}).fail(o.reject.bind(o)),o}updateSelectedItemKeyHash(t){for(var i=0;i<t.length;i++){var r=ge(t[i]);if(!R(r)){this.options.keyHashIndices[r]=this.options.keyHashIndices[r]||[];var n=this.options.keyHashIndices[r];n.push(i)}}}_isAnyItemSelected(t){for(var i=0;i<t.length;i++)if(this.options.isItemSelected(t[i]))return;return!1}_getFullSelectAllState(){var t=this.options.plainItems(),i=this.options.filter(),r=this.options.ignoreDisabledItems?this.options.selectedItems:this.options.selectedItems.filter(a=>!(a!=null&&a.disabled));i&&(r=Ie(r).filter(i).toArray());var n=r.length,s=t.length-this.getSelectableItems(t).length;if(!n)return this._isAnyItemSelected(t);if(n>=this.options.totalCount()-s)return!0}_getVisibleSelectAllState(){for(var t=this.getSelectableItems(this.options.plainItems()),i=!1,r=!1,n=0;n<t.length;n++){var s=t[n],a=this.options.getItemData(s),o=this.options.keyOf(a);this.options.isSelectableItem(s)&&(this.isItemKeySelected(o)?i=!0:r=!0)}return i?r?void 0:!0:!1}}class Fs extends zi{getSelectedItems(){return this._loadFilteredData(this.options.selectionFilter)}getSelectedItemKeys(){var t=new v,i=this,r=this.options.key(),n=Y(r)?[r]:r;return this._loadFilteredData(this.options.selectionFilter,null,n).done(function(s){var a=s.map(function(o){return i.options.keyOf(o)});t.resolve(a)}).fail(t.reject),t.promise()}selectedItemKeys(t,i,r,n){if(n){var s=this.options.filter(),a=!s||JSON.stringify(s)===JSON.stringify(this.options.selectionFilter)&&r;a?this._setOption("selectionFilter",r?[]:null):this._addSelectionFilter(r,s,n)}else{i||this._setOption("selectionFilter",[]);for(var o=0;o<t.length;o++)r?this.removeSelectedItem(t[o]):this.addSelectedItem(t[o],n,!i)}return this.onSelectionChanged(),new v().resolve()}setSelectedItems(t){this._setOption("selectionFilter",null);for(var i=0;i<t.length;i++)this.addSelectedItem(t[i])}isItemDataSelected(t){return this.isItemKeySelected(t)}isItemKeySelected(t){var i=this.options.selectionFilter;return i?!!Ie([t]).filter(i).toArray().length:!0}_getKeyExpr(){var t=this.options.key();return Array.isArray(t)&&t.length===1?t[0]:t}_normalizeKey(t){var i=this.options.key();return Array.isArray(i)&&i.length===1?t[i[0]]:t}_getFilterByKey(t){var i=this._getKeyExpr(),r=[i,"=",this._normalizeKey(t)];if(Array.isArray(i)){r=[];for(var n=0;n<i.length;n++)r.push([i[n],"=",t[i[n]]]),n!==i.length-1&&r.push("and")}return r}addSelectedItem(t,i,r){var n=this._getFilterByKey(t);this._addSelectionFilter(!1,n,i,r)}removeSelectedItem(t){var i=this._getFilterByKey(t);this._addSelectionFilter(!0,i)}validate(){var t=this.options.key;if(t&&t()===void 0)throw tt.Error("E1042","Deferred selection")}_findSubFilter(t,i){if(!t)return-1;for(var r=JSON.stringify(i),n=0;n<t.length;n++){var s=t[n];if(s&&JSON.stringify(s)===r)return n}return-1}_isLastSubFilter(t,i){return t&&i?this._findSubFilter(t,i)===t.length-1||this._findSubFilter([t],i)===0:!1}_addFilterOperator(t,i){return t.length>1&&Y(t[1])&&t[1]!==i&&(t=[t]),t.length&&t.push(i),t}_denormalizeFilter(t){return t&&Y(t[0])&&(t=[t]),t}_isOnlyNegativeFiltersLeft(t){return t.every((i,r)=>r%2===0?Array.isArray(i)&&i[0]==="!":i==="and")}_addSelectionFilter(t,i,r,n){var s,a=t?["!",i]:i,o=t?"and":"or",c=!0,l=this.options.selectionFilter||[];if(l=this._denormalizeFilter(l),(s=l)!==null&&s!==void 0&&s.length&&!n){var h=this._removeSameFilter(l,i,t,r),u=this._removeSameFilter(l,i,!t),d=t&&(h!==-1||u!==-1)&&this._isOnlyNegativeFiltersLeft(l);d&&(l=[]);var _=this._isKeyFilter(i)&&this._hasKeyFiltersOnlyStartingFromIndex(l,u);c=i.length&&!_}c&&(l=this._addFilterOperator(l,o),l.push(a)),l=this._normalizeFilter(l),this._setOption("selectionFilter",!t&&!l.length?null:l)}_normalizeFilter(t){return t&&t.length===1&&(t=t[0]),t}_removeFilterByIndex(t,i,r){var n=t[1];i>0?t.splice(i-1,2):t.splice(i,2),r&&n==="and"&&t.splice(0,t.length)}_isSimpleKeyFilter(t,i){return t.length===3&&t[0]===i&&t[1]==="="}_isKeyFilter(t){if(t.length===2&&t[0]==="!")return this._isKeyFilter(t[1]);var i=this._getKeyExpr();if(Array.isArray(i)){if(t.length!==2*i.length-1)return!1;for(var r=0;r<i.length;r++)if(r>0&&t[2*r-1]!=="and"||!this._isSimpleKeyFilter(t[2*r],i[r]))return!1;return!0}return this._isSimpleKeyFilter(t,i)}_hasKeyFiltersOnlyStartingFromIndex(t,i){if(i>=0){for(var r=i;r<t.length;r++)if(typeof t[r]!="string"&&!this._isKeyFilter(t[r]))return!1;return!0}return!1}_removeSameFilter(t,i,r,n){if(i=r?["!",i]:i,JSON.stringify(i)===JSON.stringify(t))return t.splice(0,t.length),0;var s=this._findSubFilter(t,i);if(s>=0)return this._removeFilterByIndex(t,s,n),s;for(var a=0;a<t.length;a++)if(Array.isArray(t[a])&&t[a].length>2){var o=this._removeSameFilter(t[a],i,!1,n);if(o>=0)return t[a].length?t[a].length===1&&(t[a]=t[a][0]):this._removeFilterByIndex(t,a,n),o}return-1}getSelectAllState(){var t=this.options.filter(),i=this.options.selectionFilter;if(!i)return!0;if(!i.length)return!1;if(!(!t||!t.length)){if(i=this._denormalizeFilter(i),this._isLastSubFilter(i,t))return!0;if(this._isLastSubFilter(i,["!",t]))return!1}}loadSelectedItemsWithFilter(){var t=this.options.filter(),i=this.options.selectionFilter,r=t?[t,"and",i]:i;return this._loadFilteredData(r)}}var Jt=function(e,t){this.getLocalFilter=function(a,o,c,l){return o=o===void 0?pe:o,n.bind(this,o,a,c,l)},this.getExpr=function(a){if(a){var o;return e.forEach(function(c,l){o=o||[];var h;l>0&&o.push(t?"and":"or"),Y(a)?h=s(a,c):h=function(u,d){for(var _=[],p=0,y=u.length;p<y;p++){var I=u[p],S=d&&d[I],C=s(I,S);if(!C)break;p>0&&_.push(t?"or":"and"),_.push(C)}return _}(a,c),o.push(h)}),o&&o.length===1&&(o=o[0]),o}},this.getCombinedFilter=function(a,o){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=this.getExpr(a),h=l;return(c||t)&&o&&(l?(h=[],h.push(l),h.push(o)):h=o),h};var i,r=function(a,o,c){return Array.isArray(c)?a.map(l=>o(l)):a};function n(a,o,c,l,h){var u=o(h),d,_;if(!c&&(d=ge(u),!R(d))){var p=function(y,I){if(!i){i={};for(var S=r(e,y,I),C=0;C<S.length;C++)i[ge(S[C])]=!0}return i}(o,l);return p[d]?!t:!!t}for(_=0;_<e.length;_++)if(a(e[_],u))return!t;return!!t}function s(a,o){if(o!==void 0)return[a,t?"<>":"=",o]}};class Hs extends zi{constructor(t){super(t),this._initSelectedItemKeyHash()}_initSelectedItemKeyHash(){this._setOption("keyHashIndices",this.options.equalByReference?null:{})}getSelectedItemKeys(){return this.options.selectedItemKeys.slice(0)}getSelectedItems(){return this.options.selectedItems.slice(0)}_preserveSelectionUpdate(t,i){var r=this.options.keyOf,n,s,a;if(r){var o=i&&t.length>1&&!this.options.equalByReference;for(o&&(n={}),a=0;a<t.length;a++){var c=t[a],l=r(c);i?(s=this.removeSelectedItem(l,n,c==null?void 0:c.disabled),n&&s>=0&&(n[s]=!0)):this.addSelectedItem(l,c)}o&&this._batchRemoveSelectedItems(n)}}_batchRemoveSelectedItems(t){var i=this.options.selectedItemKeys.slice(0),r=this.options.selectedItems.slice(0);this.options.selectedItemKeys.length=0,this.options.selectedItems.length=0;for(var n=0;n<i.length;n++)t[n]||(this.options.selectedItemKeys.push(i[n]),this.options.selectedItems.push(r[n]));this._initSelectedItemKeyHash(),this.updateSelectedItemKeyHash(this.options.selectedItemKeys)}_loadSelectedItemsCore(t,i,r,n){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,a=new v,o=this.options.key();if(!t.length&&!r)return a.resolve([]),a;if(r&&i&&!n)return a.resolve(this.getSelectedItems()),a;var c=new Jt(t,r),l=c.getCombinedFilter(o,n,s),h=[];if(i){var u=this.options.selectedItems;h=l&&t.length!==u.length?Ie(u).filter(l).toArray():u.slice(0)}var d=h.length?h:this.options.plainItems(!0).filter(this.options.isSelectableItem).map(this.options.getItemData),_=c.getLocalFilter(this.options.keyOf,this.equalKeys.bind(this),this.options.equalByReference,o);return d=d.filter(_),h.length||!r&&d.length===t.length?a.resolve(d):a=this._loadFilteredData(l,_,null,r),a}_replaceSelectionUpdate(t){var i=[],r=this.options.keyOf;if(r){for(var n=0;n<t.length;n++){var s=t[n],a=r(s);i.push(a)}this.setSelectedItems(i,t)}}_warnOnIncorrectKeys(t){for(var i=this.options.allowNullValue,r=0;r<t.length;r++){var n=t[r];(!i||n!==null)&&!this.isItemKeySelected(n)&&tt.log("W1002",n)}}_isMultiSelectEnabled(){var t=this.options.mode;return t==="all"||t==="multiple"}_requestInProgress(){var t;return((t=this._lastLoadDeferred)===null||t===void 0?void 0:t.state())==="pending"}_concatRequestsItems(t,i,r,n){var s,a=i?t:[];return n?s=n:s=It(t,this.options.selectedItemKeys),{addedItems:r.added.concat(s),removedItems:r.removed.concat(a),keys:t}}_collectLastRequestData(t,i,r,n){var s=i&&r,a={added:[],removed:[]},o=this._isMultiSelectEnabled(),c=o?this._lastRequestData:{};return o&&(this._shouldMergeWithLastRequest&&(s?(this._lastLoadDeferred.reject(),c={}):On(t,this.options.selectedItemKeys)||(a.added=c.addedItems,a.removed=c.removedItems,i||this._lastLoadDeferred.reject())),c=this._concatRequestsItems(t,i,a,this._shouldMergeWithLastRequest?void 0:n)),c}_updateKeysByLastRequestData(t,i,r){var n=t;if(this._isMultiSelectEnabled()&&this._shouldMergeWithLastRequest&&!i&&!r){var s,a;n=It(t.concat((s=this._lastRequestData)===null||s===void 0?void 0:s.addedItems),(a=this._lastRequestData)===null||a===void 0?void 0:a.removedItems),n=cr(n)}return n}_loadSelectedItems(t,i,r,n){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,a=this,o=new v,c=a.options.filter();return this._shouldMergeWithLastRequest=this._requestInProgress(),this._lastRequestData=this._collectLastRequestData(t,i,r,n),L(a._lastLoadDeferred).always(function(){var l=a._updateKeysByLastRequestData(t,i,r);a._shouldMergeWithLastRequest=!1,a._loadSelectedItemsCore(l,i,r,c,s).done(o.resolve).fail(o.reject)}),a._lastLoadDeferred=o,o}selectedItemKeys(t,i,r,n,s){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,o=this,c=o._loadSelectedItems(t,r,n,s,a);return c.done(function(l){i?o._preserveSelectionUpdate(l,r):o._replaceSelectionUpdate(l),o.onSelectionChanged()}),c}addSelectedItem(t,i){if(E(i)&&!this.options.ignoreDisabledItems&&i.disabled){this.options.disabledItemKeys.indexOf(t)===-1&&this.options.disabledItemKeys.push(t);return}var r=this._getKeyHash(t);this._indexOfSelectedItemKey(r)===-1&&(!R(r)&&this.options.keyHashIndices&&(this.options.keyHashIndices[r]=[this.options.selectedItemKeys.length]),this.options.selectedItemKeys.push(t),this.options.addedItemKeys.push(t),this.options.addedItems.push(i),this.options.selectedItems.push(i))}_getSelectedIndexByKey(t,i){for(var r=this.options.selectedItemKeys,n=0;n<r.length;n++)if((!i||!i[n])&&this.equalKeys(r[n],t))return n;return-1}_getSelectedIndexByHash(t,i){var r=this.options.keyHashIndices[t];return r&&r.length>1&&i&&(r=r.filter(function(n){return!i[n]})),r&&r[0]>=0?r[0]:-1}_indexOfSelectedItemKey(t,i){var r;return this.options.equalByReference?r=this.options.selectedItemKeys.indexOf(t):R(t)?r=this._getSelectedIndexByKey(t,i):r=this._getSelectedIndexByHash(t,i),r}_shiftSelectedKeyIndices(t){for(var i=t;i<this.options.selectedItemKeys.length;i++){var r=this.options.selectedItemKeys[i],n=ge(r),s=this.options.keyHashIndices[n];if(s)for(var a=0;a<s.length;a++)s[a]>t&&s[a]--}}removeSelectedItem(t,i,r){if(!(!this.options.ignoreDisabledItems&&r)){var n=this._getKeyHash(t),s=!!i,a=this._indexOfSelectedItemKey(n,i);if(a<0||(this.options.removedItemKeys.push(t),this.options.removedItems.push(this.options.selectedItems[a]),s)||(this.options.selectedItemKeys.splice(a,1),this.options.selectedItems.splice(a,1),R(n)||!this.options.keyHashIndices))return a;var o=this.options.keyHashIndices[n];return o&&(o.shift(),o.length||delete this.options.keyHashIndices[n],this._shiftSelectedKeyIndices(a)),a}}_updateAddedItemKeys(t,i){for(var r=0;r<t.length;r++)this.isItemKeySelected(t[r])||(this.options.addedItemKeys.push(t[r]),this.options.addedItems.push(i[r]))}_updateRemovedItemKeys(t,i,r){for(var n=0;n<i.length;n++)this.isItemKeySelected(i[n])||(this.options.removedItemKeys.push(i[n]),this.options.removedItems.push(r[n]))}_isItemSelectionInProgress(t,i){var r=i&&this._lastRequestData&&this._requestInProgress();if(r){var n,s=(n=this._lastRequestData.addedItems)!==null&&n!==void 0?n:[];return s.includes(t)}else return!1}_getKeyHash(t){return this.options.equalByReference?t:ge(t)}setSelectedItems(t,i){this._updateAddedItemKeys(t,i);var r=this.options.selectedItemKeys,n=this.options.selectedItems;this.options.equalByReference||(this._initSelectedItemKeyHash(),this.updateSelectedItemKeyHash(t)),this._setOption("selectedItemKeys",t),this._setOption("selectedItems",i),this._updateRemovedItemKeys(t,r,n)}isItemDataSelected(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=this.options.keyOf(t);return this.isItemKeySelected(r,i)}isItemKeySelected(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=this._isItemSelectionInProgress(t,i.checkPending);if(!r){var n=this._getKeyHash(t),s=this._indexOfSelectedItemKey(n);r=s!==-1}return r}getSelectAllState(t){return t?this._getVisibleSelectAllState():this._getFullSelectAllState()}loadSelectedItemsWithFilter(){var t=this.options.key(),i=this.getSelectedItemKeys(),r=this.options.filter();if(!i.length)return v().resolve([]);var n=new Jt(i),s=n.getCombinedFilter(t,r,!0);return this._loadFilteredData(s)}}class Ms{constructor(t){this.options=b(this._getDefaultOptions(),t,{selectedItemKeys:t.selectedKeys||[]}),this._selectionStrategy=this.options.deferred?new Fs(this.options):new Hs(this.options),this._focusedItemIndex=-1,this.options.equalByReference||this._selectionStrategy.updateSelectedItemKeyHash(this.options.selectedItemKeys)}_getDefaultOptions(){return{allowNullValue:!1,deferred:!1,equalByReference:!1,mode:"multiple",selectedItems:[],selectionFilter:[],maxFilterLengthInRequest:0,onSelectionChanged:m,key:m,keyOf:function(t){return t},load:function(){return new v().resolve([])},totalCount:function(){return-1},isSelectableItem:function(){return!0},isItemSelected:function(){return!1},getItemData:function(t){return t},dataFields:m,filter:m}}validate(){this._selectionStrategy.validate()}getSelectedItemKeys(){return this._selectionStrategy.getSelectedItemKeys()}getSelectedItems(){return this._selectionStrategy.getSelectedItems()}selectionFilter(t){if(t===void 0)return this.options.selectionFilter;var i=this.options.selectionFilter!==t&&JSON.stringify(this.options.selectionFilter)!==JSON.stringify(t);this.options.selectionFilter=t,i&&this.onSelectionChanged()}setSelection(t,i){return this.selectedItemKeys(t,!1,!1,!1,i)}select(t){return this.selectedItemKeys(t,!0)}deselect(t){return this.selectedItemKeys(t,!0,!0)}selectedItemKeys(t,i,r,n,s){var a;return t=(a=t)!==null&&a!==void 0?a:[],t=Array.isArray(t)?t:[t],this.validate(),this._selectionStrategy.selectedItemKeys(t,i,r,n,s)}clearSelection(){return this.selectedItemKeys([])}_addSelectedItem(t,i){this._selectionStrategy.addSelectedItem(i,t)}_removeSelectedItem(t){this._selectionStrategy.removeSelectedItem(t)}_setSelectedItems(t,i){this._selectionStrategy.setSelectedItems(t,i)}onSelectionChanged(){this._selectionStrategy.onSelectionChanged()}changeItemSelection(t,i,r){var n,s,a,o=this.options.plainItems(),c=o[t],l,h=(n=(s=this.options).allowLoadByRange)===null||n===void 0?void 0:n.call(s),u,d=!1,_=!1,p=T=>T>=0&&!o.filter(le=>le.loadIndex===T).length;if(h&&E(c)&&(u=c.loadIndex-t,t=c.loadIndex,d=p(this._focusedItemIndex),E(this._shiftFocusedItemIndex)&&(_=p(this._shiftFocusedItemIndex))),!this.isSelectable()||!this.isDataItem(c))return!1;var y=this.options.getItemData(c),I=this.options.keyOf(y);if(i=i||{},i.shift&&this.options.mode==="multiple"&&this._focusedItemIndex>=0)d||_?(a=t!==this._shiftFocusedItemIndex||this._focusedItemIndex!==this._shiftFocusedItemIndex,a&&(l=this.changeItemSelectionWhenShiftKeyInVirtualPaging(t))):a=this.changeItemSelectionWhenShiftKeyPressed(t,o,u);else if(i.control){if(this._resetItemSelectionWhenShiftKeyPressed(),!r){var S=this._selectionStrategy.isItemDataSelected(y);this.options.mode==="single"&&this.clearSelectedItems(),S?this._removeSelectedItem(I):this._addSelectedItem(y,I)}a=!0}else{this._resetItemSelectionWhenShiftKeyPressed();var C=this._selectionStrategy.equalKeys(this.options.selectedItemKeys[0],I);(this.options.selectedItemKeys.length!==1||!C)&&(this._setSelectedItems([I],[y]),a=!0)}if(a)return L(l).done(()=>{this._focusedItemIndex=t,!r&&this.onSelectionChanged()}),!0}isDataItem(t){return this.options.isSelectableItem(t)}isSelectable(){return this.options.mode==="single"||this.options.mode==="multiple"}isItemDataSelected(t){return this._selectionStrategy.isItemDataSelected(t,{checkPending:!0})}isItemSelected(t,i){return this._selectionStrategy.isItemKeySelected(t,i)}_resetItemSelectionWhenShiftKeyPressed(){delete this._shiftFocusedItemIndex}_resetFocusedItemIndex(){this._focusedItemIndex=-1}changeItemSelectionWhenShiftKeyInVirtualPaging(t){var i=this.options.getLoadOptions(t,this._focusedItemIndex,this._shiftFocusedItemIndex),r=new v,n=i.skip;return this.options.load(i).done(s=>{this.changeItemSelectionWhenShiftKeyPressed(t,s,n),r.resolve()}),r.promise()}changeItemSelectionWhenShiftKeyPressed(t,i,r){var n=!1,s,a=E(r),o=a?this._focusedItemIndex-r:this._focusedItemIndex,c=this.options.keyOf,l=i[o],h=this.options.getItemData(l),u=c(h),d=l&&this.isItemDataSelected(h);E(this._shiftFocusedItemIndex)||(this._shiftFocusedItemIndex=this._focusedItemIndex);var _,p,y,I;if(this._shiftFocusedItemIndex!==this._focusedItemIndex)for(s=this._focusedItemIndex<this._shiftFocusedItemIndex?1:-1,y=a?this._focusedItemIndex-r:this._focusedItemIndex,I=a?this._shiftFocusedItemIndex-r:this._shiftFocusedItemIndex,o=y;o!==I;o+=s)(a||this.isDataItem(i[o]))&&(p=c(this.options.getItemData(i[o])),this._removeSelectedItem(p),n=!0);if(t!==this._shiftFocusedItemIndex)for(s=t<this._shiftFocusedItemIndex?1:-1,y=a?t-r:t,I=a?this._shiftFocusedItemIndex-r:this._shiftFocusedItemIndex,o=y;o!==I;o+=s)(a||this.isDataItem(i[o]))&&(_=this.options.getItemData(i[o]),p=c(_),this._addSelectedItem(_,p),n=!0);return(a||this.isDataItem(l))&&!d&&(this._addSelectedItem(h,u),n=!0),n}clearSelectedItems(){this._setSelectedItems([],[])}selectAll(t){return this._resetFocusedItemIndex(),t?this._onePageSelectAll(!1):this.selectedItemKeys([],!0,!1,!0)}deselectAll(t){return this._resetFocusedItemIndex(),t?this._onePageSelectAll(!0):this.selectedItemKeys([],!0,!0,!0)}_onePageSelectAll(t){for(var i=this._selectionStrategy.getSelectableItems(this.options.plainItems()),r=0;r<i.length;r++){var n=i[r];if(this.isDataItem(n)){var s=this.options.getItemData(n),a=this.options.keyOf(s),o=this.isItemSelected(a);!o&&!t&&this._addSelectedItem(s,a),o&&t&&this._removeSelectedItem(a)}}return this.onSelectionChanged(),new v().resolve()}getSelectAllState(t){return this._selectionStrategy.getSelectAllState(t)}loadSelectedItemsWithFilter(){return this._selectionStrategy.loadSelectedItemsWithFilter()}}var ze="dxItemDeleting",Ae=-1,M=function(e){return e!==Ae},Ws=$i.inherit({_setOptionsByReference:function(){this.callBase(),b(this._optionsByReference,{selectedItem:!0})},_getDefaultOptions:function(){return b(this.callBase(),{selectionMode:"none",selectionRequired:!1,selectByClick:!0,selectedItems:[],selectedItemKeys:[],maxFilterLengthInRequest:1500,keyExpr:null,selectedIndex:Ae,selectedItem:null,onSelectionChanged:null,onItemReordered:null,onItemDeleting:null,onItemDeleted:null})},ctor:function(e,t){this._userOptions=t||{},this.callBase(e,t)},_init:function(){this._initEditStrategy(),this.callBase(),this._initKeyGetter(),this._initSelectionModule()},_initKeyGetter:function(){this._keyGetter=V(this.option("keyExpr"))},_getKeysByItems:function(e){return this._editStrategy.getKeysByItems(e)},_getItemsByKeys:function(e,t){return this._editStrategy.getItemsByKeys(e,t)},_getKeyByIndex:function(e){return this._editStrategy.getKeyByIndex(e)},_getIndexByKey:function(e){return this._editStrategy.getIndexByKey(e)},_getIndexByItemData:function(e){return this._editStrategy.getIndexByItemData(e)},_isKeySpecified:function(){return!!this._dataController.key()},_getCombinedFilter:function(){return this._dataController.filter()},key:function(){return this.option("keyExpr")?this.option("keyExpr"):this._dataController.key()},keyOf:function(e){var t=e;return this.option("keyExpr")?t=this._keyGetter(e):this._dataController.store()&&(t=this._dataController.keyOf(e)),t},_nullValueSelectionSupported:function(){return!1},_initSelectionModule:function(){var e=this,t=e._editStrategy.itemsGetter;this._selection=new Ms({allowNullValue:this._nullValueSelectionSupported(),mode:this.option("selectionMode"),maxFilterLengthInRequest:this.option("maxFilterLengthInRequest"),equalByReference:!this._isKeySpecified(),onSelectionChanged:function(i){(i.addedItemKeys.length||i.removedItemKeys.length)&&(e.option("selectedItems",e._getItemsByKeys(i.selectedItemKeys,i.selectedItems)),e._updateSelectedItems(i))},filter:e._getCombinedFilter.bind(e),totalCount:function(){var i=e.option("items"),r=e._dataController.totalCount();return r>=0?r:e._getItemsCount(i)},key:e.key.bind(e),keyOf:e.keyOf.bind(e),load:function(i){var r,n=e._dataController;return i.customQueryParams=(r=n.loadOptions())===null||r===void 0?void 0:r.customQueryParams,i.userData=n.userData(),n.store()?n.loadFromStore(i).done(function(s){if(!e._disposed){var a=Ti(s).data;n.applyMapFunction(a)}}):new v().resolve(this.plainItems())},dataFields:function(){return e._dataController.select()},plainItems:t.bind(e._editStrategy)})},_getItemsCount:function(e){return e.reduce((t,i)=>t+(i.items?this._getItemsCount(i.items):1),0)},_initEditStrategy:function(){var e=Bs;this._editStrategy=new e(this)},_getSelectedItemIndices:function(e){var t=this,i=[];return e=e||this._selection.getSelectedItemKeys(),t._editStrategy.beginCache(),x(e,function(r,n){var s=t._getIndexByKey(n);M(s)&&i.push(s)}),t._editStrategy.endCache(),i},_initMarkup:function(){this._rendering=!0,this._dataController.isLoading()||this._syncSelectionOptions().done(()=>this._normalizeSelectedItems()),this.callBase()},_render:function(){this.callBase(),this._rendering=!1},_fireContentReadyAction:function(){this._rendering=!1,this._rendered=!0,this.callBase.apply(this,arguments)},_syncSelectionOptions:function(e){e=e||this._chooseSelectOption();var t,i,r,n;switch(e){case"selectedIndex":t=this._editStrategy.getItemDataByIndex(this.option("selectedIndex")),E(t)?(this._setOptionWithoutOptionChange("selectedItems",[t]),this._setOptionWithoutOptionChange("selectedItem",t),this._setOptionWithoutOptionChange("selectedItemKeys",this._editStrategy.getKeysByItems([t]))):(this._setOptionWithoutOptionChange("selectedItems",[]),this._setOptionWithoutOptionChange("selectedItemKeys",[]),this._setOptionWithoutOptionChange("selectedItem",null));break;case"selectedItems":if(n=this.option("selectedItems")||[],i=n.length?this._editStrategy.getIndexByItemData(n[0]):Ae,this.option("selectionRequired")&&!M(i))return this._syncSelectionOptions("selectedIndex");this._setOptionWithoutOptionChange("selectedItem",n[0]),this._setOptionWithoutOptionChange("selectedIndex",i),this._setOptionWithoutOptionChange("selectedItemKeys",this._editStrategy.getKeysByItems(n));break;case"selectedItem":if(t=this.option("selectedItem"),i=this._editStrategy.getIndexByItemData(t),this.option("selectionRequired")&&!M(i))return this._syncSelectionOptions("selectedIndex");E(t)?(this._setOptionWithoutOptionChange("selectedItems",[t]),this._setOptionWithoutOptionChange("selectedIndex",i),this._setOptionWithoutOptionChange("selectedItemKeys",this._editStrategy.getKeysByItems([t]))):(this._setOptionWithoutOptionChange("selectedItems",[]),this._setOptionWithoutOptionChange("selectedItemKeys",[]),this._setOptionWithoutOptionChange("selectedIndex",Ae));break;case"selectedItemKeys":if(r=this.option("selectedItemKeys"),this.option("selectionRequired")){var s=this._getIndexByKey(r[0]);if(!M(s))return this._syncSelectionOptions("selectedIndex")}return this._selection.setSelection(r)}return new v().resolve().promise()},_chooseSelectOption:function(){var e="selectedIndex",t=(function(i){var r=this.option(i),n=E(r)&&r.length;return n||i in this._userOptions}).bind(this);return t("selectedItems")?e="selectedItems":t("selectedItem")?e="selectedItem":t("selectedItemKeys")&&(e="selectedItemKeys"),e},_compareKeys:function(e,t){if(e.length!==t.length)return!1;for(var i=0;i<t.length;i++)if(e[i]!==t[i])return!1;return!0},_normalizeSelectedItems:function(){if(this.option("selectionMode")==="none")this._setOptionWithoutOptionChange("selectedItems",[]),this._syncSelectionOptions("selectedItems");else if(this.option("selectionMode")==="single"){var e=this.option("selectedItems");if(e.length>1||!e.length&&this.option("selectionRequired")&&this.option("items")&&this.option("items").length){var t=this._selection.getSelectedItems(),i=e[0]===void 0?t[0]:e[0];return i===void 0&&(i=this._editStrategy.itemsGetter()[0]),this.option("grouped")&&i&&i.items&&(i.items=[i.items[0]]),this._selection.setSelection(this._getKeysByItems([i])),this._setOptionWithoutOptionChange("selectedItems",[i]),this._syncSelectionOptions("selectedItems")}else this._selection.setSelection(this._getKeysByItems(e))}else{var r=this._getKeysByItems(this.option("selectedItems")),n=this._selection.getSelectedItemKeys();this._compareKeys(n,r)||this._selection.setSelection(r)}return new v().resolve().promise()},_itemClickHandler:function(e){var t=new v().resolve(),i=this.callBase;this._createAction((function(r){var n;t=(n=this._itemSelectHandler(r.event))!==null&&n!==void 0?n:t}).bind(this),{validatingTargetName:"itemElement"})({itemElement:f(e.currentTarget),event:e}),t.always(()=>{i.apply(this,arguments)})},_itemSelectHandler:function(e){var t,i;if(this.option("selectByClick")){var r=e.currentTarget;return this.isItemSelected(r)?this.unselectItem(e.currentTarget):i=this.selectItem(e.currentTarget),(t=i)===null||t===void 0?void 0:t.promise()}},_selectedItemElement:function(e){return this._itemElements().eq(e)},_postprocessRenderItem:function(e){if(this.option("selectionMode")!=="none"){var t=f(e.itemElement),i=this._editStrategy.getNormalizedIndex(t),r=this._isItemSelected(i);this._processSelectableItem(t,r)}},_processSelectableItem:function(e,t){e.toggleClass(this._selectedItemClass(),t),this._setAriaSelectionAttribute(e,String(t))},_updateSelectedItems:function(e){var t=this,i=e.addedItemKeys,r=e.removedItemKeys;if(t._rendered&&(i.length||r.length)){var n=t._selectionChangePromise;if(!t._rendering){var s=[],a,o=[];t._editStrategy.beginCache();for(var c=0;c<i.length;c++)a=t._getIndexByKey(i[c]),s.push(a),t._addSelection(a);for(var l=0;l<r.length;l++)a=t._getIndexByKey(r[l]),o.push(a),t._removeSelection(a);t._editStrategy.endCache(),t._updateSelection(s,o)}L(n).done(function(){t._fireSelectionChangeEvent(e.addedItems,e.removedItems)})}},_fireSelectionChangeEvent:function(e,t){this._createActionByOption("onSelectionChanged",{excludeValidators:["disabled","readOnly"]})({addedItems:e,removedItems:t})},_updateSelection:m,_setAriaSelectionAttribute:function(e,t){this.setAria("selected",t,e)},_removeSelection:function(e){var t=this._editStrategy.getItemElement(e);M(e)&&(this._processSelectableItem(t,!1),g.triggerHandler(t,"stateChanged",!1))},_addSelection:function(e){var t=this._editStrategy.getItemElement(e);M(e)&&(this._processSelectableItem(t,!0),g.triggerHandler(t,"stateChanged",!0))},_isItemSelected:function(e){var t=this._getKeyByIndex(e);return this._selection.isItemSelected(t,{checkPending:!0})},_optionChanged:function(e){switch(e.name){case"selectionMode":this._invalidate();break;case"dataSource":(!e.value||Array.isArray(e.value)&&!e.value.length)&&this.option("selectedItemKeys",[]),this.callBase(e);break;case"selectedIndex":case"selectedItem":case"selectedItems":case"selectedItemKeys":this._syncSelectionOptions(e.name).done(()=>this._normalizeSelectedItems());break;case"keyExpr":this._initKeyGetter();break;case"selectionRequired":this._normalizeSelectedItems();break;case"selectByClick":case"onSelectionChanged":case"onItemDeleting":case"onItemDeleted":case"onItemReordered":case"maxFilterLengthInRequest":break;default:this.callBase(e)}},_clearSelectedItems:function(){this._setOptionWithoutOptionChange("selectedItems",[]),this._syncSelectionOptions("selectedItems")},_waitDeletingPrepare:function(e){if(e.data(ze))return new v().resolve().promise();e.data(ze,!0);var t=new v,i={cancel:!1},r=this._itemEventHandler(e,"onItemDeleting",i,{excludeValidators:["disabled","readOnly"]});return L(r).always((function(n){var s=!r,a=!s&&r.state()==="resolved",o=!!arguments.length,c=s||a&&!o||a&&n;L(J(i.cancel)).always(function(){e.data(ze,!1)}).done(function(l){c&&!l?t.resolve():t.reject()}).fail(t.reject)}).bind(this)),t.promise()},_deleteItemFromDS:function(e){var t=this._dataController,i=new v,r=this.option("disabled"),n=t.store();if(!n)return new v().resolve().promise();if(!n.remove)throw tt.Error("E1011");return this.option("disabled",!0),n.remove(t.keyOf(this._getItemData(e))).done(function(s){s!==void 0?i.resolve():i.reject()}).fail(function(){i.reject()}),i.always((function(){this.option("disabled",r)}).bind(this)),i},_tryRefreshLastPage:function(){var e=new v;return this._isLastPage()||this.option("grouped")?e.resolve():this._refreshLastPage().done(function(){e.resolve()}),e.promise()},_refreshLastPage:function(){return this._expectLastItemLoading(),this._dataController.load()},_updateSelectionAfterDelete:function(e){var t=this._getKeyByIndex(e);this._selection.deselect([t])},_updateIndicesAfterIndex:function(e){for(var t=this._itemElements(),i=e+1;i<t.length;i++)f(t[i]).data(this._itemIndexKey(),i-1)},_simulateOptionChange:function(e){var t=this.option(e);t instanceof Je||this._optionChangedAction({name:e,fullName:e,value:t})},isItemSelected:function(e){return this._isItemSelected(this._editStrategy.getNormalizedIndex(e))},selectItem:function(e){if(this.option("selectionMode")!=="none"){var t=this._editStrategy.getNormalizedIndex(e);if(M(t)){var i=this._getKeyByIndex(t);if(!this._selection.isItemSelected(i)){if(this.option("selectionMode")==="single")return this._selection.setSelection([i]);var r=this.option("selectedItemKeys")||[];return this._selection.setSelection([...r,i],[i])}}}},unselectItem:function(e){var t=this._editStrategy.getNormalizedIndex(e);if(M(t)){var i=this._selection.getSelectedItemKeys();if(!(this.option("selectionRequired")&&i.length<=1)){var r=this._getKeyByIndex(t);this._selection.isItemSelected(r,{checkPending:!0})&&this._selection.deselect([r])}}},_deleteItemElementByIndex:function(e){this._updateSelectionAfterDelete(e),this._updateIndicesAfterIndex(e),this._editStrategy.deleteItemAtIndex(e)},_afterItemElementDeleted:function(e,t){var i=this._dataController.getDataSource()?"dataSource":"items";this._simulateOptionChange(i),this._itemEventHandler(e,"onItemDeleted",t,{beforeExecute:function(){e.remove()},excludeValidators:["disabled","readOnly"]}),this._renderEmptyMessage()},deleteItem:function(e){var t=this,i=new v,r=this._editStrategy.getItemElement(e),n=this._editStrategy.getNormalizedIndex(e),s=this._itemResponseWaitClass();return M(n)?this._waitDeletingPrepare(r).done(function(){r.addClass(s);var a=t._extendActionArgs(r);t._deleteItemFromDS(r).done(function(){t._deleteItemElementByIndex(n),t._afterItemElementDeleted(r,a),t._tryRefreshLastPage().done(function(){i.resolveWith(t)})}).fail(function(){r.removeClass(s),i.rejectWith(t)})}).fail(function(){i.rejectWith(t)}):i.rejectWith(t),i.promise()},reorderItem:function(e,t){var i=new v,r=this,n=this._editStrategy,s=n.getItemElement(e),a=n.getItemElement(t),o=n.getNormalizedIndex(e),c=n.getNormalizedIndex(t),l=this._dataController.getDataSource()?"dataSource":"items",h=M(o)&&M(c)&&o!==c;return h?i.resolveWith(this):i.rejectWith(this),i.promise().done(function(){a[n.itemPlacementFunc(o,c)](s),n.moveItemAtIndexToIndex(o,c),this._updateIndicesAfterIndex(o),r.option("selectedItems",r._getItemsByKeys(r._selection.getSelectedItemKeys(),r._selection.getSelectedItems())),l==="items"&&r._simulateOptionChange(l),r._itemEventHandler(s,"onItemReordered",{fromIndex:n.getIndex(o),toIndex:n.getIndex(c)},{excludeValidators:["disabled","readOnly"]})})}});export{pn as A,Is as B,ct as C,Ln as D,Gn as E,qn as F,ye as G,vi as H,pi as I,Zn as J,Jn as N,Bs as P,Jt as S,_n as a,Je as b,Ws as c,Hr as d,yr as e,A as f,j as g,wi as h,Ki as i,ps as j,ki as k,Ms as l,Ve as m,Ti as n,ks as o,at as p,Ie as q,nt as r,Xe as s,wn as t,Ni as u,es as v,ts as w,is as x,$s as y,zs as z};
