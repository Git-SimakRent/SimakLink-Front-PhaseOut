import{c as Je,a as Er,g as wr}from"./_commonjsHelpers.23102255.js";import{aJ as Ar,d as it,T as Gi,g as je,$ as A,e as ce,W as ye,t as Me,a as De,u as Ye,i as ni,V as xr,L as Dr,aK as Mr,aL as Hi,m as ze,P as Ee,U as ji,X as Zi,K as Qe,_ as Fr,C as Bt,Q as It,a6 as Pr,a1 as ai,r as pt,af as si,M as Tr,aM as oi,v as li,p as Dt,aN as Or,aO as kr,c as qi}from"./index.94f86987.js";import{T as Y,a0 as ne,af as fe,$ as Ce,W as re,U as ke,Z as xe,a1 as _t,aB as Re,ac as Xi,ab as yt,aH as Ie,aj as Rr,ay as Ne,aE as Lr,a6 as Yi,aI as Ji,a9 as Br,ai as z,Y as Qi,ad as Ut,aM as ot,aq as Xe,ar as Nr}from"./entry.f47474d7.js";import{n as Ur}from"./notify.6d2dad03.js";import{b as zr}from"./ui.form.bf59509c.js";import{f as $r,a as ht,C as Vr,k as Kr,c as Wr,B as Gr,l as Hr,j as jr}from"./ui.collection_widget.edit.95cdfece.js";import{C as Zr,T as qr,D as Xr,M as Yr}from"./ui.menu.f201d4e6.js";import{B as We,g as St}from"./resize_observer.3c2fa9a2.js";import{$ as Jr}from"./row_dragging.56a54afd.js";import{S as zt,P as er}from"./ui.popup.81669a77.js";import{T as Qr}from"./ui.toolbar.1b55a2cc.js";import{E as tr,T as en}from"./text_box.08b8e7e6.js";var de={},Nt=function(m,e,t){e=e||ke,t=t||ke,Array.isArray(m)||(m=[m]);var i=m.map((r,n)=>fe(r).then(a=>(Ce(e)&&e({item:r,index:n,result:a}),a),a=>(a||(a={}),a.index=n,Ce(t)&&t(a),new re().resolve().promise())));return fe.apply(null,i)},ir=function(m){for(var e=["B","KB","MB","GB","TB"],t=0,i=m;i>=1024&&t<=e.length-1;)i/=1024,t++;return i=Math.round(10*i)/10,"".concat(i," ").concat(e[t])},Ge=function(m,e,t){return t.forEach(i=>{Y(!0,m,ne(e[i])?{[i]:e[i]}:{})}),m},tn=(m,e)=>{var t={};e.forEach(r=>{t[r]=null}),m.forEach(r=>{var n=r.fileItem.key;Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=r)});var i=[];return e.forEach(r=>{var n=t[r];n&&i.push(n)}),i},di=function(m){var e=Object.keys(m),t=[];return e.forEach(i=>t.push(m[i])),{keys:e,values:t}},rt="/",rr=m=>{var e=m.lastIndexOf(".");return e!==-1?m.substr(e):""},hi=m=>{var e=m.lastIndexOf(rt);return e!==-1?m.substr(e+rt.length):m},nr=(m,e)=>{if(!m||m==="/")return[];for(var t=[],i="",r=0;r<m.length;r++){var n=m.charAt(r);if(n===rt){var a=m.charAt(r+1);a!==rt&&(i&&(t.push(i),i=""),n=a),r++}i+=n}if(i&&t.push(i),e)for(var o=0;o<t.length;o++)t[o]=Le(o===0?"":t[o-1],$t(t[o]));return t},$t=function(m){return m.replace(/\/{1,1}/g,"//")},Le=function(){var m="";return xe(arguments,(e,t)=>{t&&(m&&(m+=rt),m+=t)}),m};class et{constructor(){var e=_t(arguments[0])?this._publicCtor:this._internalCtor;e.apply(this,arguments)}_internalCtor(e,t,i,r){this.name=t||"",this.pathInfo=e&&[...e]||[],this.parentPath=this._getPathByPathInfo(this.pathInfo),this.relativeName=Le(this.parentPath,t),this.key=r||this._getPathByPathInfo(this.getFullPathInfo(),!0),this.path=Le(this.parentPath,t),this.pathKeys=this.pathInfo.map(n=>{var{key:a}=n;return a}),this.isRoot()||this.pathKeys.push(this.key),this._initialize(i)}_publicCtor(e,t,i){this.path=e||"",this.pathKeys=i||[];for(var r=[],n=nr(e,!0),a=0;a<n.length-1;a++){var o=n[a],d={key:this.pathKeys[a]||o,name:hi(o)};r.push(d)}this.pathInfo=r,this.relativeName=e,this.name=hi(e),this.key=this.pathKeys.length?this.pathKeys[this.pathKeys.length-1]:e,this.parentPath=n.length>1?n[n.length-2]:"",this._initialize(t)}_initialize(e){this.isDirectory=!!e,this.size=0,this.dateModified=new Date,this.thumbnail="",this.tooltipText=""}getFullPathInfo(){var e=[...this.pathInfo];return this.isRoot()||e.push({key:this.key,name:this.name}),e}isRoot(){return this.path===""}getFileExtension(){return this.isDirectory?"":rr(this.name)}equals(e){return e&&this.key===e.key}createClone(){var e=new et(this.pathInfo,this.name,this.isDirectory,this.key);return e.key=this.key,e.size=this.size,e.dateModified=this.dateModified,e.thumbnail=this.thumbnail,e.tooltipText=this.tooltipText,e.hasSubDirectories=this.hasSubDirectories,e.dataItem=this.dataItem,e}_getPathByPathInfo(e,t){return e.map(i=>t?$t(i.name):i.name).join(rt)}}var rn=2e5;class bt{constructor(e){e=Ie(e,{}),this._keyGetter=Re(this._getKeyExpr(e)),this._nameGetter=Re(this._getNameExpr(e)),this._isDirGetter=Re(this._getIsDirExpr(e)),this._sizeGetter=Re(this._getSizeExpr(e)),this._dateModifiedGetter=Re(this._getDateModifiedExpr(e)),this._thumbnailGetter=Re(e.thumbnailExpr||"thumbnail")}getItems(e){return[]}renameItem(e,t){}createDirectory(e,t){}deleteItems(e){}moveItems(e,t){}copyItems(e,t){}uploadFileChunk(e,t,i){}abortFileUpload(e,t,i){}downloadItems(e){}getItemsContent(e){}getFileUploadChunkSize(){return rn}_convertDataObjectsToFileItems(e,t){var i=[];return xe(e,(r,n)=>{var a=this._createFileItem(n,t);i.push(a)}),i}_createFileItem(e,t){var i=this._keyGetter(e),r=new et(t,this._nameGetter(e),!!this._isDirGetter(e),i);return r.size=this._sizeGetter(e),r.size===void 0&&(r.size=0),r.dateModified=zr.deserializeDate(this._dateModifiedGetter(e)),r.dateModified===void 0&&(r.dateModified=new Date),r.isDirectory&&(r.hasSubDirectories=this._hasSubDirs(e)),i||(r.key=r.relativeName),r.thumbnail=this._thumbnailGetter(e)||"",r.dataItem=e,r}_hasSubDirs(e){return!0}_getKeyExpr(e){return e.keyExpr||this._defaultKeyExpr}_defaultKeyExpr(e){if(arguments.length===2){e.__KEY__=arguments[1];return}return Object.prototype.hasOwnProperty.call(e,"__KEY__")?e.__KEY__:null}_getNameExpr(e){return e.nameExpr||"name"}_getIsDirExpr(e){return e.isDirectoryExpr||"isDirectory"}_getSizeExpr(e){return e.sizeExpr||"size"}_getDateModifiedExpr(e){return e.dateModifiedExpr||"dateModified"}_executeActionAsDeferred(e,t){var i=new re;try{var r=e();Xi(r)?yt(r).done(n=>i.resolve(t&&n||void 0)).fail(n=>i.reject(n)):i.resolve(t&&r||void 0)}catch(n){return i.reject(n)}return i.promise()}}var Ue=je(),Mt=Ar(),ci={EXCEL:"xlsx",CSS:"css",PNG:"png",JPEG:"jpeg",GIF:"gif",SVG:"svg",PDF:"pdf"},nn={CSS:"text/css",EXCEL:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",PNG:"image/png",JPEG:"image/jpeg",GIF:"image/gif",SVG:"image/svg+xml",PDF:"application/pdf"},ui={_revokeObjectURLTimeout:3e4,_getDataUri:function(m,e){var t=this._getMimeType(m);return"data:".concat(t,";base64,").concat(e)},_getMimeType:function(m){return nn[m]||"application/octet-stream"},_linkDownloader:function(m,e){var t=it.createElement("a");return t.download=m,t.href=e,t.target="_blank",t},_winJSBlobSave:function(m,e,t){var i=new Windows.Storage.Pickers.FileSavePicker;i.suggestedStartLocation=Windows.Storage.Pickers.PickerLocationId.documentsLibrary;var r=ci[t];if(r){var n=this._getMimeType(t);i.fileTypeChoices.insert(n,["."+r])}i.suggestedFileName=e,i.pickSaveFileAsync().then(function(a){a&&a.openAsync(Windows.Storage.FileAccessMode.readWrite).then(function(o){var d=m.msDetachStream();Windows.Storage.Streams.RandomAccessStream.copyAsync(d,o).then(function(){o.flushAsync().done(function(){d.close(),o.close()})})})})},_click:function(m){try{m.dispatchEvent(new MouseEvent("click",{cancelable:!0}))}catch{var e=it.getDocument().createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,Ue,0,0,0,80,20,!1,!1,!1,!1,0,null),m.dispatchEvent(e)}},_saveBlobAs:function(m,e,t){if(this._blobSaved=!1,ne(Mt.msSaveOrOpenBlob))Mt.msSaveOrOpenBlob(t,m),this._blobSaved=!0;else if(ne(Ue.WinJS))this._winJSBlobSave(t,m,e),this._blobSaved=!0;else{var i=Ue.URL||Ue.webkitURL||Ue.mozURL||Ue.msURL||Ue.oURL;if(ne(i)){var r=i.createObjectURL(t),n=this._linkDownloader(m,r);setTimeout(()=>{i.revokeObjectURL(r),this._objectUrlRevoked=!0},this._revokeObjectURLTimeout),this._click(n)}else Rr.warn("window.URL || window.webkitURL || window.mozURL || window.msURL || window.oURL is not defined")}},saveAs:function(m,e,t){var i=ci[e];if(i&&(m+="."+i),Ce(Ue.Blob))this._saveBlobAs(m,e,t);else{ne(Mt.userAgent.match(/iPad/i))||Gi.log("E1034");var r=this._linkDownloader(m,this._getDataUri(e,t));this._click(r)}}};function Ct(m){throw new Error('Could not dynamically require "'+m+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ar={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(m,e){(function(t){m.exports=t()})(function(){return function t(i,r,n){function a(g,y){if(!r[g]){if(!i[g]){var C=typeof Ct=="function"&&Ct;if(!y&&C)return C(g,!0);if(o)return o(g,!0);var b=new Error("Cannot find module '"+g+"'");throw b.code="MODULE_NOT_FOUND",b}var c=r[g]={exports:{}};i[g][0].call(c.exports,function(v){var h=i[g][1][v];return a(h||v)},c,c.exports,t,i,r,n)}return r[g].exports}for(var o=typeof Ct=="function"&&Ct,d=0;d<n.length;d++)a(n[d]);return a}({1:[function(t,i,r){var n=t("./utils"),a=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(d){for(var g,y,C,b,c,v,h,_=[],u=0,I=d.length,E=I,D=n.getTypeOf(d)!=="string";u<d.length;)E=I-u,C=D?(g=d[u++],y=u<I?d[u++]:0,u<I?d[u++]:0):(g=d.charCodeAt(u++),y=u<I?d.charCodeAt(u++):0,u<I?d.charCodeAt(u++):0),b=g>>2,c=(3&g)<<4|y>>4,v=1<E?(15&y)<<2|C>>6:64,h=2<E?63&C:64,_.push(o.charAt(b)+o.charAt(c)+o.charAt(v)+o.charAt(h));return _.join("")},r.decode=function(d){var g,y,C,b,c,v,h=0,_=0,u="data:";if(d.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var I,E=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===o.charAt(64)&&E--,d.charAt(d.length-2)===o.charAt(64)&&E--,E%1!=0)throw new Error("Invalid base64 input, bad content length.");for(I=a.uint8array?new Uint8Array(0|E):new Array(0|E);h<d.length;)g=o.indexOf(d.charAt(h++))<<2|(b=o.indexOf(d.charAt(h++)))>>4,y=(15&b)<<4|(c=o.indexOf(d.charAt(h++)))>>2,C=(3&c)<<6|(v=o.indexOf(d.charAt(h++))),I[_++]=g,c!==64&&(I[_++]=y),v!==64&&(I[_++]=C);return I}},{"./support":30,"./utils":32}],2:[function(t,i,r){var n=t("./external"),a=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),d=t("./stream/DataLengthProbe");function g(y,C,b,c,v){this.compressedSize=y,this.uncompressedSize=C,this.crc32=b,this.compression=c,this.compressedContent=v}g.prototype={getContentWorker:function(){var y=new a(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),C=this;return y.on("end",function(){if(this.streamInfo.data_length!==C.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),y},getCompressedWorker:function(){return new a(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},g.createWorkerFrom=function(y,C,b){return y.pipe(new o).pipe(new d("uncompressedSize")).pipe(C.compressWorker(b)).pipe(new d("compressedSize")).withStreamInfo("compression",C)},i.exports=g},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,i,r){var n=t("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},r.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,i,r){var n=t("./utils"),a=function(){for(var o,d=[],g=0;g<256;g++){o=g;for(var y=0;y<8;y++)o=1&o?3988292384^o>>>1:o>>>1;d[g]=o}return d}();i.exports=function(o,d){return o!==void 0&&o.length?n.getTypeOf(o)!=="string"?function(g,y,C,b){var c=a,v=b+C;g^=-1;for(var h=b;h<v;h++)g=g>>>8^c[255&(g^y[h])];return-1^g}(0|d,o,o.length,0):function(g,y,C,b){var c=a,v=b+C;g^=-1;for(var h=b;h<v;h++)g=g>>>8^c[255&(g^y.charCodeAt(h))];return-1^g}(0|d,o,o.length,0):0}},{"./utils":32}],5:[function(t,i,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(t,i,r){var n=null;n=typeof Promise<"u"?Promise:t("lie"),i.exports={Promise:n}},{lie:37}],7:[function(t,i,r){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=t("pako"),o=t("./utils"),d=t("./stream/GenericWorker"),g=n?"uint8array":"array";function y(C,b){d.call(this,"FlateWorker/"+C),this._pako=null,this._pakoAction=C,this._pakoOptions=b,this.meta={}}r.magic="\b\0",o.inherits(y,d),y.prototype.processChunk=function(C){this.meta=C.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(g,C.data),!1)},y.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},y.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},y.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var C=this;this._pako.onData=function(b){C.push({data:b,meta:C.meta})}},r.compressWorker=function(C){return new y("Deflate",C)},r.uncompressWorker=function(){return new y("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,i,r){function n(c,v){var h,_="";for(h=0;h<v;h++)_+=String.fromCharCode(255&c),c>>>=8;return _}function a(c,v,h,_,u,I){var E,D,x=c.file,N=c.compression,k=I!==g.utf8encode,K=o.transformTo("string",I(x.name)),O=o.transformTo("string",g.utf8encode(x.name)),j=x.comment,ee=o.transformTo("string",I(j)),S=o.transformTo("string",g.utf8encode(j)),R=O.length!==x.name.length,l=S.length!==j.length,B="",ie="",V="",ae=x.dir,W=x.date,te={crc32:0,compressedSize:0,uncompressedSize:0};v&&!h||(te.crc32=c.crc32,te.compressedSize=c.compressedSize,te.uncompressedSize=c.uncompressedSize);var P=0;v&&(P|=8),k||!R&&!l||(P|=2048);var F=0,Q=0;ae&&(F|=16),u==="UNIX"?(Q=798,F|=function(Z,ue){var ge=Z;return Z||(ge=ue?16893:33204),(65535&ge)<<16}(x.unixPermissions,ae)):(Q=20,F|=function(Z){return 63&(Z||0)}(x.dosPermissions)),E=W.getUTCHours(),E<<=6,E|=W.getUTCMinutes(),E<<=5,E|=W.getUTCSeconds()/2,D=W.getUTCFullYear()-1980,D<<=4,D|=W.getUTCMonth()+1,D<<=5,D|=W.getUTCDate(),R&&(ie=n(1,1)+n(y(K),4)+O,B+="up"+n(ie.length,2)+ie),l&&(V=n(1,1)+n(y(ee),4)+S,B+="uc"+n(V.length,2)+V);var q="";return q+=`
\0`,q+=n(P,2),q+=N.magic,q+=n(E,2),q+=n(D,2),q+=n(te.crc32,4),q+=n(te.compressedSize,4),q+=n(te.uncompressedSize,4),q+=n(K.length,2),q+=n(B.length,2),{fileRecord:C.LOCAL_FILE_HEADER+q+K+B,dirRecord:C.CENTRAL_FILE_HEADER+n(Q,2)+q+n(ee.length,2)+"\0\0\0\0"+n(F,4)+n(_,4)+K+B+ee}}var o=t("../utils"),d=t("../stream/GenericWorker"),g=t("../utf8"),y=t("../crc32"),C=t("../signature");function b(c,v,h,_){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=h,this.encodeFileName=_,this.streamFiles=c,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(b,d),b.prototype.push=function(c){var v=c.meta.percent||0,h=this.entriesCount,_=this._sources.length;this.accumulate?this.contentBuffer.push(c):(this.bytesWritten+=c.data.length,d.prototype.push.call(this,{data:c.data,meta:{currentFile:this.currentFile,percent:h?(v+100*(h-_-1))/h:100}}))},b.prototype.openedSource=function(c){this.currentSourceOffset=this.bytesWritten,this.currentFile=c.file.name;var v=this.streamFiles&&!c.file.dir;if(v){var h=a(c,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:h.fileRecord,meta:{percent:0}})}else this.accumulate=!0},b.prototype.closedSource=function(c){this.accumulate=!1;var v=this.streamFiles&&!c.file.dir,h=a(c,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(h.dirRecord),v)this.push({data:function(_){return C.DATA_DESCRIPTOR+n(_.crc32,4)+n(_.compressedSize,4)+n(_.uncompressedSize,4)}(c),meta:{percent:100}});else for(this.push({data:h.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},b.prototype.flush=function(){for(var c=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var h=this.bytesWritten-c,_=function(u,I,E,D,x){var N=o.transformTo("string",x(D));return C.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(u,2)+n(u,2)+n(I,4)+n(E,4)+n(N.length,2)+N}(this.dirRecords.length,h,c,this.zipComment,this.encodeFileName);this.push({data:_,meta:{percent:100}})},b.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},b.prototype.registerPrevious=function(c){this._sources.push(c);var v=this;return c.on("data",function(h){v.processChunk(h)}),c.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),c.on("error",function(h){v.error(h)}),this},b.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},b.prototype.error=function(c){var v=this._sources;if(!d.prototype.error.call(this,c))return!1;for(var h=0;h<v.length;h++)try{v[h].error(c)}catch{}return!0},b.prototype.lock=function(){d.prototype.lock.call(this);for(var c=this._sources,v=0;v<c.length;v++)c[v].lock()},i.exports=b},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,i,r){var n=t("../compressions"),a=t("./ZipFileWorker");r.generateWorker=function(o,d,g){var y=new a(d.streamFiles,g,d.platform,d.encodeFileName),C=0;try{o.forEach(function(b,c){C++;var v=function(I,E){var D=I||E,x=n[D];if(!x)throw new Error(D+" is not a valid compression method !");return x}(c.options.compression,d.compression),h=c.options.compressionOptions||d.compressionOptions||{},_=c.dir,u=c.date;c._compressWorker(v,h).withStreamInfo("file",{name:b,dir:_,date:u,comment:c.comment||"",unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions}).pipe(y)}),y.entriesCount=C}catch(b){y.error(b)}return y}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,i,r){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new n;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(n.prototype=t("./object")).loadAsync=t("./load"),n.support=t("./support"),n.defaults=t("./defaults"),n.version="3.10.1",n.loadAsync=function(a,o){return new n().loadAsync(a,o)},n.external=t("./external"),i.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,i,r){var n=t("./utils"),a=t("./external"),o=t("./utf8"),d=t("./zipEntries"),g=t("./stream/Crc32Probe"),y=t("./nodejsUtils");function C(b){return new a.Promise(function(c,v){var h=b.decompressed.getContentWorker().pipe(new g);h.on("error",function(_){v(_)}).on("end",function(){h.streamInfo.crc32!==b.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):c()}).resume()})}i.exports=function(b,c){var v=this;return c=n.extend(c||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),y.isNode&&y.isStream(b)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",b,!0,c.optimizedBinaryString,c.base64).then(function(h){var _=new d(c);return _.load(h),_}).then(function(h){var _=[a.Promise.resolve(h)],u=h.files;if(c.checkCRC32)for(var I=0;I<u.length;I++)_.push(C(u[I]));return a.Promise.all(_)}).then(function(h){for(var _=h.shift(),u=_.files,I=0;I<u.length;I++){var E=u[I],D=E.fileNameStr,x=n.resolve(E.fileNameStr);v.file(x,E.decompressed,{binary:!0,optimizedBinaryString:!0,date:E.date,dir:E.dir,comment:E.fileCommentStr.length?E.fileCommentStr:null,unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions,createFolders:c.createFolders}),E.dir||(v.file(x).unsafeOriginalName=D)}return _.zipComment.length&&(v.comment=_.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,i,r){var n=t("../utils"),a=t("../stream/GenericWorker");function o(d,g){a.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(g)}n.inherits(o,a),o.prototype._bindStream=function(d){var g=this;(this._stream=d).pause(),d.on("data",function(y){g.push({data:y,meta:{percent:0}})}).on("error",function(y){g.isPaused?this.generatedError=y:g.error(y)}).on("end",function(){g.isPaused?g._upstreamEnded=!0:g.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,i,r){var n=t("readable-stream").Readable;function a(o,d,g){n.call(this,d),this._helper=o;var y=this;o.on("data",function(C,b){y.push(C)||y._helper.pause(),g&&g(b)}).on("error",function(C){y.emit("error",C)}).on("end",function(){y.push(null)})}t("../utils").inherits(a,n),a.prototype._read=function(){this._helper.resume()},i.exports=a},{"../utils":32,"readable-stream":16}],14:[function(t,i,r){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(n,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,a);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,a)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var a=new Buffer(n);return a.fill(0),a},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(t,i,r){function n(x,N,k){var K,O=o.getTypeOf(N),j=o.extend(k||{},y);j.date=j.date||new Date,j.compression!==null&&(j.compression=j.compression.toUpperCase()),typeof j.unixPermissions=="string"&&(j.unixPermissions=parseInt(j.unixPermissions,8)),j.unixPermissions&&16384&j.unixPermissions&&(j.dir=!0),j.dosPermissions&&16&j.dosPermissions&&(j.dir=!0),j.dir&&(x=u(x)),j.createFolders&&(K=_(x))&&I.call(this,K,!0);var ee=O==="string"&&j.binary===!1&&j.base64===!1;k&&k.binary!==void 0||(j.binary=!ee),(N instanceof C&&N.uncompressedSize===0||j.dir||!N||N.length===0)&&(j.base64=!1,j.binary=!0,N="",j.compression="STORE",O="string");var S=null;S=N instanceof C||N instanceof d?N:v.isNode&&v.isStream(N)?new h(x,N):o.prepareContent(x,N,j.binary,j.optimizedBinaryString,j.base64);var R=new b(x,S,j);this.files[x]=R}var a=t("./utf8"),o=t("./utils"),d=t("./stream/GenericWorker"),g=t("./stream/StreamHelper"),y=t("./defaults"),C=t("./compressedObject"),b=t("./zipObject"),c=t("./generate"),v=t("./nodejsUtils"),h=t("./nodejs/NodejsStreamInputAdapter"),_=function(x){x.slice(-1)==="/"&&(x=x.substring(0,x.length-1));var N=x.lastIndexOf("/");return 0<N?x.substring(0,N):""},u=function(x){return x.slice(-1)!=="/"&&(x+="/"),x},I=function(x,N){return N=N!==void 0?N:y.createFolders,x=u(x),this.files[x]||n.call(this,x,null,{dir:!0,createFolders:N}),this.files[x]};function E(x){return Object.prototype.toString.call(x)==="[object RegExp]"}var D={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(x){var N,k,K;for(N in this.files)K=this.files[N],(k=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&x(k,K)},filter:function(x){var N=[];return this.forEach(function(k,K){x(k,K)&&N.push(K)}),N},file:function(x,N,k){if(arguments.length!==1)return x=this.root+x,n.call(this,x,N,k),this;if(E(x)){var K=x;return this.filter(function(j,ee){return!ee.dir&&K.test(j)})}var O=this.files[this.root+x];return O&&!O.dir?O:null},folder:function(x){if(!x)return this;if(E(x))return this.filter(function(O,j){return j.dir&&x.test(O)});var N=this.root+x,k=I.call(this,N),K=this.clone();return K.root=k.name,K},remove:function(x){x=this.root+x;var N=this.files[x];if(N||(x.slice(-1)!=="/"&&(x+="/"),N=this.files[x]),N&&!N.dir)delete this.files[x];else for(var k=this.filter(function(O,j){return j.name.slice(0,x.length)===x}),K=0;K<k.length;K++)delete this.files[k[K].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(x){var N,k={};try{if((k=o.extend(x||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=k.type.toLowerCase(),k.compression=k.compression.toUpperCase(),k.type==="binarystring"&&(k.type="string"),!k.type)throw new Error("No output type specified.");o.checkSupport(k.type),k.platform!=="darwin"&&k.platform!=="freebsd"&&k.platform!=="linux"&&k.platform!=="sunos"||(k.platform="UNIX"),k.platform==="win32"&&(k.platform="DOS");var K=k.comment||this.comment||"";N=c.generateWorker(this,k,K)}catch(O){(N=new d("error")).error(O)}return new g(N,k.type||"string",k.mimeType)},generateAsync:function(x,N){return this.generateInternalStream(x).accumulate(N)},generateNodeStream:function(x,N){return(x=x||{}).type||(x.type="nodebuffer"),this.generateInternalStream(x).toNodejsStream(N)}};i.exports=D},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,i,r){i.exports=t("stream")},{stream:void 0}],17:[function(t,i,r){var n=t("./DataReader");function a(o){n.call(this,o);for(var d=0;d<this.data.length;d++)o[d]=255&o[d]}t("../utils").inherits(a,n),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var d=o.charCodeAt(0),g=o.charCodeAt(1),y=o.charCodeAt(2),C=o.charCodeAt(3),b=this.length-4;0<=b;--b)if(this.data[b]===d&&this.data[b+1]===g&&this.data[b+2]===y&&this.data[b+3]===C)return b-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var d=o.charCodeAt(0),g=o.charCodeAt(1),y=o.charCodeAt(2),C=o.charCodeAt(3),b=this.readData(4);return d===b[0]&&g===b[1]&&y===b[2]&&C===b[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,d},i.exports=a},{"../utils":32,"./DataReader":18}],18:[function(t,i,r){var n=t("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var d,g=0;for(this.checkOffset(o),d=this.index+o-1;d>=this.index;d--)g=(g<<8)+this.byteAt(d);return this.index+=o,g},readString:function(o){return n.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},i.exports=a},{"../utils":32}],19:[function(t,i,r){var n=t("./Uint8ArrayReader");function a(o){n.call(this,o)}t("../utils").inherits(a,n),a.prototype.readData=function(o){this.checkOffset(o);var d=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,d},i.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,i,r){var n=t("./DataReader");function a(o){n.call(this,o)}t("../utils").inherits(a,n),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var d=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,d},i.exports=a},{"../utils":32,"./DataReader":18}],21:[function(t,i,r){var n=t("./ArrayReader");function a(o){n.call(this,o)}t("../utils").inherits(a,n),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,d},i.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(t,i,r){var n=t("../utils"),a=t("../support"),o=t("./ArrayReader"),d=t("./StringReader"),g=t("./NodeBufferReader"),y=t("./Uint8ArrayReader");i.exports=function(C){var b=n.getTypeOf(C);return n.checkSupport(b),b!=="string"||a.uint8array?b==="nodebuffer"?new g(C):a.uint8array?new y(n.transformTo("uint8array",C)):new o(n.transformTo("array",C)):new d(C)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,i,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,i,r){var n=t("./GenericWorker"),a=t("../utils");function o(d){n.call(this,"ConvertWorker to "+d),this.destType=d}a.inherits(o,n),o.prototype.processChunk=function(d){this.push({data:a.transformTo(this.destType,d.data),meta:d.meta})},i.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,i,r){var n=t("./GenericWorker"),a=t("../crc32");function o(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,n),o.prototype.processChunk=function(d){this.streamInfo.crc32=a(d.data,this.streamInfo.crc32||0),this.push(d)},i.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,i,r){var n=t("../utils"),a=t("./GenericWorker");function o(d){a.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}n.inherits(o,a),o.prototype.processChunk=function(d){if(d){var g=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=g+d.data.length}a.prototype.processChunk.call(this,d)},i.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,i,r){var n=t("../utils"),a=t("./GenericWorker");function o(d){a.call(this,"DataWorker");var g=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(y){g.dataIsReady=!0,g.data=y,g.max=y&&y.length||0,g.type=n.getTypeOf(y),g.isPaused||g._tickAndRepeat()},function(y){g.error(y)})}n.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,g=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,g);break;case"uint8array":d=this.data.subarray(this.index,g);break;case"array":case"nodebuffer":d=this.data.slice(this.index,g)}return this.index=g,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,i,r){function n(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var d=0;d<this._listeners[a].length;d++)this._listeners[a][d].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(d){o.processChunk(d)}),a.on("end",function(){o.end()}),a.on("error",function(d){o.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},i.exports=n},{}],29:[function(t,i,r){var n=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),d=t("../base64"),g=t("../support"),y=t("../external"),C=null;if(g.nodestream)try{C=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function b(v,h){return new y.Promise(function(_,u){var I=[],E=v._internalType,D=v._outputType,x=v._mimeType;v.on("data",function(N,k){I.push(N),h&&h(k)}).on("error",function(N){I=[],u(N)}).on("end",function(){try{var N=function(k,K,O){switch(k){case"blob":return n.newBlob(n.transformTo("arraybuffer",K),O);case"base64":return d.encode(K);default:return n.transformTo(k,K)}}(D,function(k,K){var O,j=0,ee=null,S=0;for(O=0;O<K.length;O++)S+=K[O].length;switch(k){case"string":return K.join("");case"array":return Array.prototype.concat.apply([],K);case"uint8array":for(ee=new Uint8Array(S),O=0;O<K.length;O++)ee.set(K[O],j),j+=K[O].length;return ee;case"nodebuffer":return Buffer.concat(K);default:throw new Error("concat : unsupported type '"+k+"'")}}(E,I),x);_(N)}catch(k){u(k)}I=[]}).resume()})}function c(v,h,_){var u=h;switch(h){case"blob":case"arraybuffer":u="uint8array";break;case"base64":u="string"}try{this._internalType=u,this._outputType=h,this._mimeType=_,n.checkSupport(u),this._worker=v.pipe(new a(u)),v.lock()}catch(I){this._worker=new o("error"),this._worker.error(I)}}c.prototype={accumulate:function(v){return b(this,v)},on:function(v,h){var _=this;return v==="data"?this._worker.on(v,function(u){h.call(_,u.data,u.meta)}):this._worker.on(v,function(){n.delay(h,arguments,_)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new C(this,{objectMode:this._outputType!=="nodebuffer"},v)}},i.exports=c},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,i,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",r.nodebuffer=typeof Buffer<"u",r.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")r.blob=!1;else{var n=new ArrayBuffer(0);try{r.blob=new Blob([n],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(n),r.blob=a.getBlob("application/zip").size===0}catch{r.blob=!1}}}try{r.nodestream=!!t("readable-stream").Readable}catch{r.nodestream=!1}},{"readable-stream":16}],31:[function(t,i,r){for(var n=t("./utils"),a=t("./support"),o=t("./nodejsUtils"),d=t("./stream/GenericWorker"),g=new Array(256),y=0;y<256;y++)g[y]=252<=y?6:248<=y?5:240<=y?4:224<=y?3:192<=y?2:1;g[254]=g[254]=1;function C(){d.call(this,"utf-8 decode"),this.leftOver=null}function b(){d.call(this,"utf-8 encode")}r.utf8encode=function(c){return a.nodebuffer?o.newBufferFrom(c,"utf-8"):function(v){var h,_,u,I,E,D=v.length,x=0;for(I=0;I<D;I++)(64512&(_=v.charCodeAt(I)))==55296&&I+1<D&&(64512&(u=v.charCodeAt(I+1)))==56320&&(_=65536+(_-55296<<10)+(u-56320),I++),x+=_<128?1:_<2048?2:_<65536?3:4;for(h=a.uint8array?new Uint8Array(x):new Array(x),I=E=0;E<x;I++)(64512&(_=v.charCodeAt(I)))==55296&&I+1<D&&(64512&(u=v.charCodeAt(I+1)))==56320&&(_=65536+(_-55296<<10)+(u-56320),I++),_<128?h[E++]=_:(_<2048?h[E++]=192|_>>>6:(_<65536?h[E++]=224|_>>>12:(h[E++]=240|_>>>18,h[E++]=128|_>>>12&63),h[E++]=128|_>>>6&63),h[E++]=128|63&_);return h}(c)},r.utf8decode=function(c){return a.nodebuffer?n.transformTo("nodebuffer",c).toString("utf-8"):function(v){var h,_,u,I,E=v.length,D=new Array(2*E);for(h=_=0;h<E;)if((u=v[h++])<128)D[_++]=u;else if(4<(I=g[u]))D[_++]=65533,h+=I-1;else{for(u&=I===2?31:I===3?15:7;1<I&&h<E;)u=u<<6|63&v[h++],I--;1<I?D[_++]=65533:u<65536?D[_++]=u:(u-=65536,D[_++]=55296|u>>10&1023,D[_++]=56320|1023&u)}return D.length!==_&&(D.subarray?D=D.subarray(0,_):D.length=_),n.applyFromCharCode(D)}(c=n.transformTo(a.uint8array?"uint8array":"array",c))},n.inherits(C,d),C.prototype.processChunk=function(c){var v=n.transformTo(a.uint8array?"uint8array":"array",c.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var h=v;(v=new Uint8Array(h.length+this.leftOver.length)).set(this.leftOver,0),v.set(h,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var _=function(I,E){var D;for((E=E||I.length)>I.length&&(E=I.length),D=E-1;0<=D&&(192&I[D])==128;)D--;return D<0||D===0?E:D+g[I[D]]>E?D:E}(v),u=v;_!==v.length&&(a.uint8array?(u=v.subarray(0,_),this.leftOver=v.subarray(_,v.length)):(u=v.slice(0,_),this.leftOver=v.slice(_,v.length))),this.push({data:r.utf8decode(u),meta:c.meta})},C.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=C,n.inherits(b,d),b.prototype.processChunk=function(c){this.push({data:r.utf8encode(c.data),meta:c.meta})},r.Utf8EncodeWorker=b},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,i,r){var n=t("./support"),a=t("./base64"),o=t("./nodejsUtils"),d=t("./external");function g(h){return h}function y(h,_){for(var u=0;u<h.length;++u)_[u]=255&h.charCodeAt(u);return _}t("setimmediate"),r.newBlob=function(h,_){r.checkSupport("blob");try{return new Blob([h],{type:_})}catch{try{var u=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return u.append(h),u.getBlob(_)}catch{throw new Error("Bug : can't construct the Blob.")}}};var C={stringifyByChunk:function(h,_,u){var I=[],E=0,D=h.length;if(D<=u)return String.fromCharCode.apply(null,h);for(;E<D;)_==="array"||_==="nodebuffer"?I.push(String.fromCharCode.apply(null,h.slice(E,Math.min(E+u,D)))):I.push(String.fromCharCode.apply(null,h.subarray(E,Math.min(E+u,D)))),E+=u;return I.join("")},stringifyByChar:function(h){for(var _="",u=0;u<h.length;u++)_+=String.fromCharCode(h[u]);return _},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function b(h){var _=65536,u=r.getTypeOf(h),I=!0;if(u==="uint8array"?I=C.applyCanBeUsed.uint8array:u==="nodebuffer"&&(I=C.applyCanBeUsed.nodebuffer),I)for(;1<_;)try{return C.stringifyByChunk(h,u,_)}catch{_=Math.floor(_/2)}return C.stringifyByChar(h)}function c(h,_){for(var u=0;u<h.length;u++)_[u]=h[u];return _}r.applyFromCharCode=b;var v={};v.string={string:g,array:function(h){return y(h,new Array(h.length))},arraybuffer:function(h){return v.string.uint8array(h).buffer},uint8array:function(h){return y(h,new Uint8Array(h.length))},nodebuffer:function(h){return y(h,o.allocBuffer(h.length))}},v.array={string:b,array:g,arraybuffer:function(h){return new Uint8Array(h).buffer},uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return o.newBufferFrom(h)}},v.arraybuffer={string:function(h){return b(new Uint8Array(h))},array:function(h){return c(new Uint8Array(h),new Array(h.byteLength))},arraybuffer:g,uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return o.newBufferFrom(new Uint8Array(h))}},v.uint8array={string:b,array:function(h){return c(h,new Array(h.length))},arraybuffer:function(h){return h.buffer},uint8array:g,nodebuffer:function(h){return o.newBufferFrom(h)}},v.nodebuffer={string:b,array:function(h){return c(h,new Array(h.length))},arraybuffer:function(h){return v.nodebuffer.uint8array(h).buffer},uint8array:function(h){return c(h,new Uint8Array(h.length))},nodebuffer:g},r.transformTo=function(h,_){if(_=_||"",!h)return _;r.checkSupport(h);var u=r.getTypeOf(_);return v[u][h](_)},r.resolve=function(h){for(var _=h.split("/"),u=[],I=0;I<_.length;I++){var E=_[I];E==="."||E===""&&I!==0&&I!==_.length-1||(E===".."?u.pop():u.push(E))}return u.join("/")},r.getTypeOf=function(h){return typeof h=="string"?"string":Object.prototype.toString.call(h)==="[object Array]"?"array":n.nodebuffer&&o.isBuffer(h)?"nodebuffer":n.uint8array&&h instanceof Uint8Array?"uint8array":n.arraybuffer&&h instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(h){if(!n[h.toLowerCase()])throw new Error(h+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(h){var _,u,I="";for(u=0;u<(h||"").length;u++)I+="\\x"+((_=h.charCodeAt(u))<16?"0":"")+_.toString(16).toUpperCase();return I},r.delay=function(h,_,u){setImmediate(function(){h.apply(u||null,_||[])})},r.inherits=function(h,_){function u(){}u.prototype=_.prototype,h.prototype=new u},r.extend=function(){var h,_,u={};for(h=0;h<arguments.length;h++)for(_ in arguments[h])Object.prototype.hasOwnProperty.call(arguments[h],_)&&u[_]===void 0&&(u[_]=arguments[h][_]);return u},r.prepareContent=function(h,_,u,I,E){return d.Promise.resolve(_).then(function(D){return n.blob&&(D instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(D))!==-1)&&typeof FileReader<"u"?new d.Promise(function(x,N){var k=new FileReader;k.onload=function(K){x(K.target.result)},k.onerror=function(K){N(K.target.error)},k.readAsArrayBuffer(D)}):D}).then(function(D){var x=r.getTypeOf(D);return x?(x==="arraybuffer"?D=r.transformTo("uint8array",D):x==="string"&&(E?D=a.decode(D):u&&I!==!0&&(D=function(N){return y(N,n.uint8array?new Uint8Array(N.length):new Array(N.length))}(D))),D):d.Promise.reject(new Error("Can't read the data of '"+h+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,i,r){var n=t("./reader/readerFor"),a=t("./utils"),o=t("./signature"),d=t("./zipEntry"),g=t("./support");function y(C){this.files=[],this.loadOptions=C}y.prototype={checkSignature:function(C){if(!this.reader.readAndCheckSignature(C)){this.reader.index-=4;var b=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(b)+", expected "+a.pretty(C)+")")}},isSignature:function(C,b){var c=this.reader.index;this.reader.setIndex(C);var v=this.reader.readString(4)===b;return this.reader.setIndex(c),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var C=this.reader.readData(this.zipCommentLength),b=g.uint8array?"uint8array":"array",c=a.transformTo(b,C);this.zipComment=this.loadOptions.decodeFileName(c)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var C,b,c,v=this.zip64EndOfCentralSize-44;0<v;)C=this.reader.readInt(2),b=this.reader.readInt(4),c=this.reader.readData(b),this.zip64ExtensibleData[C]={id:C,length:b,value:c}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var C,b;for(C=0;C<this.files.length;C++)b=this.files[C],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var C;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(C=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(C);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var C=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(C<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(C);var b=C;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(C=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(C),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var c=this.centralDirOffset+this.centralDirSize;this.zip64&&(c+=20,c+=12+this.zip64EndOfCentralSize);var v=b-c;if(0<v)this.isSignature(b,o.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(C){this.reader=n(C)},load:function(C){this.prepareReader(C),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=y},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,i,r){var n=t("./reader/readerFor"),a=t("./utils"),o=t("./compressedObject"),d=t("./crc32"),g=t("./utf8"),y=t("./compressions"),C=t("./support");function b(c,v){this.options=c,this.loadOptions=v}b.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(c){var v,h;if(c.skip(22),this.fileNameLength=c.readInt(2),h=c.readInt(2),this.fileName=c.readData(this.fileNameLength),c.skip(h),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=function(_){for(var u in y)if(Object.prototype.hasOwnProperty.call(y,u)&&y[u].magic===_)return y[u];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,v,c.readData(this.compressedSize))},readCentralPart:function(c){this.versionMadeBy=c.readInt(2),c.skip(2),this.bitFlag=c.readInt(2),this.compressionMethod=c.readString(2),this.date=c.readDate(),this.crc32=c.readInt(4),this.compressedSize=c.readInt(4),this.uncompressedSize=c.readInt(4);var v=c.readInt(2);if(this.extraFieldsLength=c.readInt(2),this.fileCommentLength=c.readInt(2),this.diskNumberStart=c.readInt(2),this.internalFileAttributes=c.readInt(2),this.externalFileAttributes=c.readInt(4),this.localHeaderOffset=c.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");c.skip(v),this.readExtraFields(c),this.parseZIP64ExtraField(c),this.fileComment=c.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var c=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),c==0&&(this.dosPermissions=63&this.externalFileAttributes),c==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var c=n(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=c.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=c.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=c.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=c.readInt(4))}},readExtraFields:function(c){var v,h,_,u=c.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});c.index+4<u;)v=c.readInt(2),h=c.readInt(2),_=c.readData(h),this.extraFields[v]={id:v,length:h,value:_};c.setIndex(u)},handleUTF8:function(){var c=C.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=g.utf8decode(this.fileName),this.fileCommentStr=g.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var h=a.transformTo(c,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(h)}var _=this.findExtraFieldUnicodeComment();if(_!==null)this.fileCommentStr=_;else{var u=a.transformTo(c,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(u)}}},findExtraFieldUnicodePath:function(){var c=this.extraFields[28789];if(c){var v=n(c.value);return v.readInt(1)!==1||d(this.fileName)!==v.readInt(4)?null:g.utf8decode(v.readData(c.length-5))}return null},findExtraFieldUnicodeComment:function(){var c=this.extraFields[25461];if(c){var v=n(c.value);return v.readInt(1)!==1||d(this.fileComment)!==v.readInt(4)?null:g.utf8decode(v.readData(c.length-5))}return null}},i.exports=b},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,i,r){function n(v,h,_){this.name=v,this.dir=_.dir,this.date=_.date,this.comment=_.comment,this.unixPermissions=_.unixPermissions,this.dosPermissions=_.dosPermissions,this._data=h,this._dataBinary=_.binary,this.options={compression:_.compression,compressionOptions:_.compressionOptions}}var a=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),d=t("./utf8"),g=t("./compressedObject"),y=t("./stream/GenericWorker");n.prototype={internalStream:function(v){var h=null,_="string";try{if(!v)throw new Error("No output type specified.");var u=(_=v.toLowerCase())==="string"||_==="text";_!=="binarystring"&&_!=="text"||(_="string"),h=this._decompressWorker();var I=!this._dataBinary;I&&!u&&(h=h.pipe(new d.Utf8EncodeWorker)),!I&&u&&(h=h.pipe(new d.Utf8DecodeWorker))}catch(E){(h=new y("error")).error(E)}return new a(h,_,"")},async:function(v,h){return this.internalStream(v).accumulate(h)},nodeStream:function(v,h){return this.internalStream(v||"nodebuffer").toNodejsStream(h)},_compressWorker:function(v,h){if(this._data instanceof g&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var _=this._decompressWorker();return this._dataBinary||(_=_.pipe(new d.Utf8EncodeWorker)),g.createWorkerFrom(_,v,h)},_decompressWorker:function(){return this._data instanceof g?this._data.getContentWorker():this._data instanceof y?this._data:new o(this._data)}};for(var C=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],b=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},c=0;c<C.length;c++)n.prototype[C[c]]=b;i.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,i,r){(function(n){var a,o,d=n.MutationObserver||n.WebKitMutationObserver;if(d){var g=0,y=new d(v),C=n.document.createTextNode("");y.observe(C,{characterData:!0}),a=function(){C.data=g=++g%2}}else if(n.setImmediate||n.MessageChannel===void 0)a="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var h=n.document.createElement("script");h.onreadystatechange=function(){v(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},n.document.documentElement.appendChild(h)}:function(){setTimeout(v,0)};else{var b=new n.MessageChannel;b.port1.onmessage=v,a=function(){b.port2.postMessage(0)}}var c=[];function v(){var h,_;o=!0;for(var u=c.length;u;){for(_=c,c=[],h=-1;++h<u;)_[h]();u=c.length}o=!1}i.exports=function(h){c.push(h)!==1||o||a()}}).call(this,typeof Je<"u"?Je:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,i,r){var n=t("immediate");function a(){}var o={},d=["REJECTED"],g=["FULFILLED"],y=["PENDING"];function C(u){if(typeof u!="function")throw new TypeError("resolver must be a function");this.state=y,this.queue=[],this.outcome=void 0,u!==a&&h(this,u)}function b(u,I,E){this.promise=u,typeof I=="function"&&(this.onFulfilled=I,this.callFulfilled=this.otherCallFulfilled),typeof E=="function"&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}function c(u,I,E){n(function(){var D;try{D=I(E)}catch(x){return o.reject(u,x)}D===u?o.reject(u,new TypeError("Cannot resolve promise with itself")):o.resolve(u,D)})}function v(u){var I=u&&u.then;if(u&&(typeof u=="object"||typeof u=="function")&&typeof I=="function")return function(){I.apply(u,arguments)}}function h(u,I){var E=!1;function D(k){E||(E=!0,o.reject(u,k))}function x(k){E||(E=!0,o.resolve(u,k))}var N=_(function(){I(x,D)});N.status==="error"&&D(N.value)}function _(u,I){var E={};try{E.value=u(I),E.status="success"}catch(D){E.status="error",E.value=D}return E}(i.exports=C).prototype.finally=function(u){if(typeof u!="function")return this;var I=this.constructor;return this.then(function(E){return I.resolve(u()).then(function(){return E})},function(E){return I.resolve(u()).then(function(){throw E})})},C.prototype.catch=function(u){return this.then(null,u)},C.prototype.then=function(u,I){if(typeof u!="function"&&this.state===g||typeof I!="function"&&this.state===d)return this;var E=new this.constructor(a);return this.state!==y?c(E,this.state===g?u:I,this.outcome):this.queue.push(new b(E,u,I)),E},b.prototype.callFulfilled=function(u){o.resolve(this.promise,u)},b.prototype.otherCallFulfilled=function(u){c(this.promise,this.onFulfilled,u)},b.prototype.callRejected=function(u){o.reject(this.promise,u)},b.prototype.otherCallRejected=function(u){c(this.promise,this.onRejected,u)},o.resolve=function(u,I){var E=_(v,I);if(E.status==="error")return o.reject(u,E.value);var D=E.value;if(D)h(u,D);else{u.state=g,u.outcome=I;for(var x=-1,N=u.queue.length;++x<N;)u.queue[x].callFulfilled(I)}return u},o.reject=function(u,I){u.state=d,u.outcome=I;for(var E=-1,D=u.queue.length;++E<D;)u.queue[E].callRejected(I);return u},C.resolve=function(u){return u instanceof this?u:o.resolve(new this(a),u)},C.reject=function(u){var I=new this(a);return o.reject(I,u)},C.all=function(u){var I=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=u.length,D=!1;if(!E)return this.resolve([]);for(var x=new Array(E),N=0,k=-1,K=new this(a);++k<E;)O(u[k],k);return K;function O(j,ee){I.resolve(j).then(function(S){x[ee]=S,++N!==E||D||(D=!0,o.resolve(K,x))},function(S){D||(D=!0,o.reject(K,S))})}},C.race=function(u){var I=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=u.length,D=!1;if(!E)return this.resolve([]);for(var x=-1,N=new this(a);++x<E;)k=u[x],I.resolve(k).then(function(K){D||(D=!0,o.resolve(N,K))},function(K){D||(D=!0,o.reject(N,K))});var k;return N}},{immediate:36}],38:[function(t,i,r){var n={};(0,t("./lib/utils/common").assign)(n,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),i.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,i,r){var n=t("./zlib/deflate"),a=t("./utils/common"),o=t("./utils/strings"),d=t("./zlib/messages"),g=t("./zlib/zstream"),y=Object.prototype.toString,C=0,b=-1,c=0,v=8;function h(u){if(!(this instanceof h))return new h(u);this.options=a.assign({level:b,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:""},u||{});var I=this.options;I.raw&&0<I.windowBits?I.windowBits=-I.windowBits:I.gzip&&0<I.windowBits&&I.windowBits<16&&(I.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var E=n.deflateInit2(this.strm,I.level,I.method,I.windowBits,I.memLevel,I.strategy);if(E!==C)throw new Error(d[E]);if(I.header&&n.deflateSetHeader(this.strm,I.header),I.dictionary){var D;if(D=typeof I.dictionary=="string"?o.string2buf(I.dictionary):y.call(I.dictionary)==="[object ArrayBuffer]"?new Uint8Array(I.dictionary):I.dictionary,(E=n.deflateSetDictionary(this.strm,D))!==C)throw new Error(d[E]);this._dict_set=!0}}function _(u,I){var E=new h(I);if(E.push(u,!0),E.err)throw E.msg||d[E.err];return E.result}h.prototype.push=function(u,I){var E,D,x=this.strm,N=this.options.chunkSize;if(this.ended)return!1;D=I===~~I?I:I===!0?4:0,typeof u=="string"?x.input=o.string2buf(u):y.call(u)==="[object ArrayBuffer]"?x.input=new Uint8Array(u):x.input=u,x.next_in=0,x.avail_in=x.input.length;do{if(x.avail_out===0&&(x.output=new a.Buf8(N),x.next_out=0,x.avail_out=N),(E=n.deflate(x,D))!==1&&E!==C)return this.onEnd(E),!(this.ended=!0);x.avail_out!==0&&(x.avail_in!==0||D!==4&&D!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(x.output,x.next_out))):this.onData(a.shrinkBuf(x.output,x.next_out)))}while((0<x.avail_in||x.avail_out===0)&&E!==1);return D===4?(E=n.deflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===C):D!==2||(this.onEnd(C),!(x.avail_out=0))},h.prototype.onData=function(u){this.chunks.push(u)},h.prototype.onEnd=function(u){u===C&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=u,this.msg=this.strm.msg},r.Deflate=h,r.deflate=_,r.deflateRaw=function(u,I){return(I=I||{}).raw=!0,_(u,I)},r.gzip=function(u,I){return(I=I||{}).gzip=!0,_(u,I)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,i,r){var n=t("./zlib/inflate"),a=t("./utils/common"),o=t("./utils/strings"),d=t("./zlib/constants"),g=t("./zlib/messages"),y=t("./zlib/zstream"),C=t("./zlib/gzheader"),b=Object.prototype.toString;function c(h){if(!(this instanceof c))return new c(h);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},h||{});var _=this.options;_.raw&&0<=_.windowBits&&_.windowBits<16&&(_.windowBits=-_.windowBits,_.windowBits===0&&(_.windowBits=-15)),!(0<=_.windowBits&&_.windowBits<16)||h&&h.windowBits||(_.windowBits+=32),15<_.windowBits&&_.windowBits<48&&!(15&_.windowBits)&&(_.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var u=n.inflateInit2(this.strm,_.windowBits);if(u!==d.Z_OK)throw new Error(g[u]);this.header=new C,n.inflateGetHeader(this.strm,this.header)}function v(h,_){var u=new c(_);if(u.push(h,!0),u.err)throw u.msg||g[u.err];return u.result}c.prototype.push=function(h,_){var u,I,E,D,x,N,k=this.strm,K=this.options.chunkSize,O=this.options.dictionary,j=!1;if(this.ended)return!1;I=_===~~_?_:_===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof h=="string"?k.input=o.binstring2buf(h):b.call(h)==="[object ArrayBuffer]"?k.input=new Uint8Array(h):k.input=h,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new a.Buf8(K),k.next_out=0,k.avail_out=K),(u=n.inflate(k,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&O&&(N=typeof O=="string"?o.string2buf(O):b.call(O)==="[object ArrayBuffer]"?new Uint8Array(O):O,u=n.inflateSetDictionary(this.strm,N)),u===d.Z_BUF_ERROR&&j===!0&&(u=d.Z_OK,j=!1),u!==d.Z_STREAM_END&&u!==d.Z_OK)return this.onEnd(u),!(this.ended=!0);k.next_out&&(k.avail_out!==0&&u!==d.Z_STREAM_END&&(k.avail_in!==0||I!==d.Z_FINISH&&I!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(E=o.utf8border(k.output,k.next_out),D=k.next_out-E,x=o.buf2string(k.output,E),k.next_out=D,k.avail_out=K-D,D&&a.arraySet(k.output,k.output,E,D,0),this.onData(x)):this.onData(a.shrinkBuf(k.output,k.next_out)))),k.avail_in===0&&k.avail_out===0&&(j=!0)}while((0<k.avail_in||k.avail_out===0)&&u!==d.Z_STREAM_END);return u===d.Z_STREAM_END&&(I=d.Z_FINISH),I===d.Z_FINISH?(u=n.inflateEnd(this.strm),this.onEnd(u),this.ended=!0,u===d.Z_OK):I!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(k.avail_out=0))},c.prototype.onData=function(h){this.chunks.push(h)},c.prototype.onEnd=function(h){h===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg},r.Inflate=c,r.inflate=v,r.inflateRaw=function(h,_){return(_=_||{}).raw=!0,v(h,_)},r.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,i,r){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";r.assign=function(d){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var y=g.shift();if(y){if(typeof y!="object")throw new TypeError(y+"must be non-object");for(var C in y)y.hasOwnProperty(C)&&(d[C]=y[C])}}return d},r.shrinkBuf=function(d,g){return d.length===g?d:d.subarray?d.subarray(0,g):(d.length=g,d)};var a={arraySet:function(d,g,y,C,b){if(g.subarray&&d.subarray)d.set(g.subarray(y,y+C),b);else for(var c=0;c<C;c++)d[b+c]=g[y+c]},flattenChunks:function(d){var g,y,C,b,c,v;for(g=C=0,y=d.length;g<y;g++)C+=d[g].length;for(v=new Uint8Array(C),g=b=0,y=d.length;g<y;g++)c=d[g],v.set(c,b),b+=c.length;return v}},o={arraySet:function(d,g,y,C,b){for(var c=0;c<C;c++)d[b+c]=g[y+c]},flattenChunks:function(d){return[].concat.apply([],d)}};r.setTyped=function(d){d?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,a)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,o))},r.setTyped(n)},{}],42:[function(t,i,r){var n=t("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var d=new n.Buf8(256),g=0;g<256;g++)d[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;function y(C,b){if(b<65537&&(C.subarray&&o||!C.subarray&&a))return String.fromCharCode.apply(null,n.shrinkBuf(C,b));for(var c="",v=0;v<b;v++)c+=String.fromCharCode(C[v]);return c}d[254]=d[254]=1,r.string2buf=function(C){var b,c,v,h,_,u=C.length,I=0;for(h=0;h<u;h++)(64512&(c=C.charCodeAt(h)))==55296&&h+1<u&&(64512&(v=C.charCodeAt(h+1)))==56320&&(c=65536+(c-55296<<10)+(v-56320),h++),I+=c<128?1:c<2048?2:c<65536?3:4;for(b=new n.Buf8(I),h=_=0;_<I;h++)(64512&(c=C.charCodeAt(h)))==55296&&h+1<u&&(64512&(v=C.charCodeAt(h+1)))==56320&&(c=65536+(c-55296<<10)+(v-56320),h++),c<128?b[_++]=c:(c<2048?b[_++]=192|c>>>6:(c<65536?b[_++]=224|c>>>12:(b[_++]=240|c>>>18,b[_++]=128|c>>>12&63),b[_++]=128|c>>>6&63),b[_++]=128|63&c);return b},r.buf2binstring=function(C){return y(C,C.length)},r.binstring2buf=function(C){for(var b=new n.Buf8(C.length),c=0,v=b.length;c<v;c++)b[c]=C.charCodeAt(c);return b},r.buf2string=function(C,b){var c,v,h,_,u=b||C.length,I=new Array(2*u);for(c=v=0;c<u;)if((h=C[c++])<128)I[v++]=h;else if(4<(_=d[h]))I[v++]=65533,c+=_-1;else{for(h&=_===2?31:_===3?15:7;1<_&&c<u;)h=h<<6|63&C[c++],_--;1<_?I[v++]=65533:h<65536?I[v++]=h:(h-=65536,I[v++]=55296|h>>10&1023,I[v++]=56320|1023&h)}return y(I,v)},r.utf8border=function(C,b){var c;for((b=b||C.length)>C.length&&(b=C.length),c=b-1;0<=c&&(192&C[c])==128;)c--;return c<0||c===0?b:c+d[C[c]]>b?c:b}},{"./common":41}],43:[function(t,i,r){i.exports=function(n,a,o,d){for(var g=65535&n|0,y=n>>>16&65535|0,C=0;o!==0;){for(o-=C=2e3<o?2e3:o;y=y+(g=g+a[d++]|0)|0,--C;);g%=65521,y%=65521}return g|y<<16|0}},{}],44:[function(t,i,r){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,i,r){var n=function(){for(var a,o=[],d=0;d<256;d++){a=d;for(var g=0;g<8;g++)a=1&a?3988292384^a>>>1:a>>>1;o[d]=a}return o}();i.exports=function(a,o,d,g){var y=n,C=g+d;a^=-1;for(var b=g;b<C;b++)a=a>>>8^y[255&(a^o[b])];return-1^a}},{}],46:[function(t,i,r){var n,a=t("../utils/common"),o=t("./trees"),d=t("./adler32"),g=t("./crc32"),y=t("./messages"),C=0,b=4,c=0,v=-2,h=-1,_=4,u=2,I=8,E=9,D=286,x=30,N=19,k=2*D+1,K=15,O=3,j=258,ee=j+O+1,S=42,R=113,l=1,B=2,ie=3,V=4;function ae(s,L){return s.msg=y[L],L}function W(s){return(s<<1)-(4<s?9:0)}function te(s){for(var L=s.length;0<=--L;)s[L]=0}function P(s){var L=s.state,T=L.pending;T>s.avail_out&&(T=s.avail_out),T!==0&&(a.arraySet(s.output,L.pending_buf,L.pending_out,T,s.next_out),s.next_out+=T,L.pending_out+=T,s.total_out+=T,s.avail_out-=T,L.pending-=T,L.pending===0&&(L.pending_out=0))}function F(s,L){o._tr_flush_block(s,0<=s.block_start?s.block_start:-1,s.strstart-s.block_start,L),s.block_start=s.strstart,P(s.strm)}function Q(s,L){s.pending_buf[s.pending++]=L}function q(s,L){s.pending_buf[s.pending++]=L>>>8&255,s.pending_buf[s.pending++]=255&L}function Z(s,L){var T,f,p=s.max_chain_length,w=s.strstart,U=s.prev_length,$=s.nice_match,M=s.strstart>s.w_size-ee?s.strstart-(s.w_size-ee):0,G=s.window,X=s.w_mask,H=s.prev,J=s.strstart+j,he=G[w+U-1],oe=G[w+U];s.prev_length>=s.good_match&&(p>>=2),$>s.lookahead&&($=s.lookahead);do if(G[(T=L)+U]===oe&&G[T+U-1]===he&&G[T]===G[w]&&G[++T]===G[w+1]){w+=2,T++;do;while(G[++w]===G[++T]&&G[++w]===G[++T]&&G[++w]===G[++T]&&G[++w]===G[++T]&&G[++w]===G[++T]&&G[++w]===G[++T]&&G[++w]===G[++T]&&G[++w]===G[++T]&&w<J);if(f=j-(J-w),w=J-j,U<f){if(s.match_start=L,$<=(U=f))break;he=G[w+U-1],oe=G[w+U]}}while((L=H[L&X])>M&&--p!=0);return U<=s.lookahead?U:s.lookahead}function ue(s){var L,T,f,p,w,U,$,M,G,X,H=s.w_size;do{if(p=s.window_size-s.lookahead-s.strstart,s.strstart>=H+(H-ee)){for(a.arraySet(s.window,s.window,H,H,0),s.match_start-=H,s.strstart-=H,s.block_start-=H,L=T=s.hash_size;f=s.head[--L],s.head[L]=H<=f?f-H:0,--T;);for(L=T=H;f=s.prev[--L],s.prev[L]=H<=f?f-H:0,--T;);p+=H}if(s.strm.avail_in===0)break;if(U=s.strm,$=s.window,M=s.strstart+s.lookahead,G=p,X=void 0,X=U.avail_in,G<X&&(X=G),T=X===0?0:(U.avail_in-=X,a.arraySet($,U.input,U.next_in,X,M),U.state.wrap===1?U.adler=d(U.adler,$,X,M):U.state.wrap===2&&(U.adler=g(U.adler,$,X,M)),U.next_in+=X,U.total_in+=X,X),s.lookahead+=T,s.lookahead+s.insert>=O)for(w=s.strstart-s.insert,s.ins_h=s.window[w],s.ins_h=(s.ins_h<<s.hash_shift^s.window[w+1])&s.hash_mask;s.insert&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[w+O-1])&s.hash_mask,s.prev[w&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=w,w++,s.insert--,!(s.lookahead+s.insert<O)););}while(s.lookahead<ee&&s.strm.avail_in!==0)}function ge(s,L){for(var T,f;;){if(s.lookahead<ee){if(ue(s),s.lookahead<ee&&L===C)return l;if(s.lookahead===0)break}if(T=0,s.lookahead>=O&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+O-1])&s.hash_mask,T=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),T!==0&&s.strstart-T<=s.w_size-ee&&(s.match_length=Z(s,T)),s.match_length>=O)if(f=o._tr_tally(s,s.strstart-s.match_start,s.match_length-O),s.lookahead-=s.match_length,s.match_length<=s.max_lazy_match&&s.lookahead>=O){for(s.match_length--;s.strstart++,s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+O-1])&s.hash_mask,T=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart,--s.match_length!=0;);s.strstart++}else s.strstart+=s.match_length,s.match_length=0,s.ins_h=s.window[s.strstart],s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+1])&s.hash_mask;else f=o._tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++;if(f&&(F(s,!1),s.strm.avail_out===0))return l}return s.insert=s.strstart<O-1?s.strstart:O-1,L===b?(F(s,!0),s.strm.avail_out===0?ie:V):s.last_lit&&(F(s,!1),s.strm.avail_out===0)?l:B}function se(s,L){for(var T,f,p;;){if(s.lookahead<ee){if(ue(s),s.lookahead<ee&&L===C)return l;if(s.lookahead===0)break}if(T=0,s.lookahead>=O&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+O-1])&s.hash_mask,T=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),s.prev_length=s.match_length,s.prev_match=s.match_start,s.match_length=O-1,T!==0&&s.prev_length<s.max_lazy_match&&s.strstart-T<=s.w_size-ee&&(s.match_length=Z(s,T),s.match_length<=5&&(s.strategy===1||s.match_length===O&&4096<s.strstart-s.match_start)&&(s.match_length=O-1)),s.prev_length>=O&&s.match_length<=s.prev_length){for(p=s.strstart+s.lookahead-O,f=o._tr_tally(s,s.strstart-1-s.prev_match,s.prev_length-O),s.lookahead-=s.prev_length-1,s.prev_length-=2;++s.strstart<=p&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+O-1])&s.hash_mask,T=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),--s.prev_length!=0;);if(s.match_available=0,s.match_length=O-1,s.strstart++,f&&(F(s,!1),s.strm.avail_out===0))return l}else if(s.match_available){if((f=o._tr_tally(s,0,s.window[s.strstart-1]))&&F(s,!1),s.strstart++,s.lookahead--,s.strm.avail_out===0)return l}else s.match_available=1,s.strstart++,s.lookahead--}return s.match_available&&(f=o._tr_tally(s,0,s.window[s.strstart-1]),s.match_available=0),s.insert=s.strstart<O-1?s.strstart:O-1,L===b?(F(s,!0),s.strm.avail_out===0?ie:V):s.last_lit&&(F(s,!1),s.strm.avail_out===0)?l:B}function le(s,L,T,f,p){this.good_length=s,this.max_lazy=L,this.nice_length=T,this.max_chain=f,this.func=p}function me(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=I,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*k),this.dyn_dtree=new a.Buf16(2*(2*x+1)),this.bl_tree=new a.Buf16(2*(2*N+1)),te(this.dyn_ltree),te(this.dyn_dtree),te(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(K+1),this.heap=new a.Buf16(2*D+1),te(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*D+1),te(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function pe(s){var L;return s&&s.state?(s.total_in=s.total_out=0,s.data_type=u,(L=s.state).pending=0,L.pending_out=0,L.wrap<0&&(L.wrap=-L.wrap),L.status=L.wrap?S:R,s.adler=L.wrap===2?0:1,L.last_flush=C,o._tr_init(L),c):ae(s,v)}function Pe(s){var L=pe(s);return L===c&&function(T){T.window_size=2*T.w_size,te(T.head),T.max_lazy_match=n[T.level].max_lazy,T.good_match=n[T.level].good_length,T.nice_match=n[T.level].nice_length,T.max_chain_length=n[T.level].max_chain,T.strstart=0,T.block_start=0,T.lookahead=0,T.insert=0,T.match_length=T.prev_length=O-1,T.match_available=0,T.ins_h=0}(s.state),L}function Ae(s,L,T,f,p,w){if(!s)return v;var U=1;if(L===h&&(L=6),f<0?(U=0,f=-f):15<f&&(U=2,f-=16),p<1||E<p||T!==I||f<8||15<f||L<0||9<L||w<0||_<w)return ae(s,v);f===8&&(f=9);var $=new me;return(s.state=$).strm=s,$.wrap=U,$.gzhead=null,$.w_bits=f,$.w_size=1<<$.w_bits,$.w_mask=$.w_size-1,$.hash_bits=p+7,$.hash_size=1<<$.hash_bits,$.hash_mask=$.hash_size-1,$.hash_shift=~~(($.hash_bits+O-1)/O),$.window=new a.Buf8(2*$.w_size),$.head=new a.Buf16($.hash_size),$.prev=new a.Buf16($.w_size),$.lit_bufsize=1<<p+6,$.pending_buf_size=4*$.lit_bufsize,$.pending_buf=new a.Buf8($.pending_buf_size),$.d_buf=1*$.lit_bufsize,$.l_buf=3*$.lit_bufsize,$.level=L,$.strategy=w,$.method=T,Pe(s)}n=[new le(0,0,0,0,function(s,L){var T=65535;for(T>s.pending_buf_size-5&&(T=s.pending_buf_size-5);;){if(s.lookahead<=1){if(ue(s),s.lookahead===0&&L===C)return l;if(s.lookahead===0)break}s.strstart+=s.lookahead,s.lookahead=0;var f=s.block_start+T;if((s.strstart===0||s.strstart>=f)&&(s.lookahead=s.strstart-f,s.strstart=f,F(s,!1),s.strm.avail_out===0)||s.strstart-s.block_start>=s.w_size-ee&&(F(s,!1),s.strm.avail_out===0))return l}return s.insert=0,L===b?(F(s,!0),s.strm.avail_out===0?ie:V):(s.strstart>s.block_start&&(F(s,!1),s.strm.avail_out),l)}),new le(4,4,8,4,ge),new le(4,5,16,8,ge),new le(4,6,32,32,ge),new le(4,4,16,16,se),new le(8,16,32,32,se),new le(8,16,128,128,se),new le(8,32,128,256,se),new le(32,128,258,1024,se),new le(32,258,258,4096,se)],r.deflateInit=function(s,L){return Ae(s,L,I,15,8,0)},r.deflateInit2=Ae,r.deflateReset=Pe,r.deflateResetKeep=pe,r.deflateSetHeader=function(s,L){return s&&s.state?s.state.wrap!==2?v:(s.state.gzhead=L,c):v},r.deflate=function(s,L){var T,f,p,w;if(!s||!s.state||5<L||L<0)return s?ae(s,v):v;if(f=s.state,!s.output||!s.input&&s.avail_in!==0||f.status===666&&L!==b)return ae(s,s.avail_out===0?-5:v);if(f.strm=s,T=f.last_flush,f.last_flush=L,f.status===S)if(f.wrap===2)s.adler=0,Q(f,31),Q(f,139),Q(f,8),f.gzhead?(Q(f,(f.gzhead.text?1:0)+(f.gzhead.hcrc?2:0)+(f.gzhead.extra?4:0)+(f.gzhead.name?8:0)+(f.gzhead.comment?16:0)),Q(f,255&f.gzhead.time),Q(f,f.gzhead.time>>8&255),Q(f,f.gzhead.time>>16&255),Q(f,f.gzhead.time>>24&255),Q(f,f.level===9?2:2<=f.strategy||f.level<2?4:0),Q(f,255&f.gzhead.os),f.gzhead.extra&&f.gzhead.extra.length&&(Q(f,255&f.gzhead.extra.length),Q(f,f.gzhead.extra.length>>8&255)),f.gzhead.hcrc&&(s.adler=g(s.adler,f.pending_buf,f.pending,0)),f.gzindex=0,f.status=69):(Q(f,0),Q(f,0),Q(f,0),Q(f,0),Q(f,0),Q(f,f.level===9?2:2<=f.strategy||f.level<2?4:0),Q(f,3),f.status=R);else{var U=I+(f.w_bits-8<<4)<<8;U|=(2<=f.strategy||f.level<2?0:f.level<6?1:f.level===6?2:3)<<6,f.strstart!==0&&(U|=32),U+=31-U%31,f.status=R,q(f,U),f.strstart!==0&&(q(f,s.adler>>>16),q(f,65535&s.adler)),s.adler=1}if(f.status===69)if(f.gzhead.extra){for(p=f.pending;f.gzindex<(65535&f.gzhead.extra.length)&&(f.pending!==f.pending_buf_size||(f.gzhead.hcrc&&f.pending>p&&(s.adler=g(s.adler,f.pending_buf,f.pending-p,p)),P(s),p=f.pending,f.pending!==f.pending_buf_size));)Q(f,255&f.gzhead.extra[f.gzindex]),f.gzindex++;f.gzhead.hcrc&&f.pending>p&&(s.adler=g(s.adler,f.pending_buf,f.pending-p,p)),f.gzindex===f.gzhead.extra.length&&(f.gzindex=0,f.status=73)}else f.status=73;if(f.status===73)if(f.gzhead.name){p=f.pending;do{if(f.pending===f.pending_buf_size&&(f.gzhead.hcrc&&f.pending>p&&(s.adler=g(s.adler,f.pending_buf,f.pending-p,p)),P(s),p=f.pending,f.pending===f.pending_buf_size)){w=1;break}w=f.gzindex<f.gzhead.name.length?255&f.gzhead.name.charCodeAt(f.gzindex++):0,Q(f,w)}while(w!==0);f.gzhead.hcrc&&f.pending>p&&(s.adler=g(s.adler,f.pending_buf,f.pending-p,p)),w===0&&(f.gzindex=0,f.status=91)}else f.status=91;if(f.status===91)if(f.gzhead.comment){p=f.pending;do{if(f.pending===f.pending_buf_size&&(f.gzhead.hcrc&&f.pending>p&&(s.adler=g(s.adler,f.pending_buf,f.pending-p,p)),P(s),p=f.pending,f.pending===f.pending_buf_size)){w=1;break}w=f.gzindex<f.gzhead.comment.length?255&f.gzhead.comment.charCodeAt(f.gzindex++):0,Q(f,w)}while(w!==0);f.gzhead.hcrc&&f.pending>p&&(s.adler=g(s.adler,f.pending_buf,f.pending-p,p)),w===0&&(f.status=103)}else f.status=103;if(f.status===103&&(f.gzhead.hcrc?(f.pending+2>f.pending_buf_size&&P(s),f.pending+2<=f.pending_buf_size&&(Q(f,255&s.adler),Q(f,s.adler>>8&255),s.adler=0,f.status=R)):f.status=R),f.pending!==0){if(P(s),s.avail_out===0)return f.last_flush=-1,c}else if(s.avail_in===0&&W(L)<=W(T)&&L!==b)return ae(s,-5);if(f.status===666&&s.avail_in!==0)return ae(s,-5);if(s.avail_in!==0||f.lookahead!==0||L!==C&&f.status!==666){var $=f.strategy===2?function(M,G){for(var X;;){if(M.lookahead===0&&(ue(M),M.lookahead===0)){if(G===C)return l;break}if(M.match_length=0,X=o._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++,X&&(F(M,!1),M.strm.avail_out===0))return l}return M.insert=0,G===b?(F(M,!0),M.strm.avail_out===0?ie:V):M.last_lit&&(F(M,!1),M.strm.avail_out===0)?l:B}(f,L):f.strategy===3?function(M,G){for(var X,H,J,he,oe=M.window;;){if(M.lookahead<=j){if(ue(M),M.lookahead<=j&&G===C)return l;if(M.lookahead===0)break}if(M.match_length=0,M.lookahead>=O&&0<M.strstart&&(H=oe[J=M.strstart-1])===oe[++J]&&H===oe[++J]&&H===oe[++J]){he=M.strstart+j;do;while(H===oe[++J]&&H===oe[++J]&&H===oe[++J]&&H===oe[++J]&&H===oe[++J]&&H===oe[++J]&&H===oe[++J]&&H===oe[++J]&&J<he);M.match_length=j-(he-J),M.match_length>M.lookahead&&(M.match_length=M.lookahead)}if(M.match_length>=O?(X=o._tr_tally(M,1,M.match_length-O),M.lookahead-=M.match_length,M.strstart+=M.match_length,M.match_length=0):(X=o._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++),X&&(F(M,!1),M.strm.avail_out===0))return l}return M.insert=0,G===b?(F(M,!0),M.strm.avail_out===0?ie:V):M.last_lit&&(F(M,!1),M.strm.avail_out===0)?l:B}(f,L):n[f.level].func(f,L);if($!==ie&&$!==V||(f.status=666),$===l||$===ie)return s.avail_out===0&&(f.last_flush=-1),c;if($===B&&(L===1?o._tr_align(f):L!==5&&(o._tr_stored_block(f,0,0,!1),L===3&&(te(f.head),f.lookahead===0&&(f.strstart=0,f.block_start=0,f.insert=0))),P(s),s.avail_out===0))return f.last_flush=-1,c}return L!==b?c:f.wrap<=0?1:(f.wrap===2?(Q(f,255&s.adler),Q(f,s.adler>>8&255),Q(f,s.adler>>16&255),Q(f,s.adler>>24&255),Q(f,255&s.total_in),Q(f,s.total_in>>8&255),Q(f,s.total_in>>16&255),Q(f,s.total_in>>24&255)):(q(f,s.adler>>>16),q(f,65535&s.adler)),P(s),0<f.wrap&&(f.wrap=-f.wrap),f.pending!==0?c:1)},r.deflateEnd=function(s){var L;return s&&s.state?(L=s.state.status)!==S&&L!==69&&L!==73&&L!==91&&L!==103&&L!==R&&L!==666?ae(s,v):(s.state=null,L===R?ae(s,-3):c):v},r.deflateSetDictionary=function(s,L){var T,f,p,w,U,$,M,G,X=L.length;if(!s||!s.state||(w=(T=s.state).wrap)===2||w===1&&T.status!==S||T.lookahead)return v;for(w===1&&(s.adler=d(s.adler,L,X,0)),T.wrap=0,X>=T.w_size&&(w===0&&(te(T.head),T.strstart=0,T.block_start=0,T.insert=0),G=new a.Buf8(T.w_size),a.arraySet(G,L,X-T.w_size,T.w_size,0),L=G,X=T.w_size),U=s.avail_in,$=s.next_in,M=s.input,s.avail_in=X,s.next_in=0,s.input=L,ue(T);T.lookahead>=O;){for(f=T.strstart,p=T.lookahead-(O-1);T.ins_h=(T.ins_h<<T.hash_shift^T.window[f+O-1])&T.hash_mask,T.prev[f&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=f,f++,--p;);T.strstart=f,T.lookahead=O-1,ue(T)}return T.strstart+=T.lookahead,T.block_start=T.strstart,T.insert=T.lookahead,T.lookahead=0,T.match_length=T.prev_length=O-1,T.match_available=0,s.next_in=$,s.input=M,s.avail_in=U,T.wrap=w,c},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,i,r){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,i,r){i.exports=function(n,a){var o,d,g,y,C,b,c,v,h,_,u,I,E,D,x,N,k,K,O,j,ee,S,R,l,B;o=n.state,d=n.next_in,l=n.input,g=d+(n.avail_in-5),y=n.next_out,B=n.output,C=y-(a-n.avail_out),b=y+(n.avail_out-257),c=o.dmax,v=o.wsize,h=o.whave,_=o.wnext,u=o.window,I=o.hold,E=o.bits,D=o.lencode,x=o.distcode,N=(1<<o.lenbits)-1,k=(1<<o.distbits)-1;e:do{E<15&&(I+=l[d++]<<E,E+=8,I+=l[d++]<<E,E+=8),K=D[I&N];t:for(;;){if(I>>>=O=K>>>24,E-=O,(O=K>>>16&255)===0)B[y++]=65535&K;else{if(!(16&O)){if(!(64&O)){K=D[(65535&K)+(I&(1<<O)-1)];continue t}if(32&O){o.mode=12;break e}n.msg="invalid literal/length code",o.mode=30;break e}j=65535&K,(O&=15)&&(E<O&&(I+=l[d++]<<E,E+=8),j+=I&(1<<O)-1,I>>>=O,E-=O),E<15&&(I+=l[d++]<<E,E+=8,I+=l[d++]<<E,E+=8),K=x[I&k];i:for(;;){if(I>>>=O=K>>>24,E-=O,!(16&(O=K>>>16&255))){if(!(64&O)){K=x[(65535&K)+(I&(1<<O)-1)];continue i}n.msg="invalid distance code",o.mode=30;break e}if(ee=65535&K,E<(O&=15)&&(I+=l[d++]<<E,(E+=8)<O&&(I+=l[d++]<<E,E+=8)),c<(ee+=I&(1<<O)-1)){n.msg="invalid distance too far back",o.mode=30;break e}if(I>>>=O,E-=O,(O=y-C)<ee){if(h<(O=ee-O)&&o.sane){n.msg="invalid distance too far back",o.mode=30;break e}if(R=u,(S=0)===_){if(S+=v-O,O<j){for(j-=O;B[y++]=u[S++],--O;);S=y-ee,R=B}}else if(_<O){if(S+=v+_-O,(O-=_)<j){for(j-=O;B[y++]=u[S++],--O;);if(S=0,_<j){for(j-=O=_;B[y++]=u[S++],--O;);S=y-ee,R=B}}}else if(S+=_-O,O<j){for(j-=O;B[y++]=u[S++],--O;);S=y-ee,R=B}for(;2<j;)B[y++]=R[S++],B[y++]=R[S++],B[y++]=R[S++],j-=3;j&&(B[y++]=R[S++],1<j&&(B[y++]=R[S++]))}else{for(S=y-ee;B[y++]=B[S++],B[y++]=B[S++],B[y++]=B[S++],2<(j-=3););j&&(B[y++]=B[S++],1<j&&(B[y++]=B[S++]))}break}}break}}while(d<g&&y<b);d-=j=E>>3,I&=(1<<(E-=j<<3))-1,n.next_in=d,n.next_out=y,n.avail_in=d<g?g-d+5:5-(d-g),n.avail_out=y<b?b-y+257:257-(y-b),o.hold=I,o.bits=E}},{}],49:[function(t,i,r){var n=t("../utils/common"),a=t("./adler32"),o=t("./crc32"),d=t("./inffast"),g=t("./inftrees"),y=1,C=2,b=0,c=-2,v=1,h=852,_=592;function u(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function I(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(S){var R;return S&&S.state?(R=S.state,S.total_in=S.total_out=R.total=0,S.msg="",R.wrap&&(S.adler=1&R.wrap),R.mode=v,R.last=0,R.havedict=0,R.dmax=32768,R.head=null,R.hold=0,R.bits=0,R.lencode=R.lendyn=new n.Buf32(h),R.distcode=R.distdyn=new n.Buf32(_),R.sane=1,R.back=-1,b):c}function D(S){var R;return S&&S.state?((R=S.state).wsize=0,R.whave=0,R.wnext=0,E(S)):c}function x(S,R){var l,B;return S&&S.state?(B=S.state,R<0?(l=0,R=-R):(l=1+(R>>4),R<48&&(R&=15)),R&&(R<8||15<R)?c:(B.window!==null&&B.wbits!==R&&(B.window=null),B.wrap=l,B.wbits=R,D(S))):c}function N(S,R){var l,B;return S?(B=new I,(S.state=B).window=null,(l=x(S,R))!==b&&(S.state=null),l):c}var k,K,O=!0;function j(S){if(O){var R;for(k=new n.Buf32(512),K=new n.Buf32(32),R=0;R<144;)S.lens[R++]=8;for(;R<256;)S.lens[R++]=9;for(;R<280;)S.lens[R++]=7;for(;R<288;)S.lens[R++]=8;for(g(y,S.lens,0,288,k,0,S.work,{bits:9}),R=0;R<32;)S.lens[R++]=5;g(C,S.lens,0,32,K,0,S.work,{bits:5}),O=!1}S.lencode=k,S.lenbits=9,S.distcode=K,S.distbits=5}function ee(S,R,l,B){var ie,V=S.state;return V.window===null&&(V.wsize=1<<V.wbits,V.wnext=0,V.whave=0,V.window=new n.Buf8(V.wsize)),B>=V.wsize?(n.arraySet(V.window,R,l-V.wsize,V.wsize,0),V.wnext=0,V.whave=V.wsize):(B<(ie=V.wsize-V.wnext)&&(ie=B),n.arraySet(V.window,R,l-B,ie,V.wnext),(B-=ie)?(n.arraySet(V.window,R,l-B,B,0),V.wnext=B,V.whave=V.wsize):(V.wnext+=ie,V.wnext===V.wsize&&(V.wnext=0),V.whave<V.wsize&&(V.whave+=ie))),0}r.inflateReset=D,r.inflateReset2=x,r.inflateResetKeep=E,r.inflateInit=function(S){return N(S,15)},r.inflateInit2=N,r.inflate=function(S,R){var l,B,ie,V,ae,W,te,P,F,Q,q,Z,ue,ge,se,le,me,pe,Pe,Ae,s,L,T,f,p=0,w=new n.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return c;(l=S.state).mode===12&&(l.mode=13),ae=S.next_out,ie=S.output,te=S.avail_out,V=S.next_in,B=S.input,W=S.avail_in,P=l.hold,F=l.bits,Q=W,q=te,L=b;e:for(;;)switch(l.mode){case v:if(l.wrap===0){l.mode=13;break}for(;F<16;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}if(2&l.wrap&&P===35615){w[l.check=0]=255&P,w[1]=P>>>8&255,l.check=o(l.check,w,2,0),F=P=0,l.mode=2;break}if(l.flags=0,l.head&&(l.head.done=!1),!(1&l.wrap)||(((255&P)<<8)+(P>>8))%31){S.msg="incorrect header check",l.mode=30;break}if((15&P)!=8){S.msg="unknown compression method",l.mode=30;break}if(F-=4,s=8+(15&(P>>>=4)),l.wbits===0)l.wbits=s;else if(s>l.wbits){S.msg="invalid window size",l.mode=30;break}l.dmax=1<<s,S.adler=l.check=1,l.mode=512&P?10:12,F=P=0;break;case 2:for(;F<16;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}if(l.flags=P,(255&l.flags)!=8){S.msg="unknown compression method",l.mode=30;break}if(57344&l.flags){S.msg="unknown header flags set",l.mode=30;break}l.head&&(l.head.text=P>>8&1),512&l.flags&&(w[0]=255&P,w[1]=P>>>8&255,l.check=o(l.check,w,2,0)),F=P=0,l.mode=3;case 3:for(;F<32;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}l.head&&(l.head.time=P),512&l.flags&&(w[0]=255&P,w[1]=P>>>8&255,w[2]=P>>>16&255,w[3]=P>>>24&255,l.check=o(l.check,w,4,0)),F=P=0,l.mode=4;case 4:for(;F<16;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}l.head&&(l.head.xflags=255&P,l.head.os=P>>8),512&l.flags&&(w[0]=255&P,w[1]=P>>>8&255,l.check=o(l.check,w,2,0)),F=P=0,l.mode=5;case 5:if(1024&l.flags){for(;F<16;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}l.length=P,l.head&&(l.head.extra_len=P),512&l.flags&&(w[0]=255&P,w[1]=P>>>8&255,l.check=o(l.check,w,2,0)),F=P=0}else l.head&&(l.head.extra=null);l.mode=6;case 6:if(1024&l.flags&&(W<(Z=l.length)&&(Z=W),Z&&(l.head&&(s=l.head.extra_len-l.length,l.head.extra||(l.head.extra=new Array(l.head.extra_len)),n.arraySet(l.head.extra,B,V,Z,s)),512&l.flags&&(l.check=o(l.check,B,Z,V)),W-=Z,V+=Z,l.length-=Z),l.length))break e;l.length=0,l.mode=7;case 7:if(2048&l.flags){if(W===0)break e;for(Z=0;s=B[V+Z++],l.head&&s&&l.length<65536&&(l.head.name+=String.fromCharCode(s)),s&&Z<W;);if(512&l.flags&&(l.check=o(l.check,B,Z,V)),W-=Z,V+=Z,s)break e}else l.head&&(l.head.name=null);l.length=0,l.mode=8;case 8:if(4096&l.flags){if(W===0)break e;for(Z=0;s=B[V+Z++],l.head&&s&&l.length<65536&&(l.head.comment+=String.fromCharCode(s)),s&&Z<W;);if(512&l.flags&&(l.check=o(l.check,B,Z,V)),W-=Z,V+=Z,s)break e}else l.head&&(l.head.comment=null);l.mode=9;case 9:if(512&l.flags){for(;F<16;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}if(P!==(65535&l.check)){S.msg="header crc mismatch",l.mode=30;break}F=P=0}l.head&&(l.head.hcrc=l.flags>>9&1,l.head.done=!0),S.adler=l.check=0,l.mode=12;break;case 10:for(;F<32;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}S.adler=l.check=u(P),F=P=0,l.mode=11;case 11:if(l.havedict===0)return S.next_out=ae,S.avail_out=te,S.next_in=V,S.avail_in=W,l.hold=P,l.bits=F,2;S.adler=l.check=1,l.mode=12;case 12:if(R===5||R===6)break e;case 13:if(l.last){P>>>=7&F,F-=7&F,l.mode=27;break}for(;F<3;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}switch(l.last=1&P,F-=1,3&(P>>>=1)){case 0:l.mode=14;break;case 1:if(j(l),l.mode=20,R!==6)break;P>>>=2,F-=2;break e;case 2:l.mode=17;break;case 3:S.msg="invalid block type",l.mode=30}P>>>=2,F-=2;break;case 14:for(P>>>=7&F,F-=7&F;F<32;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}if((65535&P)!=(P>>>16^65535)){S.msg="invalid stored block lengths",l.mode=30;break}if(l.length=65535&P,F=P=0,l.mode=15,R===6)break e;case 15:l.mode=16;case 16:if(Z=l.length){if(W<Z&&(Z=W),te<Z&&(Z=te),Z===0)break e;n.arraySet(ie,B,V,Z,ae),W-=Z,V+=Z,te-=Z,ae+=Z,l.length-=Z;break}l.mode=12;break;case 17:for(;F<14;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}if(l.nlen=257+(31&P),P>>>=5,F-=5,l.ndist=1+(31&P),P>>>=5,F-=5,l.ncode=4+(15&P),P>>>=4,F-=4,286<l.nlen||30<l.ndist){S.msg="too many length or distance symbols",l.mode=30;break}l.have=0,l.mode=18;case 18:for(;l.have<l.ncode;){for(;F<3;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}l.lens[U[l.have++]]=7&P,P>>>=3,F-=3}for(;l.have<19;)l.lens[U[l.have++]]=0;if(l.lencode=l.lendyn,l.lenbits=7,T={bits:l.lenbits},L=g(0,l.lens,0,19,l.lencode,0,l.work,T),l.lenbits=T.bits,L){S.msg="invalid code lengths set",l.mode=30;break}l.have=0,l.mode=19;case 19:for(;l.have<l.nlen+l.ndist;){for(;le=(p=l.lencode[P&(1<<l.lenbits)-1])>>>16&255,me=65535&p,!((se=p>>>24)<=F);){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}if(me<16)P>>>=se,F-=se,l.lens[l.have++]=me;else{if(me===16){for(f=se+2;F<f;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}if(P>>>=se,F-=se,l.have===0){S.msg="invalid bit length repeat",l.mode=30;break}s=l.lens[l.have-1],Z=3+(3&P),P>>>=2,F-=2}else if(me===17){for(f=se+3;F<f;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}F-=se,s=0,Z=3+(7&(P>>>=se)),P>>>=3,F-=3}else{for(f=se+7;F<f;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}F-=se,s=0,Z=11+(127&(P>>>=se)),P>>>=7,F-=7}if(l.have+Z>l.nlen+l.ndist){S.msg="invalid bit length repeat",l.mode=30;break}for(;Z--;)l.lens[l.have++]=s}}if(l.mode===30)break;if(l.lens[256]===0){S.msg="invalid code -- missing end-of-block",l.mode=30;break}if(l.lenbits=9,T={bits:l.lenbits},L=g(y,l.lens,0,l.nlen,l.lencode,0,l.work,T),l.lenbits=T.bits,L){S.msg="invalid literal/lengths set",l.mode=30;break}if(l.distbits=6,l.distcode=l.distdyn,T={bits:l.distbits},L=g(C,l.lens,l.nlen,l.ndist,l.distcode,0,l.work,T),l.distbits=T.bits,L){S.msg="invalid distances set",l.mode=30;break}if(l.mode=20,R===6)break e;case 20:l.mode=21;case 21:if(6<=W&&258<=te){S.next_out=ae,S.avail_out=te,S.next_in=V,S.avail_in=W,l.hold=P,l.bits=F,d(S,q),ae=S.next_out,ie=S.output,te=S.avail_out,V=S.next_in,B=S.input,W=S.avail_in,P=l.hold,F=l.bits,l.mode===12&&(l.back=-1);break}for(l.back=0;le=(p=l.lencode[P&(1<<l.lenbits)-1])>>>16&255,me=65535&p,!((se=p>>>24)<=F);){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}if(le&&!(240&le)){for(pe=se,Pe=le,Ae=me;le=(p=l.lencode[Ae+((P&(1<<pe+Pe)-1)>>pe)])>>>16&255,me=65535&p,!(pe+(se=p>>>24)<=F);){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}P>>>=pe,F-=pe,l.back+=pe}if(P>>>=se,F-=se,l.back+=se,l.length=me,le===0){l.mode=26;break}if(32&le){l.back=-1,l.mode=12;break}if(64&le){S.msg="invalid literal/length code",l.mode=30;break}l.extra=15&le,l.mode=22;case 22:if(l.extra){for(f=l.extra;F<f;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}l.length+=P&(1<<l.extra)-1,P>>>=l.extra,F-=l.extra,l.back+=l.extra}l.was=l.length,l.mode=23;case 23:for(;le=(p=l.distcode[P&(1<<l.distbits)-1])>>>16&255,me=65535&p,!((se=p>>>24)<=F);){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}if(!(240&le)){for(pe=se,Pe=le,Ae=me;le=(p=l.distcode[Ae+((P&(1<<pe+Pe)-1)>>pe)])>>>16&255,me=65535&p,!(pe+(se=p>>>24)<=F);){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}P>>>=pe,F-=pe,l.back+=pe}if(P>>>=se,F-=se,l.back+=se,64&le){S.msg="invalid distance code",l.mode=30;break}l.offset=me,l.extra=15&le,l.mode=24;case 24:if(l.extra){for(f=l.extra;F<f;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}l.offset+=P&(1<<l.extra)-1,P>>>=l.extra,F-=l.extra,l.back+=l.extra}if(l.offset>l.dmax){S.msg="invalid distance too far back",l.mode=30;break}l.mode=25;case 25:if(te===0)break e;if(Z=q-te,l.offset>Z){if((Z=l.offset-Z)>l.whave&&l.sane){S.msg="invalid distance too far back",l.mode=30;break}ue=Z>l.wnext?(Z-=l.wnext,l.wsize-Z):l.wnext-Z,Z>l.length&&(Z=l.length),ge=l.window}else ge=ie,ue=ae-l.offset,Z=l.length;for(te<Z&&(Z=te),te-=Z,l.length-=Z;ie[ae++]=ge[ue++],--Z;);l.length===0&&(l.mode=21);break;case 26:if(te===0)break e;ie[ae++]=l.length,te--,l.mode=21;break;case 27:if(l.wrap){for(;F<32;){if(W===0)break e;W--,P|=B[V++]<<F,F+=8}if(q-=te,S.total_out+=q,l.total+=q,q&&(S.adler=l.check=l.flags?o(l.check,ie,q,ae-q):a(l.check,ie,q,ae-q)),q=te,(l.flags?P:u(P))!==l.check){S.msg="incorrect data check",l.mode=30;break}F=P=0}l.mode=28;case 28:if(l.wrap&&l.flags){for(;F<32;){if(W===0)break e;W--,P+=B[V++]<<F,F+=8}if(P!==(4294967295&l.total)){S.msg="incorrect length check",l.mode=30;break}F=P=0}l.mode=29;case 29:L=1;break e;case 30:L=-3;break e;case 31:return-4;case 32:default:return c}return S.next_out=ae,S.avail_out=te,S.next_in=V,S.avail_in=W,l.hold=P,l.bits=F,(l.wsize||q!==S.avail_out&&l.mode<30&&(l.mode<27||R!==4))&&ee(S,S.output,S.next_out,q-S.avail_out)?(l.mode=31,-4):(Q-=S.avail_in,q-=S.avail_out,S.total_in+=Q,S.total_out+=q,l.total+=q,l.wrap&&q&&(S.adler=l.check=l.flags?o(l.check,ie,q,S.next_out-q):a(l.check,ie,q,S.next_out-q)),S.data_type=l.bits+(l.last?64:0)+(l.mode===12?128:0)+(l.mode===20||l.mode===15?256:0),(Q==0&&q===0||R===4)&&L===b&&(L=-5),L)},r.inflateEnd=function(S){if(!S||!S.state)return c;var R=S.state;return R.window&&(R.window=null),S.state=null,b},r.inflateGetHeader=function(S,R){var l;return S&&S.state&&2&(l=S.state).wrap?((l.head=R).done=!1,b):c},r.inflateSetDictionary=function(S,R){var l,B=R.length;return S&&S.state?(l=S.state).wrap!==0&&l.mode!==11?c:l.mode===11&&a(1,R,B,0)!==l.check?-3:ee(S,R,B,B)?(l.mode=31,-4):(l.havedict=1,b):c},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,i,r){var n=t("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],g=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(y,C,b,c,v,h,_,u){var I,E,D,x,N,k,K,O,j,ee=u.bits,S=0,R=0,l=0,B=0,ie=0,V=0,ae=0,W=0,te=0,P=0,F=null,Q=0,q=new n.Buf16(16),Z=new n.Buf16(16),ue=null,ge=0;for(S=0;S<=15;S++)q[S]=0;for(R=0;R<c;R++)q[C[b+R]]++;for(ie=ee,B=15;1<=B&&q[B]===0;B--);if(B<ie&&(ie=B),B===0)return v[h++]=20971520,v[h++]=20971520,u.bits=1,0;for(l=1;l<B&&q[l]===0;l++);for(ie<l&&(ie=l),S=W=1;S<=15;S++)if(W<<=1,(W-=q[S])<0)return-1;if(0<W&&(y===0||B!==1))return-1;for(Z[1]=0,S=1;S<15;S++)Z[S+1]=Z[S]+q[S];for(R=0;R<c;R++)C[b+R]!==0&&(_[Z[C[b+R]]++]=R);if(k=y===0?(F=ue=_,19):y===1?(F=a,Q-=257,ue=o,ge-=257,256):(F=d,ue=g,-1),S=l,N=h,ae=R=P=0,D=-1,x=(te=1<<(V=ie))-1,y===1&&852<te||y===2&&592<te)return 1;for(;;){for(K=S-ae,j=_[R]<k?(O=0,_[R]):_[R]>k?(O=ue[ge+_[R]],F[Q+_[R]]):(O=96,0),I=1<<S-ae,l=E=1<<V;v[N+(P>>ae)+(E-=I)]=K<<24|O<<16|j|0,E!==0;);for(I=1<<S-1;P&I;)I>>=1;if(I!==0?(P&=I-1,P+=I):P=0,R++,--q[S]==0){if(S===B)break;S=C[b+_[R]]}if(ie<S&&(P&x)!==D){for(ae===0&&(ae=ie),N+=l,W=1<<(V=S-ae);V+ae<B&&!((W-=q[V+ae])<=0);)V++,W<<=1;if(te+=1<<V,y===1&&852<te||y===2&&592<te)return 1;v[D=P&x]=ie<<24|V<<16|N-h|0}}return P!==0&&(v[N+P]=S-ae<<24|64<<16|0),u.bits=ie,0}},{"../utils/common":41}],51:[function(t,i,r){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,i,r){var n=t("../utils/common"),a=0,o=1;function d(p){for(var w=p.length;0<=--w;)p[w]=0}var g=0,y=29,C=256,b=C+1+y,c=30,v=19,h=2*b+1,_=15,u=16,I=7,E=256,D=16,x=17,N=18,k=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],K=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=new Array(2*(b+2));d(ee);var S=new Array(2*c);d(S);var R=new Array(512);d(R);var l=new Array(256);d(l);var B=new Array(y);d(B);var ie,V,ae,W=new Array(c);function te(p,w,U,$,M){this.static_tree=p,this.extra_bits=w,this.extra_base=U,this.elems=$,this.max_length=M,this.has_stree=p&&p.length}function P(p,w){this.dyn_tree=p,this.max_code=0,this.stat_desc=w}function F(p){return p<256?R[p]:R[256+(p>>>7)]}function Q(p,w){p.pending_buf[p.pending++]=255&w,p.pending_buf[p.pending++]=w>>>8&255}function q(p,w,U){p.bi_valid>u-U?(p.bi_buf|=w<<p.bi_valid&65535,Q(p,p.bi_buf),p.bi_buf=w>>u-p.bi_valid,p.bi_valid+=U-u):(p.bi_buf|=w<<p.bi_valid&65535,p.bi_valid+=U)}function Z(p,w,U){q(p,U[2*w],U[2*w+1])}function ue(p,w){for(var U=0;U|=1&p,p>>>=1,U<<=1,0<--w;);return U>>>1}function ge(p,w,U){var $,M,G=new Array(_+1),X=0;for($=1;$<=_;$++)G[$]=X=X+U[$-1]<<1;for(M=0;M<=w;M++){var H=p[2*M+1];H!==0&&(p[2*M]=ue(G[H]++,H))}}function se(p){var w;for(w=0;w<b;w++)p.dyn_ltree[2*w]=0;for(w=0;w<c;w++)p.dyn_dtree[2*w]=0;for(w=0;w<v;w++)p.bl_tree[2*w]=0;p.dyn_ltree[2*E]=1,p.opt_len=p.static_len=0,p.last_lit=p.matches=0}function le(p){8<p.bi_valid?Q(p,p.bi_buf):0<p.bi_valid&&(p.pending_buf[p.pending++]=p.bi_buf),p.bi_buf=0,p.bi_valid=0}function me(p,w,U,$){var M=2*w,G=2*U;return p[M]<p[G]||p[M]===p[G]&&$[w]<=$[U]}function pe(p,w,U){for(var $=p.heap[U],M=U<<1;M<=p.heap_len&&(M<p.heap_len&&me(w,p.heap[M+1],p.heap[M],p.depth)&&M++,!me(w,$,p.heap[M],p.depth));)p.heap[U]=p.heap[M],U=M,M<<=1;p.heap[U]=$}function Pe(p,w,U){var $,M,G,X,H=0;if(p.last_lit!==0)for(;$=p.pending_buf[p.d_buf+2*H]<<8|p.pending_buf[p.d_buf+2*H+1],M=p.pending_buf[p.l_buf+H],H++,$===0?Z(p,M,w):(Z(p,(G=l[M])+C+1,w),(X=k[G])!==0&&q(p,M-=B[G],X),Z(p,G=F(--$),U),(X=K[G])!==0&&q(p,$-=W[G],X)),H<p.last_lit;);Z(p,E,w)}function Ae(p,w){var U,$,M,G=w.dyn_tree,X=w.stat_desc.static_tree,H=w.stat_desc.has_stree,J=w.stat_desc.elems,he=-1;for(p.heap_len=0,p.heap_max=h,U=0;U<J;U++)G[2*U]!==0?(p.heap[++p.heap_len]=he=U,p.depth[U]=0):G[2*U+1]=0;for(;p.heap_len<2;)G[2*(M=p.heap[++p.heap_len]=he<2?++he:0)]=1,p.depth[M]=0,p.opt_len--,H&&(p.static_len-=X[2*M+1]);for(w.max_code=he,U=p.heap_len>>1;1<=U;U--)pe(p,G,U);for(M=J;U=p.heap[1],p.heap[1]=p.heap[p.heap_len--],pe(p,G,1),$=p.heap[1],p.heap[--p.heap_max]=U,p.heap[--p.heap_max]=$,G[2*M]=G[2*U]+G[2*$],p.depth[M]=(p.depth[U]>=p.depth[$]?p.depth[U]:p.depth[$])+1,G[2*U+1]=G[2*$+1]=M,p.heap[1]=M++,pe(p,G,1),2<=p.heap_len;);p.heap[--p.heap_max]=p.heap[1],function(oe,Se){var nt,Te,at,_e,gt,xt,Be=Se.dyn_tree,ii=Se.max_code,yr=Se.stat_desc.static_tree,Sr=Se.stat_desc.has_stree,br=Se.stat_desc.extra_bits,ri=Se.stat_desc.extra_base,st=Se.stat_desc.max_length,vt=0;for(_e=0;_e<=_;_e++)oe.bl_count[_e]=0;for(Be[2*oe.heap[oe.heap_max]+1]=0,nt=oe.heap_max+1;nt<h;nt++)st<(_e=Be[2*Be[2*(Te=oe.heap[nt])+1]+1]+1)&&(_e=st,vt++),Be[2*Te+1]=_e,ii<Te||(oe.bl_count[_e]++,gt=0,ri<=Te&&(gt=br[Te-ri]),xt=Be[2*Te],oe.opt_len+=xt*(_e+gt),Sr&&(oe.static_len+=xt*(yr[2*Te+1]+gt)));if(vt!==0){do{for(_e=st-1;oe.bl_count[_e]===0;)_e--;oe.bl_count[_e]--,oe.bl_count[_e+1]+=2,oe.bl_count[st]--,vt-=2}while(0<vt);for(_e=st;_e!==0;_e--)for(Te=oe.bl_count[_e];Te!==0;)ii<(at=oe.heap[--nt])||(Be[2*at+1]!==_e&&(oe.opt_len+=(_e-Be[2*at+1])*Be[2*at],Be[2*at+1]=_e),Te--)}}(p,w),ge(G,he,p.bl_count)}function s(p,w,U){var $,M,G=-1,X=w[1],H=0,J=7,he=4;for(X===0&&(J=138,he=3),w[2*(U+1)+1]=65535,$=0;$<=U;$++)M=X,X=w[2*($+1)+1],++H<J&&M===X||(H<he?p.bl_tree[2*M]+=H:M!==0?(M!==G&&p.bl_tree[2*M]++,p.bl_tree[2*D]++):H<=10?p.bl_tree[2*x]++:p.bl_tree[2*N]++,G=M,he=(H=0)===X?(J=138,3):M===X?(J=6,3):(J=7,4))}function L(p,w,U){var $,M,G=-1,X=w[1],H=0,J=7,he=4;for(X===0&&(J=138,he=3),$=0;$<=U;$++)if(M=X,X=w[2*($+1)+1],!(++H<J&&M===X)){if(H<he)for(;Z(p,M,p.bl_tree),--H!=0;);else M!==0?(M!==G&&(Z(p,M,p.bl_tree),H--),Z(p,D,p.bl_tree),q(p,H-3,2)):H<=10?(Z(p,x,p.bl_tree),q(p,H-3,3)):(Z(p,N,p.bl_tree),q(p,H-11,7));G=M,he=(H=0)===X?(J=138,3):M===X?(J=6,3):(J=7,4)}}d(W);var T=!1;function f(p,w,U,$){q(p,(g<<1)+($?1:0),3),function(M,G,X,H){le(M),H&&(Q(M,X),Q(M,~X)),n.arraySet(M.pending_buf,M.window,G,X,M.pending),M.pending+=X}(p,w,U,!0)}r._tr_init=function(p){T||(function(){var w,U,$,M,G,X=new Array(_+1);for(M=$=0;M<y-1;M++)for(B[M]=$,w=0;w<1<<k[M];w++)l[$++]=M;for(l[$-1]=M,M=G=0;M<16;M++)for(W[M]=G,w=0;w<1<<K[M];w++)R[G++]=M;for(G>>=7;M<c;M++)for(W[M]=G<<7,w=0;w<1<<K[M]-7;w++)R[256+G++]=M;for(U=0;U<=_;U++)X[U]=0;for(w=0;w<=143;)ee[2*w+1]=8,w++,X[8]++;for(;w<=255;)ee[2*w+1]=9,w++,X[9]++;for(;w<=279;)ee[2*w+1]=7,w++,X[7]++;for(;w<=287;)ee[2*w+1]=8,w++,X[8]++;for(ge(ee,b+1,X),w=0;w<c;w++)S[2*w+1]=5,S[2*w]=ue(w,5);ie=new te(ee,k,C+1,b,_),V=new te(S,K,0,c,_),ae=new te(new Array(0),O,0,v,I)}(),T=!0),p.l_desc=new P(p.dyn_ltree,ie),p.d_desc=new P(p.dyn_dtree,V),p.bl_desc=new P(p.bl_tree,ae),p.bi_buf=0,p.bi_valid=0,se(p)},r._tr_stored_block=f,r._tr_flush_block=function(p,w,U,$){var M,G,X=0;0<p.level?(p.strm.data_type===2&&(p.strm.data_type=function(H){var J,he=4093624447;for(J=0;J<=31;J++,he>>>=1)if(1&he&&H.dyn_ltree[2*J]!==0)return a;if(H.dyn_ltree[18]!==0||H.dyn_ltree[20]!==0||H.dyn_ltree[26]!==0)return o;for(J=32;J<C;J++)if(H.dyn_ltree[2*J]!==0)return o;return a}(p)),Ae(p,p.l_desc),Ae(p,p.d_desc),X=function(H){var J;for(s(H,H.dyn_ltree,H.l_desc.max_code),s(H,H.dyn_dtree,H.d_desc.max_code),Ae(H,H.bl_desc),J=v-1;3<=J&&H.bl_tree[2*j[J]+1]===0;J--);return H.opt_len+=3*(J+1)+5+5+4,J}(p),M=p.opt_len+3+7>>>3,(G=p.static_len+3+7>>>3)<=M&&(M=G)):M=G=U+5,U+4<=M&&w!==-1?f(p,w,U,$):p.strategy===4||G===M?(q(p,2+($?1:0),3),Pe(p,ee,S)):(q(p,4+($?1:0),3),function(H,J,he,oe){var Se;for(q(H,J-257,5),q(H,he-1,5),q(H,oe-4,4),Se=0;Se<oe;Se++)q(H,H.bl_tree[2*j[Se]+1],3);L(H,H.dyn_ltree,J-1),L(H,H.dyn_dtree,he-1)}(p,p.l_desc.max_code+1,p.d_desc.max_code+1,X+1),Pe(p,p.dyn_ltree,p.dyn_dtree)),se(p),$&&le(p)},r._tr_tally=function(p,w,U){return p.pending_buf[p.d_buf+2*p.last_lit]=w>>>8&255,p.pending_buf[p.d_buf+2*p.last_lit+1]=255&w,p.pending_buf[p.l_buf+p.last_lit]=255&U,p.last_lit++,w===0?p.dyn_ltree[2*U]++:(p.matches++,w--,p.dyn_ltree[2*(l[U]+C+1)]++,p.dyn_dtree[2*F(w)]++),p.last_lit===p.lit_bufsize-1},r._tr_align=function(p){q(p,2,3),Z(p,E,ee),function(w){w.bi_valid===16?(Q(w,w.bi_buf),w.bi_buf=0,w.bi_valid=0):8<=w.bi_valid&&(w.pending_buf[w.pending++]=255&w.bi_buf,w.bi_buf>>=8,w.bi_valid-=8)}(p)}},{"../utils/common":41}],53:[function(t,i,r){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,i,r){(function(n){(function(a,o){if(!a.setImmediate){var d,g,y,C,b=1,c={},v=!1,h=a.document,_=Object.getPrototypeOf&&Object.getPrototypeOf(a);_=_&&_.setTimeout?_:a,d={}.toString.call(a.process)==="[object process]"?function(D){process.nextTick(function(){I(D)})}:function(){if(a.postMessage&&!a.importScripts){var D=!0,x=a.onmessage;return a.onmessage=function(){D=!1},a.postMessage("","*"),a.onmessage=x,D}}()?(C="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",E,!1):a.attachEvent("onmessage",E),function(D){a.postMessage(C+D,"*")}):a.MessageChannel?((y=new MessageChannel).port1.onmessage=function(D){I(D.data)},function(D){y.port2.postMessage(D)}):h&&"onreadystatechange"in h.createElement("script")?(g=h.documentElement,function(D){var x=h.createElement("script");x.onreadystatechange=function(){I(D),x.onreadystatechange=null,g.removeChild(x),x=null},g.appendChild(x)}):function(D){setTimeout(I,0,D)},_.setImmediate=function(D){typeof D!="function"&&(D=new Function(""+D));for(var x=new Array(arguments.length-1),N=0;N<x.length;N++)x[N]=arguments[N+1];var k={callback:D,args:x};return c[b]=k,d(b),b++},_.clearImmediate=u}function u(D){delete c[D]}function I(D){if(v)setTimeout(I,0,D);else{var x=c[D];if(x){v=!0;try{(function(N){var k=N.callback,K=N.args;switch(K.length){case 0:k();break;case 1:k(K[0]);break;case 2:k(K[0],K[1]);break;case 3:k(K[0],K[1],K[2]);break;default:k.apply(o,K)}})(x)}finally{u(D),v=!1}}}}function E(D){D.source===a&&typeof D.data=="string"&&D.data.indexOf(C)===0&&I(+D.data.slice(C.length))}})(typeof self>"u"?n===void 0?this:n:self)}).call(this,typeof Je<"u"?Je:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(ar);var an=ar.exports;const pi=Er(an);class ct{constructor(e,t,i){this.errorCode=e,this.fileSystemItem=t,this.errorText=i}}var ve={NoAccess:0,FileExists:1,FileNotFound:2,DirectoryExists:3,DirectoryNotFound:4,WrongFileExtension:5,MaxFileSizeExceeded:6,InvalidSymbols:7,Other:32767},Ft=je();class _i extends bt{constructor(e){e=Ie(e,{}),super(e);var t=e.data;if(t&&!Array.isArray(t))throw $r.Error("E4006");var i=e.itemsExpr||"items";this._subFileItemsGetter=Re(i),this._subFileItemsSetter=this._getSetter(i);var r=e.contentExpr||"content";this._contentGetter=Re(r),this._contentSetter=this._getSetter(r);var n=this._getNameExpr(e);this._nameSetter=this._getSetter(n);var a=this._getIsDirExpr(e);this._getIsDirSetter=this._getSetter(a);var o=this._getKeyExpr(e);this._keySetter=this._getSetter(o);var d=this._getSizeExpr(e);this._sizeSetter=this._getSetter(d);var g=this._getDateModifiedExpr(e);this._dateModifiedSetter=this._getSetter(g),this._data=t||[]}getItems(e){return this._executeActionAsDeferred(()=>this._getItems(e),!0)}renameItem(e,t){return this._executeActionAsDeferred(()=>this._renameItemCore(e,t))}_renameItemCore(e,t){if(e){var i=this._findDataObject(e);this._nameSetter(i,t),e.name=t,e.key=this._ensureDataObjectKey(i)}}createDirectory(e,t){return this._executeActionAsDeferred(()=>{this._validateDirectoryExists(e),this._createDataObject(e,t,!0)})}deleteItems(e){return e.map(t=>this._executeActionAsDeferred(()=>this._deleteItem(t)))}moveItems(e,t){var i=this._findDataObject(t),r=this._getDirectoryDataItems(i),n=e.map(a=>this._executeActionAsDeferred(()=>{this._checkAbilityToMoveOrCopyItem(a,t);var o=this._findDataObject(a);this._deleteItem(a),r.push(o)}));return n}copyItems(e,t){var i=this._findDataObject(t),r=this._getDirectoryDataItems(i),n=e.map(a=>this._executeActionAsDeferred(()=>{this._checkAbilityToMoveOrCopyItem(a,t);var o=this._findDataObject(a),d=this._createCopy(o);r.push(d)}));return n}uploadFileChunk(e,t,i){if(t.chunkIndex>0)return t.customData.deferred;this._validateDirectoryExists(i);var r=t.customData.deferred=new re,n=this._createFileReader();return n.readAsDataURL(e),n.onload=()=>{var a=n.result.split(",")[1],o=this._createDataObject(i,e.name,!1);this._sizeSetter(o,e.size),this._dateModifiedSetter(o,e.lastModifiedDate),this._contentSetter(o,a),r.resolve()},n.onerror=a=>r.reject(a),r}downloadItems(e){e.length===1?this._downloadSingleFile(e[0]):this._downloadMultipleFiles(e)}_downloadSingleFile(e){for(var t=this._getFileContent(e),i=Ft.atob(t),r=new ArrayBuffer(i.length),n=new Uint8Array(r),a=0;a<i.length;a++)n[a]=i.charCodeAt(a);var o=new Ft.Blob([r],{type:"application/octet-stream"});ui.saveAs(e.name,null,o)}_downloadMultipleFiles(e){var t=sn(),i=new t;e.forEach(a=>i.file(a.name,this._getFileContent(a),{base64:!0}));var r={type:"blob",compression:"DEFLATE",mimeType:"application/zip"},n=new re;i.generateAsync?i.generateAsync(r).then(n.resolve):n.resolve(i.generate(r)),n.done(a=>ui.saveAs("files.zip",null,a))}_getFileContent(e){var t=this._findDataObject(e);return this._contentGetter(t)||""}_validateDirectoryExists(e){if(!this._isFileItemExists(e)||this._isDirGetter(e.fileItem))throw new ct(ve.DirectoryNotFound,e)}_checkAbilityToMoveOrCopyItem(e,t){var i=this._findDataObject(e),r=this._getKeyFromDataObject(i,e.parentPath),n=t.getFullPathInfo(),a="";n.forEach(o=>{a=Le(a,o.name);var d=this._getDataObjectKey(o.key,a);if(d===r)throw new ct(ve.Other,e)})}_createDataObject(e,t,i){var r={};this._nameSetter(r,t),this._getIsDirSetter(r,i),this._keySetter(r,String(new Ne));var n=this._findDataObject(e),a=this._getDirectoryDataItems(n);return a.push(r),r}_createCopy(e){var t={};this._nameSetter(t,this._nameGetter(e)),this._getIsDirSetter(t,this._isDirGetter(e));var i=this._subFileItemsGetter(e);if(Array.isArray(i)){var r=[];i.forEach(n=>{var a=this._createCopy(n);r.push(a)}),this._subFileItemsSetter(t,r)}return t}_deleteItem(e){var t=this._findDataObject(e),i=this._findFileItemObj(e.pathInfo),r=this._getDirectoryDataItems(i),n=r.indexOf(t);r.splice(n,1)}_getDirectoryDataItems(e){if(!e)return this._data;var t=this._subFileItemsGetter(e);return Array.isArray(t)||(t=[],this._subFileItemsSetter(e,t)),t}_getItems(e){this._validateDirectoryExists(e);var t=e.getFullPathInfo(),i=t&&t.length>0?t[t.length-1].key:null,r=this._data;if(i){var n=this._findFileItemObj(t);r=n&&this._subFileItemsGetter(n)||[]}return this._ensureKeysForDuplicateNameItems(r),this._convertDataObjectsToFileItems(r,t)}_ensureKeysForDuplicateNameItems(e){var t={};e.forEach(i=>{var r=this._nameGetter(i);t[r]?this._ensureDataObjectKey(i):t[r]=!0})}_findDataObject(e){if(e.isRoot())return null;var t=this._findFileItemObj(e.getFullPathInfo());if(!t){var i=e.isDirectory?ve.DirectoryNotFound:ve.FileNotFound;throw new ct(i,e)}return t}_findFileItemObj(e){var t=this;Array.isArray(e)||(e=[]);for(var i="",r=null,n=this._data,a=function(d){r=n.find(g=>{var y=t._isDirGetter(g)||d===e.length-1;return t._getKeyFromDataObject(g,i)===e[d].key&&t._nameGetter(g)===e[d].name&&y}),r&&(i=Le(i,t._nameGetter(r)),n=t._subFileItemsGetter(r))},o=0;o<e.length&&(o===0||r);o++)a(o);return r}_getKeyFromDataObject(e,t){var i=this._keyGetter(e),r=Le(t,this._nameGetter(e));return this._getDataObjectKey(i,r)}_getDataObjectKey(e,t){return e||t}_ensureDataObjectKey(e){var t=this._keyGetter(e);return t||(t=String(new Ne),this._keySetter(e,t)),t}_hasSubDirs(e){var t=Ie(this._subFileItemsGetter(e),[]);if(!Array.isArray(t))return!0;for(var i=0;i<t.length;i++)if(this._isDirGetter(t[i])===!0)return!0;return!1}_getSetter(e){return Ce(e)?e:Lr(e)}_isFileItemExists(e){return e.isDirectory&&e.isRoot()||!!this._findFileItemObj(e.getFullPathInfo())}_createFileReader(){return new Ft.FileReader}}function sn(){if(!pi)throw Gi.Error("E1041","JSZip");return pi}var on=je(),ln="chunk",Oe={GET_DIR_CONTENTS:"GetDirContents",CREATE_DIR:"CreateDir",RENAME:"Rename",MOVE:"Move",COPY:"Copy",REMOVE:"Remove",UPLOAD_CHUNK:"UploadChunk",ABORT_UPLOAD:"AbortUpload",DOWLOAD:"Download"},lt={GET:"GET",POST:"POST"};class dn extends bt{constructor(e){e=Ie(e,{}),super(e),this._endpointUrl=e.endpointUrl,this._beforeAjaxSend=e.beforeAjaxSend,this._beforeSubmit=e.beforeSubmit,this._requestHeaders=e.requestHeaders,this._hasSubDirsGetter=Re(e.hasSubDirectoriesExpr||"hasSubDirectories")}getItems(e){var t=e.getFullPathInfo();return this._executeRequest(Oe.GET_DIR_CONTENTS,{pathInfo:t}).then(i=>this._convertDataObjectsToFileItems(i.result,t))}renameItem(e,t){return this._executeRequest(Oe.RENAME,{pathInfo:e.getFullPathInfo(),isDirectory:e.isDirectory,name:t})}createDirectory(e,t){return this._executeRequest(Oe.CREATE_DIR,{pathInfo:e.getFullPathInfo(),name:t})}deleteItems(e){return e.map(t=>this._executeRequest(Oe.REMOVE,{pathInfo:t.getFullPathInfo(),isDirectory:t.isDirectory}))}moveItems(e,t){return e.map(i=>this._executeRequest(Oe.MOVE,{sourcePathInfo:i.getFullPathInfo(),sourceIsDirectory:i.isDirectory,destinationPathInfo:t.getFullPathInfo()}))}copyItems(e,t){return e.map(i=>this._executeRequest(Oe.COPY,{sourcePathInfo:i.getFullPathInfo(),sourceIsDirectory:i.isDirectory,destinationPathInfo:t.getFullPathInfo()}))}uploadFileChunk(e,t,i){t.chunkIndex===0&&(t.customData.uploadId=new Ne);var r={destinationPathInfo:i.getFullPathInfo(),chunkMetadata:JSON.stringify({UploadId:t.customData.uploadId,FileName:e.name,Index:t.chunkIndex,TotalCount:t.chunkCount,FileSize:e.size})},n={url:this._endpointUrl,headers:this._requestHeaders||{},method:lt.POST,dataType:"json",data:{[ln]:t.chunkBlob,arguments:JSON.stringify(r),command:Oe.UPLOAD_CHUNK},upload:{onprogress:ke,onloadstart:ke,onabort:ke},xhrFields:{},cache:!1},a=new re;return this._beforeSendInternal(n),ht.sendRequest(n).done(o=>{!o.success&&a.reject(o)||a.resolve()}).fail(a.reject),a.promise()}abortFileUpload(e,t,i){return this._executeRequest(Oe.ABORT_UPLOAD,{uploadId:t.customData.uploadId})}downloadItems(e){var t=this._getDownloadArgs(e),i=A("<form>").css({display:"none"}).attr({method:lt.POST,action:t.url}),r={command:t.command,arguments:t.arguments};this._beforeSubmitInternal(r),this._appendFormDataInputsToForm(r,i),i.appendTo("body"),ce.trigger(i,"submit"),setTimeout(()=>i.remove())}getItemsContent(e){var t=this._getDownloadArgs(e),i={url:t.url,headers:this._requestHeaders||{},method:lt.POST,responseType:"arraybuffer",data:{command:t.command,arguments:t.arguments},upload:{onprogress:ke,onloadstart:ke,onabort:ke},xhrFields:{},cache:!1};return this._beforeSendInternal(i),ht.sendRequest(i)}_getDownloadArgs(e){var t=e.map(n=>n.getFullPathInfo()),i={pathInfoList:t},r=JSON.stringify(i);return{url:this._endpointUrl,arguments:r,command:Oe.DOWLOAD}}_getItemsIds(e){return e.map(t=>t.relativeName)}_executeRequest(e,t){var i=e===Oe.GET_DIR_CONTENTS?lt.GET:lt.POST,r=new re,n={url:this._getEndpointUrl(e,t),headers:this._requestHeaders||{},method:i,dataType:"json",data:{},xhrFields:{},cache:!1};return this._beforeSendInternal(n),ht.sendRequest(n).then(a=>{!a.success&&r.reject(a)||r.resolve(a)},a=>r.reject(a)),r.promise()}_beforeSubmitInternal(e){Ce(this._beforeSubmit)&&this._beforeSubmit({formData:e})}_beforeSendInternal(e){if(Ce(this._beforeAjaxSend)){var t={headers:e.headers,formData:e.data,xhrFields:e.xhrFields};this._beforeAjaxSend(t),e.headers=t.headers,e.data=t.formData,e.xhrFields=t.xhrFields}Yi(e.data)?delete e.data:(e.responseType||e.upload)&&(e.data=this._createFormData(e.data))}_createFormData(e){var t=new on.FormData;for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&ne(e[i])&&t.append(i,e[i]);return t}_appendFormDataInputsToForm(e,t){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&ne(e[i])&&A("<input>").attr({type:"hidden",name:i,value:e[i]}).appendTo(t)}_getEndpointUrl(e,t){var i=this._getQueryString({command:e,arguments:JSON.stringify(t)}),r=this._endpointUrl&&this._endpointUrl.indexOf("?")>0?"&":"?";return this._endpointUrl+r+i}_getQueryString(e){for(var t=[],i=Object.keys(e),r=0;r<i.length;r++){var n=i[r],a=e[n];if(a!==void 0)if(a===null&&(a=""),Array.isArray(a))this._processQueryStringArrayParam(n,a,t);else{var o=this._getQueryStringPair(n,a);t.push(o)}}return t.join("&")}_processQueryStringArrayParam(e,t,i){xe(t,(r,n)=>{var a=this._getQueryStringPair(e,n);i.push(a)})}_getQueryStringPair(e,t){return encodeURIComponent(e)+"="+encodeURIComponent(t)}_hasSubDirs(e){var t=this._hasSubDirsGetter(e);return typeof t=="boolean"?t:!0}_getKeyExpr(e){return e.keyExpr||"key"}}class hn extends bt{constructor(e){e=Ie(e,{}),super(e),this._hasSubDirsGetter=Re(e.hasSubDirectoriesExpr||"hasSubDirectories"),this._getItemsFunction=this._ensureFunction(e.getItems,()=>[]),this._renameItemFunction=this._ensureFunction(e.renameItem),this._createDirectoryFunction=this._ensureFunction(e.createDirectory),this._deleteItemFunction=this._ensureFunction(e.deleteItem),this._moveItemFunction=this._ensureFunction(e.moveItem),this._copyItemFunction=this._ensureFunction(e.copyItem),this._uploadFileChunkFunction=this._ensureFunction(e.uploadFileChunk),this._abortFileUploadFunction=this._ensureFunction(e.abortFileUpload),this._downloadItemsFunction=this._ensureFunction(e.downloadItems),this._getItemsContentFunction=this._ensureFunction(e.getItemsContent)}getItems(e){var t=e.getFullPathInfo();return this._executeActionAsDeferred(()=>this._getItemsFunction(e),!0).then(i=>this._convertDataObjectsToFileItems(i,t))}renameItem(e,t){return this._executeActionAsDeferred(()=>this._renameItemFunction(e,t))}createDirectory(e,t){return this._executeActionAsDeferred(()=>this._createDirectoryFunction(e,t))}deleteItems(e){return e.map(t=>this._executeActionAsDeferred(()=>this._deleteItemFunction(t)))}moveItems(e,t){return e.map(i=>this._executeActionAsDeferred(()=>this._moveItemFunction(i,t)))}copyItems(e,t){return e.map(i=>this._executeActionAsDeferred(()=>this._copyItemFunction(i,t)))}uploadFileChunk(e,t,i){return this._executeActionAsDeferred(()=>this._uploadFileChunkFunction(e,t,i))}abortFileUpload(e,t,i){return this._executeActionAsDeferred(()=>this._abortFileUploadFunction(e,t,i))}downloadItems(e){return this._executeActionAsDeferred(()=>this._downloadItemsFunction(e))}getItemsContent(e){return this._executeActionAsDeferred(()=>this._getItemsContentFunction(e))}_hasSubDirs(e){var t=this._hasSubDirsGetter(e);return typeof t=="boolean"?t:!0}_getKeyExpr(e){return e.keyExpr||"key"}_ensureFunction(e,t){return t=t||ke,Ce(e)?e:t}}var mi="Files",tt={NAVIGATION:"navigation",REFRESH:"refresh"};class cn{constructor(e){e=e||{},this._options=Y({},e),this._isInitialized=!1,this._dataLoading=!1,this._dataLoadingDeferred=null,this._rootDirectoryInfo=this._createRootDirectoryInfo(e.rootText),this._currentDirectoryInfo=this._rootDirectoryInfo,this._defaultIconMap=this._createDefaultIconMap(),this.startSingleLoad(),this._setSecurityController(),this._setProvider(e.fileProvider),this._initialize()}_initialize(){var e=this._options.currentPathKeys&&this._options.currentPathKeys.length?this.setCurrentPathByKeys(this._options.currentPathKeys):this.setCurrentPath(this._options.currentPath),t=()=>{this._isInitialized=!0,this._raiseInitialized()};e?fe(e).always(t):t()}_setSecurityController(){this._securityController=new un({allowedFileExtensions:this._options.allowedFileExtensions,maxFileSize:this._options.uploadMaxFileSize}),this._resetState()}setAllowedFileExtensions(e){ne(e)&&(this._options.allowedFileExtensions=e),this._setSecurityController(),this.refresh()}setUploadOptions(e){var{maxFileSize:t,chunkSize:i}=e;ne(i)&&(this._options.uploadChunkSize=i),ne(t)&&(this._options.uploadMaxFileSize=t,this._setSecurityController(),this.refresh())}_setProvider(e){this._fileProvider=this._createFileProvider(e),this._resetState()}updateProvider(e,t){return ne(t)?fe(this._getDirectoryByPathParts(this._rootDirectoryInfo,t,!0)).then(i=>{i!==this._rootDirectoryInfo&&this._resetCurrentDirectory(),this._setProvider(e)}).then(()=>this.setCurrentPathByKeys(t)):this._updateProviderOnly(e)}_updateProviderOnly(e){return this._resetCurrentDirectory(),this._setProvider(e),fe(this.refresh())}_createFileProvider(e){if(e||(e=[]),Array.isArray(e))return new _i({data:e});if(e instanceof bt)return e;switch(e.type){case"remote":return new dn(e);case"custom":return new hn(e)}return new _i(e)}setCurrentPath(e){var t=nr(e),i=Le(...t);return this.getCurrentDirectory().fileItem.relativeName===i?new re().resolve().promise():this._setCurrentDirectoryByPathParts(t)}setCurrentPathByKeys(e){return Ji(this.getCurrentDirectory().fileItem.pathKeys,e)?new re().resolve().promise():this._setCurrentDirectoryByPathParts(e,!0)}getCurrentPath(){for(var e="",t=this.getCurrentDirectory();t&&!t.fileItem.isRoot();){var i=$t(t.fileItem.name);e=Le(i,e),t=t.parentDirectory}return e}getCurrentPathKeys(){return this.getCurrentDirectory().fileItem.pathKeys}getCurrentDirectory(){return this._currentDirectoryInfo}setCurrentDirectory(e,t){if(e){if(t&&(e=this._getActualDirectoryInfo(e)),this._currentDirectoryInfo&&this._currentDirectoryInfo===e){this._raisePathPotentiallyChanged();return}var i=this._currentDirectoryInfo.fileItem.key!==e.fileItem.key;this._currentDirectoryInfo=e,i&&this._isInitialized&&(this._dataLoading||this._raiseDataLoading(tt.NAVIGATION),this._raiseSelectedDirectoryChanged(e))}}_resetCurrentDirectory(){this._currentDirectoryInfo=this._rootDirectoryInfo}getCurrentItems(e){return this._dataLoadingDeferred?this._dataLoadingDeferred.then(()=>this._getCurrentItemsInternal(e)):this._getCurrentItemsInternal(e)}_getCurrentItemsInternal(e){var t=this.getCurrentDirectory(),i=this.getDirectoryContents(t);return i.then(r=>{var n=this._separateItemsByType(r);return t.fileItem.hasSubDirectories=!!n.folders.length,e?n.files:r})}getDirectories(e,t){return this.getDirectoryContents(e,t).then(i=>i.filter(r=>r.fileItem.isDirectory))}_separateItemsByType(e){var t=[],i=[];return e.forEach(r=>r.fileItem.isDirectory?t.push(r):i.push(r)),{folders:t,files:i}}getDirectoryContents(e,t){if(!e)return new re().resolve([this._rootDirectoryInfo]).promise();if(e.itemsLoaded)return new re().resolve(e.items).promise();if(this._singleOperationLockId&&e.itemsSingleLoadErrorId===this._singleOperationLockId)return this._changeDirectoryOnError(e,t,!0),new re().reject().promise();var i=e.getInternalKey(),r=this._loadedItems[i];return r||(r=this._getFileItems(e,t).then(n=>(n=n||[],e.items=n.map(a=>a.isDirectory&&this._createDirectoryInfo(a,e)||this._createFileInfo(a,e)),e.itemsLoaded=!0,e.items),()=>(this._singleOperationLockId&&e.itemsSingleLoadErrorId!==this._singleOperationLockId&&(e.itemsSingleLoadErrorId=this._singleOperationLockId),[])),this._loadedItems[i]=r,r.always(()=>{delete this._loadedItems[i]}),r)}_getFileItems(e,t){var i=null;try{i=this._fileProvider.getItems(e.fileItem)}catch(r){return this._handleItemLoadError(e,r,t)}return fe(i).then(r=>this._securityController.getAllowedItems(r),r=>this._handleItemLoadError(e,r,t))}createDirectory(e,t){var i=e.fileItem,r=this._createDirInfoByName(t,e),n=this._createEditActionInfo("create",r,e);return this._processEditAction(n,a=>{a.parentDirectory=i,a.name=t,this._editingEvents.onDirectoryCreating(a)},()=>this._fileProvider.createDirectory(i,t).done(a=>(i.isRoot()||(i.hasSubDirectories=!0),a)),()=>{var a={parentDirectory:i,name:t};this._editingEvents.onDirectoryCreated(a)},()=>this._resetDirectoryState(e,!0))}renameItem(e,t){var i=e.fileItem.createClone(),r=this._createEditActionInfo("rename",e,e.parentDirectory,{itemNewName:t});return this._processEditAction(r,(n,a)=>{a.fileItem.isDirectory||this._securityController.validateExtension(t),n.item=i,n.newName=t,this._editingEvents.onItemRenaming(n)},n=>this._fileProvider.renameItem(n,t),()=>{var n={sourceItem:i,itemName:t};this._editingEvents.onItemRenamed(n)},()=>{var n=this._getActualDirectoryInfo(e.parentDirectory);this._resetDirectoryState(n),this.setCurrentDirectory(n)})}moveItems(e,t){var i=this._createEditActionInfo("move",e,t);return this._processEditAction(i,(r,n)=>{r.item=n.fileItem,r.destinationDirectory=t.fileItem,this._editingEvents.onItemMoving(r)},r=>this._fileProvider.moveItems([r],t.fileItem),r=>{var n={sourceItem:r.fileItem,parentDirectory:t.fileItem,itemName:r.fileItem.name,itemPath:Le(t.fileItem.path,r.fileItem.name)};this._editingEvents.onItemMoved(n)},r=>{e.forEach(n=>this._resetDirectoryState(n.parentDirectory,!0)),r&&(this._resetDirectoryState(t),this.setCurrentPathByKeys(t.fileItem.pathKeys),t.expanded=!0)})}copyItems(e,t){var i=this._createEditActionInfo("copy",e,t);return this._processEditAction(i,(r,n)=>{r.item=n.fileItem,r.destinationDirectory=t.fileItem,this._editingEvents.onItemCopying(r)},r=>this._fileProvider.copyItems([r],t.fileItem),r=>{var n={sourceItem:r.fileItem,parentDirectory:t.fileItem,itemName:r.fileItem.name,itemPath:Le(t.fileItem.path,r.fileItem.name)};this._editingEvents.onItemCopied(n)},r=>{r&&(t=this._getActualDirectoryInfo(t),this._resetDirectoryState(t),this.setCurrentDirectory(t),t.expanded=!0)})}deleteItems(e){var t=e.length>0?e[0].parentDirectory:null,i=this._createEditActionInfo("delete",e,t);return this._processEditAction(i,(r,n)=>{r.item=n.fileItem,this._editingEvents.onItemDeleting(r)},r=>this._fileProvider.deleteItems([r]),r=>this._editingEvents.onItemDeleted({item:r.fileItem}),()=>{e.forEach(r=>{var n=this._getActualDirectoryInfo(r.parentDirectory);this._resetDirectoryState(n),this.setCurrentDirectory(n)})})}processUploadSession(e,t){var i=this._getItemInfosForUploaderFiles(e.files,t),r=this._createEditActionInfo("upload",i,t,{sessionInfo:e});return this._processEditAction(r,()=>{},(n,a)=>e.deferreds[a],()=>{},()=>this._resetDirectoryState(t,!0))}uploadFileChunk(e,t,i){var r=null;t.chunkIndex===0?(this._securityController.validateMaxFileSize(e.size),this._securityController.validateExtension(e.name),r=this._processBeforeItemEditAction(a=>{a.fileData=e,a.destinationDirectory=i,this._editingEvents.onFileUploading(a)})):r=new re().resolve().promise();var n=r.then(()=>this._fileProvider.uploadFileChunk(e,t,i));return t.chunkIndex===t.chunkCount-1&&(n=n.done(()=>{var a={fileData:e,parentDirectory:i};this._editingEvents.onFileUploaded(a)})),n}abortFileUpload(e,t,i){return fe(this._fileProvider.abortFileUpload(e,t,i))}getFileUploadChunkSize(){var e=this._options.uploadChunkSize;return e&&e>0?e:this._fileProvider.getFileUploadChunkSize()}downloadItems(e){var t=e.map(i=>this._processBeforeItemEditAction(r=>{r.item=i.fileItem,this._editingEvents.onItemDownloading(r)},i));return fe(...t).then(()=>{var i=e.map(r=>r.fileItem);return fe(this._getItemActionResult(this._fileProvider.downloadItems(i))).then(()=>{},r=>{this._raiseDownloadItemsError(e,e[0].parentDirectory,r)})},i=>{this._raiseDownloadItemsError(e,e[0].parentDirectory,i)})}getItemContent(e){var t=e.map(i=>i.fileItem);return fe(this._fileProvider.getItemsContent(t))}_handleItemLoadError(e,t,i){return e=this._getActualDirectoryInfo(e),this._raiseGetItemsError(e,t),this._changeDirectoryOnError(e,i),new re().reject().promise()}_raiseGetItemsError(e,t){var i=this._createEditActionInfo("getItems",e,e);this._raiseEditActionStarting(i),this._raiseEditActionResultAcquired(i),this._raiseEditActionError(i,{errorCode:t.errorCode,errorText:t.errorText,fileItem:e.fileItem,index:0})}_raiseDownloadItemsError(e,t,i){var r=this._createEditActionInfo("download",e,t),n=e.length;r.singleRequest=n===1,this._raiseEditActionStarting(r),this._raiseEditActionResultAcquired(r);for(var a=0;a<n-1;a++)this._raiseEditActionItemError(r,{errorCode:i.errorCode,errorText:i.errorText,fileItem:e[a].fileItem,index:a});this._raiseEditActionError(r,{errorCode:i.errorCode,errorText:i.errorText,fileItem:e[n-1].fileItem,index:n-1})}_changeDirectoryOnError(e,t,i){i&&(e=this._getActualDirectoryInfo(e)),this._resetDirectoryState(e),e.expanded=!1,t||this.setCurrentDirectory(e.parentDirectory)}_getItemActionResult(e){return Array.isArray(e)?e[0]:e}_processEditAction(e,t,i,r,n){var a=!1;this._raiseEditActionStarting(e);var o=e.itemInfos.map((d,g)=>this._processBeforeItemEditAction(t,d).then(()=>{var y=this._getItemActionResult(i(d.fileItem,g));return y.done(()=>r(d))}));return e.singleRequest=o.length===1,this._raiseEditActionResultAcquired(e),Nt(o,d=>{a=!0,this._raiseCompleteEditActionItem(e,d)},d=>this._raiseEditActionItemError(e,d)).then(()=>{n(a),this._raiseCompleteEditAction(e)})}_createEditActionInfo(e,t,i,r){t=Array.isArray(t)?t:[t],r=r||{};var n=t.map(a=>a.fileItem);return{name:e,itemInfos:t,items:n,directory:i,customData:r,singleRequest:!0}}_processBeforeItemEditAction(e,t){var i=new re,r=this._createBeforeActionArgs();try{e(r,t)}catch(n){return i.reject(n).promise()}if(!r.cancel)i.resolve();else{if(r.cancel===!0)return i.reject({errorText:r.errorText,errorCode:r.errorCode});Xi(r.cancel)&&fe(r.cancel).then(n=>{n===!0?i.reject():Br(n)&&n.cancel===!0&&i.reject({errorText:n.errorText,errorCode:n.errorCode}),i.resolve()},i.resolve)}return i.promise()}_createBeforeActionArgs(){return{errorCode:void 0,errorText:"",cancel:!1}}_getItemInfosForUploaderFiles(e,t){for(var i=this._getPathInfo(t),r=[],n=0;n<e.length;n++){var a=e[n],o=new et(i,a.name,!1),d=this._createFileInfo(o,t);r.push(d)}return r}refresh(){return this._lockRefresh?this._refreshDeferred:(this._lockRefresh=!0,this._executeDataLoad(()=>this._refreshDeferred=this._refreshInternal(),tt.REFRESH))}startSingleLoad(){this._singleOperationLockId=new Ne().toString()}endSingleLoad(){delete this._singleOperationLockId}_refreshInternal(){var e={items:this._rootDirectoryInfo.items},t=this._getDirectoryPathKeyParts(this.getCurrentDirectory());return this._resetDirectoryState(this._rootDirectoryInfo),this._loadItemsRecursive(this._rootDirectoryInfo,e).then(()=>{var i=this._findDirectoryByPathKeyParts(t);this.setCurrentDirectory(i),delete this._lockRefresh})}_loadItemsRecursive(e,t){var i=this;return this.getDirectories(e).then(r=>{for(var n=[],a=function(g){var y=t.items.find(C=>r[g].fileItem.key===C.fileItem.key);if(!y)return"continue";r[g].expanded=y.expanded,r[g].expanded&&n.push(i._loadItemsRecursive(r[g],y))},o=0;o<r.length;o++)var d=a(o);return Nt(n)},()=>null)}_setCurrentDirectoryByPathParts(e,t){return this._executeDataLoad(()=>this._setCurrentDirectoryByPathPartsInternal(e,t),tt.NAVIGATION)}_setCurrentDirectoryByPathPartsInternal(e,t){return this._getDirectoryByPathParts(this._rootDirectoryInfo,e,t).then(i=>{for(var r=i.parentDirectory;r;r=r.parentDirectory)r.expanded=!0;this.setCurrentDirectory(i)},()=>{this._raisePathPotentiallyChanged()})}_executeDataLoad(e,t){return this._dataLoadingDeferred?this._dataLoadingDeferred.then(()=>this._executeDataLoad(e,t)):(this._dataLoading=!0,this._dataLoadingDeferred=new re,this._isInitialized&&this._raiseDataLoading(t),e().always(()=>{var i=this._dataLoadingDeferred;this._dataLoadingDeferred=null,this._dataLoading=!1,i.resolve()}))}_getDirectoryByPathParts(e,t,i){if(t.length<1)return new re().resolve(e).promise();var r=i?"key":"name";return this.getDirectories(e).then(n=>{var a=n.find(d=>d.fileItem[r]===t[0]);if(!a)return new re().reject().promise();var o=[...t].splice(1);return this._getDirectoryByPathParts(a,o,i)})}_getDirectoryPathKeyParts(e){for(var t=[];e&&e.parentDirectory;)t.unshift(e.fileItem.key),e=e.parentDirectory;return t}_findDirectoryByPathKeyParts(e){var t=this._rootDirectoryInfo;if(e.length===0)return t;for(var i=0,r=t;r&&i<e.length;)r=t.items.find(n=>n.fileItem.key===e[i]),r&&(t=r),i++;return t}_getActualDirectoryInfo(e){var t=this._getDirectoryPathKeyParts(e);return this._findDirectoryByPathKeyParts(t)}_createDirInfoByName(e,t){var i=this._getPathInfo(t),r=new et(i,e,!0);return this._createDirectoryInfo(r,t)}_createDirectoryInfo(e,t){return Y(this._createFileInfo(e,t),{icon:"folder",expanded:e.isRoot(),items:[]})}_createFileInfo(e,t){return{fileItem:e,parentDirectory:t,icon:this._getFileItemDefaultIcon(e),getInternalKey(){return"FIK_".concat(this.fileItem.key)},getDisplayName(){return this.displayName||this.fileItem.name}}}_resetDirectoryState(e,t){t&&(e=this._getActualDirectoryInfo(e)),e.itemsLoaded=!1,e.items=[]}_getFileItemDefaultIcon(e){if(e.isDirectory)return"folder";var t=e.getFileExtension(),i=this._defaultIconMap[t];return i||"doc"}_createDefaultIconMap(){var e={".txt":"txtfile",".rtf":"rtffile",".doc":"docfile",".docx":"docxfile",".xls":"xlsfile",".xlsx":"xlsxfile",".ppt":"pptfile",".pptx":"pptxfile",".pdf":"pdffile"};return[".png",".gif",".jpg",".jpeg",".ico",".bmp"].forEach(t=>{e[t]="image"}),e}_createRootDirectoryInfo(e){var t=new et(null,"",!0),i=this._createDirectoryInfo(t,null);return i.displayName=e||mi,i}setRootText(e){this._rootDirectoryInfo.displayName=e||mi}_raiseInitialized(){this._tryCallAction("onInitialized",{controller:this})}_raiseDataLoading(e){this._tryCallAction("onDataLoading",{operation:e})}_raiseSelectedDirectoryChanged(e){this._tryCallAction("onSelectedDirectoryChanged",{selectedDirectoryInfo:e})}_raiseEditActionStarting(e){this._tryCallAction("onEditActionStarting",e)}_raiseEditActionResultAcquired(e){this._tryCallAction("onEditActionResultAcquired",e)}_raiseEditActionError(e,t){this._tryCallAction("onEditActionError",e,t)}_raiseEditActionItemError(e,t){this._tryCallAction("onEditActionItemError",e,t)}_raiseCompleteEditActionItem(e,t){this._tryCallAction("onCompleteEditActionItem",e,t)}_raiseCompleteEditAction(e){this._tryCallAction("onCompleteEditAction",e)}_raisePathPotentiallyChanged(){this._tryCallAction("onPathPotentiallyChanged")}_tryCallAction(e){var t=Array.prototype.slice.call(arguments,1);this._isInitialized&&this._options[e]&&this._options[e](...t)}_resetState(){this._selectedDirectory=null,this._rootDirectoryInfo.items=[],this._rootDirectoryInfo.itemsLoaded=!1,this._loadedItems={}}_getPathInfo(e){for(var t=[],i=e;i&&!i.fileItem.isRoot();i=i.parentDirectory)t.unshift({key:i.fileItem.key,name:i.fileItem.name});return t}on(e,t){var i="on".concat(e);this._options[i]=t}get _editingEvents(){return this._options.editingEvents}}class un{constructor(e){this._options=Y({allowedFileExtensions:[],maxFileSize:0},e),this._extensionsMap={},this._allowedFileExtensions.forEach(t=>{this._extensionsMap[t.toUpperCase()]=!0})}getAllowedItems(e){return this._allowedFileExtensions.length===0?e:e.filter(t=>t.isDirectory||this._isValidExtension(t.name))}validateExtension(e){if(!this._isValidExtension(e))throw new ct(ve.WrongFileExtension,null)}validateMaxFileSize(e){if(this._maxFileSize&&e>this._maxFileSize)throw new ct(ve.MaxFileSizeExceeded,null)}_isValidExtension(e){if(this._allowedFileExtensions.length===0)return!0;var t=rr(e).toUpperCase();return this._extensionsMap[t]}get _allowedFileExtensions(){return this._options.allowedFileExtensions}get _maxFileSize(){return this._options.maxFileSize}}var sr={create:!1,copy:!1,move:!1,delete:!1,rename:!1,upload:!1,download:!1};class pn{constructor(e){this._actions={},this._permissions=e||{},this._initCommands()}_initCommands(){this._commands=[{name:"create",text:z.format("dxFileManager-commandCreate"),icon:"newfolder",enabled:this._permissions.create,noFileItemRequired:!0},{name:"rename",text:z.format("dxFileManager-commandRename"),icon:"rename",enabled:this._permissions.rename,isSingleFileItemCommand:!0},{name:"move",text:z.format("dxFileManager-commandMove"),icon:"movetofolder",enabled:this._permissions.move},{name:"copy",text:z.format("dxFileManager-commandCopy"),icon:"copy",enabled:this._permissions.copy},{name:"delete",text:z.format("dxFileManager-commandDelete"),icon:"trash",enabled:this._permissions.delete},{name:"download",text:z.format("dxFileManager-commandDownload"),icon:"download",enabled:this._permissions.download},{name:"upload",text:z.format("dxFileManager-commandUpload"),icon:"upload",enabled:this._permissions.upload,noFileItemRequired:!0},{name:"refresh",text:z.format("dxFileManager-commandRefresh"),icon:"dx-filemanager-i dx-filemanager-i-refresh",enabled:!0,noFileItemRequired:!0},{name:"thumbnails",text:z.format("dxFileManager-commandThumbnails"),icon:"mediumiconslayout",enabled:!0,noFileItemRequired:!0},{name:"details",text:z.format("dxFileManager-commandDetails"),icon:"detailslayout",enabled:!0,noFileItemRequired:!0},{name:"clearSelection",text:z.format("dxFileManager-commandClearSelection"),icon:"remove",enabled:!0},{name:"showNavPane",hint:z.format("dxFileManager-commandShowNavPane"),icon:"menu",enabled:!1,noFileItemRequired:!0}],this._commandMap={},this._commands.forEach(e=>{this._commandMap[e.name]=e})}registerActions(e){this._actions=Y(this._actions,e)}executeCommand(e,t){var i=_t(e)?e:e.name,r=this._actions[i];if(r)return r(t)}updatePermissions(e){var t=Y({},sr,e);this._permissions=t,xe(this._permissions,i=>{this._commandMap[i].enabled=this._permissions[i]})}setCommandEnabled(e,t){var i=this.getCommandByName(e);i&&(i.enabled=t)}getCommandByName(e){return this._commandMap[e]}isCommandAvailable(e,t){var i=this.getCommandByName(e);if(!i||!i.enabled)return!1;if(i.noFileItemRequired)return!0;var r=t&&t.length||0;return r===0||t.some(n=>n.fileItem.isRoot()||n.fileItem.isParentFolder)?!1:e==="download"?t.every(n=>!n.fileItem.isDirectory):!i.isSingleFileItemCommand||r===1}}var _n="dx-filemanager-context-menu",fi={create:{},upload:{},download:{},rename:{},move:{},copy:{},delete:{},refresh:{beginGroup:!0}},mn=["beginGroup","closeMenuOnClick","disabled","icon","selectable","selected","text","visible"];class fn extends ye{_initMarkup(){this._initActions(),this._isVisible=!1;var e=A("<div>").appendTo(this.$element());this._contextMenu=this._createComponent(e,Zr,{cssClass:_n,showEvent:"",onItemClick:t=>this._onContextMenuItemClick(t.itemData.name,t),onShowing:t=>this._onContextMenuShowing(t),onShown:()=>this._onContextMenuShown(),onHidden:()=>this._onContextMenuHidden()}),super._initMarkup()}showAt(e,t,i,r){var{itemData:n,itemElement:a,isActionButton:o=!1}=r;this._isVisible&&this._onContextMenuHidden(),this._menuShowingContext={targetElement:a,itemData:n,fileItems:e,event:i,isActionButton:o};var d={of:t,at:"top left",my:"top left",offset:""};i?d.offset=i.offsetX+" "+i.offsetY:(d.my="left top",d.at="left bottom",d.boundaryOffset="1"),this._contextMenu.option({target:t,position:d}),this._contextMenu.show()}createContextMenuItems(e,t,i){this._targetFileItems=e,this._targetFileItem=ne(i)?i:e==null?void 0:e[0];var r=[],n=t||this.option("items");return n.forEach(a=>{var o=_t(a)?a:a.name,d=this._configureItemByCommandName(o,a,e,this._targetFileItem);this._isContextMenuItemAvailable(d,e)&&r.push(d)}),r}_isContextMenuItemAvailable(e,t){return!this._isDefaultItem(e.name)||!e._autoHide?Ie(e.visible,!0):this._isIsolatedCreationItemCommand(e.name)&&t&&t.length?!1:this._commandManager.isCommandAvailable(e.name,t)}_isIsolatedCreationItemCommand(e){return(e==="create"||e==="upload")&&this.option("isolateCreationItemCommands")}_isDefaultItem(e){return!!fi[e]}_configureItemByCommandName(e,t,i,r){if(!this._isDefaultItem(e)){var n=Y(!0,{},t);return n.originalItemData=t,this._addItemClickHandler(e,n),Array.isArray(t.items)&&(n.items=this.createContextMenuItems(i,t.items,r)),n}var a=this._createMenuItemByCommandName(e),o=fi[e];return Y(a,o),a.originalItemData=t,Ge(a,t,mn),ne(a.visible)||(a._autoHide=!0),e&&!a.name&&Y(a,{name:e}),a}_createMenuItemByCommandName(e){var{text:t,icon:i}=this._commandManager.getCommandByName(e),r={name:e,text:t,icon:i};return this._addItemClickHandler(e,r),r}_addItemClickHandler(e,t){t.onItemClick=i=>this._onContextMenuItemClick(e,i)}_onContextMenuItemClick(e,t){var i,r=Y(!0,{},t);if(r.itemData=t.itemData.originalItemData,r.fileSystemItem=(i=this._targetFileItem)===null||i===void 0?void 0:i.fileItem,r.viewArea=this.option("viewArea"),this._actions.onItemClick(r),this._isDefaultItem(e)){var n=this._isIsolatedCreationItemCommand(e)?null:this._targetFileItems;this._commandManager.executeCommand(e,n)}}_initActions(){this._actions={onContextMenuHidden:this._createActionByOption("onContextMenuHidden"),onContextMenuShowing:this._createActionByOption("onContextMenuShowing"),onItemClick:this._createActionByOption("onItemClick")}}_onContextMenuShowing(e){if(this._isVisible&&this._onContextMenuHidden(!0),e=Y(e,this._menuShowingContext,{options:this.option(),cancel:!1}),this._actions.onContextMenuShowing(e),!e.cancel){var t=this.createContextMenuItems(this._menuShowingContext.fileItems,null,this._menuShowingContext.fileSystemItem);this._contextMenu.option("dataSource",t)}}tryUpdateVisibleContextMenu(){if(this._isVisible){var e=this.createContextMenuItems(this._targetFileItems);this._contextMenu.option("dataSource",e)}}_onContextMenuShown(){this._isVisible=!0}_onContextMenuHidden(e){this._isVisible=!1,e||(this._menuShowingContext={}),this._contextMenu.option("visible",!1),this._raiseContextMenuHidden()}_raiseContextMenuHidden(){this._actions.onContextMenuHidden()}_getDefaultOptions(){return Y(super._getDefaultOptions(),{commandManager:null,onContextMenuHidden:null,onItemClick:null})}_optionChanged(e){var t=e.name;switch(t){case"commandManager":this.repaint();break;case"items":this.tryUpdateVisibleContextMenu();break;case"onItemClick":case"onContextMenuShowing":case"onContextMenuHidden":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}get _commandManager(){return this.option("commandManager")}}var gn="dx-filemanager-file-actions-button",vn="dx-filemanager-file-actions-button-activated",In="dx-state-active";class or extends ye{_initMarkup(){this._createClickAction();var e=A("<div>");this.$element().append(e).addClass(gn),this._button=this._createComponent(e,We,{icon:"overflow",stylingMode:"text",onClick:t=>this._raiseClick(t)}),super._initMarkup()}_createClickAction(){this._clickAction=this._createActionByOption("onClick")}_raiseClick(e){this._clickAction(e)}_getDefaultOptions(){return Y(super._getDefaultOptions(),{cssClass:"",onClick:null})}_optionChanged(e){var t=e.name;switch(t){case"cssClass":this.repaint();break;case"onClick":this._createClickAction();break;default:super._optionChanged(e)}}setActive(e){this.$element().toggleClass(vn,e),setTimeout(()=>this._button.$element().toggleClass(In,e))}}var Cn="dx-filemanager-dirs-tree",gi="dx-filemanager-focused-item",yn="dx-filemanager-dirs-tree-item-text",Sn="dx-treeview-item";class lr extends ye{_initMarkup(){this._initActions(),this._getCurrentDirectory=this.option("getCurrentDirectory"),this._createFileActionsButton=ke,this._storeExpandedState=this.option("storeExpandedState")||!1;var e=A("<div>").addClass(Cn).appendTo(this.$element()),t={dataStructure:"plain",rootValue:"",createChildren:this._onFilesTreeViewCreateSubDirectories.bind(this),itemTemplate:this._createFilesTreeViewItemTemplate.bind(this),keyExpr:"getInternalKey",parentIdExpr:"parentDirectory.getInternalKey",displayExpr:i=>i.getDisplayName(),hasItemsExpr:"fileItem.hasSubDirectories",onItemClick:i=>this._actions.onDirectoryClick(i),onItemExpanded:i=>this._onFilesTreeViewItemExpanded(i),onItemCollapsed:i=>this._onFilesTreeViewItemCollapsed(i),onItemRendered:i=>this._onFilesTreeViewItemRendered(i),onContentReady:()=>this._actions.onFilesTreeViewContentReady()};this._contextMenu&&(this._contextMenu.option("onContextMenuHidden",()=>this._onContextMenuHidden()),t.onItemContextMenu=i=>this._onFilesTreeViewItemContextMenu(i),this._createFileActionsButton=(i,r)=>this._createComponent(i,or,r)),this._filesTreeView=this._createComponent(e,qr,t)}_initActions(){this._actions={onDirectoryClick:this._createActionByOption("onDirectoryClick"),onFilesTreeViewContentReady:this._createActionByOption("onFilesTreeViewContentReady")}}_render(){super._render();var e=this;setTimeout(()=>{e._updateFocusedElement()})}_onFilesTreeViewCreateSubDirectories(e){var t=this.option("getDirectories"),i=e&&e.itemData||null;return t&&t(i,!0)}_onFilesTreeViewItemRendered(e){var{itemData:t}=e,i=this._getCurrentDirectory();i&&i.fileItem.equals(t.fileItem)&&(this._updateFocusedElement(),this._restoreScrollTopPosition())}_onFilesTreeViewItemExpanded(e){var{itemData:t}=e;this._storeExpandedState&&(t.expanded=!0)}_onFilesTreeViewItemCollapsed(e){var{itemData:t}=e;this._storeExpandedState&&(t.expanded=!1)}_createFilesTreeViewItemTemplate(e,t,i){var r=A(i),n=r.closest(this._filesTreeViewItemSelector);n.data("item",e);var a=St(e.icon),o=A("<span>").text(e.getDisplayName()).addClass(yn),d=A("<div>");r.append(a,o,d),this._createFileActionsButton(d,{onClick:g=>this._onFileItemActionButtonClick(g)})}_onFilesTreeViewItemContextMenu(e){var{itemElement:t,event:i}=e;i.preventDefault(),i.stopPropagation();var r=A(t).data("item");this._contextMenu.showAt([r],t,i,{itemData:r,itemElement:t})}_onFileItemActionButtonClick(e){var{component:t,element:i,event:r}=e;r.stopPropagation();var n=t.$element().closest(this._filesTreeViewItemSelector),a=n.data("item"),o={itemData:a,itemElement:n,isActionButton:!0};this._contextMenu.showAt([a],i,r,o),this._activeFileActionsButton=t,this._activeFileActionsButton.setActive(!0)}_onContextMenuHidden(){this._activeFileActionsButton&&this._activeFileActionsButton.setActive(!1)}toggleNodeDisabledState(e,t){var i=this._getNodeByKey(e);if(i){var r=this._filesTreeView.option("items"),n=r.map(a=>a.getInternalKey()).indexOf(i.getInternalKey());n!==-1&&this._filesTreeView.option("items[".concat(n,"].disabled"),t)}}_saveScrollTopPosition(){Me()&&(this._scrollTopPosition=this._filesTreeView.getScrollable().scrollTop())}_restoreScrollTopPosition(){!Me()||!Qi(this._scrollTopPosition)||setTimeout(()=>this._filesTreeView.getScrollable().scrollTo(this._scrollTopPosition))}_updateFocusedElement(){var e=this._getCurrentDirectory(),t=this._getItemElementByKey(e==null?void 0:e.getInternalKey());this._$focusedElement&&this._$focusedElement.toggleClass(gi,!1),this._$focusedElement=t||A(),this._$focusedElement.toggleClass(gi,!0)}_getNodeByKey(e){var t;return(t=this._filesTreeView)===null||t===void 0?void 0:t._getNode(e)}_getPublicNode(e){for(var t,i=[...(t=this._filesTreeView)===null||t===void 0?void 0:t.getNodes()];i.length;){var r=i.shift();if(r.itemData.getInternalKey()===e)return r;r.children.length&&i.push(...r.children)}}_getItemElementByKey(e){var t=this._getNodeByKey(e);if(t){var i=this._filesTreeView._getNodeElement(t);if(i)return i.children(this._filesTreeViewItemSelector)}return null}_getDefaultOptions(){return Y(super._getDefaultOptions(),{storeExpandedState:!1,initialFolder:null,contextMenu:null,getItems:null,getCurrentDirectory:null,onDirectoryClick:null})}_optionChanged(e){var t=e.name;switch(t){case"storeExpandedState":this._storeExpandedState=this.option(t);break;case"getItems":case"rootFolderDisplayName":case"initialFolder":case"contextMenu":this.repaint();break;case"getCurrentDirectory":this.getCurrentDirectory=this.option(t);break;case"onDirectoryClick":case"onFilesTreeViewContentReady":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}get _filesTreeViewItemSelector(){return".".concat(Sn)}get _contextMenu(){return this.option("contextMenu")}toggleDirectoryExpandedState(e,t){var i=new re,r=this._getPublicNode(e==null?void 0:e.getInternalKey());if(!r)return i.reject().promise();if(r.expanded===t||r.itemsLoaded&&!r.itemData.fileItem.hasSubDirectories)return i.resolve().promise();var n=t?"expandItem":"collapseItem";return this._filesTreeView[n](e.getInternalKey())}refresh(){this._$focusedElement=null,this._saveScrollTopPosition(),this._filesTreeView.option("dataSource",[])}updateCurrentDirectory(){this._disposed||(this._updateFocusedElement(),this._storeExpandedState&&this._updateExpandedStateToCurrentDirectory())}_updateExpandedStateToCurrentDirectory(){return this.toggleDirectoryExpandedStateRecursive(this._getCurrentDirectory().parentDirectory,!0)}toggleDirectoryExpandedStateRecursive(e,t){for(var i=[],r=e;r;r=r.parentDirectory)i.unshift(r);return this.toggleDirectoryLineExpandedState(i,t)}toggleDirectoryLineExpandedState(e,t){return e.length?this.toggleDirectoryExpandedState(e.shift(),t).then(()=>this.toggleDirectoryLineExpandedState(e,t)):new re().resolve().promise()}}var bn="dx-filemanager-files-view",En="dxFileManager_open";class dr extends ye{_init(){this._initActions(),this._lockFocusedItemProcessing=!1,this._focusedItemKey=this.option("focusedItemKey"),super._init()}_initMarkup(){this._needResetScrollPosition=!1,this.$element().addClass(bn);var e=De(Xr,En);ce.on(this.$element(),e,this._getItemSelector(),this._onItemDblClick.bind(this)),super._initMarkup()}_initActions(){this._actions={onError:this._createActionByOption("onError"),onSelectionChanged:this._createActionByOption("onSelectionChanged"),onFocusedItemChanged:this._createActionByOption("onFocusedItemChanged"),onSelectedItemOpened:this._createActionByOption("onSelectedItemOpened"),onContextMenuShowing:this._createActionByOption("onContextMenuShowing"),onItemListDataLoaded:this._createActionByOption("onItemListDataLoaded")}}_getDefaultOptions(){return Y(super._getDefaultOptions(),{selectionMode:"single",selectedItemKeys:[],focusedItemKey:void 0,contextMenu:null,getItems:null,getItemThumbnail:null,onError:null,onSelectionChanged:null,onFocusedItemChanged:null,onSelectedItemOpened:null,onContextMenuShowing:null})}_optionChanged(e){var t=e.name;switch(t){case"selectionMode":case"contextMenu":case"getItems":case"getItemThumbnail":this.repaint();break;case"selectedItemKeys":this._setSelectedItemKeys(e.value);break;case"focusedItemKey":this._lockFocusedItemProcessing||this._setFocusedItemKey(e.value);break;case"onError":case"onSelectedItemOpened":case"onSelectionChanged":case"onFocusedItemChanged":case"onContextMenuShowing":case"onItemListDataLoaded":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}_getItems(){return this._getItemsInternal().done(e=>{this._itemCount=e.length,this._itemCount===0&&this._resetFocus();var t=this._findParentDirectoryItem(e);this._hasParentDirectoryItem=!!t,this._parentDirectoryItemKey=t?t.fileItem.key:null}).always(()=>{this._onDataLoaded()})}_getItemsInternal(){var e=this.option("getItems"),t=e?e():[];return fe(t)}_raiseOnError(e){this._actions.onError({error:e})}_raiseSelectionChanged(e){this._actions.onSelectionChanged(e)}_raiseFocusedItemChanged(e){this._actions.onFocusedItemChanged(e)}_raiseSelectedItemOpened(e){this._actions.onSelectedItemOpened({fileItemInfo:e})}_raiseContextMenuShowing(e){this._actions.onContextMenuShowing(e)}_raiseItemListDataLoaded(){this._actions.onItemListDataLoaded()}_onDataLoaded(){var e;this._raiseItemListDataLoaded(),(e=this._refreshDeferred)===null||e===void 0||e.resolve()}_onContentReady(){this._needResetScrollPosition&&(this._resetScrollTopPosition(),this._needResetScrollPosition=!1)}_tryRaiseSelectionChanged(e){var{selectedItemInfos:t,selectedItems:i,selectedItemKeys:r,currentSelectedItemKeys:n,currentDeselectedItemKeys:a}=e,o=this._findParentDirectoryItem(this.getSelectedItems());o&&this._deselectItem(o);var d=!this._hasParentDirectoryItem;d=d||this._hasValidKeys(n)||this._hasValidKeys(a),d&&(t=this._filterOutItemByPredicate(t,g=>g.fileItem.key===this._parentDirectoryItemKey),i=this._filterOutParentDirectory(i),r=this._filterOutParentDirectoryKey(r,!0),n=this._filterOutParentDirectoryKey(n,!0),a=this._filterOutParentDirectoryKey(a,!0),this._raiseSelectionChanged({selectedItemInfos:t,selectedItems:i,selectedItemKeys:r,currentSelectedItemKeys:n,currentDeselectedItemKeys:a}))}_onFocusedItemChanged(e){this._focusedItemKey!==e.itemKey&&(this._focusedItemKey=e.itemKey,this._lockFocusedItemProcessing=!0,this.option("focusedItemKey",e.itemKey),this._lockFocusedItemProcessing=!1,this._raiseFocusedItemChanged(e))}_resetFocus(){}_resetScrollTopPosition(){Me()&&setTimeout(()=>{var e;return(e=this._getScrollable())===null||e===void 0?void 0:e.scrollTo(0)})}_getScrollable(){}_getItemThumbnail(e){var t=this.option("getItemThumbnail");return t?t(e):{thumbnail:""}}_getItemThumbnailContainer(e){var{thumbnail:t,cssClass:i}=this._getItemThumbnail(e),r=St(t).addClass(this._getItemThumbnailCssClass());return i&&r.addClass(i),r}_getItemThumbnailCssClass(){return""}_getItemSelector(){}_onItemDblClick(e){}_isDesktop(){return Ye.real().deviceType==="desktop"}_showContextMenu(e,t,i,r){this._contextMenu.showAt(e,t,i,r)}get _contextMenu(){return this.option("contextMenu")}_findParentDirectoryItem(e){for(var t=0;t<e.length;t++){var i=e[t];if(this._isParentDirectoryItem(i))return i}return null}_getFileItemsForContextMenu(e){var t=this.getSelectedItems();return this._isParentDirectoryItem(e)&&t.push(e),t}_isParentDirectoryItem(e){return e.fileItem.isParentFolder}_hasValidKeys(e){return e.length>1||e.length===1&&e[0]!==this._parentDirectoryItemKey}_filterOutParentDirectory(e,t){return this._filterOutItemByPredicate(e,i=>i.key===this._parentDirectoryItemKey,t)}_filterOutParentDirectoryKey(e,t){return this._filterOutItemByPredicate(e,i=>i===this._parentDirectoryItemKey,t)}_filterOutItemByPredicate(e,t,i){for(var r=e,n=-1,a=0;a<e.length;a++)if(t(e[a])){n=a;break}return n!==-1&&(i&&(r=[...e]),r.splice(n,1)),r}_isMultipleSelectionMode(){return this.option("selectionMode")==="multiple"}_deselectItem(e){}_setSelectedItemKeys(e){}_setFocusedItemKey(e){}_createDataSource(){return{store:new Vr({key:"fileItem.key",load:this._getItems.bind(this)})}}getSelectedItems(){}clearSelection(){}selectItem(){}refresh(e,t){}}var wn="dx-filemanager-details",An="dx-filemanager-details-item-thumbnail",xn="dx-filemanager-details-item-name",Dn="dx-filemanager-details-item-name-wrapper",Mn="dx-filemanager-details-item-is-directory",Fn="dx-filemanager-parent-directory-item",Pn="dx-data-row",vi={thumbnail:{caption:"",calculateSortValue:"isDirectory",width:36,alignment:"center",cssClass:Mn},name:{caption:z.format("dxFileManager-listDetailsColumnCaptionName")},dateModified:{caption:z.format("dxFileManager-listDetailsColumnCaptionDateModified"),width:110,hidingPriority:1},size:{caption:z.format("dxFileManager-listDetailsColumnCaptionFileSize"),width:90,alignment:"right",hidingPriority:0},isParentFolder:{caption:"isParentFolder",visible:!1,sortIndex:0,sortOrder:"asc"}};class Tn extends dr{_initMarkup(){this._itemCount=0,this._focusedItem=null,this._hasParentDirectoryItem=!1,this._parentDirectoryItemKey=null,this._selectAllCheckBox=null,this._selectAllCheckBoxUpdating=!1,this.$element().addClass(wn),this._createFilesView(),this._contextMenu.option("onContextMenuHidden",()=>this._onContextMenuHidden()),super._initMarkup()}_createFilesView(){var e=A("<div>").appendTo(this.$element()),t=this._isMultipleSelectionMode()?"multiple":"none";this._filesView=this._createComponent(e,Jr,{dataSource:this._createDataSource(),hoverStateEnabled:!0,selection:{mode:t,showCheckBoxesMode:this._isDesktop()?"onClick":"none"},selectedRowKeys:this.option("selectedItemKeys"),focusedRowKey:this.option("focusedItemKey"),focusedRowEnabled:!0,allowColumnResizing:!0,scrolling:{mode:"virtual"},sorting:{mode:"single",showSortIndexes:!1},loadPanel:{shading:!0},showColumnLines:!1,showRowLines:!1,columnHidingEnabled:!1,columns:this._createColumns(),onEditorPreparing:this._onEditorPreparing.bind(this),onRowPrepared:this._onRowPrepared.bind(this),onContextMenuPreparing:this._onContextMenuPreparing.bind(this),onSelectionChanged:this._onFilesViewSelectionChanged.bind(this),onFocusedRowChanged:this._onFilesViewFocusedRowChanged.bind(this),onOptionChanged:this._onFilesViewOptionChanged.bind(this),onContentReady:this._onContentReady.bind(this)})}_createColumns(){var e=this.option("detailColumns");e=e.slice(0),e=e.map(i=>{var r=i;return _t(i)&&(r={dataField:i}),this._getPreparedColumn(r)});var t=this.option("customizeDetailColumns");return Ce(t)&&(e=t(e)),e.push(this._getPreparedColumn({dataField:"isParentFolder"})),e.forEach(i=>this._updateColumnDataField(i)),e}_getPreparedColumn(e){var t={},i="";if(this._isDefaultColumn(e.dataField)){var r=Y(!0,{},vi[e.dataField]);switch(i=r.cssClass||"",e.dataField){case"thumbnail":r.cellTemplate=this._createThumbnailColumnCell.bind(this),r.calculateSortValue="fileItem.".concat(r.calculateSortValue);break;case"name":r.cellTemplate=this._createNameColumnCell.bind(this),r.caption=z.format("dxFileManager-listDetailsColumnCaptionName");break;case"size":r.calculateCellValue=this._calculateSizeColumnCellValue.bind(this),r.caption=z.format("dxFileManager-listDetailsColumnCaptionFileSize"),r.calculateSortValue=n=>n.fileItem.isDirectory?-1:n.fileItem.size;break;case"dateModified":r.caption=z.format("dxFileManager-listDetailsColumnCaptionDateModified")}Y(!0,t,r)}return Ge(t,e,["alignment","caption","dataField","dataType","hidingPriority","sortIndex","sortOrder","visible","visibleIndex","width"]),e.cssClass&&(i="".concat(i," ").concat(e.cssClass)),i&&(t.cssClass=i),t}_updateColumnDataField(e){var t=this._isDefaultColumn(e.dataField)?"":"dataItem.";return e.dataField="fileItem."+t+e.dataField,e}_isDefaultColumn(e){return!!vi[e]}_onFileItemActionButtonClick(e){var{component:t,element:i,event:r}=e;r.stopPropagation();var n=t.$element().closest(this._getItemSelector()),a=n.data("item");this._selectItem(a);var o={itemData:a,itemElement:n,isActionButton:!0},d=this._getFileItemsForContextMenu(a);this._showContextMenu(d,i,r,o),this._activeFileActionsButton=t,this._activeFileActionsButton.setActive(!0)}_onContextMenuHidden(){this._activeFileActionsButton&&this._activeFileActionsButton.setActive(!1)}_getItemThumbnailCssClass(){return An}_getItemSelector(){return".".concat(Pn)}_onItemDblClick(e){var t=A(e.currentTarget),i=t.data("item");this._raiseSelectedItemOpened(i)}_isAllItemsSelected(){var e=this._hasParentDirectoryItem?this._itemCount-1:this._itemCount,t=this._filesView.option("selectedRowKeys");return t.length?t.length>=e?!0:void 0:!1}_onEditorPreparing(e){var{component:t,command:i,row:r,parentType:n,editorOptions:a}=e;this._filesView||(this._filesView=t),i==="select"&&r?this._isParentDirectoryItem(r.data)&&(a.disabled=!0):n==="headerRow"&&(a.onInitialized=o=>{var{component:d}=o;this._selectAllCheckBox=d},a.value=this._isAllItemsSelected(),a.onValueChanged=o=>this._onSelectAllCheckBoxValueChanged(o))}_onSelectAllCheckBoxValueChanged(e){var{event:t,previousValue:i,value:r}=e;if(!t){i&&!this._selectAllCheckBoxUpdating&&this._selectAllCheckBox&&this._selectAllCheckBox.option("value",i);return}this._isAllItemsSelected()!==r&&(r?this._filesView.selectAll():this._filesView.deselectAll(),t.preventDefault())}_onRowPrepared(e){var{rowType:t,rowElement:i,data:r}=e;if(t==="data"){var n=A(i);n.data("item",r),this._isParentDirectoryItem(r)&&n.addClass(Fn)}}_onContextMenuPreparing(e){if(this._isDesktop()){var t=null,i={};e.row&&e.row.rowType==="data"&&(i=e.row.data,this._selectItem(i),t=this._getFileItemsForContextMenu(i));var r=Y({},{targetElement:e.target==="content"&&ne(e.row)?this._filesView.getRowElement(e.rowIndex):void 0,itemData:i,options:this._contextMenu.option(),event:e.event,isActionButton:!1,cancel:!1});this._raiseContextMenuShowing(r),e.items=r.cancel?[]:this._contextMenu.createContextMenuItems(t,null,i)}}_onFilesViewSelectionChanged(e){var{component:t,selectedRowsData:i,selectedRowKeys:r,currentSelectedRowKeys:n,currentDeselectedRowKeys:a}=e;this._filesView=this._filesView||t,this._selectAllCheckBox&&(this._selectAllCheckBoxUpdating=!0,this._selectAllCheckBox.option("value",this._isAllItemsSelected()),this._selectAllCheckBoxUpdating=!1);var o=i.map(d=>d.fileItem);this._tryRaiseSelectionChanged({selectedItemInfos:i,selectedItems:o,selectedItemKeys:r,currentSelectedItemKeys:n,currentDeselectedItemKeys:a})}_onFilesViewFocusedRowChanged(e){var t;if(!this._isMultipleSelectionMode()){var i;this._selectItemSingleSelection((i=e.row)===null||i===void 0?void 0:i.data)}var r=((t=e.row)===null||t===void 0?void 0:t.data.fileItem)||null;this._onFocusedItemChanged({item:r,itemKey:r==null?void 0:r.key,itemElement:e.rowElement})}_onFilesViewOptionChanged(e){var{fullName:t}=e;t.indexOf("sortOrder")>-1&&this._filesView.columnOption("isParentFolder",{sortOrder:"asc",sortIndex:0})}_resetFocus(){this._setFocusedItemKey(void 0)}_createThumbnailColumnCell(e,t){this._getItemThumbnailContainer(t.data).appendTo(e)}_createNameColumnCell(e,t){var i=A("<div>"),r=A("<span>").text(t.data.fileItem.name).addClass(xn),n=A("<div>").append(r,i).addClass(Dn);A(e).append(n),this._createComponent(i,or,{onClick:a=>this._onFileItemActionButtonClick(a)})}_calculateSizeColumnCellValue(e){return e.fileItem.isDirectory?"":ir(e.fileItem.size)}_selectItem(e){var t=this._isMultipleSelectionMode()?this._selectItemMultipleSelection:this._selectItemSingleSelection;t.call(this,e)}_deselectItem(e){this._filesView.deselectRows([e.fileItem.key])}_selectItemSingleSelection(e){if(!this._focusedItem||!e||this._focusedItem.fileItem.key!==e.fileItem.key){var t=this._focusedItem;this._focusedItem=e;var i=[];t&&i.push(t.fileItem.key);var r=[],n=[];e&&!this._isParentDirectoryItem(e)&&(r.push(e.fileItem),n.push(e.fileItem.key)),this._raiseSelectionChanged({selectedItems:r,selectedItemKeys:n,currentSelectedItemKeys:[...n],currentDeselectedItemKeys:i})}}_selectItemMultipleSelection(e){var{fileItem:t}=e;if(!this._filesView.isRowSelected(t.key)){var i=this._filesView.getController("selection"),r=i.isSelectionWithCheckboxes();this._filesView.selectRows([t.key],r)}}_setSelectedItemKeys(e){this._filesView.option("selectedRowKeys",e)}_setFocusedItemKey(e){var t;(t=this._filesView)===null||t===void 0||t.option("focusedRowKey",e)}clearSelection(){this._isMultipleSelectionMode()?this._filesView.clearSelection():this._filesView.option("focusedRowIndex",-1)}refresh(e,t){var i={dataSource:this._createDataSource()};e&&Object.prototype.hasOwnProperty.call(e,"focusedItemKey")&&(ne(e.focusedItemKey)?i.focusedRowKey=e.focusedItemKey:i.focusedRowIndex=-1);var r=!ne(i.focusedRowKey)&&i.focusedRowIndex===-1;return r&&t===tt.NAVIGATION&&(i.paging={pageIndex:0},this._needResetScrollPosition=!0),this._filesView.option(i),this._refreshDeferred=new re,this._refreshDeferred.promise()}_getScrollable(){return this._filesView.getScrollable()}getSelectedItems(){return this._isMultipleSelectionMode()?this._filesView.getSelectedRowsData():this._focusedItem&&!this._isParentDirectoryItem(this._focusedItem)?[this._focusedItem]:[]}}var On="dx-filemanager-thumbnails-view-port",kn="dx-filemanager-thumbnails-container",Rn="dx-filemanager-thumbnails-item",Ln="dx-filemanager-thumbnails-item-name",Bn="dx-filemanager-thumbnails-item-spacer",Nn="dxFileManagerItemData",Un="dxFileManagerThumbnailsListBox",Ii=De(Kr.name,Un);class zn extends Wr{_initMarkup(){this._initActions(),this._lockFocusedItemProcessing=!1,this.$element().addClass(On),this._renderScrollView(),this._renderItemsContainer(),this._createScrollViewControl(),super._initMarkup(),this.onFocusedItemChanged=this._onFocusedItemChanged.bind(this),this._layoutUtils=new $n(this._scrollView,this.$element(),this._$itemContainer,this.itemElements().first()),this._syncFocusedItemKey()}_initActions(){this._actions={onItemEnterKeyPressed:this._createActionByOption("onItemEnterKeyPressed"),onFocusedItemChanged:this._createActionByOption("onFocusedItemChanged")}}_initTemplates(){super._initTemplates(),this._itemThumbnailTemplate=this.option("itemThumbnailTemplate"),this._getTooltipText=this.option("getTooltipText"),this._templateManager.addDefaultTemplates({item:new Gr((function(e,t,i){var r=this._getDefaultItemTemplate(i,e);e.append(r)}).bind(this),["fileItem"],this.option("integrationOptions.watchMethod"))})}_createScrollViewControl(){this._scrollView||(this._scrollView=this._createComponent(this._$scrollView,zt,{scrollByContent:!0,scrollByThumb:!0,useKeyboard:!1,showScrollbar:"onHover"}))}_renderScrollView(){this._$scrollView||(this._$scrollView=A("<div>").appendTo(this.$element()))}getScrollable(){return this._scrollView}_renderItemsContainer(){this._$itemContainer||(this._$itemContainer=A("<div>").addClass(kn).appendTo(this._$scrollView))}_render(){super._render(),this._detachEventHandlers(),this._attachEventHandlers()}_clean(){this._detachEventHandlers(),super._clean()}_supportedKeys(){return Y(super._supportedKeys(),{upArrow(e){this._beforeKeyProcessing(e),this._processArrowKeys(-1,!1,e)},downArrow(e){this._beforeKeyProcessing(e),this._processArrowKeys(1,!1,e)},home(e){this._beforeKeyProcessing(e),this._processHomeEndKeys(0,!0,e)},end(e){this._beforeKeyProcessing(e),this._processHomeEndKeys(this._getItemsLength()-1,!0,e)},pageUp(e){this._beforeKeyProcessing(e),this._processPageChange(!0,e)},pageDown(e){this._beforeKeyProcessing(e),this._processPageChange(!1,e)},enter(e){this._beforeKeyProcessing(e),this._actions.onItemEnterKeyPressed(this._getFocusedItem())},A(e){this._beforeKeyProcessing(e),ni(e)&&this.selectAll()}})}_beforeKeyProcessing(e){e.preventDefault(),this._layoutUtils.reset()}_processArrowKeys(e,t,i){var r=this._getFocusedItem();if(r){if(!t){var n=this._layoutUtils.getLayoutModel();if(!n)return;e*=n.itemPerRowCount}var a=this._getIndexByItem(r)+e;this._focusItemByIndex(a,!0,i)}}_processHomeEndKeys(e,t,i){this._focusItemByIndex(e,t,i)}_processPageChange(e,t){var i=this._getFocusedItem();if(i){var r=this._layoutUtils.getLayoutModel();if(r){var n=this._layoutUtils.createItemLayoutModel(this._getIndexByItem(i)),a=e?r.rowPerPageRate:-r.rowPerPageRate,o=n.itemRowIndex-a,d=e?Math.ceil:Math.floor,g=d(o),y=g*r.itemPerRowCount+n.itemColumnIndex;y<0?y=0:y>=this._getItemsLength()&&(y=this._getItemsLength()-1),this._focusItemByIndex(y,!0,t)}}}_processLongTap(e){var t=this._closestItemElement(A(e.target)),i=this._getIndexByItemElement(t);this._selection.changeItemSelection(i,{control:!0})}_attachEventHandlers(){this.option("selectionMode")==="multiple"&&ce.on(this._itemContainer(),Ii,".".concat(this._itemContentClass()),e=>{this._processLongTap(e),e.stopPropagation()}),ce.on(this._itemContainer(),"mousedown selectstart",e=>{e.shiftKey&&e.preventDefault()})}_detachEventHandlers(){ce.off(this._itemContainer(),Ii),ce.off(this._itemContainer(),"mousedown selectstart")}_itemContainer(){return this._$itemContainer}_itemClass(){return Rn}_itemDataKey(){return Nn}_getDefaultItemTemplate(e,t){t.attr("title",this._getTooltipText(e));var i=this._itemThumbnailTemplate(e),r=A("<div>").addClass(Bn),n=A("<div>").addClass(Ln).text(e.fileItem.name);t.append(i,r,n)}_itemSelectHandler(e){var t={};this.option("selectionMode")==="multiple"&&(this._isPreserveSelectionMode||(this._isPreserveSelectionMode=ni(e)||e.shiftKey),t={control:this._isPreserveSelectionMode,shift:e.shiftKey});var i=this._getIndexByItemElement(e.currentTarget);this._selection.changeItemSelection(i,t)}_initSelectionModule(){super._initSelectionModule();var e=Y(this._selection.options,{selectedKeys:this.option("selectedItemKeys"),onSelectionChanged:t=>{this.option("selectedItems",this._getItemsByKeys(t.selectedItemKeys,t.selectedItems)),this._updateSelectedItems(t)}});this._selection=new Hr(e)}_updateSelectedItems(e){var t=e.addedItemKeys,i=e.removedItemKeys;if(this._rendered&&(t.length||i.length)){var r=this._selectionChangePromise;if(!this._rendering){var n=[],a,o=[];this._editStrategy.beginCache();for(var d=0;d<i.length;d++)a=this._getIndexByKey(i[d]),o.push(a),this._removeSelection(a);for(var g=0;g<t.length;g++)a=this._getIndexByKey(t[g]),n.push(a),this._addSelection(a);this._editStrategy.endCache(),this._updateSelection(n,o)}fe(r).done(()=>this._fireSelectionChangeEvent(e))}}_fireSelectionChangeEvent(e){this._createActionByOption("onSelectionChanged",{excludeValidators:["disabled","readOnly"]})(e)}_updateSelection(e,t){var i=this.getSelectedItems().length;i===0&&(this._isPreserveSelectionMode=!1)}_normalizeSelectedItems(){var e=this._getKeysByItems(this.option("selectedItems")),t=this._selection.getSelectedItemKeys();return this._compareKeys(t,e)||this._selection.setSelection(e),new re().resolve().promise()}_focusOutHandler(){}_getItems(){return this.option("items")||[]}_getItemsLength(){return this._getItems().length}_getIndexByItemElement(e){return this._editStrategy.getNormalizedIndex(e)}_getItemByIndex(e){return this._getItems()[e]}_getFocusedItem(){return this.getItemByItemElement(this.option("focusedElement"))}_focusItem(e,t){this.option("focusedElement",this.getItemElementByItem(e)),t&&this._layoutUtils.scrollToItem(this._getIndexByItem(e))}_focusItemByIndex(e,t,i){if(e>=0&&e<this._getItemsLength()){var r=this._getItemByIndex(e);this._focusItem(r,t,i)}}_syncFocusedItemKey(){this._syncFocusedItemKeyDeferred||(this._syncFocusedItemKeyDeferred=new re);var e=this._syncFocusedItemKeyDeferred;if(this._dataSource&&this._dataSource.isLoading())return e.promise();var t=this.option("focusedItemKey");if(ne(t)){var i=this.option("items"),r=i.find(n=>this.keyOf(n)===t);r?(this._focusItem(r,!0),e.resolve()):(this.option("focusedItemKey",void 0),e.reject())}else e.resolve();return this._syncFocusedItemKeyDeferred=null,e.promise()}_onFocusedItemChanged(){var e=this._getFocusedItem(),t=this.keyOf(e),i=this.option("focusedItemKey");t!==i&&(this._lockFocusedItemProcessing=!0,this.option("focusedItemKey",t),this._lockFocusedItemProcessing=!1,this._raiseFocusedItemChanged(e))}_raiseFocusedItemChanged(e){var t={item:e,itemElement:this.option("focusedElement")};this._actions.onFocusedItemChanged(t)}_changeItemSelection(e,t){if(this.isItemSelected(e)!==t){var i=this.getItemElementByItem(e),r=this._getIndexByItemElement(i);this._selection.changeItemSelection(r,{control:this._isPreserveSelectionMode})}}_chooseSelectOption(){return"selectedItemKeys"}getSelectedItems(){return this._selection.getSelectedItems()}getItemElementByItem(e){return this._editStrategy.getItemElement(e)}getItemByItemElement(e){return this._getItemByIndex(this._getIndexByItemElement(e))}selectAll(){this.option("selectionMode")==="multiple"&&(this._selection.selectAll(),this._isPreserveSelectionMode=!0)}selectItem(e){this._changeItemSelection(e,!0)}deselectItem(e){this._changeItemSelection(e,!1)}clearSelection(){this._selection.deselectAll()}_optionChanged(e){switch(e.name){case"items":this._layoutUtils&&this._layoutUtils.updateItems(this.itemElements().first()),super._optionChanged(e);break;case"focusedItemKey":if(this._lockFocusedItemProcessing)break;ne(e.value)?this._syncFocusedItemKey().done(()=>{var t=this._getFocusedItem();this._raiseFocusedItemChanged(t)}):(this.option("focusedElement",null),this._raiseFocusedItemChanged(null));break;case"onItemEnterKeyPressed":case"onFocusedItemChanged":this._actions[e.name]=this._createActionByOption(e.name);break;default:super._optionChanged(e)}}}class $n{constructor(e,t,i,r){this._layoutModel=null,this._scrollView=e,this._$viewPort=t,this._$itemContainer=i,this._$item=r}updateItems(e){this._$item=e}reset(){this._layoutModel=null}getLayoutModel(){return this._layoutModel||(this._layoutModel=this._createLayoutModel()),this._layoutModel}_createLayoutModel(){if(!this._$item)return null;var e=xr(this._$item,!0);if(e===0)return null;var t=Dr(this._$item,!0),i=Mr(this._$itemContainer),r=Hi(this._$viewPort),n=this._scrollView.scrollTop(),a=n+r,o=Math.floor(i/e),d=r/t;return{itemWidth:e,itemHeight:t,viewPortWidth:i,viewPortHeight:r,viewPortScrollTop:n,viewPortScrollBottom:a,itemPerRowCount:o,rowPerPageRate:d}}createItemLayoutModel(e){var t=this.getLayoutModel();if(!t)return null;var i=Math.floor(e/t.itemPerRowCount),r=e%t.itemPerRowCount,n=i*t.itemHeight,a=n+t.itemHeight;return{itemRowIndex:i,itemColumnIndex:r,itemTop:n,itemBottom:a}}scrollToItem(e){var t=this.getLayoutModel();if(t){var i=Math.floor(e/t.itemPerRowCount),r=i*t.itemHeight,n=r+t.itemHeight,a=t.viewPortScrollTop;r<t.viewPortScrollTop?a=r:n>t.viewPortScrollBottom&&(a=n-t.viewPortHeight),this._scrollView.scrollTo(a)}}}var Vn="dx-filemanager-thumbnails",Kn="dx-filemanager-thumbnails-item",Wn="dx-filemanager-thumbnails-item-thumbnail",Gn="dxFileManager_thumbnails";class Hn extends dr{_initMarkup(){super._initMarkup(),this.$element().addClass(Vn);var e=De(jr,Gn);ce.on(this.$element(),e,this._onContextMenu.bind(this)),this._createItemList()}_createItemList(){var e=this._isMultipleSelectionMode()?"multiple":"single",t=A("<div>").appendTo(this.$element());this._itemList=this._createComponent(t,zn,{dataSource:this._createDataSource(),selectionMode:e,selectedItemKeys:this.option("selectedItemKeys"),focusedItemKey:this.option("focusedItemKey"),activeStateEnabled:!0,hoverStateEnabled:!0,loopItemFocus:!1,focusStateEnabled:!0,onItemEnterKeyPressed:this._tryOpen.bind(this),itemThumbnailTemplate:this._getItemThumbnailContainer.bind(this),getTooltipText:this._getTooltipText.bind(this),onSelectionChanged:this._onItemListSelectionChanged.bind(this),onFocusedItemChanged:this._onItemListFocusedItemChanged.bind(this),onContentReady:this._onContentReady.bind(this)})}_onContextMenu(e){if(e.preventDefault(),e.stopPropagation(),!!this._isDesktop()){var t=null,i=A(e.target).closest(this._getItemSelector()),r=null;i.length>0&&(r=this._itemList.getItemByItemElement(i),this._itemList.selectItem(r),t=this._getFileItemsForContextMenu(r));var n={itemData:r,itemElement:i.length?i:void 0};this._showContextMenu(t,e.target,e,n)}}_getItemThumbnailCssClass(){return Wn}_getItemSelector(){return".".concat(Kn)}_getTooltipText(e){var t=e.fileItem;if(t.tooltipText)return t.tooltipText;var i="".concat(t.name,`\r
`);return t.isDirectory||(i+="".concat(z.format("dxFileManager-listThumbnailsTooltipTextSize"),": ").concat(ir(t.size),`\r
`)),i+="".concat(z.format("dxFileManager-listThumbnailsTooltipTextDateModified"),": ").concat(t.dateModified),i}_onItemDblClick(e){var t=A(e.currentTarget),i=this._itemList.getItemByItemElement(t);this._tryOpen(i)}_tryOpen(e){e&&this._raiseSelectedItemOpened(e)}_getItemsInternal(){return super._getItemsInternal().then(e=>{var t=new re;return setTimeout(()=>t.resolve(e)),t.promise()})}_disableDragging(){return!1}_getDefaultOptions(){return Y(super._getDefaultOptions(),{focusStateEnabled:!0})}_onItemListSelectionChanged(e){var{addedItemKeys:t,removedItemKeys:i}=e,r=this.getSelectedItems(),n=r.map(o=>o.fileItem),a=n.map(o=>o.key);this._tryRaiseSelectionChanged({selectedItemInfos:r,selectedItems:n,selectedItemKeys:a,currentSelectedItemKeys:t,currentDeselectedItemKeys:i})}_onItemListFocusedItemChanged(e){var{item:t,itemElement:i}=e;this._isMultipleSelectionMode()||this._selectItemSingleSelection(t);var r=(t==null?void 0:t.fileItem)||null;this._onFocusedItemChanged({item:r,itemKey:r==null?void 0:r.key,itemElement:i||void 0})}_getScrollable(){return this._itemList.getScrollable()}_setSelectedItemKeys(e){this._itemList.option("selectedItemKeys",e)}_setFocusedItemKey(e){this._itemList.option("focusedItemKey",e)}refresh(e,t){var i={dataSource:this._createDataSource()};return e&&Object.prototype.hasOwnProperty.call(e,"focusedItemKey")&&(i.focusedItemKey=e.focusedItemKey),e&&Object.prototype.hasOwnProperty.call(e,"selectedItemKeys")&&(i.selectedItemKeys=e.selectedItemKeys),!ne(i.focusedItemKey)&&t===tt.NAVIGATION&&(this._needResetScrollPosition=!0),this._itemList.option(i),this._refreshDeferred=new re,this._refreshDeferred.promise()}_deselectItem(e){var t=this._itemList.getItemElementByItem(e);this._itemList.unselectItem(t)}_selectItemSingleSelection(e){e?this._itemList.selectItem(e):this._itemList.clearSelection()}clearSelection(){this._itemList.clearSelection()}getSelectedItems(){return this._itemList.getSelectedItems()}}var Et="dx-filemanager-toolbar",Ci="dx-filemanager-general-toolbar",jn="dx-filemanager-file-toolbar",Zn=Et+"-separator-item",qn=Et+"-viewmode-item",Xn=Et+"-has-large-icon",Yn="dx-filemanager-view-switcher-popup",yi={showNavPane:{location:"before"},create:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},upload:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},refresh:{location:"after",showText:"inMenu",cssClass:Xn,compactMode:{showText:"inMenu",locateInMenu:"auto"}},switchView:{location:"after"},download:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},move:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},copy:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},rename:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},delete:{location:"before",compactMode:{showText:"inMenu"}},clearSelection:{location:"after",locateInMenu:"never",compactMode:{showText:"inMenu"}},separator:{location:"before"}},Jn=["visible","location","locateInMenu","disabled","showText"],Qn=["accessKey","elementAttr","height","hint","icon","stylingMode","tabIndex","text","width"],ea=["separator","switchView"],Si={default:"dx-filemanager-i dx-filemanager-i-refresh",progress:"dx-filemanager-i dx-filemanager-i-progress",success:"dx-filemanager-i dx-filemanager-i-done",error:"dx-filemanager-i dx-filemanager-i-danger"},ta=500;class ia extends ye{_init(){super._init(),this._generalToolbarVisible=!0,this._refreshItemState={message:"",status:"default"}}_initMarkup(){this._createItemClickedAction(),this._$viewSwitcherPopup=A("<div>").addClass(Yn),this._generalToolbar=this._createToolbar(this.option("generalItems"),!this._generalToolbarVisible),this._fileToolbar=this._createToolbar(this.option("fileItems"),this._generalToolbarVisible),this._$viewSwitcherPopup.appendTo(this.$element()),this.$element().addClass(Et+" "+Ci)}_render(){super._render();var e=this._getVisibleToolbar();this._checkCompactMode(e)}_clean(){delete this._commandManager,delete this._itemClickedAction,delete this._$viewSwitcherPopup,delete this._generalToolbar,delete this._fileToolbar,super._clean()}_dimensionChanged(e){if(!e||e!=="height"){var t=this._getVisibleToolbar();this._checkCompactMode(t)}}_getVisibleToolbar(){return this._generalToolbarVisible?this._generalToolbar:this._fileToolbar}_createToolbar(e,t){var i=this._getPreparedItems(e),r=A("<div>").appendTo(this.$element()),n=this._createComponent(r,Qr,{items:i,visible:!t,onItemClick:a=>this._raiseItemClicked(a)});return n.compactMode=!1,n}_getPreparedItems(e){return e=e.map(t=>{var i=t;_t(t)&&(i={name:t});var r=i.name,n=this._configureItemByCommandName(r,i);return n.originalItemData=t,r!=="separator"&&this._setItemVisibleAvailable(n),n}),this._updateSeparatorsVisibility(e),e}_updateSeparatorsVisibility(e,t){var i=!1,r=this._getMenuItems(t),n={before:!1,center:!1,after:!1},a={before:this._getItemsInGroup(e,r,"before"),center:this._getItemsInGroup(e,r,"center"),after:this._getItemsInGroup(e,r,"after")};return e.forEach((o,d)=>{var g=o.location;if(o.name==="separator"){var y=n[g]&&this._groupHasItemsAfter(a[g]);o.visible!==y&&(i=!0,o.visible=y),n[g]=!1}else this._isItemInMenu(r,o)||(n[g]=n[g]||o.visible),a[g].shift()}),t&&i&&t.repaint(),i}_getMenuItems(e){var t=e?e._getMenuItems():[];return t.map(i=>i.originalItemData)}_isItemInMenu(e,t){return!!e.length&&Ie(t.locateInMenu,"never")!=="never"&&e.indexOf(t.originalItemData)!==-1}_getItemsInGroup(e,t,i){return e.filter(r=>r.location===i&&!this._isItemInMenu(t,r))}_groupHasItemsAfter(e){for(var t=0;t<e.length;t++)if(e[t].name!=="separator"&&e[t].visible)return!0;return!1}_configureItemByCommandName(e,t){var i,r={},n=this._commandManager.getCommandByName(e);switch(n&&(r=this._createCommandItem(n)),e){case"separator":r=this._createSeparatorItem();break;case"switchView":r=this._createViewModeItem()}if(this._isDefaultItem(e)){var a=yi[e];Y(!0,r,a);var o=r.cssClass||"";Ge(r,t,Jn),ne(t.options)&&Ge(r.options,t.options,Qn),Ge(r.options,t,["text","icon"]),t.cssClass&&(o="".concat(o," ").concat(t.cssClass)),o&&(r.cssClass=o),ne(t.visible)||(r._autoHide=!0),r.widget==="dxButton"&&(r.showText==="inMenu"&&!ne(r.options.hint)&&(r.options.hint=r.options.text),r.compactMode&&!ne(r.options.hint)&&this._configureHintForCompactMode(r))}else Y(!0,r,t),r.widget||(r.widget="dxButton"),r.widget==="dxButton"&&!r.compactMode&&!r.showText&&r.options&&r.options.icon&&r.options.text&&(r.compactMode={showText:"inMenu"});return e&&!r.name&&Y(r,{name:e}),r.location=Ie(r.location,"before"),ne((i=r.options)===null||i===void 0?void 0:i.stylingMode)||(r.widget==="dxButton"&&Y(!0,r,{options:{stylingMode:"text"}}),r.widget==="dxSelectBox"&&Y(!0,r,{options:{stylingMode:"filled"}})),r}_isDefaultItem(e){return!!yi[e]}_createCommandItem(e){return{widget:"dxButton",options:{text:e.text,hint:e.hint,commandText:e.text,icon:e.icon,stylingMode:"text",onClick:t=>this._executeCommand(e)}}}_createSeparatorItem(){return{template:(e,t,i)=>{A(i).addClass(Zn)}}}_createViewModeItem(){var e=["details","thumbnails"].map(i=>{var{text:r,icon:n}=this._commandManager.getCommandByName(i);return{name:i,text:r,icon:n}}),t=this.option("itemViewMode")==="thumbnails"?1:0;return{cssClass:qn,widget:"dxDropDownButton",options:{items:e,keyExpr:"name",selectedItemKey:this.option("itemViewMode"),displayExpr:" ",hint:e[t].text,stylingMode:"text",showArrowIcon:!1,useSelectMode:!0,dropDownOptions:{container:this._$viewSwitcherPopup},onItemClick:i=>this._executeCommand(i.itemData.name)}}}_configureHintForCompactMode(e){e.options.hint="",e.compactMode.options=e.compactMode.options||{},e.compactMode.options.hint=e.options.text}_checkCompactMode(e){e.compactMode&&this._toggleCompactMode(e,!1);var t=this._toolbarHasItemsOverflow(e);e.compactMode!==t?(e.compactMode||this._toggleCompactMode(e,t),e.compactMode=t):e.compactMode&&this._toggleCompactMode(e,!0)}_toolbarHasItemsOverflow(e){var t=ze(e.$element()),i=e._getItemsWidth();return t<i}_toggleCompactMode(e,t){var i=!1,r=e.option("items");r.forEach(n=>{if(n.compactMode){var a=null;t?(n.saved=this._getCompactModeOptions(n,n._available),a=n.compactMode):a=n.saved;var o=this._getCompactModeOptions(a,n._available);Y(!0,n,o),i=!0}}),i=this._updateSeparatorsVisibility(r)||i,i&&e.repaint(),this._updateSeparatorsVisibility(r,e)}_getCompactModeOptions(e,t){var{showText:i,locateInMenu:r,options:n}=e;return{visible:t,showText:Ie(i,"always"),locateInMenu:Ie(r,"never"),options:{hint:n==null?void 0:n.hint}}}_ensureAvailableCommandsVisible(e){var t=!1,i=e.option("items");i.forEach(r=>{if(r.name!=="separator"){var n=r._available;this._setItemVisibleAvailable(r),r._available!==n&&(t=!0)}}),t=this._updateSeparatorsVisibility(i)||t,t&&e.repaint(),this._updateSeparatorsVisibility(i,e)}_setItemVisibleAvailable(e){var t,i=(t=e.originalItemData)===null||t===void 0?void 0:t.visible;e._available=this._isToolbarItemAvailable(e),e.visible=ne(i)?i:e._available}_fileToolbarHasEffectiveItems(){var e=this._fileToolbar.option("items");return e.some(t=>this._isFileToolbarItemAvailable(t))}_executeCommand(e){this._commandManager.executeCommand(e)}_isToolbarItemAvailable(e){return!this._isDefaultItem(e.name)||!e._autoHide?Ie(e.visible,!0):e.name==="refresh"?this._generalToolbarVisible||!!this._isRefreshVisibleInFileToolbar:ea.indexOf(e.name)>-1?!0:this._isCommandAvailable(e.name)}_isFileToolbarItemAvailable(e){var{name:t,visible:i}=e;return!this._isDefaultItem(t)&&Ie(i,!0)||t!=="clearSelection"&&t!=="refresh"&&this._isCommandAvailable(t)}_isCommandAvailable(e){return this._commandManager.isCommandAvailable(e,this.option("contextItems"))}_updateItemInToolbar(e,t,i){e.beginUpdate();for(var r=e.option("items"),n=0;n<r.length;n++){var a=r[n];if(a.name===t){e.option("items[".concat(n,"]"),i);break}}e.endUpdate()}_raiseItemClicked(e){var t=Y(!0,{},e);t.itemData=e.itemData.originalItemData,this._itemClickedAction(t)}_createItemClickedAction(){this._itemClickedAction=this._createActionByOption("onItemClick")}_getDefaultOptions(){return Y(super._getDefaultOptions(),{commandManager:null,generalItems:[],fileItems:[],contextItems:[],itemViewMode:"details",onItemClick:null})}_optionChanged(e){var t=e.name;switch(t){case"commandManager":case"itemViewMode":case"generalItems":case"fileItems":this.repaint();break;case"contextItems":this._update();break;case"onItemClick":this._itemClickedAction=this._createActionByOption(t);break;default:super._optionChanged(e)}}updateItemPermissions(){this.repaint(),this._restoreRefreshItemState()}_restoreRefreshItemState(){this.updateRefreshItem(this._refreshItemState.message,this._refreshItemState.status)}updateRefreshItem(e,t){var i=null,r=z.format("dxFileManager-commandRefresh"),n="inMenu";this._isRefreshVisibleInFileToolbar=!1,this._refreshItemState={message:e,status:t},t==="default"?i={options:{icon:Si.default}}:(i={options:{icon:Si[t]}},this._isRefreshVisibleInFileToolbar=!0,r=e,n="always");var a=Y({},i,{visible:this._isRefreshVisibleInFileToolbar});this._applyRefreshItemOptions(i,a),this._refreshItemTextTimeout=this._updateRefreshItemText(t==="progress",r,n)}_updateRefreshItemText(e,t,i){var r={showText:i,options:{text:t}};if(e)return setTimeout(()=>{this._applyRefreshItemOptions(r),this._refreshItemTextTimeout=void 0},ta);this._refreshItemTextTimeout&&clearTimeout(this._refreshItemTextTimeout),this._applyRefreshItemOptions(r)}_applyRefreshItemOptions(e,t){t||(t=Y({},e)),this._updateItemInToolbar(this._generalToolbar,"refresh",e),this._updateItemInToolbar(this._fileToolbar,"refresh",t)}_update(){var e=this.option("contextItems").length===0||!this._fileToolbarHasEffectiveItems();this._generalToolbarVisible!==e&&(this._generalToolbar.option("visible",e),this._fileToolbar.option("visible",!e),this._generalToolbarVisible=e,this.$element().toggleClass(Ci,e),this.$element().toggleClass(jn,!e));var t=this._getVisibleToolbar();this._ensureAvailableCommandsVisible(t),this._checkCompactMode(t)}get _commandManager(){return this.option("commandManager")}}var He={moveTo(m){var e=m.$element,t=m.position,i=m.direction||"left",r={},n;switch(i){case"right":r.transform="translate("+t+"px, 0px)",n="custom";break;case"left":r.left=t,n="slide";break;case"top":case"bottom":r.top=t,n="slide"}Ee.animate(e,{type:n,to:r,duration:m.duration,complete:m.complete})},margin(m){var e=m.$element,t=m.margin,i=m.direction||"left",r={};r["margin"+Ut(i,!0)]=t,Ee.animate(e,{to:r,duration:m.duration,complete:m.complete})},fade(m,e,t,i){Ee.animate(m,{type:"fade",to:e.to,from:e.from,duration:t,complete:i})},size(m){var e=m.$element,t=m.size,i=m.direction||"left",r=m.marginTop||0,n=m.duration,a={};i==="right"||i==="left"?a.width=t:a.height=t,i==="bottom"&&(a.marginTop=r),Ee.animate(e,{to:a,duration:n,complete:m.complete})},complete(m){Ee.stop(m,!0)}};class Vt{constructor(e){this._drawer=e}getDrawerInstance(){return this._drawer}renderPanelContent(e){var t=this.getDrawerInstance(),i=t._getTemplate(t.option("template"));i&&i.render({container:t.content(),onRendered:()=>{e.resolve()}})}renderPosition(e,t){var i=new re,r=new re,n=this.getDrawerInstance();e&&fe.apply(A,[i,r]).done(()=>{n._animationCompleteHandler()}),this._internalRenderPosition(e,i),e||n.resizeViewContent(),this.renderShaderVisibility(e,t,r)}_getPanelOffset(e){var t=this.getDrawerInstance(),i=t.isHorizontalDirection()?t.getRealPanelWidth():t.getRealPanelHeight();return e?-(i-t.getMaxSize()):-(i-t.getMinSize())}_getPanelSize(e){return e?this.getDrawerInstance().getMaxSize():this.getDrawerInstance().getMinSize()}renderShaderVisibility(e,t,i){var r=this.getDrawerInstance(),n=r.option("opened"),a=n?{from:0,to:1}:{from:1,to:0};e?He.fade(A(r._$shader),a,t,()=>{this._drawer._toggleShaderVisibility(n),i.resolve()}):(r._toggleShaderVisibility(n),r._$shader.css("opacity",a.to))}getPanelContent(){return A(this.getDrawerInstance().content())}setPanelSize(e){this.refreshPanelElementSize(e)}refreshPanelElementSize(e){var t=this.getDrawerInstance(),i=this._getPanelSize(t.option("opened"));t.isHorizontalDirection()?ji(A(t.content()),e?t.getRealPanelWidth():i):Zi(A(t.content()),e?t.getRealPanelHeight():i)}isViewContentFirst(){return!1}onPanelContentRendered(){}}class bi extends Vt{_internalRenderPosition(e,t){var i=this.getDrawerInstance(),r=this._getPanelSize(!0),n=this._getPanelSize(i.option("opened"))*i._getPositionCorrection();if(A(i.content()).css(i.isHorizontalDirection()?"width":"height",r),i.getMinSize()){var a="padding";switch(i.calcTargetPosition()){case"left":a+="Right";break;case"right":a+="Left";break;case"top":a+="Bottom";break;case"bottom":a+="Top"}A(i.viewContent()).css(a,i.getMinSize())}e?He.moveTo({$element:A(i.viewContent()),position:n,direction:i.calcTargetPosition(),duration:i.option("animationDuration"),complete:()=>{t.resolve()}}):i.isHorizontalDirection()?Qe(A(i.viewContent()),{left:n}):Qe(A(i.viewContent()),{top:n})}onPanelContentRendered(){A(this.getDrawerInstance().viewContent()).addClass("dx-theme-background-color")}}class ra extends Vt{_internalRenderPosition(e,t){var i=this.getDrawerInstance(),r=i.calcTargetPosition(),n=A(i.content()),a=this._getPanelSize(i.option("opened")),o=this._getPanelOffset(i.option("opened")),d=i.option("revealMode");e?d==="slide"?He.margin({complete:()=>{t.resolve()},$element:n,duration:i.option("animationDuration"),direction:r,margin:o}):d==="expand"&&He.size({complete:()=>{t.resolve()},$element:n,duration:i.option("animationDuration"),direction:r,size:a}):d==="slide"?n.css("margin"+Ut(r,!0),o):d==="expand"&&n.css(i.isHorizontalDirection()?"width":"height",a)}isViewContentFirst(e,t){return(t?e==="left":e==="right")||e==="bottom"}}class na extends Vt{renderPanelContent(e){delete this._initialPosition;var t=this.getDrawerInstance(),{opened:i,minSize:r}=t.option();t._overlay=t._createComponent(t.content(),Fr,{shading:!1,container:t.content(),visualContainer:t.getOverlayTarget(),position:this._getOverlayPosition(),width:i?"auto":r||0,height:"100%",templatesRenderAsynchronously:t.option("templatesRenderAsynchronously"),animation:{show:{duration:0}},onPositioned:(function(n){this._fixOverlayPosition(n.component.$content())}).bind(this),contentTemplate:t.option("template"),onContentReady:n=>{e.resolve(),this._processOverlayZIndex(n.component.content())},visible:!0,propagateOutsideClick:!0})}_fixOverlayPosition(e){var t=Ie(this._initialPosition,{left:0,top:0});Qe(e,t),this.getDrawerInstance().calcTargetPosition()==="right"&&e.css("left","auto"),this.getDrawerInstance().calcTargetPosition()==="bottom"&&(e.css("top","auto"),e.css("bottom","0px"))}_getOverlayPosition(){var e=this.getDrawerInstance(),t=e.calcTargetPosition(),i={};switch(t){case"left":i={my:"top left",at:"top left"};break;case"right":i={my:e.option("rtlEnabled")?"top left":"top right",at:"top right"};break;case"top":case"bottom":i={my:t,at:t}}return i.of=e.getOverlayTarget(),i}refreshPanelElementSize(e){var t=this.getDrawerInstance(),i=t.getOverlay();t.isHorizontalDirection()?(i.option("height","100%"),i.option("width",e?t.getRealPanelWidth():this._getPanelSize(t.option("opened")))):(i.option("width",ze(t.getOverlayTarget())),i.option("height",e?t.getRealPanelHeight():this._getPanelSize(t.option("opened"))))}onPanelContentRendered(){this._updateViewContentStyles()}_updateViewContentStyles(){var e=this.getDrawerInstance();A(e.viewContent()).css("padding"+Ut(e.calcTargetPosition(),!0),e.option("minSize")),A(e.viewContent()).css("transform","inherit")}_internalRenderPosition(e,t){var i=this.getDrawerInstance(),r=A(i.content()),n=i.getOverlay().$content(),a=i.option("revealMode"),o=i.calcTargetPosition(),d=this._getPanelSize(i.option("opened")),g=this._getPanelOffset(i.option("opened"))*i._getPositionCorrection(),y=i.getRealPanelHeight()-d;this._updateViewContentStyles(),e?a==="slide"?(this._initialPosition=i.isHorizontalDirection()?{left:g}:{top:g},He.moveTo({complete:()=>{t.resolve()},duration:i.option("animationDuration"),direction:o,$element:r,position:g})):a==="expand"&&(this._initialPosition={left:0},Qe(n,this._initialPosition),He.size({complete:()=>{t.resolve()},duration:i.option("animationDuration"),direction:o,$element:n,size:d,marginTop:y})):a==="slide"?(this._initialPosition=i.isHorizontalDirection()?{left:g}:{top:g},Qe(r,this._initialPosition)):a==="expand"&&(this._initialPosition={left:0},Qe(n,this._initialPosition),i.isHorizontalDirection()?A(n).css("width",d):(A(n).css("height",d),o==="bottom"&&A(n).css("marginTop",y)))}getPanelContent(){return A(this.getDrawerInstance().getOverlay().content())}_processOverlayZIndex(e){var t=A(e).get(0).style,i=t.zIndex||1;this.getDrawerInstance().setZIndex(i)}isViewContentFirst(e){return e==="right"||e==="bottom"}}var Ve="dx-drawer",aa="dx-drawer-wrapper",Ei="dx-drawer-panel-content",sa="dx-drawer-content",wi="dx-drawer-shader",Ai="dx-state-invisible",oa="dx-drawer-opened",Pt="content",xi="panel",Kt=ye.inherit({_getDefaultOptions(){return Y(this.callBase(),{position:"left",opened:!1,minSize:null,maxSize:null,shading:!1,template:xi,openedStateMode:"shrink",revealMode:"slide",animationEnabled:!0,animationDuration:400,closeOnOutsideClick:!1,contentTemplate:Pt})},_init(){this.callBase(),this._initStrategy(),this.$element().addClass(Ve),this._whenAnimationCompleted=void 0,this._whenPanelContentRendered=void 0,this._whenPanelContentRefreshed=void 0,this._$wrapper=A("<div>").addClass(aa),this._$viewContentWrapper=A("<div>").addClass(sa),this._$wrapper.append(this._$viewContentWrapper),this.$element().append(this._$wrapper)},_initStrategy(){switch(this.option("openedStateMode")){case"push":this._strategy=new bi(this);break;case"shrink":this._strategy=new ra(this);break;case"overlap":this._strategy=new na(this);break;default:this._strategy=new bi(this)}},_getAnonymousTemplateName:function(){return Pt},_initTemplates(){var m={};m[xi]=new si,m[Pt]=new si,this._templateManager.addDefaultTemplates(m),this.callBase()},_viewContentWrapperClickHandler(m){var e=this.option("closeOnOutsideClick");Ce(e)&&(e=e(m)),e&&this.option("opened")&&(this.stopAnimations(),this.option("shading")&&m.preventDefault(),this.hide())},_initMarkup(){this.callBase(),this._toggleOpenedStateClass(this.option("opened")),this._renderPanelContentWrapper(),this._refreshOpenedStateModeClass(),this._refreshRevealModeClass(),this._renderShader(),this._refreshPositionClass(),this._whenPanelContentRendered=new re,this._strategy.renderPanelContent(this._whenPanelContentRendered),this._strategy.onPanelContentRendered(),this._renderViewContent(),ce.off(this._$viewContentWrapper,Bt),ce.on(this._$viewContentWrapper,Bt,this._viewContentWrapperClickHandler.bind(this)),this._refreshWrapperChildrenOrder()},_render(){this._initMinMaxSize(),this.callBase(),this._whenPanelContentRendered.always(()=>{this._initMinMaxSize(),this._strategy.refreshPanelElementSize(this.option("revealMode")==="slide"||!this.isHorizontalDirection()),this._renderPosition(this.option("opened"),!0),this._removePanelManualPosition()})},_removePanelManualPosition(){this._$panelContentWrapper.attr("manualposition")&&(this._$panelContentWrapper.removeAttr("manualPosition"),this._$panelContentWrapper.css({position:"",top:"",left:"",right:"",bottom:""}))},_renderPanelContentWrapper(){this._$panelContentWrapper=A("<div>").addClass(Ei);var m=this.calcTargetPosition();this.option("openedStateMode")==="push"&&["top","bottom"].indexOf(m)>-1&&this._$panelContentWrapper.addClass(Ei+"-push-top-or-bottom"),this.option("openedStateMode")!=="overlap"&&!this.option("opened")&&!this.option("minSize")&&(this._$panelContentWrapper.attr("manualposition",!0),this._$panelContentWrapper.css({position:"absolute",top:"-10000px",left:"-10000px",right:"auto",bottom:"auto"})),this._$wrapper.append(this._$panelContentWrapper)},_refreshOpenedStateModeClass(m){m&&this.$element().removeClass(Ve+"-"+m),this.$element().addClass(Ve+"-"+this.option("openedStateMode"))},_refreshPositionClass(m){m&&this.$element().removeClass(Ve+"-"+m),this.$element().addClass(Ve+"-"+this.calcTargetPosition())},_refreshWrapperChildrenOrder(){var m=this.calcTargetPosition();this._strategy.isViewContentFirst(m,this.option("rtlEnabled"))?this._$wrapper.prepend(this._$viewContentWrapper):this._$wrapper.prepend(this._$panelContentWrapper)},_refreshRevealModeClass(m){m&&this.$element().removeClass(Ve+"-"+m),this.$element().addClass(Ve+"-"+this.option("revealMode"))},_renderViewContent(){var m=this.option("contentTemplate"),e=this._getTemplate(m);if(e){var t=e.render({container:this.viewContent(),noModel:!0,transclude:this._templateManager.anonymousTemplateName===m});t.hasClass("ng-scope")&&A(this._$viewContentWrapper).children().not(".".concat(wi)).replaceWith(t)}},_renderShader(){this._$shader=this._$shader||A("<div>").addClass(wi),this._$shader.appendTo(this.viewContent()),this._toggleShaderVisibility(this.option("opened"))},_initSize(){this._initMinMaxSize()},_initMinMaxSize(){var m=this.isHorizontalDirection()?this.getRealPanelWidth():this.getRealPanelHeight();this._maxSize=this.option("maxSize")||m,this._minSize=this.option("minSize")||0},calcTargetPosition(){var m=this.option("position"),e=this.option("rtlEnabled"),t=m;return m==="before"?t=e?"right":"left":m==="after"&&(t=e?"left":"right"),t},getOverlayTarget(){return this._$wrapper},getOverlay(){return this._overlay},getMaxSize(){return this._maxSize},getMinSize(){return this._minSize},getRealPanelWidth(){return Me()?ne(this.option("templateSize"))?this.option("templateSize"):It(this._getPanelTemplateElement()).width:0},getRealPanelHeight(){return Me()?ne(this.option("templateSize"))?this.option("templateSize"):It(this._getPanelTemplateElement()).height:0},_getPanelTemplateElement(){var m=this._strategy.getPanelContent(),e=m;return m.children().length&&(e=m.children().eq(0),m.hasClass("dx-overlay-content")&&e.hasClass("dx-template-wrapper")&&e.children().length&&(e=e.children().eq(0))),e.get(0)},getElementHeight(m){var e=m.children();return e.length?It(e.eq(0).get(0)).height:It(m.get(0)).height},isHorizontalDirection(){var m=this.calcTargetPosition();return m==="left"||m==="right"},stopAnimations(m){Ee.stop(this._$shader,m),Ee.stop(A(this.content()),m),Ee.stop(A(this.viewContent()),m);var e=this.getOverlay();e&&Ee.stop(A(e.$content()),m)},setZIndex(m){this._$shader.css("zIndex",m-1),this._$panelContentWrapper.css("zIndex",m)},resizeContent(){this.resizeViewContent},resizeViewContent(){Pr(this.viewContent())},_isInvertedPosition(){var m=this.calcTargetPosition();return m==="right"||m==="bottom"},_renderPosition(m,e,t){if(this.stopAnimations(t),!!Me()){A(this.viewContent()).css("paddingLeft",0),A(this.viewContent()).css("paddingRight",0),A(this.viewContent()).css("paddingTop",0),A(this.viewContent()).css("paddingBottom",0);var i=this.option("animationEnabled");e===!0&&(i=!1),m&&this._toggleShaderVisibility(m),this._strategy.renderPosition(i,this.option("animationDuration"))}},_animationCompleteHandler(){this.resizeViewContent(),this._whenAnimationCompleted&&this._whenAnimationCompleted.resolve()},_getPositionCorrection(){return this._isInvertedPosition()?-1:1},_dispose(){He.complete(A(this.viewContent())),this.callBase()},_visibilityChanged(m){m&&this._dimensionChanged()},_dimensionChanged(){this._initMinMaxSize(),this._strategy.refreshPanelElementSize(this.option("revealMode")==="slide"),this._renderPosition(this.option("opened"),!0)},_toggleShaderVisibility(m){this.option("shading")?(this._$shader.toggleClass(Ai,!m),this._$shader.css("visibility",m?"visible":"hidden")):this._$shader.toggleClass(Ai,!0)},_toggleOpenedStateClass(m){this.$element().toggleClass(oa,m)},_refreshPanel(){A(this.viewContent()).css("left",0),A(this.viewContent()).css("transform","translate(0px, 0px)"),A(this.viewContent()).removeClass("dx-theme-background-color"),this._removePanelContentWrapper(),this._removeOverlay(),this._renderPanelContentWrapper(),this._refreshWrapperChildrenOrder(),this._whenPanelContentRefreshed=new re,this._strategy.renderPanelContent(this._whenPanelContentRefreshed),this._strategy.onPanelContentRendered(),Me()&&this._whenPanelContentRefreshed.always(()=>{this._strategy.refreshPanelElementSize(this.option("revealMode")==="slide"),this._renderPosition(this.option("opened"),!0,!0),this._removePanelManualPosition()})},_clean(){this._cleanFocusState(),this._removePanelContentWrapper(),this._removeOverlay()},_removePanelContentWrapper(){this._$panelContentWrapper&&this._$panelContentWrapper.remove()},_removeOverlay(){this._overlay&&(this._overlay.dispose(),delete this._overlay,delete this._$panelContentWrapper)},_optionChanged(m){switch(m.name){case"width":this.callBase(m),this._dimensionChanged();break;case"opened":this._renderPosition(this.option("opened")),this._toggleOpenedStateClass(m.value);break;case"position":this._refreshPositionClass(m.previousValue),this._refreshWrapperChildrenOrder(),this._invalidate();break;case"contentTemplate":case"template":this._invalidate();break;case"openedStateMode":this._initStrategy(),this._refreshOpenedStateModeClass(m.previousValue),this._refreshPanel();break;case"minSize":case"maxSize":this._initMinMaxSize(),this._renderPosition(this.option("opened"),!0);break;case"revealMode":this._refreshRevealModeClass(m.previousValue),this._refreshPanel();break;case"shading":this._toggleShaderVisibility(this.option("opened"));break;case"animationEnabled":case"animationDuration":case"closeOnOutsideClick":break;default:this.callBase(m)}},content(){return ai(this._$panelContentWrapper)},viewContent(){return ai(this._$viewContentWrapper)},show(){return this.toggle(!0)},hide(){return this.toggle(!1)},toggle(m){var e=m===void 0?!this.option("opened"):m;return this._whenAnimationCompleted=new re,this.option("opened",e),this._whenAnimationCompleted.promise()}});pt("dxDrawer",Kt);var la="dx-trackbar",da="dx-trackbar-container",ha="dx-trackbar-range",ca="dx-trackbar-wrapper",hr=tr.inherit({_getDefaultOptions:function(){return Y(this.callBase(),{min:0,max:100,value:0})},_initMarkup:function(){this.$element().addClass(la),this._renderWrapper(),this._renderContainer(),this._renderRange(),this._renderValue(),this._setRangeStyles(),this.callBase()},_render:function(){this.callBase(),this._setRangeStyles(this._rangeStylesConfig())},_renderWrapper:function(){this._$wrapper=A("<div>").addClass(ca).appendTo(this.$element())},_renderContainer:function(){this._$bar=A("<div>").addClass(da).appendTo(this._$wrapper)},_renderRange:function(){this._$range=A("<div>").addClass(ha).appendTo(this._$bar)},_renderValue:function(){var m=this.option("value"),e=this.option("min"),t=this.option("max");if(!(e>t)){if(m<e){this.option("value",e),this._currentRatio=0;return}if(m>t){this.option("value",t),this._currentRatio=1;return}var i=e===t?0:(m-e)/(t-e);!this._needPreventAnimation&&this._setRangeStyles({width:100*i+"%"}),this.setAria({valuemin:this.option("min"),valuemax:t,valuenow:m}),this._currentRatio=i}},_rangeStylesConfig:function(){return{width:100*this._currentRatio+"%"}},_setRangeStyles:function(m){if(Ee.stop(this._$range),!m){this._$range.css({width:0});return}this._needPreventAnimation||!Me()||Ee.animate(this._$range,{type:"custom",duration:100,to:m})},_optionChanged:function(m){switch(m.name){case"value":this._renderValue(),this.callBase(m);break;case"max":case"min":this._renderValue();break;default:this.callBase(m)}},_dispose:function(){Ee.stop(this._$range),this.callBase()}});pt("dxTrackBar",hr);var ua="dx-progressbar",pa="dx-progressbar-container",_a="dx-progressbar-range-container",ma="dx-progressbar-range",fa="dx-progressbar-wrapper",ga="dx-progressbar-status",va="dx-progressbar-animating-container",Di="dx-progressbar-animating-segment",wt=hr.inherit({_getDefaultOptions:function(){return Y(this.callBase(),{value:0,statusFormat:function(m){return"Progress: "+Math.round(100*m)+"%"},showStatus:!0,onComplete:null,activeStateEnabled:!1,statusPosition:"bottom left",_animatingSegmentCount:0})},_defaultOptionsRules:function(){return this.callBase().concat([{device:function(m){return m.platform==="android"},options:{_animatingSegmentCount:2}}])},_initMarkup:function(){this._renderStatus(),this._createCompleteAction(),this.callBase(),this.$element().addClass(ua),this._$wrapper.addClass(fa),this._$bar.addClass(pa),this.setAria("role","progressbar"),A("<div>").addClass(_a).appendTo(this._$wrapper).append(this._$bar),this._$range.addClass(ma),this._toggleStatus(this.option("showStatus"))},_useTemplates:function(){return!1},_createCompleteAction:function(){this._completeAction=this._createActionByOption("onComplete")},_renderStatus:function(){this._$status=A("<div>").addClass(ga)},_renderIndeterminateState:function(){this._$segmentContainer=A("<div>").addClass(va);for(var m=this.option("_animatingSegmentCount"),e=0;e<m;e++)A("<div>").addClass(Di).addClass(Di+"-"+(e+1)).appendTo(this._$segmentContainer);this._$segmentContainer.appendTo(this._$wrapper)},_toggleStatus:function(m){var e=this.option("statusPosition").split(" ");m?e[0]==="top"||e[0]==="left"?this._$status.prependTo(this._$wrapper):this._$status.appendTo(this._$wrapper):this._$status.detach(),this._togglePositionClass()},_togglePositionClass:function(){var m=this.option("statusPosition"),e=m.split(" ");this._$wrapper.removeClass("dx-position-top-left dx-position-top-right dx-position-bottom-left dx-position-bottom-right dx-position-left dx-position-right");var t="dx-position-"+e[0];e[1]&&(t+="-"+e[1]),this._$wrapper.addClass(t)},_toggleIndeterminateState:function(m){m?(this._renderIndeterminateState(),this._$bar.toggle(!1)):(this._$bar.toggle(!0),this._$segmentContainer.remove(),delete this._$segmentContainer)},_renderValue:function(){var m=this.option("value"),e=this.option("max");if(!m&&m!==0){this._toggleIndeterminateState(!0);return}this._$segmentContainer&&this._toggleIndeterminateState(!1),m===e&&this._completeAction(),this.callBase(),this._setStatus()},_setStatus:function(){var m=this.option("statusFormat");Ce(m)?m=m.bind(this):m=function(t){return t};var e=m(this._currentRatio,this.option("value"));this._$status.text(e)},_dispose:function(){this._$status.remove(),this.callBase()},_optionChanged:function(m){switch(m.name){case"statusFormat":this._setStatus();break;case"showStatus":this._toggleStatus(m.value);break;case"statusPosition":this._toggleStatus(this.option("showStatus"));break;case"onComplete":this._createCompleteAction();break;case"_animatingSegmentCount":break;default:this.callBase(m)}}});pt("dxProgressBar",wt);const Co=Object.freeze(Object.defineProperty({__proto__:null,default:wt},Symbol.toStringTag,{value:"Module"}));var Fe="dx-filemanager-progress-panel",Ia="".concat(Fe,"-container"),Ca="".concat(Fe,"-title"),ya="".concat(Fe,"-title-text"),Sa="".concat(Fe,"-close-button"),ba="".concat(Fe,"-infos-container"),Mi="".concat(Fe,"-separator"),Ea="".concat(Fe,"-info"),wa="".concat(Fe,"-common"),Aa="".concat(Fe,"-info-with-details"),xa="".concat(Fe,"-details"),$e="dx-filemanager-progress-box",Da="".concat($e,"-error"),Fi="".concat($e,"-without-close-button"),Ma="".concat($e,"-image"),Fa="".concat($e,"-wrapper"),Pa="".concat($e,"-common"),Ta="".concat($e,"-progress-bar"),Oa="".concat($e,"-close-button"),ka="dx-card";class Ra extends ye{_initMarkup(){super._initMarkup(),this._initActions(),this._operationCount=0,this.$element().addClass(Fe);var e=A("<div>").appendTo(this.$element()),t=A("<div>").addClass(Ia).appendTo(e);this._scrollView=this._createComponent(e,zt,{scrollByContent:!0,scrollByThumb:!0,showScrollbar:"onScroll"});var i=A("<div>").addClass(Ca).appendTo(t);A("<div>").text(z.format("dxFileManager-notificationProgressPanelTitle")).addClass(ya).appendTo(i);var r=A("<div>").addClass(Sa).appendTo(i);this._createComponent(r,We,{icon:"close",stylingMode:"text",onClick:()=>this._raisePanelClosed()}),this._$infosContainer=A("<div>").addClass(ba).appendTo(t),this._renderEmptyListText()}_getDefaultOptions(){return Y(super._getDefaultOptions(),{onOperationClosed:null,onOperationCanceled:null,onOperationItemCanceled:null,onPanelClosed:null})}_initActions(){this._actions={onOperationClosed:this._createActionByOption("onOperationClosed"),onOperationCanceled:this._createActionByOption("onOperationCanceled"),onOperationItemCanceled:this._createActionByOption("onOperationItemCanceled"),onPanelClosed:this._createActionByOption("onPanelClosed")}}_optionChanged(e){var t=e.name;switch(t){case"test":break;case"onOperationClosed":case"onOperationCanceled":case"onOperationItemCanceled":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}addOperation(e,t,i){this._operationCount?A("<div>").addClass(Mi).prependTo(this._$infosContainer):this._$infosContainer.empty(),this._operationCount++;var r={customCloseHandling:t,allowProgressAutoUpdate:Ie(i,!0)},n=A("<div>").addClass(Ea).prependTo(this._$infosContainer);r.$info=n;var a=A("<div>").addClass(wa).appendTo(n);return r.common=this._createProgressBox(a,{commonText:e,showCloseButton:!0,showCloseButtonAlways:t,onCloseButtonClick:()=>this._closeOperation(r)}),r}addOperationDetails(e,t,i){e.$info.addClass(Aa);var r=A("<div>").addClass(xa).appendTo(e.$info);e.details=t.map((n,a)=>(n.info=e,this._createDetailsItem(r,n,a,!1,i)))}_createDetailsItem(e,t,i,r,n){var a=A("<div>").appendTo(e);return i!==-1&&a.addClass(ka),this._createProgressBox(a,{commonText:t.commonText,imageUrl:t.imageUrl,skipProgressBox:r,showCloseButton:n,showCloseButtonAlways:n,onCloseButtonClick:()=>this._cancelOperationItem(t,i)})}completeOperationItem(e,t,i){e.allowProgressAutoUpdate&&this.updateOperationItemProgress(e,t,100,i),this._setCloseButtonVisible(e.details[t],!1)}updateOperationItemProgress(e,t,i,r){if(this.updateOperationCommonProgress(e,r),e.details){var n=e.details[t];n.progressBar.option("value",i)}}updateOperationCommonProgress(e,t){var i;(i=e.common.progressBar)===null||i===void 0||i.option("value",t)}completeOperation(e,t,i,r){e.completed=!0,e.common.$commonText.text(t),i?this._removeProgressBar(e.common):e.allowProgressAutoUpdate&&this.updateOperationCommonProgress(e,100),r&&this._setProgressBarText(e.common,r),this._setCloseButtonVisible(e.common,!0)}completeSingleOperationWithError(e,t){var i,r=(i=e.details)===null||i===void 0?void 0:i[0];e.completed=!0,this._renderOperationError(r||e.common,t),this._setCloseButtonVisible(e.common,!0),r&&this._setCloseButtonVisible(r,!1)}addOperationDetailsError(e,t,i){var r=e.details[t];this._renderOperationError(r,i),this._setCloseButtonVisible(r,!1)}_renderError(e,t,i){A("<div>").text(i).addClass(Da).appendTo(e)}_renderEmptyListText(){this._$infosContainer.text(z.format("dxFileManager-notificationProgressPanelEmptyListText"))}_renderOperationError(e,t){this._removeProgressBar(e),this._renderError(e.$wrapper,e.$commonText,t)}_removeProgressBar(e){e.progressBar&&(e.progressBar.dispose(),e.progressBar.$element().remove(),e.progressBar=null)}_createProgressBox(e,t){e.addClass($e),t.showCloseButtonAlways||e.addClass(Fi),t.imageUrl&&St(t.imageUrl).addClass(Ma).appendTo(e);var i=A("<div>").addClass(Fa).appendTo(e),r=A("<div>").addClass(Pa).text(t.commonText).appendTo(i),n=null;if(!t.skipProgressBox){var a=A("<div>").addClass(Ta).appendTo(i);n=this._createComponent(a,wt,{min:0,max:100,width:"100%",validationMessageMode:"always",statusFormat:(g,y)=>this._getStatusString(g,y)})}var o=null;if(t.showCloseButton){var d=A("<div>").addClass(Oa).appendTo(e);o=this._createComponent(d,We,{icon:"dx-filemanager-i dx-filemanager-i-cancel",stylingMode:"text",visible:t.showCloseButtonAlways,onClick:t.onCloseButtonClick})}return{$commonText:r,progressBar:n,$element:e,$wrapper:i,closeButton:o}}_setCloseButtonVisible(e,t){e.closeButton&&(e.$element.toggleClass(Fi,!t),e.closeButton.option("visible",t))}_setProgressBarText(e,t){e.progressBar.option("statusFormat",()=>t)}_closeOperation(e){e.customCloseHandling&&!e.completed?(this._raiseOperationCanceled(e),this._setCloseButtonVisible(e.common,!1),e.details.forEach(t=>this._displayClosedOperationItem(t))):(this._raiseOperationClosed(e),e.$info.next(".".concat(Mi)).remove(),e.$info.remove(),this._operationCount--,this._operationCount||this._renderEmptyListText())}_cancelOperationItem(e,t){this._raiseOperationItemCanceled(e,t);var i=e.info.details[t];this._displayClosedOperationItem(i)}_displayClosedOperationItem(e){this._setProgressBarText(e,z.format("dxFileManager-notificationProgressPanelOperationCanceled")),this._setCloseButtonVisible(e,!1)}_getStatusString(e,t){return e===1?z.format("Done"):Math.round(100*e)+"%"}_raiseOperationClosed(e){this._actions.onOperationClosed({info:e})}_raiseOperationCanceled(e){this._actions.onOperationCanceled({info:e})}_raiseOperationItemCanceled(e,t){this._actions.onOperationItemCanceled({item:e,itemIndex:t})}_raisePanelClosed(){this._actions.onPanelClosed()}}var mt="dx-filemanager-progress-box",La="".concat(mt,"-error"),Ba="".concat(mt,"-image"),Na="".concat(mt,"-wrapper"),Ua="".concat(mt,"-common"),Wt="__operationInfoManager",be={default:"default",progress:"progress",error:"error",success:"success"};class cr{constructor(e){var{onActionProgressStatusChanged:t,isActual:i}=e;this._id=new Ne().toString(),this._isActual=i||!1,this._actionProgressStatus=be.default,this._raiseActionProgress=t}getId(){return this._id}isActual(){return this._isActual}createErrorDetailsProgressBox(e,t,i){var r=this._createDetailsItem(e,t);this.renderError(r.$wrapper,i)}renderError(e,t){A("<div>").text(t).addClass(La).appendTo(e)}isActionProgressStatusDefault(){return this._actionProgressStatus===be.default}_createDetailsItem(e,t){var i=A("<div>").appendTo(e);return this._createProgressBox(i,{commonText:t.commonText,imageUrl:t.imageUrl})}_createProgressBox(e,t){e.addClass(mt),t.imageUrl&&St(t.imageUrl).addClass(Ba).appendTo(e);var i=A("<div>").addClass(Na).appendTo(e),r=A("<div>").addClass(Ua).text(t.commonText).appendTo(i);return{$commonText:r,$element:e,$wrapper:i}}}class za extends cr{addOperation(){return{[Wt]:this._id}}addOperationDetails(){}updateOperationItemProgress(){}completeOperationItem(){}finishOperation(){}completeOperation(){}completeSingleOperationWithError(){}addOperationDetailsError(){}handleDimensionChanged(){return!1}ensureProgressPanelCreated(){}tryHideActionProgress(){this._updateActionProgress("",be.default)}updateActionProgressStatus(){this._updateActionProgress("",be.default)}_updateActionProgress(e,t){t!==be.default&&t!==be.progress||(this._actionProgressStatus=t,this._raiseActionProgress(e,t))}hasNoOperations(){return!0}get _operationInProgressCount(){return 0}set _operationInProgressCount(e){}get _failedOperationCount(){return 0}set _failedOperationCount(e){}}class $a extends cr{constructor(e){super(e),this._failedOperationCount=0,this._operationInProgressCount=0}addOperation(e,t,i){this._operationInProgressCount++;var r=this._progressPanel.addOperation(e,t,i);return r[Wt]=this._id,this._updateActionProgress(e,be.progress),r}addOperationDetails(e,t,i){this._progressPanel.addOperationDetails(e,t,i)}updateOperationItemProgress(e,t,i,r){this._progressPanel.updateOperationItemProgress(e,t,i,r)}completeOperationItem(e,t,i){this._progressPanel.completeOperationItem(e,t,i)}finishOperation(e,t){this._progressPanel.updateOperationCommonProgress(e,t)}completeOperation(e,t,i,r){this._operationInProgressCount--,i&&this._failedOperationCount++,this._progressPanel.completeOperation(e,t,i,r)}completeSingleOperationWithError(e,t){this._progressPanel.completeSingleOperationWithError(e,t.detailErrorText),this._notifyError(t)}addOperationDetailsError(e,t){this._progressPanel.addOperationDetailsError(e,t.itemIndex,t.detailErrorText),this._notifyError(t)}handleDimensionChanged(){return this._progressPanel&&this._progressPanel.$element().detach(),!0}ensureProgressPanelCreated(e,t){if(this._progressPanel)this._progressPanel.$element().appendTo(e);else{var i=A("<div>").appendTo(e),r=this._getProgressPanelComponent();this._progressPanel=new r(i,Y({},t,{onOperationClosed:n=>{var{info:a}=n;return this._onProgressPanelOperationClosed(a)}}))}}_getProgressPanelComponent(){return Ra}_onProgressPanelOperationClosed(e){e.hasError&&(this._failedOperationCount--,this.tryHideActionProgress())}tryHideActionProgress(){this.hasNoOperations()&&this._updateActionProgress("",be.default)}updateActionProgressStatus(e){if(e){var t=this._failedOperationCount===0?be.success:be.error;this._updateActionProgress("",t)}}_notifyError(e){var t=this.hasNoOperations()?be.default:be.error;this._updateActionProgress(e.commonErrorText,t)}_updateActionProgress(e,t){this._actionProgressStatus=t,this._raiseActionProgress(e,t)}hasNoOperations(){return this._operationInProgressCount===0&&this._failedOperationCount===0}get _operationInProgressCount(){return this._operationInProgressCountInternal}set _operationInProgressCount(e){this._operationInProgressCountInternal=e}get _failedOperationCount(){return this._failedOperationCountInternal}set _failedOperationCount(e){this._failedOperationCountInternal=e}}var Va=je(),Ka=1e3,Ze="dx-filemanager-notification",ur="".concat(Ze,"-drawer"),Pi="".concat(ur,"-panel"),Wa="".concat(Ze,"-popup"),Ga="".concat(Ze,"-popup-error"),Ha="".concat(Ze,"-common"),ja="".concat(Ze,"-separator"),Za="".concat(Ze,"-details"),qa="".concat(Ze,"-common-no-item");class Xa extends ye{_initMarkup(){super._initMarkup(),this._initActions(),this._isInAdaptiveState=this._isSmallScreen(),this._managerMap={},this._notificationManagerStubId=null,this._setNotificationManager();var e=this.option("progressPanelContainer"),t=A("<div>").addClass(ur).appendTo(e);A("<div>").addClass(Pi).appendTo(t);var i=Y({opened:!1,position:"right",template:a=>this._ensureProgressPanelCreated(a)},this._getProgressDrawerAdaptiveOptions());this._progressDrawer=this._createComponent(t,Kt,i);var r=t.find(".".concat(Pi)).first(),n=this.option("contentTemplate");Ce(n)&&n(r,this)}_setNotificationManager(e){if(e=Y({onActionProgressStatusChanged:this._raiseActionProgress.bind(this)},e),!this._notificationManagerStubId){var t=new za(e);this._notificationManagerStubId=t.getId(),this._managerMap[this._notificationManagerStubId]=t}if(!this._isProgressDrawerDisabled()){var i=this._getProgressManagerComponent();e.isActual=!0;var r=new i(e);this._managerMap[r.getId()]=r}}_getNotificationManager(e){var t=(e==null?void 0:e[Wt])||this._getActualNotificationManagerId();return this._managerMap[t]||this._managerMap[this._notificationManagerStubId]}_clearManagerMap(){var e=this._managerMap[this._notificationManagerStubId];delete this._managerMap,this._managerMap={[this._notificationManagerStubId]:e}}_getActualNotificationManagerId(){return Object.keys(this._managerMap).filter(e=>this._managerMap[e].isActual())[0]}tryShowProgressPanel(){var e=new re,t=this._getNotificationManager();return t.isActionProgressStatusDefault()||this._isProgressDrawerOpened()||this._isProgressDrawerDisabled()?e.resolve().promise():(setTimeout(()=>{this._progressDrawer.show().done(e.resolve),this._hidePopup(),t.tryHideActionProgress()}),e.promise())}addOperation(e,t,i){var r=this._getNotificationManager();return r.addOperation(e,t,i)}addOperationDetails(e,t,i){var r=this._getNotificationManager(e);r.addOperationDetails(e,t,i)}updateOperationItemProgress(e,t,i,r){var n=this._getNotificationManager(e);n.updateOperationItemProgress(e,t,i,r)}completeOperationItem(e,t,i){var r=this._getNotificationManager(e);r.completeOperationItem(e,t,i)}finishOperation(e,t){var i=this._getNotificationManager(e);i.finishOperation(e,t)}completeOperation(e,t,i,r){var n=this._getNotificationManager(e);i||this._showPopup(t),n.completeOperation(e,t,i,r),!this._isProgressDrawerOpened()||!n.hasNoOperations()?n.updateActionProgressStatus(e):n.tryHideActionProgress()}completeSingleOperationWithError(e,t){var i=this._getNotificationManager(e);i.completeSingleOperationWithError(e,t),this._showPopupError(t)}addOperationDetailsError(e,t){var i=this._getNotificationManager(e);i.addOperationDetailsError(e,t),this._showPopupError(t)}_hideProgressPanel(){setTimeout(()=>this._progressDrawer.hide())}_isSmallScreen(){return Me()?ze(Va)<=Ka:!1}_dimensionChanged(e){e&&e==="height"||this._checkAdaptiveState()}_checkAdaptiveState(){var e=this._isInAdaptiveState;if(this._isInAdaptiveState=this._isSmallScreen(),e!==this._isInAdaptiveState&&this._progressDrawer){var t=this._getNotificationManager();if(t.handleDimensionChanged()){var i=this._getProgressDrawerAdaptiveOptions();this._progressDrawer.option(i)}}}_getProgressDrawerAdaptiveOptions(){return this._isInAdaptiveState?{openedStateMode:"overlap",shading:!0,hideOnOutsideClick:!0}:{openedStateMode:"shrink",shading:!1,hideOnOutsideClick:!1}}_ensureProgressPanelCreated(e){var t=this._getNotificationManager();t.ensureProgressPanelCreated(e,{onOperationCanceled:i=>{var{info:r}=i;return this._raiseOperationCanceled(r)},onOperationItemCanceled:i=>{var{item:r,itemIndex:n}=i;return this._raiseOperationItemCanceled(r,n)},onPanelClosed:()=>this._hideProgressPanel()})}_getProgressManagerComponent(){return $a}_isProgressDrawerDisabled(){return!this.option("showProgressPanel")}_isProgressDrawerOpened(){return this._progressDrawer.option("opened")}_hidePopup(e){!this.option("showNotificationPopup")&&!e||this._getNotificationPopup().hide()}_showPopup(e,t){this._isProgressDrawerOpened()||!this.option("showNotificationPopup")||(this._getNotificationPopup().$wrapper().toggleClass(Ga,!!t),this._getNotificationPopup().option("contentTemplate",e),this._getNotificationPopup().option("visible")||this._getNotificationPopup().show())}_showPopupError(e){if(this.option("showNotificationPopup")){var t=this._getNotificationManager(),i=A("<div>"),r=A("<div>").addClass(Ha).text(e.commonErrorText),n=A("<div>").addClass(ja);A("<div>").appendTo(n);var a=A("<div>").addClass(Za);e.item?t.createErrorDetailsProgressBox(a,e.item,e.detailErrorText):(r.addClass(qa),t.renderError(a,e.detailErrorText)),i.append(r,n,a),this._showPopup(i,!0)}}_getNotificationPopup(){if(!this._notificationPopup){var e=A("<div>").appendTo(this.$element());this._notificationPopup=this._createComponent(e,er,{container:this.$element(),width:"auto",height:"auto",showTitle:!1,dragEnabled:!1,shading:!1,visible:!1,hideOnOutsideClick:!0,animation:{duration:0},position:{my:"right top",at:"right top",of:this.option("positionTarget"),offset:"-10 -5"},_wrapperClassExternal:Wa})}return this._notificationPopup}_raiseActionProgress(e,t){this._actions.onActionProgress({message:e,status:t})}_raiseOperationCanceled(e){this._actions.onOperationCanceled({info:e})}_raiseOperationItemCanceled(e,t){this._actions.onOperationItemCanceled({item:e,itemIndex:t})}_initActions(){this._actions={onActionProgress:this._createActionByOption("onActionProgress"),onOperationCanceled:this._createActionByOption("onOperationCanceled"),onOperationItemCanceled:this._createActionByOption("onOperationItemCanceled")}}_getDefaultOptions(){return Y(super._getDefaultOptions(),{progressPanelContainer:null,contentTemplate:null,onActionProgress:null,onOperationCanceled:null,onOperationItemCanceled:null,showProgressPanel:!0,showNotificationPopup:!0})}_optionChanged(e){var t=e.name;switch(t){case"progressPanelContainer":case"contentTemplate":break;case"showProgressPanel":this._setNotificationManager(),this._getNotificationManager().updateActionProgressStatus(),e.value||(this._hideProgressPanel(),this._clearManagerMap()),this._progressDrawer.repaint();break;case"showNotificationPopup":e.value||this._hidePopup(!0);break;case"onActionProgress":case"onOperationCanceled":case"onOperationItemCanceled":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}}var Ya="dx-filemanager-dialog",Ja="dx-filemanager-dialog-popup";class Gt extends ye{_initMarkup(){var e;super._initMarkup(),this._createOnClosedAction();var t=this._getDialogOptions(),i=A("<div>").appendTo(this.$element()),r={showTitle:!0,title:t.title,visible:!1,hideOnOutsideClick:!0,contentTemplate:this._createContentTemplate.bind(this),toolbarItems:[{widget:"dxButton",toolbar:"bottom",location:"after",options:{text:t.buttonText,onClick:this._applyDialogChanges.bind(this)}},{widget:"dxButton",toolbar:"bottom",location:"after",options:{text:z.format("dxFileManager-dialogButtonCancel"),onClick:this._closeDialog.bind(this)}}],onInitialized:n=>{var{component:a}=n;a.registerKeyHandler("enter",this._applyDialogChanges.bind(this))},onHidden:this._onPopupHidden.bind(this),onShown:this._onPopupShown.bind(this),_wrapperClassExternal:"".concat(Ja," ").concat((e=t.popupCssClass)!==null&&e!==void 0?e:"")};ne(t.height)&&(r.height=t.height),ne(t.maxHeight)&&(r.maxHeight=t.maxHeight),this._popup=this._createComponent(i,er,r)}show(){this._dialogResult=null,this._popup.show()}_getDialogOptions(){return{title:"Title",buttonText:"ButtonText",contentCssClass:"",popupCssClass:""}}_createContentTemplate(e){this._$contentElement=A("<div>").appendTo(e).addClass(Ya);var t=this._getDialogOptions().contentCssClass;t&&this._$contentElement.addClass(t)}_getDialogResult(){return null}_applyDialogChanges(){var e=this._getDialogResult();e&&(this._dialogResult=e,this._closeDialog())}_closeDialog(){this._popup.hide()}_onPopupHidden(){this._onClosedAction({dialogResult:this._dialogResult})}_onPopupShown(){}_createOnClosedAction(){this._onClosedAction=this._createActionByOption("onClosed")}_setTitle(e){this._popup.option("title",e)}_setApplyButtonOptions(e){this._popup.option("toolbarItems[0].options",e)}_getDefaultOptions(){return Y(super._getDefaultOptions(),{onClosed:null})}_optionChanged(e){var t=e.name;switch(t){case"onClosed":this._createOnPathChangedAction();break;default:super._optionChanged(e)}}}var Qa="dx-filemanager-dialog-name-editor",es="dx-filemanager-dialog-name-editor-popup";class Ti extends Gt{show(e){e=e||"",this._nameTextBox?this._nameTextBox.option("value",e):this._initialNameValue=e,super.show()}_onPopupShown(){if(this._nameTextBox){var e=this._nameTextBox._input();e.length&&e[0].select(),this._nameTextBox.focus()}}_getDialogOptions(){return Y(super._getDialogOptions(),{title:this.option("title"),buttonText:this.option("buttonText"),contentCssClass:Qa,popupCssClass:es})}_createContentTemplate(e){super._createContentTemplate(e),this._nameTextBox=this._createComponent(A("<div>"),en,{value:this._initialNameValue,onEnterKey:()=>this._hasCompositionJustEnded&&this._applyDialogChanges(),onKeyDown:t=>this._checkCompositionEnded(t)}),this._$contentElement.append(this._nameTextBox.$element())}_checkCompositionEnded(e){var{event:t}=e;this._hasCompositionJustEnded=t.which!==229}_getDialogResult(){var e=this._nameTextBox.option("value");return e?{name:e}:null}_getDefaultOptions(){return Y(super._getDefaultOptions(),{title:"",buttonText:""})}}var ts="dx-filemanager-dialog-folder-chooser",is="dx-filemanager-dialog-folder-chooser-popup";class rs extends Gt{show(){var e;this._setSelectedDirInfo(null),(e=this._filesTreeView)===null||e===void 0||e.refresh(),super.show()}switchToCopyDialog(e){this._targetItemInfos=e,this._setTitle(z.format("dxFileManager-dialogDirectoryChooserCopyTitle")),this._setApplyButtonOptions({text:z.format("dxFileManager-dialogDirectoryChooserCopyButtonText"),disabled:!0})}switchToMoveDialog(e){this._targetItemInfos=e,this._setTitle(z.format("dxFileManager-dialogDirectoryChooserMoveTitle")),this._setApplyButtonOptions({text:z.format("dxFileManager-dialogDirectoryChooserMoveButtonText"),disabled:!0})}_getDialogOptions(){return Y(super._getDialogOptions(),{contentCssClass:ts,popupCssClass:is})}_createContentTemplate(e){super._createContentTemplate(e),this._filesTreeView=this._createComponent(A("<div>"),lr,{getDirectories:this.option("getDirectories"),getCurrentDirectory:()=>this._getDialogSelectedDirectory(),onDirectoryClick:t=>this._onFilesTreeViewDirectoryClick(t),onFilesTreeViewContentReady:()=>this._toggleUnavailableLocationsDisabled(!0)}),this._$contentElement.append(this._filesTreeView.$element())}_getDialogResult(){var e=this._getDialogSelectedDirectory();return e&&{folder:e}}_getDefaultOptions(){return Y(super._getDefaultOptions(),{getItems:null})}_getDialogSelectedDirectory(){return this._selectedDirectoryInfo}_onFilesTreeViewDirectoryClick(e){var{itemData:t}=e;this._setSelectedDirInfo(t),this._filesTreeView.updateCurrentDirectory()}_setSelectedDirInfo(e){this._selectedDirectoryInfo=e,this._setApplyButtonOptions({disabled:!e})}_onPopupShown(){this._toggleUnavailableLocationsDisabled(!0),super._onPopupShown()}_onPopupHidden(){this._toggleUnavailableLocationsDisabled(!1),super._onPopupHidden()}_toggleUnavailableLocationsDisabled(e){if(this._filesTreeView){var t=this._getLocationsToProcess(e);this._filesTreeView.toggleDirectoryExpandedStateRecursive(t.locationsToExpand[0],e).then(()=>this._filesTreeView.toggleDirectoryLineExpandedState(t.locationsToCollapse,!e).then(()=>t.locationKeysToDisable.forEach(i=>this._filesTreeView.toggleNodeDisabledState(i,e))))}}_getLocationsToProcess(e){var t={},i={};this._targetItemInfos.forEach(a=>{a.parentDirectory&&(t[a.parentDirectory.getInternalKey()]=a.parentDirectory),a.fileItem.isDirectory&&(i[a.getInternalKey()]=a)});var r=di(t),n=di(i);return{locationsToExpand:e?r.values:[],locationsToCollapse:e?n.values:[],locationKeysToDisable:r.keys.concat(...n.keys)}}}var ns="dx-filemanager-dialog-delete-item",as="dx-filemanager-dialog-delete-item-popup";class ss extends Gt{show(e){var{itemName:t,itemCount:i}=e,r=i===1?z.format("dxFileManager-dialogDeleteItemSingleItemConfirmation",t):z.format("dxFileManager-dialogDeleteItemMultipleItemsConfirmation",i);this._$text?this._$text.text(r):this._initialText=r,super.show()}_getDialogOptions(){return Y(super._getDialogOptions(),{title:z.format("dxFileManager-dialogDeleteItemTitle"),buttonText:z.format("dxFileManager-dialogDeleteItemButtonText"),contentCssClass:ns,popupCssClass:as,height:"auto",maxHeight:"80vh"})}_createContentTemplate(e){super._createContentTemplate(e),this._$text=A("<div>").text(this._initialText).appendTo(this._$contentElement),this._createComponent(this._$contentElement,zt,{width:"100%",height:"100%"})}_getDialogResult(){return{}}}class os{constructor(e,t){this._$element=e,this._options=t;var i={onClosed:this._options.onDialogClosed,rtlEnabled:this._options.rtlEnabled},r=A("<div>").appendTo(this._$element);this._chooseDirectoryDialog=new rs(r,Y(i,this._options.chooseDirectoryDialog));var n=A("<div>").appendTo(this._$element);this._renameItemDialog=new Ti(n,Y(i,{title:z.format("dxFileManager-dialogRenameItemTitle"),buttonText:z.format("dxFileManager-dialogRenameItemButtonText")}));var a=A("<div>").appendTo(this._$element);this._createItemDialog=new Ti(a,Y(i,{title:z.format("dxFileManager-dialogCreateDirectoryTitle"),buttonText:z.format("dxFileManager-dialogCreateDirectoryButtonText")}));var o=A("<div>").appendTo(this._$element);this._deleteItemDialog=new ss(o,i)}getCopyDialog(e){return this._chooseDirectoryDialog.switchToCopyDialog(e),this._chooseDirectoryDialog}getMoveDialog(e){return this._chooseDirectoryDialog.switchToMoveDialog(e),this._chooseDirectoryDialog}getRenameItemDialog(){return this._renameItemDialog}getCreateItemDialog(){return this._createItemDialog}getDeleteItemDialog(){return this._deleteItemDialog}updateDialogRtl(e){[this._chooseDirectoryDialog,this._renameItemDialog,this._createItemDialog,this._deleteItemDialog].forEach(t=>{t.option("rtlEnabled",e)})}}var ut=je(),ls="dx-fileuploader",ds="dx-fileuploader-empty",hs="dx-fileuploader-show-file-list",Oi="dx-fileuploader-dragover",cs="dx-fileuploader-wrapper",us="dx-fileuploader-container",ps="dx-fileuploader-content",_s="dx-fileuploader-input-wrapper",ms="dx-fileuploader-input-container",fs="dx-fileuploader-input-label",gs="dx-fileuploader-input",vs="dx-fileuploader-files-container",ki="dx-fileuploader-file-container",Is="dx-fileuploader-file-info",Cs="dx-fileuploader-file-status-message",ys="dx-fileuploader-file",Ri="dx-fileuploader-file-name",Li="dx-fileuploader-file-size",dt="dx-fileuploader-button",Tt="dx-fileuploader-button-container",Ss="dx-fileuploader-cancel-button",Bi="dx-fileuploader-upload-button",bs="dx-fileuploader-invalid",Ni=400,Es="chunkMetadata",Ui=1,ws=()=>A("<input>").attr("type","file"),Ot=()=>!!ut.FormData;class Ht extends tr{_supportedKeys(){var e=t=>{t.preventDefault();var i=this._selectButton.$element();ce.trigger(i,Bt)};return Y(super._supportedKeys(),{space:e,enter:e})}_setOptionsByReference(){super._setOptionsByReference(),Y(this._optionsByReference,{value:!0})}_getDefaultOptions(){return Y(super._getDefaultOptions(),{chunkSize:0,value:[],selectButtonText:z.format("dxFileUploader-selectFile"),uploadButtonText:z.format("dxFileUploader-upload"),labelText:z.format("dxFileUploader-dropFile"),name:"files[]",multiple:!1,accept:"",uploadUrl:"/",allowCanceling:!0,showFileList:!0,progress:0,dialogTrigger:void 0,dropZone:void 0,readyToUploadMessage:z.format("dxFileUploader-readyToUpload"),uploadedMessage:z.format("dxFileUploader-uploaded"),uploadFailedMessage:z.format("dxFileUploader-uploadFailedMessage"),uploadAbortedMessage:z.format("dxFileUploader-uploadAbortedMessage"),uploadMode:"instantly",uploadMethod:"POST",uploadHeaders:{},uploadCustomData:{},onBeforeSend:null,onUploadStarted:null,onUploaded:null,onFilesUploaded:null,onProgress:null,onUploadError:null,onUploadAborted:null,onDropZoneEnter:null,onDropZoneLeave:null,allowedFileExtensions:[],maxFileSize:0,minFileSize:0,inputAttr:{},invalidFileExtensionMessage:z.format("dxFileUploader-invalidFileExtension"),invalidMaxFileSizeMessage:z.format("dxFileUploader-invalidMaxFileSize"),invalidMinFileSizeMessage:z.format("dxFileUploader-invalidMinFileSize"),extendSelection:!0,validationMessageMode:"always",uploadFile:null,uploadChunk:null,abortUpload:null,validationMessageOffset:{h:0,v:0},hoverStateEnabled:!0,useNativeInputClick:!1,useDragOver:!0,nativeDropSupported:!0,_uploadButtonType:"normal"})}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:()=>Ye.real().deviceType==="desktop"&&!Ye.isSimulator(),options:{focusStateEnabled:!0}},{device:[{platform:"android"}],options:{validationMessageOffset:{v:0}}},{device:()=>Ye.real().deviceType!=="desktop",options:{useDragOver:!1}},{device:()=>!Ot(),options:{uploadMode:"useForm"}},{device:()=>Ye.real().deviceType!=="desktop",options:{nativeDropSupported:!1}},{device:()=>Tr(),options:{_uploadButtonType:"default"}}])}_initOptions(e){var t="labelText"in e;super._initOptions(e),!t&&!this._shouldDragOverBeRendered()&&this.option("labelText","")}_init(){super._init(),this._initFileInput(),this._initLabel(),this._setUploadStrategy(),this._createFiles(),this._createBeforeSendAction(),this._createUploadStartedAction(),this._createUploadedAction(),this._createFilesUploadedAction(),this._createProgressAction(),this._createUploadErrorAction(),this._createUploadAbortedAction(),this._createDropZoneEnterAction(),this._createDropZoneLeaveAction()}_setUploadStrategy(){var e=null;if(this.option("chunkSize")>0){var t=this.option("uploadChunk");e=t&&Ce(t)?new Ds(this):new xs(this)}else{var i=this.option("uploadFile");e=i&&Ce(i)?new Fs(this):new Ms(this)}this._uploadStrategy=e}_initFileInput(){this._isCustomClickEvent=!1,this._$fileInput||(this._$fileInput=ws(),ce.on(this._$fileInput,"change",this._inputChangeHandler.bind(this)),ce.on(this._$fileInput,"click",e=>(e.stopPropagation(),this._resetInputValue(),this.option("useNativeInputClick")||this._isCustomClickEvent))),this._$fileInput.prop({multiple:this.option("multiple"),accept:this.option("accept"),title:this.option("hint")||null,tabIndex:-1})}_inputChangeHandler(){if(!this._doPreventInputChange){var e=this._$fileInput.val().replace(/^.*\\/,""),t=this._$fileInput.prop("files");if(!(t&&!t.length&&this.option("uploadMode")!=="useForm")){var i=t?this._getFiles(t):[{name:e}];this._changeValue(i),this.option("uploadMode")==="instantly"&&this._uploadFiles()}}}_shouldFileListBeExtended(){return this.option("uploadMode")!=="useForm"&&this.option("extendSelection")&&this.option("multiple")}_changeValue(e){var t=this._shouldFileListBeExtended()?this.option("value").slice():[];this.option("value",t.concat(e))}_getFiles(e){var t=[];return xe(e,(i,r)=>t.push(r)),t}_getFile(e){var t=Qi(e)?this.option("value")[e]:e;return this._files.filter(i=>i.value===t)[0]}_initLabel(){this._$inputLabel||(this._$inputLabel=A("<div>")),this._updateInputLabelText()}_updateInputLabelText(){var e=this._isInteractionDisabled()?"":this.option("labelText");this._$inputLabel.text(e)}_focusTarget(){return this.$element().find("."+dt)}_getSubmitElement(){return this._$fileInput}_initMarkup(){super._initMarkup(),this.$element().addClass(ls),this._renderWrapper(),this._renderInputWrapper(),this._renderSelectButton(),this._renderInputContainer(),this._renderUploadButton(),this._preventRecreatingFiles=!0,this._activeDropZone=null}_render(){this._preventRecreatingFiles=!1,this._attachDragEventHandlers(this._$inputWrapper),this._attachDragEventHandlers(this.option("dropZone")),this._renderFiles(),super._render()}_createFileProgressBar(e){e.progressBar=this._createProgressBar(e.value.size),e.progressBar.$element().appendTo(e.$file),this._initStatusMessage(e),this._ensureCancelButtonInitialized(e)}_setStatusMessage(e,t){setTimeout(()=>{this.option("showFileList")&&e.$statusMessage&&(e.$statusMessage.text(t),e.$statusMessage.css("display",""),e.progressBar.$element().remove())},Ni)}_getUploadAbortedStatusMessage(){return this.option("uploadMode")==="instantly"?this.option("uploadAbortedMessage"):this.option("readyToUploadMessage")}_createFiles(){var e=this.option("value");this._files&&(e.length===0||!this._shouldFileListBeExtended())&&(this._preventFilesUploading(this._files),this._files=null),this._files||(this._files=[]),xe(e.slice(this._files.length),(t,i)=>{var r=this._createFile(i);this._validateFile(r),this._files.push(r)})}_preventFilesUploading(e){e.forEach(t=>this._uploadStrategy.abortUpload(t))}_validateFile(e){e.isValidFileExtension=this._validateFileExtension(e),e.isValidMinSize=this._validateMinFileSize(e),e.isValidMaxSize=this._validateMaxFileSize(e)}_validateFileExtension(e){var t=this.option("allowedFileExtensions"),i=this.option("accept"),r=this._getAllowedFileTypes(i),n=e.value.name.substring(e.value.name.lastIndexOf(".")).toLowerCase();if(i.length!==0&&!this._isFileTypeAllowed(e.value,r))return!1;if(t.length===0)return!0;for(var a=0;a<t.length;a++)if(n===t[a].toLowerCase())return!0;return!1}_validateMaxFileSize(e){var t=e.value.size,i=this.option("maxFileSize");return i>0?t<=i:!0}_validateMinFileSize(e){var t=e.value.size,i=this.option("minFileSize");return i>0?t>=i:!0}_createBeforeSendAction(){this._beforeSendAction=this._createActionByOption("onBeforeSend",{excludeValidators:["readOnly"]})}_createUploadStartedAction(){this._uploadStartedAction=this._createActionByOption("onUploadStarted",{excludeValidators:["readOnly"]})}_createUploadedAction(){this._uploadedAction=this._createActionByOption("onUploaded",{excludeValidators:["readOnly"]})}_createFilesUploadedAction(){this._filesUploadedAction=this._createActionByOption("onFilesUploaded",{excludeValidators:["readOnly"]})}_createProgressAction(){this._progressAction=this._createActionByOption("onProgress",{excludeValidators:["readOnly"]})}_createUploadAbortedAction(){this._uploadAbortedAction=this._createActionByOption("onUploadAborted",{excludeValidators:["readOnly"]})}_createUploadErrorAction(){this._uploadErrorAction=this._createActionByOption("onUploadError",{excludeValidators:["readOnly"]})}_createDropZoneEnterAction(){this._dropZoneEnterAction=this._createActionByOption("onDropZoneEnter")}_createDropZoneLeaveAction(){this._dropZoneLeaveAction=this._createActionByOption("onDropZoneLeave")}_createFile(e){return{value:e,loadedSize:0,onProgress:ot(),onAbort:ot(),onLoad:ot(),onError:ot(),onLoadStart:ot(),isValidFileExtension:!0,isValidMaxSize:!0,isValidMinSize:!0,isValid(){return this.isValidFileExtension&&this.isValidMaxSize&&this.isValidMinSize},isInitialized:!1}}_resetFileState(e){e.isAborted=!1,e.uploadStarted=!1,e.isStartLoad=!1,e.loadedSize=0,e.chunksData=void 0,e.request=void 0}_renderFiles(){var e,t=this.option("value");this._$filesContainer?(!this._shouldFileListBeExtended()||t.length===0)&&this._$filesContainer.empty():this._$filesContainer=A("<div>").addClass(vs).appendTo(this._$content);var i=this.option("showFileList");i&&xe(this._files,(r,n)=>{n.$file||this._renderFile(n)}),this.$element().toggleClass(hs,i),this._toggleFileUploaderEmptyClassName(),this._updateFileNameMaxWidth(),(e=this._validationMessage)===null||e===void 0||e.repaint()}_renderFile(e){var t=e.value,i=A("<div>").addClass(ki).appendTo(this._$filesContainer);this._renderFileButtons(e,i),e.$file=A("<div>").addClass(ys).appendTo(i);var r=A("<div>").addClass(Is).appendTo(e.$file);e.$statusMessage=A("<div>").addClass(Cs).appendTo(e.$file),A("<div>").addClass(Ri).text(t.name).appendTo(r),ne(t.size)&&A("<div>").addClass(Li).text(this._getFileSize(t.size)).appendTo(r),e.isValid()?e.$statusMessage.text(this.option("readyToUploadMessage")):(e.isValidFileExtension||e.$statusMessage.append(this._createValidationElement("invalidFileExtensionMessage")),e.isValidMaxSize||e.$statusMessage.append(this._createValidationElement("invalidMaxFileSizeMessage")),e.isValidMinSize||e.$statusMessage.append(this._createValidationElement("invalidMinFileSizeMessage")),i.addClass(bs))}_createValidationElement(e){return A("<span>").text(this.option(e))}_updateFileNameMaxWidth(){var e=this.option("allowCanceling")&&this.option("uploadMode")!=="useForm"?1:0,t=this.option("uploadMode")==="useButtons"?1:0,i=ze(this._$filesContainer.find("."+ki).first())||ze(this._$filesContainer),r=this._$filesContainer.find("."+Tt).eq(0),n=ze(r)*(e+t),a=this._$filesContainer.find("."+Li).eq(0),o=a.text();a.text("1000 Mb");var d=ze(a);a.text(o),this._$filesContainer.find("."+Ri).css("maxWidth",i-n-d)}_renderFileButtons(e,t){var i=this._getCancelButton(e);i&&t.append(i);var r=this._getUploadButton(e);r&&t.append(r)}_getCancelButton(e){return this.option("uploadMode")==="useForm"?null:(e.cancelButton=this._createComponent(A("<div>").addClass(dt+" "+Ss),We,{onClick:()=>this._removeFile(e),icon:"close",visible:this.option("allowCanceling"),disabled:this.option("readOnly"),integrationOptions:{},hoverStateEnabled:this.option("hoverStateEnabled")}),A("<div>").addClass(Tt).append(e.cancelButton.$element()))}_getUploadButton(e){return!e.isValid()||this.option("uploadMode")!=="useButtons"?null:(e.uploadButton=this._createComponent(A("<div>").addClass(dt+" "+Bi),We,{onClick:()=>this._uploadFile(e),icon:"upload",hoverStateEnabled:this.option("hoverStateEnabled")}),e.onLoadStart.add(()=>e.uploadButton.option({visible:!1,disabled:!0})),e.onAbort.add(()=>e.uploadButton.option({visible:!0,disabled:!1})),A("<div>").addClass(Tt).append(e.uploadButton.$element()))}_removeFile(e){var t;(t=e.$file)===null||t===void 0||t.parent().remove(),this._files.splice(this._files.indexOf(e),1);var i=this.option("value").slice();i.splice(i.indexOf(e.value),1),this._preventRecreatingFiles=!0,this.option("value",i),this._preventRecreatingFiles=!1,this._toggleFileUploaderEmptyClassName(),this._resetInputValue(!0)}removeFile(e){if(!(this.option("uploadMode")==="useForm"||!ne(e))){var t=this._getFile(e);t&&(t.uploadStarted&&this._preventFilesUploading([t]),this._removeFile(t))}}_toggleFileUploaderEmptyClassName(){this.$element().toggleClass(ds,!this._files.length||this._hasInvalidFile(this._files))}_hasInvalidFile(e){for(var t=0;t<e.length;t++)if(!e[t].isValid())return!0;return!1}_getFileSize(e){for(var t=0,i=[z.format("dxFileUploader-bytes"),z.format("dxFileUploader-kb"),z.format("dxFileUploader-Mb"),z.format("dxFileUploader-Gb")],r=i.length-1;t<r&&e>=1024;)e/=1024,t++;return Math.round(e)+" "+i[t]}_renderSelectButton(){var e=A("<div>").addClass(dt).appendTo(this._$inputWrapper);this._selectButton=this._createComponent(e,We,{text:this.option("selectButtonText"),focusStateEnabled:!1,integrationOptions:{},disabled:this.option("readOnly"),hoverStateEnabled:this.option("hoverStateEnabled")}),this._selectFileDialogHandler=this._selectButtonClickHandler.bind(this),Ye.real().deviceType==="desktop"?this._selectButton.option("onClick",this._selectFileDialogHandler):this._attachSelectFileDialogHandler(this._selectButton.$element()),this._attachSelectFileDialogHandler(this.option("dialogTrigger"))}_selectButtonClickHandler(){if(!this.option("useNativeInputClick")){if(this._isInteractionDisabled())return!1;this._isCustomClickEvent=!0,ce.trigger(this._$fileInput,"click"),this._isCustomClickEvent=!1}}_attachSelectFileDialogHandler(e){ne(e)&&(this._detachSelectFileDialogHandler(e),ce.on(A(e),"click",this._selectFileDialogHandler))}_detachSelectFileDialogHandler(e){ne(e)&&ce.off(A(e),"click",this._selectFileDialogHandler)}_renderUploadButton(){if(this.option("uploadMode")==="useButtons"){var e=A("<div>").addClass(dt).addClass(Bi).appendTo(this._$content);this._uploadButton=this._createComponent(e,We,{text:this.option("uploadButtonText"),onClick:this._uploadButtonClickHandler.bind(this),type:this.option("_uploadButtonType"),integrationOptions:{},hoverStateEnabled:this.option("hoverStateEnabled")})}}_uploadButtonClickHandler(){this._uploadFiles()}_shouldDragOverBeRendered(){return!this.option("readOnly")&&(this.option("uploadMode")!=="useForm"||this.option("nativeDropSupported"))}_isInteractionDisabled(){return this.option("readOnly")||this.option("disabled")}_renderInputContainer(){this._$inputContainer=A("<div>").addClass(ms).appendTo(this._$inputWrapper),this._$fileInput.addClass(gs),this._renderInput();var e="dx-fileuploader-input-label-".concat(new Ne);this._$inputLabel.attr("id",e).addClass(fs).appendTo(this._$inputContainer),this.setAria("labelledby",e,this._$fileInput)}_renderInput(){this.option("useNativeInputClick")?this._selectButton.option("template",this._selectButtonInputTemplate.bind(this)):(this._$fileInput.appendTo(this._$inputContainer),this._selectButton.option("template","content")),this._applyInputAttributes(this.option("inputAttr"))}_selectButtonInputTemplate(e,t){var i=A(t),r=A("<span>").addClass("dx-button-text").text(e.text);return i.append(r).append(this._$fileInput),i}_renderInputWrapper(){this._$inputWrapper=A("<div>").addClass(_s).appendTo(this._$content)}_detachDragEventHandlers(e){ne(e)&&ce.off(A(e),De("",this.NAME))}_attachDragEventHandlers(e){var t=e!==this._$inputWrapper;!ne(e)||!this._shouldDragOverBeRendered()||(this._detachDragEventHandlers(e),e=A(e),ce.on(e,De("dragenter",this.NAME),this._dragEnterHandler.bind(this,t)),ce.on(e,De("dragover",this.NAME),this._dragOverHandler.bind(this,t)),ce.on(e,De("dragleave",this.NAME),this._dragLeaveHandler.bind(this,t)),ce.on(e,De("drop",this.NAME),this._dropHandler.bind(this,t)))}_applyInputAttributes(e){this._$fileInput.attr(e)}_useInputForDrop(){return this.option("nativeDropSupported")&&this.option("uploadMode")==="useForm"}_getDropZoneElement(e,t){var i=e?Array.from(A(this.option("dropZone"))):[this._$inputWrapper];return i=i.map(r=>A(r).get(0)),i[i.indexOf(t.currentTarget)]}_dragEnterHandler(e,t){if(this.option("disabled"))return!1;this._useInputForDrop()||t.preventDefault();var i=this._getDropZoneElement(e,t);ne(i)&&this._shouldRaiseDragOver(t,i)&&(this._activeDropZone=i,this._tryToggleDropZoneActive(!0,e,t))}_shouldRaiseDragOver(e,t){return this._activeDropZone===null&&this.isMouseOverElement(e,t,!1)&&e.originalEvent.dataTransfer.types.find(i=>i==="Files")}_dragOverHandler(e,t){if(this._useInputForDrop()||t.preventDefault(),t.originalEvent.dataTransfer.dropEffect="copy",!e){var i=this._getDropZoneElement(!1,t);this._shouldRaiseDragOver(t,i)&&this._dragEnterHandler(!1,t),this._shouldRaiseDragLeave(t,!1)&&this._dragLeaveHandler(!1,t)}}_dragLeaveHandler(e,t){this._useInputForDrop()||t.preventDefault(),this._shouldRaiseDragLeave(t,e)&&(this._tryToggleDropZoneActive(!1,e,t),this._activeDropZone=null)}_shouldRaiseDragLeave(e,t){return this._activeDropZone!==null&&!this.isMouseOverElement(e,this._activeDropZone,!t,-Ui)}_tryToggleDropZoneActive(e,t,i){var r=e?"addClass":"removeClass",n=e?"_dropZoneEnterAction":"_dropZoneLeaveAction";this[n]({event:i,dropZoneElement:this._activeDropZone}),t||this.$element()[r](Oi)}_dropHandler(e,t){if(this._activeDropZone=null,e||this.$element().removeClass(Oi),!(this._useInputForDrop()||e&&this._isInteractionDisabled())){t.preventDefault();var i=t.originalEvent.dataTransfer.files,r=this._getFiles(i);!this.option("multiple")&&r.length>1||r.length===0||(this._changeValue(r),this.option("uploadMode")==="instantly"&&this._uploadFiles())}}_areAllFilesLoaded(){return this._files.every(e=>!e.isValid()||e._isError||e._isLoaded||e.isAborted)}_handleAllFilesUploaded(){this._recalculateProgress(),this._areAllFilesLoaded()&&this._filesUploadedAction()}_getAllowedFileTypes(e){return e.length?e.split(",").map(t=>t.trim()):[]}_isFileTypeAllowed(e,t){for(var i=0,r=t.length;i<r;i++){var n=t[i];if(n[0]==="."){if(n=n.replace(".","\\."),e.name.match(new RegExp(n+"$","i")))return!0}else if(n=n.replace(new RegExp("\\*","g"),""),e.type.match(new RegExp(n,"i")))return!0}return!1}_renderWrapper(){var e=A("<div>").addClass(cs).appendTo(this.$element()),t=A("<div>").addClass(us).appendTo(e);this._$content=A("<div>").addClass(ps).appendTo(t)}_clean(){this._$fileInput.detach(),delete this._$filesContainer,this._detachSelectFileDialogHandler(this.option("dialogTrigger")),this._detachDragEventHandlers(this.option("dropZone")),this._files&&this._files.forEach(e=>{e.$file=null,e.$statusMessage=null}),super._clean()}abortUpload(e){if(this.option("uploadMode")!=="useForm")if(ne(e)){var t=this._getFile(e);t&&this._preventFilesUploading([t])}else this._preventFilesUploading(this._files)}upload(e){if(this.option("uploadMode")!=="useForm")if(ne(e)){var t=this._getFile(e);t&&Ot()&&this._uploadFile(t)}else this._uploadFiles()}_uploadFiles(){Ot()&&xe(this._files,(e,t)=>this._uploadFile(t))}_uploadFile(e){this._uploadStrategy.upload(e)}_updateProgressBar(e,t){e.progressBar&&e.progressBar.option({value:t.loaded,showStatus:!0}),this._progressAction({file:e.value,segmentSize:t.currentSegmentSize,bytesLoaded:t.loaded,bytesTotal:t.total,event:t.event,request:e.request})}_updateTotalProgress(e,t){var i=0;ne(e)&&(this._files.length>0&&this._areAllFilesLoaded()&&e===0&&t===0?i=this._getProgressValue(1):e&&(i=this._getProgressValue(t/e))),this.option("progress",i),this._setLoadedSize(t)}_getProgressValue(e){return Math.floor(100*e)}_initStatusMessage(e){e.$statusMessage.css("display","none")}_ensureCancelButtonInitialized(e){if(!e.isInitialized){e.cancelButton.option("onClick",()=>{this._preventFilesUploading([e]),this._removeFile(e)});var t=()=>{setTimeout(()=>{e.cancelButton.option({visible:!1})},Ni)};e.onLoad.add(t),e.onError.add(t)}}_createProgressBar(e){return this._createComponent(A("<div>"),wt,{value:void 0,min:0,max:e,statusFormat:t=>this._getProgressValue(t)+"%",showStatus:!1,statusPosition:"right"})}_getTotalFilesSize(){return this._totalFilesSize||(this._totalFilesSize=0,xe(this._files,(e,t)=>{this._totalFilesSize+=t.value.size})),this._totalFilesSize}_getTotalLoadedFilesSize(){return this._totalLoadedFilesSize||(this._totalLoadedFilesSize=0,xe(this._files,(e,t)=>{this._totalLoadedFilesSize+=t.loadedSize})),this._totalLoadedFilesSize}_setLoadedSize(e){this._totalLoadedFilesSize=e}_recalculateProgress(){this._totalFilesSize=0,this._totalLoadedFilesSize=0,this._updateTotalProgress(this._getTotalFilesSize(),this._getTotalLoadedFilesSize())}isMouseOverElement(e,t,i){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ui;if(!t)return!1;var n=i?parseFloat(ut.getComputedStyle(t,":before").height):0,a=i?parseFloat(ut.getComputedStyle(t,":after").height):0,o=oi(t).left,d=oi(t).top+n,g=t.offsetWidth,y=t.offsetHeight-n-a,C=this._getEventX(e),b=this._getEventY(e);return C+r>=o&&C-r<o+g&&b+r>=d&&b-r<d+y}_getEventX(e){return li(e)?this._getTouchEventX(e):e.clientX+this._getDocumentScrollLeft()}_getEventY(e){return li(e)?this._getTouchEventY(e):e.clientY+this._getDocumentScrollTop()}_getTouchEventX(e){var t=null;return e.changedTouches.length>0?t=e.changedTouches:e.targetTouches.length>0&&(t=e.targetTouches),t?t[0].pageX:0}_getTouchEventY(e){var t=null;return e.changedTouches.length>0?t=e.changedTouches:e.targetTouches.length>0&&(t=e.targetTouches),t?t[0].pageY:0}_getDocumentScrollTop(){var e=it.getDocument();return e.documentElement.scrollTop||e.body.scrollTop}_getDocumentScrollLeft(){var e=it.getDocument();return e.documentElement.scrollLeft||e.body.scrollLeft}_updateReadOnlyState(){var e=this.option("readOnly");this._selectButton.option("disabled",e),this._files.forEach(t=>{var i;return(i=t.cancelButton)===null||i===void 0?void 0:i.option("disabled",e)}),this._updateInputLabelText(),this._attachDragEventHandlers(this._$inputWrapper)}_updateHoverState(){var e,t,i=this.option("hoverStateEnabled");(e=this._selectButton)===null||e===void 0||e.option("hoverStateEnabled",i),(t=this._uploadButton)===null||t===void 0||t.option("hoverStateEnabled",i),this._files.forEach(r=>{var n,a;(n=r.uploadButton)===null||n===void 0||n.option("hoverStateEnabled",i),(a=r.cancelButton)===null||a===void 0||a.option("hoverStateEnabled",i)})}_optionChanged(e){var{name:t,value:i,previousValue:r}=e;switch(t){case"height":case"width":this._updateFileNameMaxWidth(),super._optionChanged(e);break;case"value":!i.length&&this._$fileInput.val(""),this._preventRecreatingFiles||(this._createFiles(),this._renderFiles()),this._recalculateProgress(),super._optionChanged(e);break;case"name":this._initFileInput(),super._optionChanged(e);break;case"accept":this._initFileInput();break;case"multiple":this._initFileInput(),e.value||this.reset();break;case"readOnly":this._updateReadOnlyState(),super._optionChanged(e);break;case"disabled":this._updateInputLabelText(),super._optionChanged(e);break;case"selectButtonText":this._selectButton.option("text",i);break;case"uploadButtonText":this._uploadButton&&this._uploadButton.option("text",i);break;case"_uploadButtonType":this._uploadButton&&this._uploadButton.option("type",i);break;case"dialogTrigger":this._detachSelectFileDialogHandler(r),this._attachSelectFileDialogHandler(i);break;case"dropZone":this._detachDragEventHandlers(r),this._attachDragEventHandlers(i);break;case"maxFileSize":case"minFileSize":case"allowedFileExtensions":case"invalidFileExtensionMessage":case"invalidMaxFileSizeMessage":case"invalidMinFileSizeMessage":case"readyToUploadMessage":case"uploadedMessage":case"uploadFailedMessage":case"uploadAbortedMessage":this._invalidate();break;case"labelText":this._updateInputLabelText();break;case"showFileList":this._preventRecreatingFiles||this._renderFiles();break;case"uploadFile":case"uploadChunk":case"chunkSize":this._setUploadStrategy();break;case"abortUpload":case"uploadUrl":case"progress":case"uploadMethod":case"uploadHeaders":case"uploadCustomData":case"extendSelection":break;case"hoverStateEnabled":this._updateHoverState(),super._optionChanged(e);break;case"allowCanceling":case"uploadMode":this.reset(),this._invalidate();break;case"onBeforeSend":this._createBeforeSendAction();break;case"onUploadStarted":this._createUploadStartedAction();break;case"onUploaded":this._createUploadedAction();break;case"onFilesUploaded":this._createFilesUploadedAction();break;case"onProgress":this._createProgressAction();break;case"onUploadError":this._createUploadErrorAction();break;case"onUploadAborted":this._createUploadAbortedAction();break;case"onDropZoneEnter":this._createDropZoneEnterAction();break;case"onDropZoneLeave":this._createDropZoneLeaveAction();break;case"useNativeInputClick":this._renderInput();break;case"useDragOver":this._attachDragEventHandlers(this._$inputWrapper);break;case"nativeDropSupported":this._invalidate();break;case"inputAttr":this._applyInputAttributes(this.option(t));break;case"hint":this._initFileInput(),super._optionChanged(e);break;default:super._optionChanged(e)}}_resetInputValue(e){this.option("uploadMode")==="useForm"&&!e||(this._doPreventInputChange=!0,this._$fileInput.val(""),this._doPreventInputChange=!1)}reset(){this.option("value",[])}}class As{constructor(e,t){this.file=e,this.chunkSize=t,this.index=0}read(){if(!this.file)return null;var e=this.createBlobResult(this.file,this.index,this.chunkSize);return e.isCompleted&&(this.file=null),this.index++,e}createBlobResult(e,t,i){var r=t*i;return{blob:this.sliceFile(e,r,i),index:t,isCompleted:r+i>=e.size}}sliceFile(e,t,i){return e.slice?e.slice(t,t+i):e.webkitSlice?e.webkitSlice(t,t+i):null}}class pr{constructor(e){this.fileUploader=e}upload(e){e.isInitialized&&e.isAborted&&this.fileUploader._resetFileState(e),e.isValid()&&!e.uploadStarted&&(this._prepareFileBeforeUpload(e),this._uploadCore(e))}abortUpload(e){if(!(e._isError||e._isLoaded||e.isAborted||!e.uploadStarted)&&(e.isAborted=!0,e.request&&e.request.abort(),this._isCustomCallback("abortUpload"))){var t=this.fileUploader.option("abortUpload"),i=this._createUploadArgument(e),r=null;try{var n=t(e.value,i);r=yt(n)}catch(a){r=new re().reject(a).promise()}r.done(()=>e.onAbort.fire()).fail(a=>this._handleFileError(e,a))}}_beforeSend(e,t){var i=this._createUploadArgument(t);this.fileUploader._beforeSendAction({request:e,file:t.value,uploadInfo:i}),t.request=e}_createUploadArgument(e){}_uploadCore(e){}_isCustomCallback(e){var t=this.fileUploader.option(e);return t&&Ce(t)}_handleProgress(e,t){e._isError||(e._isProgressStarted=!0,this._handleProgressCore(e,t))}_handleProgressCore(e,t){}_handleFileError(e,t){e._isError=!0,e.onError.fire(t)}_prepareFileBeforeUpload(e){if(e.$file){var t;(t=e.progressBar)===null||t===void 0||t.dispose(),this.fileUploader._createFileProgressBar(e)}e.isInitialized||(e.onLoadStart.add(this._onUploadStarted.bind(this,e)),e.onLoad.add(this._onLoadedHandler.bind(this,e)),e.onError.add(this._onErrorHandler.bind(this,e)),e.onAbort.add(this._onAbortHandler.bind(this,e)),e.onProgress.add(this._onProgressHandler.bind(this,e)),e.isInitialized=!0)}_shouldHandleError(e,t){return(this._isStatusError(t.status)||!e._isProgressStarted)&&!e.isAborted}_isStatusError(e){return 400<=e&&e<500||500<=e&&e<600}_onUploadStarted(e,t){e.uploadStarted=!0,this.fileUploader._uploadStartedAction({file:e.value,event:t,request:e.request})}_onAbortHandler(e,t){var i={file:e.value,event:t,request:e.request,message:this.fileUploader._getUploadAbortedStatusMessage()};this.fileUploader._uploadAbortedAction(i),this.fileUploader._setStatusMessage(e,i.message),this.fileUploader._handleAllFilesUploaded()}_onErrorHandler(e,t){var i={file:e.value,event:void 0,request:e.request,error:t,message:this.fileUploader.option("uploadFailedMessage")};this.fileUploader._uploadErrorAction(i),this.fileUploader._setStatusMessage(e,i.message),this.fileUploader._handleAllFilesUploaded()}_onLoadedHandler(e,t){var i={file:e.value,event:t,request:e.request,message:this.fileUploader.option("uploadedMessage")};e._isLoaded=!0,this.fileUploader._uploadedAction(i),this.fileUploader._setStatusMessage(e,i.message),this.fileUploader._handleAllFilesUploaded()}_onProgressHandler(e,t){if(e){var i=this.fileUploader._getTotalFilesSize(),r=this.fileUploader._getTotalLoadedFilesSize(),n=Math.min(t.loaded,e.value.size),a=n-e.loadedSize;e.loadedSize=n,this.fileUploader._updateTotalProgress(i,r+a),this.fileUploader._updateProgressBar(e,this._getLoadedData(n,t.total,a,t))}}_getLoadedData(e,t,i,r){return{loaded:e,total:t,currentSegmentSize:i}}_extendFormData(e){var t=this.fileUploader.option("uploadCustomData");for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&ne(t[i])&&e.append(i,t[i])}}class _r extends pr{constructor(e){super(e),this.chunkSize=this.fileUploader.option("chunkSize")}_uploadCore(e){var t=e.value,i={name:t.name,loadedBytes:0,type:t.type,blobReader:new As(t,this.chunkSize),guid:new Ne,fileSize:t.size,count:this._getFileChunksCount(t),customData:{}};e.chunksData=i,this._sendChunk(e,i)}_getFileChunksCount(e){return e.size===0?1:Math.ceil(e.size/this.chunkSize)}_sendChunk(e,t){var i=t.blobReader.read();t.currentChunk=i,i&&this._sendChunkCore(e,t,i).done(()=>{e.isAborted||(t.loadedBytes+=i.blob.size,e.onProgress.fire({loaded:t.loadedBytes,total:e.value.size}),i.isCompleted&&e.onLoad.fire(),setTimeout(()=>this._sendChunk(e,t)))}).fail(r=>{this._shouldHandleError(e,r)&&this._handleFileError(e,r)})}_sendChunkCore(e,t,i){}_tryRaiseStartLoad(e){e.isStartLoad||(e.isStartLoad=!0,e.onLoadStart.fire())}_getEvent(e){return null}_createUploadArgument(e){return this._createChunksInfo(e.chunksData)}_createChunksInfo(e){return{bytesUploaded:e.loadedBytes,chunkCount:e.count,customData:e.customData,chunkBlob:e.currentChunk.blob,chunkIndex:e.currentChunk.index}}}class xs extends _r{_sendChunkCore(e,t,i){return ht.sendRequest({url:this.fileUploader.option("uploadUrl"),method:this.fileUploader.option("uploadMethod"),headers:this.fileUploader.option("uploadHeaders"),beforeSend:r=>this._beforeSend(r,e),upload:{onprogress:r=>this._handleProgress(e,r),onloadstart:()=>this._tryRaiseStartLoad(e),onabort:()=>e.onAbort.fire()},data:this._createFormData({fileName:t.name,blobName:this.fileUploader.option("name"),blob:i.blob,index:i.index,count:t.count,type:t.type,guid:t.guid,size:t.fileSize})})}_createFormData(e){var t=new ut.FormData;return t.append(e.blobName,e.blob),t.append(Es,JSON.stringify({FileName:e.fileName,Index:e.index,TotalCount:e.count,FileSize:e.size,FileType:e.type,FileGuid:e.guid})),this._extendFormData(t),t}}class Ds extends _r{_sendChunkCore(e,t){this._tryRaiseStartLoad(e);var i=this._createChunksInfo(t),r=this.fileUploader.option("uploadChunk");try{var n=r(e.value,i);return yt(n)}catch(a){return new re().reject(a).promise()}}_shouldHandleError(e,t){return!0}}class mr extends pr{_uploadCore(e){e.loadedSize=0,this._uploadFile(e).done(()=>{e.isAborted||e.onLoad.fire()}).fail(t=>{this._shouldHandleError(e,t)&&this._handleFileError(e,t)})}_uploadFile(e){}_handleProgressCore(e,t){e.onProgress.fire(t)}_getLoadedData(e,t,i,r){var n=super._getLoadedData(e,t,i,r);return n.event=r,n}}class Ms extends mr{_uploadFile(e){return ht.sendRequest({url:this.fileUploader.option("uploadUrl"),method:this.fileUploader.option("uploadMethod"),headers:this.fileUploader.option("uploadHeaders"),beforeSend:t=>this._beforeSend(t,e),upload:{onprogress:t=>this._handleProgress(e,t),onloadstart:()=>e.onLoadStart.fire(),onabort:()=>e.onAbort.fire()},data:this._createFormData(this.fileUploader.option("name"),e.value)})}_createFormData(e,t){var i=new ut.FormData;return i.append(e,t,t.name),this._extendFormData(i),i}}class Fs extends mr{_uploadFile(e){e.onLoadStart.fire();var t=this.fileUploader.option("uploadFile");try{var i=t(e.value,r=>{var n={loaded:r,total:e.value.size};this._handleProgress(e,n)});return yt(i)}catch(r){return new re().reject(r).promise()}}_shouldHandleError(e,t){return!0}}pt("dxFileUploader",Ht);const yo=Object.freeze(Object.defineProperty({__proto__:null,default:Ht},Symbol.toStringTag,{value:"Module"}));var Ps="dx-filemanager-fileuploader",Ts="dx-filemanager-fileuploader-dropzone-placeholder";class Os extends ye{_initMarkup(){this._initActions(),this.$element().addClass(Ps),this._uploaderInfos=[],this._createInternalFileUploader(),this._createDropZonePlaceholder(),this._setDropZonePlaceholderVisible(!1),super._initMarkup()}_createInternalFileUploader(){var e=this._getController().chunkSize,t=A("<div>").appendTo(this.$element()),i=this._createComponent(t,Ht,{name:"file",multiple:!0,showFileList:!1,activeStateEnabled:!1,focusStateEnabled:!1,hoverStateEnabled:!1,labelText:"",readyToUploadMessage:"",accept:"*",chunkSize:e,dropZone:this.option("dropZone"),onValueChanged:n=>this._onFileUploaderValueChanged(n),onProgress:n=>this._onFileUploaderProgress(n),onUploaded:n=>this._onFileUploaderUploaded(n),onFilesUploaded:n=>this._onFileUploaderAllFilesUploaded(n),onUploadAborted:n=>this._onFileUploaderUploadAborted(n),onUploadError:n=>this._onFileUploaderUploadError(n),onDropZoneEnter:()=>this._setDropZonePlaceholderVisible(!0),onDropZoneLeave:()=>this._setDropZonePlaceholderVisible(!1)});i.option({uploadChunk:(n,a)=>this._fileUploaderUploadChunk(i,n,a),abortUpload:(n,a)=>this._fileUploaderAbortUpload(i,n,a)}),i._shouldRaiseDragLeaveBase=i._shouldRaiseDragLeave,i._shouldRaiseDragLeave=n=>this._shouldRaiseDragLeave(n,i);var r={fileUploader:i};this._uploaderInfos.push(r)}tryUpload(){var e=this._findAndUpdateAvailableUploaderInfo();e&&e.fileUploader._selectButtonClickHandler()}cancelUpload(e){this._cancelUpload(e)}cancelFileUpload(e,t){this._cancelUpload(e,t)}_cancelUpload(e,t){var{fileUploader:i}=this._findUploaderInfoBySessionId(e);i.abortUpload(t)}_fileUploaderUploadChunk(e,t,i){var{session:r,fileIndex:n}=this._findSessionByFile(e,t),a=r.controller;return i.fileIndex=n,a.uploadFileChunk(t,i)}_fileUploaderAbortUpload(e,t,i){var{session:r,fileIndex:n}=this._findSessionByFile(e,t),a=r.controller;return i.fileIndex=n,a.abortFileUpload(t,i)}_onFileUploaderValueChanged(e){var{component:t,value:i}=e;if(i.length!==0){var r=i.slice(),n=this._findUploaderInfo(t);this._uploadFiles(n,r),setTimeout(()=>{this._findAndUpdateAvailableUploaderInfo()||this._createInternalFileUploader()})}}_onFileUploaderProgress(e){var{component:t,file:i,bytesLoaded:r,bytesTotal:n}=e,{session:a,fileIndex:o}=this._findSessionByFile(t,i),d=n!==0?r/n:1,g=t.option("progress")/100,y={sessionId:a.id,fileIndex:o,commonValue:g,fileValue:d};this._raiseUploadProgress(y)}_onFileUploaderAllFilesUploaded(e){var{component:t}=e,{session:i}=this._findSessionByFile(t,t._files[0].value);this._raiseUploadFinished({sessionId:i.id,commonValue:t.option("progress")/100})}_onFileUploaderUploaded(e){var{component:t,file:i}=e,r=this._getDeferredForFile(t,i);r.resolve()}_onFileUploaderUploadAborted(e){var{component:t,file:i}=e,r=this._getDeferredForFile(t,i);r.resolve({canceled:!0})}_onFileUploaderUploadError(e){var{component:t,file:i,error:r}=e,n=this._getDeferredForFile(t,i);n.reject(r)}_createDropZonePlaceholder(){this._$dropZonePlaceholder=A("<div>").addClass(Ts).appendTo(this.option("dropZonePlaceholderContainer"))}_adjustDropZonePlaceholder(){var e=this.option("dropZone");if(!(!Me()||e.length===0)){var t=parseFloat(this._$dropZonePlaceholder.css("borderTopWidth")),i=parseFloat(this._$dropZonePlaceholder.css("borderLeftWidth")),r=this.option("dropZonePlaceholderContainer"),n=parseFloat(r.css("borderBottomWidth")),a=parseFloat(r.css("borderLeftWidth")),o=Hi(r),d=r.offset(),g=e.offset();this._$dropZonePlaceholder.css({top:g.top-d.top-o-n,left:g.left-d.left-a}),Zi(this._$dropZonePlaceholder,e.get(0).offsetHeight-2*t),ji(this._$dropZonePlaceholder,e.get(0).offsetWidth-2*i)}}_setDropZonePlaceholderVisible(e){e?(this._adjustDropZonePlaceholder(),this._$dropZonePlaceholder.css("display","")):this._$dropZonePlaceholder.css("display","none")}_shouldRaiseDragLeave(e,t){return t.isMouseOverElement(e,this.option("splitterElement"))||t._shouldRaiseDragLeaveBase(e,!0)}_uploadFiles(e,t){this._setDropZonePlaceholderVisible(!1);var i=new Ne().toString(),r=this._getController(),n=t.map(()=>new re),a={id:i,controller:r,files:t,deferreds:n};e.session=a;var o={sessionId:i,deferreds:n,files:t};return this._raiseUploadSessionStarted(o),Nt(n).always(()=>setTimeout(()=>{e.fileUploader.reset(),e.session=null}))}_getDeferredForFile(e,t){var{session:i,fileIndex:r}=this._findSessionByFile(e,t);return i.deferreds[r]}_findSessionByFile(e,t){var i=this._findUploaderInfo(e),r=i.session,n=r.files.indexOf(t);return{session:r,fileIndex:n}}_findUploaderInfoBySessionId(e){for(var t=0;t<this._uploaderInfos.length;t++){var i=this._uploaderInfos[t],r=i.session;if(r&&r.id===e)return i}return null}_findAndUpdateAvailableUploaderInfo(){for(var e,t=null,i=0;i<this._uploaderInfos.length;i++){var r=this._uploaderInfos[i];r.fileUploader.option("dropZone",""),!t&&!r.session&&(t=r)}return(e=t)===null||e===void 0||e.fileUploader.option("dropZone",this.option("dropZone")),t}_findUploaderInfo(e){for(var t=0;t<this._uploaderInfos.length;t++){var i=this._uploaderInfos[t];if(i.fileUploader===e)return i}return null}_getController(){var e=this.option("getController");return e()}_raiseUploadSessionStarted(e){this._actions.onUploadSessionStarted({sessionInfo:e})}_raiseUploadProgress(e){this._actions.onUploadProgress(e)}_raiseUploadFinished(e){this._actions.onUploadFinished(e)}_initActions(){this._actions={onUploadSessionStarted:this._createActionByOption("onUploadSessionStarted"),onUploadProgress:this._createActionByOption("onUploadProgress"),onUploadFinished:this._createActionByOption("onUploadFinished")}}_getDefaultOptions(){return Y(super._getDefaultOptions(),{getController:null,onUploadSessionStarted:null,onUploadProgress:null,onUploadFinished:null,splitterElement:null})}_optionChanged(e){var t=e.name;switch(t){case"getController":this.repaint();break;case"onUploadSessionStarted":case"onUploadProgress":case"onUploadFinished":this._actions[t]=this._createActionByOption(t);break;case"dropZone":this._findAndUpdateAvailableUploaderInfo(),this._adjustDropZonePlaceholder();break;case"dropZonePlaceholderContainer":this._$dropZonePlaceholder.detach(),this._$dropZonePlaceholder.appendTo(e.value);break;case"splitterElement":break;default:super._optionChanged(e)}}}var ks={get:(m,e)=>{switch(m){case ve.NoAccess:return z.format("dxFileManager-errorNoAccess");case ve.FileExists:return z.format("dxFileManager-errorFileExistsFormat",e);case ve.FileNotFound:return z.format("dxFileManager-errorFileNotFoundFormat",e);case ve.DirectoryExists:return z.format("dxFileManager-errorDirectoryExistsFormat",e);case ve.DirectoryNotFound:return z.format("dxFileManager-errorDirectoryNotFoundFormat",e);case ve.WrongFileExtension:return z.format("dxFileManager-errorWrongFileExtension");case ve.MaxFileSizeExceeded:return z.format("dxFileManager-errorMaxFileSizeExceeded");case ve.InvalidSymbols:return z.format("dxFileManager-errorInvalidSymbols")}return z.format("dxFileManager-errorDefault")}};class Rs extends ye{_initMarkup(){super._initMarkup(),this._initActions(),this._controller=this.option("controller"),this._controller.on("EditActionStarting",this._onEditActionStarting.bind(this)),this._controller.on("EditActionResultAcquired",this._onEditActionResultAcquired.bind(this)),this._controller.on("EditActionItemError",this._onEditActionItemError.bind(this)),this._controller.on("EditActionError",this._onEditActionError.bind(this)),this._controller.on("CompleteEditActionItem",this._onCompleteEditActionItem.bind(this)),this._controller.on("CompleteEditAction",this._onCompleteEditAction.bind(this)),this._model=this.option("model"),this._uploadOperationInfoMap={},this._dialogManager=new os(this.$element(),{chooseDirectoryDialog:{provider:this._controller._fileProvider,getDirectories:this._controller.getDirectories.bind(this._controller),getCurrentDirectory:this._controller.getCurrentDirectory.bind(this._controller)},rtlEnabled:this.option("rtlEnabled"),onDialogClosed:this._onDialogClosed.bind(this)}),this._fileUploader=this._createFileUploader();var e=this.option("notificationControl");e&&this._initNotificationControl(e),this._createMetadataMap()}_initNotificationControl(e){this._notificationControl=e,this._notificationControl.option({onOperationCanceled:t=>{var{info:i}=t;return this._onCancelUploadSession(i)},onOperationItemCanceled:t=>{var{item:i,itemIndex:r}=t;return this._onCancelFileUpload(i,r)}})}_getFileUploaderComponent(){return Os}_createFileUploader(){var e=A("<div>").appendTo(this.$element());return this._createComponent(e,this._getFileUploaderComponent(),{getController:this._getFileUploaderController.bind(this),dropZonePlaceholderContainer:this.option("uploadDropZonePlaceholderContainer"),onUploadSessionStarted:t=>this._onUploadSessionStarted(t),onUploadProgress:t=>this._onUploadProgress(t),onUploadFinished:t=>this._onUploadFinished(t)})}setUploaderDropZone(e){this._fileUploader.option("dropZone",e)}setUploaderSplitterElement(e){this._fileUploader.option("splitterElement",e)}_getFileUploaderController(){var e=this.uploadDirectoryInfo.fileItem;return{chunkSize:this._controller.getFileUploadChunkSize(),uploadFileChunk:(t,i)=>this._controller.uploadFileChunk(t,i,e),abortFileUpload:(t,i)=>this._controller.abortFileUpload(t,i,e)}}_createMetadataMap(){this._metadataMap={create:{action:e=>this._tryCreate(e),affectsAllItems:!0,singleItemProcessingMessage:z.format("dxFileManager-editingCreateSingleItemProcessingMessage"),singleItemSuccessMessage:z.format("dxFileManager-editingCreateSingleItemSuccessMessage"),singleItemErrorMessage:z.format("dxFileManager-editingCreateSingleItemErrorMessage"),commonErrorMessage:z.format("dxFileManager-editingCreateCommonErrorMessage")},rename:{action:e=>this._tryRename(e),singleItemProcessingMessage:z.format("dxFileManager-editingRenameSingleItemProcessingMessage"),singleItemSuccessMessage:z.format("dxFileManager-editingRenameSingleItemSuccessMessage"),singleItemErrorMessage:z.format("dxFileManager-editingRenameSingleItemErrorMessage"),commonErrorMessage:z.format("dxFileManager-editingRenameCommonErrorMessage")},delete:{action:e=>this._tryDelete(e),singleItemProcessingMessage:z.format("dxFileManager-editingDeleteSingleItemProcessingMessage"),multipleItemsProcessingMessage:z.format("dxFileManager-editingDeleteMultipleItemsProcessingMessage"),singleItemSuccessMessage:z.format("dxFileManager-editingDeleteSingleItemSuccessMessage"),multipleItemsSuccessMessage:z.format("dxFileManager-editingDeleteMultipleItemsSuccessMessage"),singleItemErrorMessage:z.format("dxFileManager-editingDeleteSingleItemErrorMessage"),multipleItemsErrorMessage:z.format("dxFileManager-editingDeleteMultipleItemsErrorMessage"),commonErrorMessage:z.format("dxFileManager-editingDeleteCommonErrorMessage")},move:{action:e=>this._tryMove(e),singleItemProcessingMessage:z.format("dxFileManager-editingMoveSingleItemProcessingMessage"),multipleItemsProcessingMessage:z.format("dxFileManager-editingMoveMultipleItemsProcessingMessage"),singleItemSuccessMessage:z.format("dxFileManager-editingMoveSingleItemSuccessMessage"),multipleItemsSuccessMessage:z.format("dxFileManager-editingMoveMultipleItemsSuccessMessage"),singleItemErrorMessage:z.format("dxFileManager-editingMoveSingleItemErrorMessage"),multipleItemsErrorMessage:z.format("dxFileManager-editingMoveMultipleItemsErrorMessage"),commonErrorMessage:z.format("dxFileManager-editingMoveCommonErrorMessage")},copy:{action:e=>this._tryCopy(e),singleItemProcessingMessage:z.format("dxFileManager-editingCopySingleItemProcessingMessage"),multipleItemsProcessingMessage:z.format("dxFileManager-editingCopyMultipleItemsProcessingMessage"),singleItemSuccessMessage:z.format("dxFileManager-editingCopySingleItemSuccessMessage"),multipleItemsSuccessMessage:z.format("dxFileManager-editingCopyMultipleItemsSuccessMessage"),singleItemErrorMessage:z.format("dxFileManager-editingCopySingleItemErrorMessage"),multipleItemsErrorMessage:z.format("dxFileManager-editingCopyMultipleItemsErrorMessage"),commonErrorMessage:z.format("dxFileManager-editingCopyCommonErrorMessage")},upload:{action:e=>this._tryUpload(e),allowCancel:!0,allowItemProgress:!0,singleItemProcessingMessage:z.format("dxFileManager-editingUploadSingleItemProcessingMessage"),multipleItemsProcessingMessage:z.format("dxFileManager-editingUploadMultipleItemsProcessingMessage"),singleItemSuccessMessage:z.format("dxFileManager-editingUploadSingleItemSuccessMessage"),multipleItemsSuccessMessage:z.format("dxFileManager-editingUploadMultipleItemsSuccessMessage"),singleItemErrorMessage:z.format("dxFileManager-editingUploadSingleItemErrorMessage"),multipleItemsErrorMessage:z.format("dxFileManager-editingUploadMultipleItemsErrorMessage"),canceledMessage:z.format("dxFileManager-editingUploadCanceledMessage")},download:{action:e=>this._download(e),singleItemProcessingMessage:"",multipleItemsProcessingMessage:"",singleItemErrorMessage:z.format("dxFileManager-editingDownloadSingleItemErrorMessage"),multipleItemsErrorMessage:z.format("dxFileManager-editingDownloadMultipleItemsErrorMessage")},getItemContent:{action:e=>this._getItemContent(e)},getItems:{singleItemProcessingMessage:"",singleItemErrorMessage:z.format("dxFileManager-errorDirectoryOpenFailed"),commonErrorMessage:z.format("dxFileManager-errorDirectoryOpenFailed")}}}getCommandActions(){var e={};return xe(this._metadataMap,t=>{Object.prototype.hasOwnProperty.call(this._metadataMap,t)&&(e[t]=i=>this._executeAction(t,i))}),e}_executeAction(e,t){var i=this._metadataMap[e];return i?i.action(t):null}_onCancelUploadSession(e){this._fileUploader.cancelUpload(e.uploadSessionId)}_onCancelFileUpload(e,t){this._fileUploader.cancelFileUpload(e.info.uploadSessionId,t)}_onUploadProgress(e){var{sessionId:t,fileIndex:i,commonValue:r,fileValue:n}=e,{operationInfo:a}=this._uploadOperationInfoMap[t];this._notificationControl.updateOperationItemProgress(a,i,100*n,100*r)}_onUploadFinished(e){var{sessionId:t,commonValue:i}=e,{operationInfo:r}=this._uploadOperationInfoMap[t];this._notificationControl.finishOperation(r,100*i),this._scheduleUploadSessionDisposal(t,"uploader")}_onUploadSessionStarted(e){var{sessionInfo:t}=e;this._controller.processUploadSession(t,this.uploadDirectoryInfo)}_onEditActionStarting(e){var t=this._metadataMap[e.name],i=new Ls(t,e.itemInfos,e.directory),r=this._notificationControl.addOperation(i.processingMessage,t.allowCancel,!t.allowItemProgress);switch(Y(e.customData,{context:i,operationInfo:r}),e.name){case"upload":var n=e.customData.sessionInfo.sessionId;r.uploadSessionId=n,this._uploadOperationInfoMap[n]={operationInfo:r};break;case"rename":e.customData.context.itemNewName=e.customData.itemNewName}}_onEditActionResultAcquired(e){var{context:t,operationInfo:i}=e.customData;t.singleRequest=e.singleRequest;var r=t.itemInfos.map(n=>this._getItemProgressDisplayInfo(n));this._notificationControl.addOperationDetails(i,r,t.actionMetadata.allowCancel)}_onEditActionError(e,t){var{context:i,operationInfo:r}=e.customData;i.singleRequest=e.singleRequest,this._handleActionError(r,i,t),this._completeAction(r,i)}_onEditActionItemError(e,t){var{context:i,operationInfo:r}=e.customData;this._handleActionError(r,i,t)}_onCompleteEditActionItem(e,t){var{context:i,operationInfo:r}=e.customData;(!t.result||!t.result.canceled)&&(i.completeOperationItem(t.index),this._notificationControl.completeOperationItem(r,t.index,i.commonProgress))}_onCompleteEditAction(e){var{context:t,operationInfo:i}=e.customData;this._completeAction(i,t),e.name==="upload"&&this._scheduleUploadSessionDisposal(e.customData.sessionInfo.sessionId,"controller")}_scheduleUploadSessionDisposal(e,t){ne(this._uploadOperationInfoMap[e].requester)&&this._uploadOperationInfoMap[e].requester!==t?delete this._uploadOperationInfoMap[e]:this._uploadOperationInfoMap[e].requester=t}_tryCreate(e){var t=e&&e[0]||this._getCurrentDirectory(),i=z.format("dxFileManager-newDirectoryName");return this._showDialog(this._dialogManager.getCreateItemDialog(),i).then(r=>{var{name:n}=r;return this._controller.createDirectory(t,n)})}_tryRename(e){var t=e&&e[0]||this._model.getMultipleSelectedItems()[0];return t?this._showDialog(this._dialogManager.getRenameItemDialog(),t.fileItem.name).then(i=>{var{name:r}=i;return this._controller.renameItem(t,r)}):new re().reject().promise()}_tryDelete(e){if(e=e||this._model.getMultipleSelectedItems(),e.length===0)return new re().reject().promise();var t=e[0].fileItem.name,i=e.length;return this._showDialog(this._dialogManager.getDeleteItemDialog(),{itemName:t,itemCount:i}).then(()=>this._controller.deleteItems(e))}_tryMove(e){return e=e||this._model.getMultipleSelectedItems(),e.length===0?new re().reject().promise():this._showDialog(this._dialogManager.getMoveDialog(e)).then(t=>{var{folder:i}=t;return this._controller.moveItems(e,i)})}_tryCopy(e){return e=e||this._model.getMultipleSelectedItems(),e.length===0?new re().reject().promise():this._showDialog(this._dialogManager.getCopyDialog(e)).then(t=>{var{folder:i}=t;return this._controller.copyItems(e,i)})}_tryUpload(e){this._uploadDirectoryInfo=e==null?void 0:e[0],this._fileUploader.tryUpload()}_download(e){return e=e||this._model.getMultipleSelectedItems(),e.length===0?new re().reject().promise():this._controller.downloadItems(e)}_getItemContent(e){return e=e||this._model.getMultipleSelectedItems(),this._controller.getItemContent(e)}_completeAction(e,t){this._notificationControl.completeOperation(e,t.completionMessage,!t.success,t.statusText),t.hasModifiedItems()&&this._raiseOnSuccess(t.onlyFiles)}_handleActionError(e,t,i){e.hasError=!0,t.singleRequest?this._handleSingleRequestActionError(e,t,i):this._handleMultipleRequestActionError(e,t,i)}_handleSingleRequestActionError(e,t,i){var r=t.getItemForSingleRequestError(),n=t.getItemName(i.errorCode),a=this._getErrorText(i,r,n);t.processSingleRequestError(a);var o=this._getOperationErrorInfo(t);this._notificationControl.completeSingleOperationWithError(e,o),t.multipleItems&&this._raiseOnSuccess(t.onlyFiles)}_handleMultipleRequestActionError(e,t,i){var r=t.getItemForMultipleRequestError(i.index),n=t.getItemName(i.errorCode,i.index),a=this._getErrorText(i,r,n);t.processMultipleRequestError(i.index,a);var o=this._getOperationErrorInfo(t);this._notificationControl.addOperationDetailsError(e,o)}_getOperationErrorInfo(e){var t=e.errorState.currentDetailError;return{commonErrorText:e.errorState.commonErrorText,item:t.itemInfo?this._getItemProgressDisplayInfo(t.itemInfo):null,itemIndex:t.itemIndex,detailErrorText:t.errorText}}_getErrorText(e,t,i){var r=e.errorText||ks.get(e.errorCode,i),n={fileSystemItem:t==null?void 0:t.fileItem,errorCode:e.errorCode,errorText:r};return this._raiseOnError(n),n.errorText}_getItemProgressDisplayInfo(e){return{commonText:e.fileItem.name,imageUrl:this._getItemThumbnail(e)}}_showDialog(e,t){return this._dialogDeferred=new re,e.show(t),this._dialogDeferred.promise()}_onDialogClosed(e){var t=e.dialogResult;t?this._dialogDeferred.resolve(t):this._dialogDeferred.reject()}updateDialogRtl(e){this._dialogManager.updateDialogRtl(e)}_getItemThumbnail(e){var t=this.option("getItemThumbnail");if(!t)return null;var i=t(e);return i?i.thumbnail:null}_initActions(){this._actions={onSuccess:this._createActionByOption("onSuccess"),onError:this._createActionByOption("onError")}}_getDefaultOptions(){return Y(super._getDefaultOptions(),{model:{getMultipleSelectedItems:null},notificationControl:null,getItemThumbnail:null,onSuccess:null,onError:null})}_optionChanged(e){var t=e.name;switch(t){case"model":this.repaint();break;case"notificationControl":this._initNotificationControl(e.value);break;case"getItemThumbnail":break;case"uploadDropZonePlaceholderContainer":this._fileUploader.option("dropZonePlaceholderContainer",e.value);break;case"onSuccess":case"onError":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}_raiseOnSuccess(e){this._actions.onSuccess({updatedOnlyFiles:e})}_raiseOnError(e){this._actions.onError(e)}_getCurrentDirectory(){return this._controller.getCurrentDirectory()}get uploadDirectoryInfo(){return this._uploadDirectoryInfo||this._getCurrentDirectory()}}class Ls{constructor(e,t,i){this._actionMetadata=e,this._itemInfos=t,this._onlyFiles=!this._actionMetadata.affectsAllItems&&this._itemInfos.every(r=>!r.fileItem.isDirectory),this._items=this._itemInfos.map(r=>r.fileItem),this._multipleItems=this._items.length>1,this._location=i.getDisplayName(),this._singleRequest=!0,this._completedItems=[],this._commonProgress=0,this._errorState={failedCount:0},this._itemNewName=""}completeOperationItem(e){if(this._singleRequest)this._completedItems=[...this._items];else{var t=this._items[e];this._completedItems.push(t)}this._actionMetadata.allowItemProgress||(this._commonProgress=this._completedItems.length/this._items.length*100)}processSingleRequestError(e){this._errorState.failedCount=1,this._errorState.commonErrorText=this._multipleItems?this._actionMetadata.commonErrorMessage:this._actionMetadata.singleItemErrorMessage;var t=this._multipleItems?-1:1,i=this.getItemForSingleRequestError();this._setCurrentDetailError(t,i,e)}processMultipleRequestError(e,t){this._errorState.failedCount++,this._errorState.commonErrorText=this._errorState.failedCount>1?Xe(this._actionMetadata.multipleItemsErrorMessage,this._errorState.failedCount):this._actionMetadata.singleItemErrorMessage;var i=this.getItemForMultipleRequestError(e);this._setCurrentDetailError(e,i,t)}hasModifiedItems(){return this._hasCompletedItems()||this._singleRequest&&!this.success&&this._multipleItems}getItemForSingleRequestError(){return this._multipleItems?null:this._itemInfos[0]}getItemForMultipleRequestError(e){return this._itemInfos[e]}getItemName(e,t){var i=this.singleRequest?this.getItemForSingleRequestError():this.getItemForMultipleRequestError(t),r=i==null?void 0:i.fileItem.name;return this.itemNewName&&this._isItemExistsErrorCode(e)&&(r=this.itemNewName),r}_isItemExistsErrorCode(e){return e===ve.DirectoryExists||e===ve.FileExists}_setCurrentDetailError(e,t,i){this._errorState.currentDetailError={itemIndex:e,itemInfo:t,errorText:i}}_hasCompletedItems(){return this._completedItems.length>0}get actionMetadata(){return this._actionMetadata}get itemInfos(){return this._itemInfos}get itemNewName(){return this._itemNewName}set itemNewName(e){this._itemNewName=e}get errorState(){return this._errorState}get singleRequest(){return this._singleRequest}set singleRequest(e){this._singleRequest=e}get multipleItems(){return this._multipleItems}get onlyFiles(){return this._onlyFiles}get processingMessage(){return this._multipleItems?Xe(this._actionMetadata.multipleItemsProcessingMessage,this._items.length,this._location):Xe(this._actionMetadata.singleItemProcessingMessage,this._location)}get successMessage(){return this._hasCompletedItems()?this._multipleItems?Xe(this._actionMetadata.multipleItemsSuccessMessage,this._completedItems.length,this._location):Xe(this._actionMetadata.singleItemSuccessMessage,this._location):this._multipleItems?Xe(this._actionMetadata.multipleItemsErrorMessage,this._items.length):this._actionMetadata.singleItemErrorMessage}get completionMessage(){return this.success?this.successMessage:this.errorState.commonErrorText}get statusText(){return this.success&&!this._hasCompletedItems()?this._actionMetadata.canceledMessage:void 0}get commonProgress(){return this._commonProgress}get success(){return!this._errorState.failedCount}}var At="dx-filemanager-breadcrumbs",Bs=At+"-parent-folder-item",Ns=At+"-separator-item",Us=At+"-path-separator-item";class zs extends ye{_init(){super._init(),this._currentDirectory=null}_initMarkup(){super._initMarkup(),this._initActions(),this._currentDirectory&&this._renderMenu(),this.$element().addClass(At)}setCurrentDirectory(e){this._areDirsEqual(this._currentDirectory,e)||(this._currentDirectory=e,this.repaint())}_renderMenu(){var e=A("<div>").appendTo(this.$element());this._menu=this._createComponent(e,Yr,{dataSource:this._getMenuItems(),onItemClick:this._onItemClick.bind(this),onItemRendered:this._onItemRendered.bind(this)})}_getMenuItems(){var e=this._getParentDirsLine(),t=[{icon:"arrowup",directory:this._currentDirectory.parentDirectory,isPathItem:!0,cssClass:Bs},{text:"",cssClass:Ns}];return e.forEach((i,r)=>{t.push({text:i.getDisplayName(),directory:i,isPathItem:!0}),r!==e.length-1&&t.push({icon:"spinnext",cssClass:Us})}),t}_onItemClick(e){var{itemData:t}=e;if(t.isPathItem){var i=t.directory;this._areDirsEqual(i,this._currentDirectory)||this._raiseCurrentDirectoryChanged(i)}}_onItemRendered(e){var{itemElement:t,itemData:i}=e;i.cssClass&&A(t).addClass(i.cssClass)}_getParentDirsLine(){for(var e=this._currentDirectory,t=[];e;)t.unshift(e),e=e.parentDirectory;return t}_areDirsEqual(e,t){return e&&t&&e===t&&e.fileItem.key===t.fileItem.key}_initActions(){this._actions={onCurrentDirectoryChanging:this._createActionByOption("onCurrentDirectoryChanging")}}_raiseCurrentDirectoryChanged(e){this._actions.onCurrentDirectoryChanging({currentDirectory:e})}_getDefaultOptions(){return Y(super._getDefaultOptions(),{rootFolderDisplayName:"Files",onCurrentDirectoryChanging:null})}_optionChanged(e){var t=e.name;switch(t){case"rootFolderDisplayName":this.repaint();break;case"onCurrentDirectoryChanging":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}}var zi=je(),ft="dx-splitter",$s="".concat(ft,"-wrapper"),kt="".concat(ft,"-inactive"),Vs="".concat(ft,"-border"),Rt="".concat(ft,"-initial"),$i="dx-state-disabled",Lt="dxSplitterResizing";class Ks extends ye{_init(){super._init();var e=new Ne().toString();this.SPLITTER_POINTER_DOWN_EVENT_NAME=De(Dt.down,Lt+e),this.SPLITTER_POINTER_MOVE_EVENT_NAME=De(Dt.move,Lt+e),this.SPLITTER_POINTER_UP_EVENT_NAME=De(Dt.up,Lt+e)}_initMarkup(){super._initMarkup(),this._initActions(),this._$container=this.option("container"),this._$leftElement=this.option("leftElement"),this._$rightElement=this.option("rightElement"),this.$element().addClass($s).addClass(Rt),this._$splitterBorder=A("<div>").addClass(Vs).appendTo(this.$element()),this._$splitter=A("<div>").addClass(ft).addClass(kt).appendTo(this._$splitterBorder)}_initActions(){this._actions={onApplyPanelSize:this._createActionByOption("onApplyPanelSize"),onActiveStateChanged:this._createActionByOption("onActiveStateChanged")}}_render(){super._render(),this._detachEventHandlers(),this._attachEventHandlers()}_clean(){this._detachEventHandlers(),super._clean()}_attachEventHandlers(){var e=it.getDocument();ce.on(this._$splitterBorder,this.SPLITTER_POINTER_DOWN_EVENT_NAME,this._onMouseDownHandler.bind(this)),ce.on(e,this.SPLITTER_POINTER_MOVE_EVENT_NAME,this._onMouseMoveHandler.bind(this)),ce.on(e,this.SPLITTER_POINTER_UP_EVENT_NAME,this._onMouseUpHandler.bind(this))}_detachEventHandlers(){var e=it.getDocument();ce.off(this._$splitterBorder,this.SPLITTER_POINTER_DOWN_EVENT_NAME),ce.off(e,this.SPLITTER_POINTER_MOVE_EVENT_NAME),ce.off(e,this.SPLITTER_POINTER_UP_EVENT_NAME)}_dimensionChanged(e){(!e||e!=="height")&&(this._containerWidth=this._$container.get(0).clientWidth,this._setSplitterPositionLeft({needUpdatePanels:!0,usePercentagePanelsWidth:!0}))}_onMouseDownHandler(e){e.preventDefault(),this._offsetX=e.pageX-this._$splitterBorder.offset().left<=this._getSplitterBorderWidth()?e.pageX-this._$splitterBorder.offset().left:0,this._containerWidth=this._$container.get(0).clientWidth,this.$element().removeClass(Rt),this._toggleActive(!0),this._setSplitterPositionLeft({needUpdatePanels:!0})}_onMouseMoveHandler(e){this._isSplitterActive&&this._setSplitterPositionLeft({splitterPositionLeft:this._getNewSplitterPositionLeft(e),needUpdatePanels:!0})}_onMouseUpHandler(){this._isSplitterActive&&(this._leftPanelPercentageWidth=null,this._toggleActive(!1),this._setSplitterPositionLeft({needUpdatePanels:!0,usePercentagePanelsWidth:!0}))}_getNewSplitterPositionLeft(e){var t=e.pageX-this._getContainerLeftOffset()-this._offsetX;return t=Math.max(0-this._getSplitterOffset(),t),t=Math.min(this._containerWidth-this._getSplitterOffset()-this._getSplitterWidth(),t),t}_getContainerLeftOffset(){var e=this._$container.offset().left;if(zi){var t=zi.getComputedStyle(this._$container.get(0)),i=parseFloat(t.paddingLeft)||0,r=parseFloat(t.borderLeftWidth)||0;e+=i+r}return e}_getSplitterOffset(){return(this._getSplitterBorderWidth()-this._getSplitterWidth())/2}_getSplitterWidth(){return this._$splitter.get(0).clientWidth}_getSplitterBorderWidth(){return this._$splitterBorder.get(0).clientWidth}_getLeftPanelWidth(){return this._$leftElement.get(0).clientWidth}getSplitterBorderElement(){return this._$splitterBorder}_toggleActive(e){this.$element().toggleClass(kt,!e),this._$splitter.toggleClass(kt,!e),this._isSplitterActive=e,this._actions.onActiveStateChanged({isActive:e})}toggleDisabled(e){this.$element().toggleClass($i,e),this._$splitter.toggleClass($i,e)}isSplitterMoved(){return!this.$element().hasClass(Rt)}disableSplitterCalculation(e){this._isSplitterCalculationDisabled=e}_setSplitterPositionLeft(){var{splitterPositionLeft:e=null,needUpdatePanels:t=!1,usePercentagePanelsWidth:i=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e=e||this._getLeftPanelWidth()-this._getSplitterOffset();var r=e+this._getSplitterOffset(),n=this._containerWidth-r;this._isSplitterCalculationDisabled||this.$element().css("left",e),this._leftPanelPercentageWidth=this._leftPanelPercentageWidth||this._convertToPercentage(r);var a=this._convertToPercentage(this._containerWidth-this._convertToPixels(this._leftPanelPercentageWidth));t&&this._actions.onApplyPanelSize({leftPanelWidth:i?"".concat(this._leftPanelPercentageWidth,"%"):r,rightPanelWidth:i?"".concat(a,"%"):n})}_optionChanged(e){switch(e.name){case"initialLeftPanelWidth":this._leftPanelPercentageWidth=this._convertToPercentage(e.value),this._dimensionChanged();break;case"leftElement":this.repaint();break;case"onActiveStateChanged":case"onApplyPanelSize":this._actions[e.name]=this._createActionByOption(e.name);break;default:super._optionChanged(e)}}_convertToPercentage(e){return e/this._$container.get(0).clientWidth*100}_convertToPixels(e){return e/100*this._$container.get(0).clientWidth}}var Ws=je(),Gs=573,Vi="dx-filemanager-adaptivity-drawer-panel",Ki="dx-drawer-panel-content-initial",Hs="dx-drawer-panel-content-adaptive";class js extends ye{_initMarkup(){super._initMarkup(),this._initActions(),this._isInAdaptiveState=!1;var e=A("<div>").appendTo(this.$element());A("<div>").addClass(Vi).appendTo(e),this._drawer=this._createComponent(e,Kt),this._drawer.option({opened:!0,template:this._createDrawerTemplate.bind(this)}),A(this._drawer.content()).addClass(Ki);var t=e.find(".".concat(Vi)).first(),i=this.option("contentTemplate");Ce(i)&&i(t),this._updateDrawerMaxSize()}_createDrawerTemplate(e){this.option("drawerTemplate")(e),this._splitter=this._createComponent("<div>",Ks,{container:this.$element(),leftElement:A(this._drawer.content()),rightElement:A(this._drawer.viewContent()),onApplyPanelSize:this._onApplyPanelSize.bind(this),onActiveStateChanged:this._onActiveStateChanged.bind(this)}),this._splitter.$element().appendTo(e),this._splitter.disableSplitterCalculation(!0)}_render(){super._render(),this._checkAdaptiveState()}_onApplyPanelSize(e){if(Me()){if(!this._splitter.isSplitterMoved()){this._setDrawerWidth("");return}A(this._drawer.content()).removeClass(Ki),this._setDrawerWidth(e.leftPanelWidth)}}_onActiveStateChanged(e){var{isActive:t}=e;this._splitter.disableSplitterCalculation(!t),!t&&this._splitter.$element().css("left","auto")}_setDrawerWidth(e){A(this._drawer.content()).css("width",e),this._updateDrawerMaxSize(),this._drawer.resizeViewContent()}_updateDrawerMaxSize(){this._drawer.option("maxSize",this._drawer.getRealPanelWidth())}_dimensionChanged(e){(!e||e!=="height")&&this._checkAdaptiveState()}_checkAdaptiveState(){var e=this._isInAdaptiveState;this._isInAdaptiveState=this._isSmallScreen(),e!==this._isInAdaptiveState&&(this.toggleDrawer(!this._isInAdaptiveState,!0),A(this._drawer.content()).toggleClass(Hs,this._isInAdaptiveState),this._raiseAdaptiveStateChanged(this._isInAdaptiveState)),this._isInAdaptiveState&&this._isDrawerOpened()&&this._updateDrawerMaxSize()}_isSmallScreen(){return ze(Ws)<=Gs}_isDrawerOpened(){return this._drawer.option("opened")}_initActions(){this._actions={onAdaptiveStateChanged:this._createActionByOption("onAdaptiveStateChanged")}}_raiseAdaptiveStateChanged(e){this._actions.onAdaptiveStateChanged({enabled:e})}_getDefaultOptions(){return Y(super._getDefaultOptions(),{drawerTemplate:null,contentTemplate:null,onAdaptiveStateChanged:null})}_optionChanged(e){var t=e.name;switch(t){case"drawerTemplate":case"contentTemplate":this.repaint();break;case"onAdaptiveStateChanged":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}isInAdaptiveState(){return this._isInAdaptiveState}toggleDrawer(e,t){this._updateDrawerMaxSize(),this._drawer.option("animationEnabled",!t),this._drawer.toggle(e);var i=this._isDrawerOpened()&&!this.isInAdaptiveState();this._splitter.toggleDisabled(!i)}getSplitterElement(){return this._splitter.getSplitterBorderElement().get(0)}}var qe="dx-filemanager",Zs=qe+"-wrapper",Wi=qe+"-container",qs=qe+"-dirs-panel",Xs=qe+"-editing-container",Ys=qe+"-items-panel",Js=qe+"-item-custom-thumbnail",Qs="[*DXPDK*]$40F96F03-FBD8-43DF-91BE-F55F4B8BA871$",Ke={folders:"navPane",items:"itemView"};class fr extends ye{_initTemplates(){}_init(){super._init(),this._initActions(),this._providerUpdateDeferred=null,this._lockCurrentPathProcessing=!1,this._wasRendered=!1,this._controller=new cn({currentPath:this.option("currentPath"),currentPathKeys:this.option("currentPathKeys"),rootText:this.option("rootFolderName"),fileProvider:this.option("fileSystemProvider"),allowedFileExtensions:this.option("allowedFileExtensions"),uploadMaxFileSize:this.option("upload").maxFileSize,uploadChunkSize:this.option("upload").chunkSize,onInitialized:this._onControllerInitialized.bind(this),onDataLoading:this._onDataLoading.bind(this),onSelectedDirectoryChanged:this._onSelectedDirectoryChanged.bind(this),onPathPotentiallyChanged:this._checkPathActuality.bind(this),editingEvents:this._actions.editing})}_initMarkup(){super._initMarkup(),this._firstItemViewLoad=!0,this._lockSelectionProcessing=!1,this._lockFocusedItemProcessing=!1,this._itemKeyToFocus=void 0,this._loadedWidgets=[],this._commandManager=new pn(this.option("permissions")),this.$element().addClass(qe),this._wasRendered?this._prepareToLoad():this._wasRendered=!0,this._createNotificationControl(),this._initCommandManager()}_createNotificationControl(){var e=A("<div>").addClass("dx-filemanager-notification-container").appendTo(this.$element());this._notificationControl=this._createComponent(e,Xa,{progressPanelContainer:this.$element(),contentTemplate:(t,i)=>this._createWrapper(t,i),onActionProgress:t=>this._onActionProgress(t),positionTarget:".".concat(Wi),showProgressPanel:this.option("notifications.showPanel"),showNotificationPopup:this.option("notifications.showPopup")})}_createWrapper(e,t){this._$wrapper=A("<div>").addClass(Zs).appendTo(e),this._createEditing(t);var i=A("<div>").appendTo(this._$wrapper);this._toolbar=this._createComponent(i,ia,{commandManager:this._commandManager,generalItems:this.option("toolbar.items"),fileItems:this.option("toolbar.fileSelectionItems"),itemViewMode:this.option("itemView").mode,onItemClick:r=>this._actions.onToolbarItemClick(r)}),this._createAdaptivityControl()}_createAdaptivityControl(){var e=A("<div>").addClass(Wi).appendTo(this._$wrapper);this._adaptivityControl=this._createComponent(e,js,{drawerTemplate:t=>this._createFilesTreeView(t),contentTemplate:t=>this._createItemsPanel(t),onAdaptiveStateChanged:t=>this._onAdaptiveStateChanged(t)}),this._editing.setUploaderSplitterElement(this._adaptivityControl.getSplitterElement())}_createEditing(e){var t=A("<div>").addClass(Xs).appendTo(this.$element());this._editing=this._createComponent(t,Rs,{controller:this._controller,model:{getMultipleSelectedItems:this._getSelectedItemInfos.bind(this)},getItemThumbnail:this._getItemThumbnailInfo.bind(this),notificationControl:e,uploadDropZonePlaceholderContainer:this.$element(),rtlEnabled:this.option("rtlEnabled"),onSuccess:i=>{var{updatedOnlyFiles:r}=i;return this._redrawComponent(r)},onError:i=>this._onEditingError(i)})}_createItemsPanel(e){this._$itemsPanel=A("<div>").addClass(Ys).appendTo(e),this._createBreadcrumbs(this._$itemsPanel),this._createItemView(this._$itemsPanel),this._updateUploadDropZone()}_updateUploadDropZone(){var e=this._commandManager.isCommandAvailable("upload")?this._$itemsPanel:A();this._editing.setUploaderDropZone(e)}_createFilesTreeView(e){this._filesTreeViewContextMenu=this._createContextMenu(!1,Ke.folders);var t=A("<div>").addClass(qs).appendTo(e);this._filesTreeView=this._createComponent(t,lr,{storeExpandedState:!0,contextMenu:this._filesTreeViewContextMenu,getDirectories:this.getDirectories.bind(this),getCurrentDirectory:this._getCurrentDirectory.bind(this),onDirectoryClick:i=>{var{itemData:r}=i;return this._setCurrentDirectory(r)},onItemListDataLoaded:()=>this._tryEndLoading(Ke.folders)}),this._filesTreeView.updateCurrentDirectory()}_createItemView(e,t){this._itemViewContextMenu=this._createContextMenu(!0,Ke.items);var i=this.option("itemView"),r={selectionMode:this.option("selectionMode"),selectedItemKeys:this.option("selectedItemKeys"),focusedItemKey:this.option("focusedItemKey"),contextMenu:this._itemViewContextMenu,getItems:this._getItemViewItems.bind(this),onError:o=>{var{error:d}=o;return this._showError(d)},onSelectionChanged:this._onItemViewSelectionChanged.bind(this),onFocusedItemChanged:this._onItemViewFocusedItemChanged.bind(this),onSelectedItemOpened:this._onSelectedItemOpened.bind(this),onContextMenuShowing:o=>this._onContextMenuShowing(Ke.items,o),onItemListItemsLoaded:()=>this._tryEndLoading(Ke.items),getItemThumbnail:this._getItemThumbnailInfo.bind(this),customizeDetailColumns:this.option("customizeDetailColumns"),detailColumns:this.option("itemView.details.columns")},n=A("<div>").appendTo(e);t=t||i.mode;var a=t==="thumbnails"?Hn:Tn;this._itemView=this._createComponent(n,a,r)}_createBreadcrumbs(e){var t=A("<div>").appendTo(e);this._breadcrumbs=this._createComponent(t,zs,{rootFolderDisplayName:this.option("rootFolderName"),onCurrentDirectoryChanging:i=>{var{currentDirectory:r}=i;return this._setCurrentDirectory(r,!0)}}),this._breadcrumbs.setCurrentDirectory(this._getCurrentDirectory())}_createContextMenu(e,t){var i=A("<div>").appendTo(this._$wrapper);return this._createComponent(i,fn,{commandManager:this._commandManager,items:this.option("contextMenu.items"),onItemClick:r=>this._actions.onContextMenuItemClick(r),onContextMenuShowing:r=>this._onContextMenuShowing(t,r),isolateCreationItemCommands:e,viewArea:t})}_initCommandManager(){var e=Y(this._editing.getCommandActions(),{refresh:()=>this._refreshAndShowProgress(),thumbnails:()=>this.option("itemView.mode","thumbnails"),details:()=>this.option("itemView.mode","details"),clearSelection:()=>this._clearSelection(),showNavPane:()=>this._adaptivityControl.toggleDrawer()});this._commandManager.registerActions(e)}_onItemViewSelectionChanged(e){var{selectedItemInfos:t,selectedItems:i,selectedItemKeys:r,currentSelectedItemKeys:n,currentDeselectedItemKeys:a}=e;this._lockSelectionProcessing=!0,this.option("selectedItemKeys",r),this._lockSelectionProcessing=!1,this._actions.onSelectionChanged({selectedItems:i,selectedItemKeys:r,currentSelectedItemKeys:n,currentDeselectedItemKeys:a}),this._updateToolbar(t)}_onItemViewFocusedItemChanged(e){this._lockFocusedItemProcessing=!0,this.option("focusedItemKey",e.itemKey),this._lockFocusedItemProcessing=!1,this._actions.onFocusedItemChanged({item:e.item,itemElement:e.itemElement})}_onAdaptiveStateChanged(e){var{enabled:t}=e;this._commandManager.setCommandEnabled("showNavPane",t),this._updateToolbar()}_onActionProgress(e){var{message:t,status:i}=e;this._toolbar.updateRefreshItem(t,i),this._updateToolbar()}_onEditingError(e){var t=Ge({},e,["errorCode","errorText","fileSystemItem"]);this._actions.onErrorOccurred(t),e.errorText=t.errorText}_refreshAndShowProgress(){return this._prepareToLoad(),fe(this._notificationControl.tryShowProgressPanel(),this._controller.refresh()).then(()=>this._filesTreeView.refresh())}_isAllWidgetsLoaded(){return this._loadedWidgets.length===2&&this._loadedWidgets.indexOf(Ke.folders)!==-1&&this._loadedWidgets.indexOf(Ke.items)!==-1}_tryEndLoading(e){this._loadedWidgets.push(e),this._isAllWidgetsLoaded()&&this._controller.endSingleLoad()}_prepareToLoad(){this._loadedWidgets=[],this._controller.startSingleLoad()}_updateToolbar(e){var t=e||this._getSelectedItemInfos();this._toolbar.option("contextItems",Ie(t,[]))}_switchView(e){this._disposeWidget(this._itemView.option("contextMenu")),this._disposeWidget(this._itemView),this._createItemView(this._$itemsPanel,e),this._toolbar.option({itemViewMode:e})}_disposeWidget(e){e.dispose(),e.$element().remove()}_clearSelection(){this._itemView.clearSelection()}_showError(e){this._showNotification(e,!1)}_showNotification(e,t){Ur({message:e,width:450},t?"success":"error",5e3)}_redrawComponent(e){this._itemView.refresh().then(()=>!e&&this._filesTreeView.refresh())}_getItemViewItems(){var e=this.option("itemView").showFolders,t=this._controller.getCurrentItems(!e);return this._updateToolbarWithSelectionOnFirstLoad(t),this.option("itemView.showParentFolder")&&(t=fe(t).then(i=>this._getPreparedItemViewItems(i))),t}_updateToolbarWithSelectionOnFirstLoad(e){if(this._firstItemViewLoad){this._firstItemViewLoad=!1;var t=this.option("selectedItemKeys");t.length>0&&fe(e).done(i=>{var r=tn(i,t);r.length>0&&this._updateToolbar(r)})}}_getPreparedItemViewItems(e){var t=this._getCurrentDirectory();if(t.fileItem.isRoot())return e;var i=t.fileItem.createClone();i.isParentFolder=!0,i.name="..",i.relativeName="..",i.key="".concat(Qs).concat(t.fileItem.key);var r=[...e];return r.unshift({fileItem:i,icon:"parentfolder"}),r}_onContextMenuShowing(e,t){var i,r=Ge({},t,["targetElement","cancel","event"]);r=Y(r,{viewArea:e,fileSystemItem:(i=t.itemData)===null||i===void 0?void 0:i.fileItem,_isActionButton:t.isActionButton}),this._actions.onContextMenuShowing(r),t.cancel=Ie(r.cancel,!1)}_getItemThumbnailInfo(e){var t=this.option("customizeThumbnail"),i=Ce(t)?t(e.fileItem):e.fileItem.thumbnail;return i?{thumbnail:i,cssClass:Js}:{thumbnail:e.icon}}_getDefaultOptions(){return Y(super._getDefaultOptions(),{fileSystemProvider:null,currentPath:"",currentPathKeys:[],rootFolderName:z.format("dxFileManager-rootDirectoryName"),selectionMode:"multiple",selectedItemKeys:[],focusedItemKey:void 0,toolbar:{items:["showNavPane","create","upload","switchView",{name:"separator",location:"after"},"refresh"],fileSelectionItems:["download","separator","move","copy","rename","separator","delete","clearSelection",{name:"separator",location:"after"},"refresh"]},contextMenu:{items:["create","upload","rename","move","copy","delete","refresh","download"]},itemView:{details:{columns:["thumbnail","name","dateModified","size"]},mode:"details",showFolders:!0,showParentFolder:!0},customizeThumbnail:null,customizeDetailColumns:null,onContextMenuItemClick:null,onContextMenuShowing:null,onCurrentDirectoryChanged:null,onSelectedFileOpened:null,onSelectionChanged:null,onFocusedItemChanged:null,onToolbarItemClick:null,onErrorOccurred:null,onDirectoryCreating:null,onDirectoryCreated:null,onItemRenaming:null,onItemRenamed:null,onItemDeleting:null,onItemDeleted:null,onItemCopying:null,onItemCopied:null,onItemMoving:null,onItemMoved:null,onFileUploading:null,onFileUploaded:null,onItemDownloading:null,allowedFileExtensions:[],upload:{maxFileSize:0,chunkSize:2e5},permissions:Y({},sr),notifications:{showPanel:!0,showPopup:!0}})}option(e,t){var i=kr(e,t),r=arguments.length<2&&Nr(e)!=="object",n=o=>ne(i[o]),a=o=>{if(!n(o))return!1;var d=this.option(o),g=i[o];return!Or(d,g)};return!r&&n("fileSystemProvider")&&(this._providerUpdateDeferred=new re,(a("currentPath")||a("currentPathKeys"))&&(this._lockCurrentPathProcessing=!0)),super.option(...arguments)}_optionChanged(e){var t=e.name;switch(t){case"currentPath":var i=()=>(this._lockCurrentPathProcessing=!1,this._controller.setCurrentPath(e.value));this._lockCurrentPathProcessing=!0,this._providerUpdateDeferred?this._providerUpdateDeferred.then(i):i();break;case"currentPathKeys":var r=()=>(this._lockCurrentPathProcessing=!1,this._controller.setCurrentPathByKeys(e.value));this._lockCurrentPathProcessing=!0,this._providerUpdateDeferred?this._providerUpdateDeferred.then(r):r();break;case"selectedItemKeys":!this._lockSelectionProcessing&&this._itemView&&this._itemView.option("selectedItemKeys",e.value);break;case"focusedItemKey":!this._lockFocusedItemProcessing&&this._itemView&&this._itemView.option("focusedItemKey",e.value);break;case"rootFolderName":this._controller.setRootText(e.value),this._invalidate();break;case"fileSystemProvider":this._lockCurrentPathProcessing||(this._providerUpdateDeferred=new re);var n=this._lockCurrentPathProcessing?void 0:this.option("currentPathKeys");this._controller.updateProvider(e.value,n).then(()=>this._providerUpdateDeferred.resolve()).always(()=>{this._providerUpdateDeferred=null,this.repaint()});break;case"allowedFileExtensions":this._controller.setAllowedFileExtensions(e.value),this._invalidate();break;case"upload":this._controller.setUploadOptions(this.option("upload")),this._invalidate();break;case"permissions":this._commandManager.updatePermissions(this.option("permissions")),this._filesTreeViewContextMenu.tryUpdateVisibleContextMenu(),this._itemViewContextMenu.tryUpdateVisibleContextMenu(),this._toolbar.updateItemPermissions(),this._updateUploadDropZone();break;case"selectionMode":case"customizeThumbnail":case"customizeDetailColumns":this._invalidate();break;case"itemView":e.fullName==="itemView.mode"?this._switchView(e.value):this._invalidate();break;case"toolbar":var a={};e.fullName==="toolbar"&&(e.value.items&&(a.generalItems=e.value.items),e.value.fileSelectionItems&&(a.fileItems=e.value.fileSelectionItems)),e.fullName.indexOf("toolbar.items")===0&&(a.generalItems=this.option("toolbar.items")),e.fullName.indexOf("toolbar.fileSelectionItems")===0&&(a.fileItems=this.option("toolbar.fileSelectionItems")),this._toolbar.option(a);break;case"contextMenu":if(e.fullName==="contextMenu"&&e.value.items||e.fullName.indexOf("contextMenu.items")===0){var o=this.option("contextMenu.items");this._filesTreeViewContextMenu.option("items",o),this._itemViewContextMenu.option("items",o)}break;case"notifications":this._notificationControl.option("showProgressPanel",this.option("notifications.showPanel")),this._notificationControl.option("showNotificationPopup",this.option("notifications.showPopup"));break;case"onContextMenuItemClick":case"onContextMenuShowing":case"onCurrentDirectoryChanged":case"onSelectedFileOpened":case"onSelectionChanged":case"onFocusedItemChanged":case"onToolbarItemClick":case"onErrorOccurred":this._actions[t]=this._createActionByOption(t);break;case"onDirectoryCreating":case"onDirectoryCreated":case"onItemRenaming":case"onItemRenamed":case"onItemDeleting":case"onItemDeleted":case"onItemCopying":case"onItemCopied":case"onItemMoving":case"onItemMoved":case"onFileUploading":case"onFileUploaded":case"onItemDownloading":this._actions.editing[t]=this._createActionByOption(t);break;case"rtlEnabled":this._editing.updateDialogRtl(e.value),super._optionChanged(e);break;default:super._optionChanged(e)}}_initActions(){this._actions={onContextMenuItemClick:this._createActionByOption("onContextMenuItemClick"),onContextMenuShowing:this._createActionByOption("onContextMenuShowing"),onCurrentDirectoryChanged:this._createActionByOption("onCurrentDirectoryChanged"),onSelectedFileOpened:this._createActionByOption("onSelectedFileOpened"),onSelectionChanged:this._createActionByOption("onSelectionChanged"),onFocusedItemChanged:this._createActionByOption("onFocusedItemChanged"),onToolbarItemClick:this._createActionByOption("onToolbarItemClick"),onErrorOccurred:this._createActionByOption("onErrorOccurred"),editing:{onDirectoryCreating:this._createActionByOption("onDirectoryCreating"),onDirectoryCreated:this._createActionByOption("onDirectoryCreated"),onItemRenaming:this._createActionByOption("onItemRenaming"),onItemRenamed:this._createActionByOption("onItemRenamed"),onItemDeleting:this._createActionByOption("onItemDeleting"),onItemDeleted:this._createActionByOption("onItemDeleted"),onItemCopying:this._createActionByOption("onItemCopying"),onItemCopied:this._createActionByOption("onItemCopied"),onItemMoving:this._createActionByOption("onItemMoving"),onItemMoved:this._createActionByOption("onItemMoved"),onFileUploading:this._createActionByOption("onFileUploading"),onFileUploaded:this._createActionByOption("onFileUploaded"),onItemDownloading:this._createActionByOption("onItemDownloading")}}}executeCommand(e){return this._commandManager.executeCommand(e)}_setCurrentDirectory(e,t){this._controller.setCurrentDirectory(e,t)}_getCurrentDirectory(){return this._controller.getCurrentDirectory()}_onControllerInitialized(e){var{controller:t}=e;this._controller=this._controller||t,this._syncToCurrentDirectory()}_onDataLoading(e){var{operation:t}=e,i=null;t===tt.NAVIGATION&&(i={focusedItemKey:this._itemKeyToFocus,selectedItemKeys:this.option("selectedItemKeys")},this._itemKeyToFocus=void 0),this._itemView.refresh(i,t)}_onSelectedDirectoryChanged(){var e=this._getCurrentDirectory();this._syncToCurrentDirectory(),this._actions.onCurrentDirectoryChanged({directory:e.fileItem})}_syncToCurrentDirectory(){var e=this._getCurrentDirectory();this._filesTreeView&&this._filesTreeView.updateCurrentDirectory(),this._breadcrumbs&&this._breadcrumbs.setCurrentDirectory(e),this._checkPathActuality()}_checkPathActuality(){if(!this._lockCurrentPathProcessing){var e=this._controller.getCurrentPath(),t=this._controller.getCurrentPathKeys(),i={};this.option("currentPath")!==e&&(i.currentPath=e),Ji(this.option("currentPathKeys"),t)||(i.currentPathKeys=t),Yi(i)||this.option(i)}}getDirectories(e,t){return this._controller.getDirectories(e,t)}_getSelectedItemInfos(){return this._itemView?this._itemView.getSelectedItems():[]}refresh(){return this.executeCommand("refresh")}getCurrentDirectory(){var e=this._getCurrentDirectory();return e&&e.fileItem||null}getSelectedItems(){return this._getSelectedItemInfos().map(e=>e.fileItem)}_onSelectedItemOpened(e){var{fileItemInfo:t}=e,i=t.fileItem;if(!i.isDirectory){this._actions.onSelectedFileOpened({file:i});return}i.isParentFolder&&(this._itemKeyToFocus=this._getCurrentDirectory().fileItem.key);var r=i.isParentFolder?this._getCurrentDirectory().parentDirectory:t;this._setCurrentDirectory(r),r&&this._filesTreeView.toggleDirectoryExpandedState(r.parentDirectory,!0)}}pt("dxFileManager",fr);const eo=Object.freeze(Object.defineProperty({__proto__:null,default:fr},Symbol.toStringTag,{value:"Module"})),to=wr(eo);/*!
 * devextreme-vue
 * Version: 23.1.6
 * Build date: Fri Oct 13 2023
 *
 * Copyright (c) 2012 - 2023 Developer Express Inc. ALL RIGHTS RESERVED
 *
 * This software may be modified and distributed under the terms
 * of the MIT license. See the LICENSE file in the root of the project for details.
 *
 * https://github.com/DevExpress/devextreme-vue
 */var io=Je&&Je.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(de,"__esModule",{value:!0});de.DxUpload=de.DxToolbarItem=de.DxToolbar=so=de.DxPermissions=de.DxNotifications=de.DxItemView=de.DxItem=de.DxFileSelectionItem=de.DxDetails=de.DxContextMenuItem=de.DxContextMenu=de.DxColumn=ao=de.DxFileManager=void 0;var ro=io(to),no=qi,we=qi,gr=(0,no.createComponent)({props:{accessKey:String,activeStateEnabled:Boolean,allowedFileExtensions:Array,contextMenu:Object,currentPath:String,currentPathKeys:Array,customizeDetailColumns:Function,customizeThumbnail:Function,disabled:Boolean,elementAttr:Object,fileSystemProvider:{},focusedItemKey:String,focusStateEnabled:Boolean,height:[Function,Number,String],hint:String,hoverStateEnabled:Boolean,itemView:Object,notifications:Object,onContentReady:Function,onContextMenuItemClick:Function,onContextMenuShowing:Function,onCurrentDirectoryChanged:Function,onDirectoryCreated:Function,onDirectoryCreating:Function,onDisposing:Function,onErrorOccurred:Function,onFileUploaded:Function,onFileUploading:Function,onFocusedItemChanged:Function,onInitialized:Function,onItemCopied:Function,onItemCopying:Function,onItemDeleted:Function,onItemDeleting:Function,onItemDownloading:Function,onItemMoved:Function,onItemMoving:Function,onItemRenamed:Function,onItemRenaming:Function,onOptionChanged:Function,onSelectedFileOpened:Function,onSelectionChanged:Function,onToolbarItemClick:Function,permissions:Object,rootFolderName:String,rtlEnabled:Boolean,selectedItemKeys:Array,selectionMode:String,tabIndex:Number,toolbar:Object,upload:Object,visible:Boolean,width:[Function,Number,String]},emits:{"update:isActive":null,"update:hoveredElement":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:allowedFileExtensions":null,"update:contextMenu":null,"update:currentPath":null,"update:currentPathKeys":null,"update:customizeDetailColumns":null,"update:customizeThumbnail":null,"update:disabled":null,"update:elementAttr":null,"update:fileSystemProvider":null,"update:focusedItemKey":null,"update:focusStateEnabled":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:itemView":null,"update:notifications":null,"update:onContentReady":null,"update:onContextMenuItemClick":null,"update:onContextMenuShowing":null,"update:onCurrentDirectoryChanged":null,"update:onDirectoryCreated":null,"update:onDirectoryCreating":null,"update:onDisposing":null,"update:onErrorOccurred":null,"update:onFileUploaded":null,"update:onFileUploading":null,"update:onFocusedItemChanged":null,"update:onInitialized":null,"update:onItemCopied":null,"update:onItemCopying":null,"update:onItemDeleted":null,"update:onItemDeleting":null,"update:onItemDownloading":null,"update:onItemMoved":null,"update:onItemMoving":null,"update:onItemRenamed":null,"update:onItemRenaming":null,"update:onOptionChanged":null,"update:onSelectedFileOpened":null,"update:onSelectionChanged":null,"update:onToolbarItemClick":null,"update:permissions":null,"update:rootFolderName":null,"update:rtlEnabled":null,"update:selectedItemKeys":null,"update:selectionMode":null,"update:tabIndex":null,"update:toolbar":null,"update:upload":null,"update:visible":null,"update:width":null},computed:{instance:function(){return this.$_instance}},beforeCreate:function(){this.$_WidgetClass=ro.default,this.$_hasAsyncTemplate=!0,this.$_expectedChildren={contextMenu:{isCollectionItem:!1,optionName:"contextMenu"},itemView:{isCollectionItem:!1,optionName:"itemView"},notifications:{isCollectionItem:!1,optionName:"notifications"},permissions:{isCollectionItem:!1,optionName:"permissions"},toolbar:{isCollectionItem:!1,optionName:"toolbar"},upload:{isCollectionItem:!1,optionName:"upload"}}}}),ao=de.DxFileManager=gr,jt=(0,we.createConfigurationComponent)({emits:{"update:isActive":null,"update:hoveredElement":null,"update:alignment":null,"update:caption":null,"update:cssClass":null,"update:dataField":null,"update:dataType":null,"update:hidingPriority":null,"update:sortIndex":null,"update:sortOrder":null,"update:visible":null,"update:visibleIndex":null,"update:width":null},props:{alignment:String,caption:String,cssClass:String,dataField:String,dataType:String,hidingPriority:Number,sortIndex:Number,sortOrder:String,visible:Boolean,visibleIndex:Number,width:[Number,String]}});de.DxColumn=jt;jt.$_optionName="columns";jt.$_isCollectionItem=!0;var Zt=(0,we.createConfigurationComponent)({emits:{"update:isActive":null,"update:hoveredElement":null,"update:items":null},props:{items:Array}});de.DxContextMenu=Zt;Zt.$_optionName="contextMenu";Zt.$_expectedChildren={contextMenuItem:{isCollectionItem:!0,optionName:"items"},item:{isCollectionItem:!0,optionName:"items"}};var qt=(0,we.createConfigurationComponent)({emits:{"update:isActive":null,"update:hoveredElement":null,"update:beginGroup":null,"update:closeMenuOnClick":null,"update:disabled":null,"update:icon":null,"update:items":null,"update:name":null,"update:selectable":null,"update:selected":null,"update:text":null,"update:visible":null},props:{beginGroup:Boolean,closeMenuOnClick:Boolean,disabled:Boolean,icon:String,items:Array,name:String,selectable:Boolean,selected:Boolean,text:String,visible:Boolean}});de.DxContextMenuItem=qt;qt.$_optionName="items";qt.$_isCollectionItem=!0;var Xt=(0,we.createConfigurationComponent)({emits:{"update:isActive":null,"update:hoveredElement":null,"update:columns":null},props:{columns:Array}});de.DxDetails=Xt;Xt.$_optionName="details";Xt.$_expectedChildren={column:{isCollectionItem:!0,optionName:"columns"}};var Yt=(0,we.createConfigurationComponent)({emits:{"update:isActive":null,"update:hoveredElement":null,"update:cssClass":null,"update:disabled":null,"update:icon":null,"update:locateInMenu":null,"update:location":null,"update:name":null,"update:options":null,"update:showText":null,"update:text":null,"update:visible":null,"update:widget":null},props:{cssClass:String,disabled:Boolean,icon:String,locateInMenu:String,location:String,name:String,options:{},showText:String,text:String,visible:Boolean,widget:String}});de.DxFileSelectionItem=Yt;Yt.$_optionName="fileSelectionItems";Yt.$_isCollectionItem=!0;var Jt=(0,we.createConfigurationComponent)({emits:{"update:isActive":null,"update:hoveredElement":null,"update:beginGroup":null,"update:closeMenuOnClick":null,"update:cssClass":null,"update:disabled":null,"update:icon":null,"update:items":null,"update:locateInMenu":null,"update:location":null,"update:name":null,"update:options":null,"update:selectable":null,"update:selected":null,"update:showText":null,"update:text":null,"update:visible":null,"update:widget":null},props:{beginGroup:Boolean,closeMenuOnClick:Boolean,cssClass:String,disabled:Boolean,icon:String,items:Array,locateInMenu:String,location:String,name:String,options:{},selectable:Boolean,selected:Boolean,showText:String,text:String,visible:Boolean,widget:String}});de.DxItem=Jt;Jt.$_optionName="items";Jt.$_isCollectionItem=!0;var Qt=(0,we.createConfigurationComponent)({emits:{"update:isActive":null,"update:hoveredElement":null,"update:details":null,"update:mode":null,"update:showFolders":null,"update:showParentFolder":null},props:{details:Object,mode:String,showFolders:Boolean,showParentFolder:Boolean}});de.DxItemView=Qt;Qt.$_optionName="itemView";Qt.$_expectedChildren={details:{isCollectionItem:!1,optionName:"details"}};var vr=(0,we.createConfigurationComponent)({emits:{"update:isActive":null,"update:hoveredElement":null,"update:showPanel":null,"update:showPopup":null},props:{showPanel:Boolean,showPopup:Boolean}});de.DxNotifications=vr;vr.$_optionName="notifications";var Ir=(0,we.createConfigurationComponent)({emits:{"update:isActive":null,"update:hoveredElement":null,"update:copy":null,"update:create":null,"update:delete":null,"update:download":null,"update:move":null,"update:rename":null,"update:upload":null},props:{copy:Boolean,create:Boolean,delete:Boolean,download:Boolean,move:Boolean,rename:Boolean,upload:Boolean}}),so=de.DxPermissions=Ir;Ir.$_optionName="permissions";var ei=(0,we.createConfigurationComponent)({emits:{"update:isActive":null,"update:hoveredElement":null,"update:fileSelectionItems":null,"update:items":null},props:{fileSelectionItems:Array,items:Array}});de.DxToolbar=ei;ei.$_optionName="toolbar";ei.$_expectedChildren={fileSelectionItem:{isCollectionItem:!0,optionName:"fileSelectionItems"},item:{isCollectionItem:!0,optionName:"items"},toolbarItem:{isCollectionItem:!0,optionName:"items"}};var ti=(0,we.createConfigurationComponent)({emits:{"update:isActive":null,"update:hoveredElement":null,"update:cssClass":null,"update:disabled":null,"update:icon":null,"update:locateInMenu":null,"update:location":null,"update:name":null,"update:options":null,"update:showText":null,"update:text":null,"update:visible":null,"update:widget":null},props:{cssClass:String,disabled:Boolean,icon:String,locateInMenu:String,location:String,name:String,options:{},showText:String,text:String,visible:Boolean,widget:String}});de.DxToolbarItem=ti;ti.$_optionName="items";ti.$_isCollectionItem=!0;var Cr=(0,we.createConfigurationComponent)({emits:{"update:isActive":null,"update:hoveredElement":null,"update:chunkSize":null,"update:maxFileSize":null},props:{chunkSize:Number,maxFileSize:Number}});de.DxUpload=Cr;Cr.$_optionName="upload";de.default=gr;export{hn as C,so as D,Ht as F,Ks as S,hr as T,ao as a,Kt as b,yo as c,de as d,ui as f,Co as p};
