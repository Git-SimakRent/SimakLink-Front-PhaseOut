import{$ as m,e as b,d as z,a3 as Ie,aq as Bt,t as ht,T as q,g as ne,o as J,Q as Ee,ad as te,C as re,av as Ta,aR as fl,a1 as be,aa as ku,ai as Mu,V as Te,m as X,L as le,p as Y,ap as ii,a as $,i as ai,aw as Ai,aK as Nu,W as dr,M as wi,r as _r,aS as zu,aH as Hu,u as _e,b as ml,aT as Wu,Y as Ra,a7 as bn,aG as In,aE as Gu,aU as Ku,aV as _l,aW as xi,R as Oa,aX as Cl,_ as Aa,X as ur,s as Tn,U as wl,ar as Uu,v as $u,a5 as ni,y as Rn,A as On,B as An,P as Dn,a4 as Di,aY as jt,E as qu,K as Xu,N as ju}from"./index.94f86987.js";import{T as S,U as me,a7 as Cr,Z as T,aM as ye,ai as y,$ as H,as as xl,ak as L,bs as Yu,a1 as G,a8 as He,Y as Fe,aa as oi,a0 as _,aF as Xr,aC as ke,ae as wr,aI as U,af as P,bt as yi,W as O,aq as At,aN as Me,bu as Vn,aS as Ue,ar as Qu,a9 as Q,aB as de,aE as Ju,az as yl,bv as hr,bw as Fn,aJ as fe,bx as cr,aA as Zu,aO as xe,by as eh,bz as th,aj as rh,ab as bt,a6 as xr,ay as Lt,aH as Da,bA as ih,aU as ah,ah as Pn}from"./entry.f47474d7.js";import{h as Ei,b as yr,m as Dt,g as nh,D as El,o as oh,A as en,C as sh,p as jr,i as Rt,l as lh,k as Sl,f as si,s as li,q as Er,r as dh,d as st,e as bl,c as uh,B as hh}from"./ui.collection_widget.edit.95cdfece.js";import{d as Nt,b as di,F as Il,V as ch,N as ph,h as gh,i as Bn,o as vh}from"./ui.form.bf59509c.js";import{D as Tl,C as fh,T as tn,M as Ln,g as mh}from"./ui.menu.f201d4e6.js";import{T as _h}from"./ui.toolbar.1b55a2cc.js";import{B as pr,g as Va,q as Ch,V as zt,C as wh,I as kt,e as qe,f as je,_ as ue,n as Sr,i as Z,b as gt,d as Ye,j as xh,t as yh,c as Si,u as Ae,h as rn,k as Eh,W as Sh,m as bh,o as Ih}from"./resize_observer.3c2fa9a2.js";import{P as vt,S as Th,t as Rh}from"./ui.popup.81669a77.js";import{E as Oh}from"./text_box.08b8e7e6.js";import{S as Ah}from"./m_sortable.242c124b.js";import{L as an}from"./ui.list.edit.decorator.selection.f35f8c9c.js";import{C as Dh,g as Vh,E as Rl,D as Ol}from"./check_box.j.64bc2370.js";import{L as Fh}from"./load_panel.0862d4ae.js";var Fa="dx-state-focused",Ph="dx-cell-focus-disabled",Bh=".dx-row-focused",Al=".dx-datagrid-rowsview .dx-row",kn="".concat(Al," > td"),Dl=".dx-treelist-rowsview .dx-row",Mn="".concat(Dl," > td"),Nn={groupPanel:[".dx-datagrid-group-panel .dx-group-panel-item[tabindex]"],columnHeaders:[".dx-datagrid-headers .dx-header-row > td.dx-datagrid-action",".dx-treelist-headers .dx-header-row > td.dx-treelist-action"],filterRow:[".dx-datagrid-headers .dx-datagrid-filter-row .dx-editor-cell .dx-texteditor-input",".dx-treelist-headers .dx-treelist-filter-row .dx-editor-cell .dx-texteditor-input"],rowsView:["".concat(Bh),"".concat(Al,"[tabindex]"),"".concat(kn,"[tabindex]"),"".concat(kn),"".concat(Dl,"[tabindex]"),"".concat(Mn,"[tabindex]"),"".concat(Mn)],footer:[".dx-datagrid-total-footer .dx-datagrid-summary-item",".dx-treelist-total-footer .dx-treelist-summary-item"],filterPanel:[".dx-datagrid-filter-panel .dx-icon-filter",".dx-treelist-filter-panel .dx-icon-filter"],pager:[".dx-datagrid-pager [tabindex]",".dx-treelist-pager [tabindex]"]},Vi=!1,ui=!1,wt=null;function Lh(r,e,t,i,a,n){var o=Mh(e,t.originalEvent,n);if(!o){var s=Ie(t);s==="enter"||s==="space"?(Vl(t.target,e),i&&i({event:t})):s==="tab"?a.addClass(Fa):on(r,e,t)}}function Vl(r,e){var t=m(r),i=t.attr("aria-label"),a=Fl(i,e.element()),n=a.index(t);wt=S({},{ariaLabel:i,index:n},{viewInstance:e})}function Fl(r,e){var t=m(e),i;return r?i=t.find('[aria-label="'.concat(r,'"][tabindex]')):i=t.find("[tabindex]"),i}function kh(r,e){var t=(e==null?void 0:e.getRootNode())||z.getDocument();for(var i in r){var a=r[i],n=m(t).find(a).first();if(n.length)return n}}function Mh(r,e,t){var i={event:e,handled:!1};return t?t(i):r._createActionByOption("onKeyDown")(i),i.handled}function Pl(){ui=z.getDocument().visibilityState==="visible"}function Nh(){b.on(z.getDocument(),"visibilitychange",Pl)}function zn(){b.off(z.getDocument(),"visibilitychange",Pl)}function zh(r,e){ui=!0,r.focus({preventScroll:e}),ui=!1}function Bl(r,e,t,i,a,n){if(e.option("useLegacyKeyboardNavigation"))return me;var o=()=>m(e.element()),s=u=>Lh(r,e,u,a,o(),n),l=()=>{Vi=!0,o().removeClass(Fa)},d=()=>{var u=!Vi&&!ui;u&&o().addClass(Fa),Vi=!1};return b.on(t,"keydown",i,s),b.on(t,"mousedown",i,l),b.on(t,"focusin",i,d),()=>{b.off(t,"keydown",i,s),b.off(t,"mousedown",i,l),b.off(t,"focusin",i,d)}}function nn(r){if(!r.option("useLegacyKeyboardNavigation")&&wt){var e=wt.viewInstance;if(e){var t=Fl(wt.ariaLabel,e.element()),i=t.eq(wt.index);wt=null,b.trigger(i,"focus")}}}function on(r,e,t){var i=Ie(t);if(t.ctrlKey&&(i==="upArrow"||i==="downArrow"))for(var a=Object.keys(Nn),n=a.indexOf(r);n>=0&&n<a.length;){n=i==="upArrow"?--n:++n;var o=a[n],s=Nn[o],l=kh(s,t.target);if(l&&l.length){l.attr("tabindex",e.option("tabindex")||0),b.trigger(l,"focus"),l.removeClass(Ph);break}}}function Hh(r,e){r.option("useLegacyKeyboardnavigation")||e.attr("tabindex",r.option("tabindex")||0)}var tr=function(r,e,t,i,a){var n=e.getController("keyboardNavigation");e.option("useLegacyKeyboardNavigation")||n&&!n.isKeyboardEnabled()||(e.createAction("onKeyDown"),Bl(r,e,t,i,a,o=>{e.executeAction("onKeyDown",o)}))},Hn="dx-column-indicators",Wh="dx-group-panel-item";const Gh={_applyColumnState(r){var e,t=this.option("rtlEnabled"),i=this._getColumnAlignment(r.column.alignment,t),a=S(!0,{columnAlignment:i},r),n=a.rootElement.hasClass(Wh),o=this._createIndicatorContainer(a,n),s=m("<span>").addClass(this._getIndicatorClassName(r.name)),l=(e=this.component)===null||e===void 0?void 0:e.getController("columns"),d=(l==null?void 0:l.getHeaderContentAlignment(i))||i;return a.container=o,a.indicator=s,this._renderIndicator(a),o[(n||!r.showColumnLines)&&d==="left"?"appendTo":"prependTo"](r.rootElement),s},_getIndicatorClassName:me,_getColumnAlignment(r,e){return e=e||this.option("rtlEnabled"),r&&r!=="center"?r:Bt(e)},_createIndicatorContainer(r,e){var t=this._getIndicatorContainer(r.rootElement),i=r.columnAlignment==="left"?"right":"left";return t.length||(t=m("<div>").addClass(Hn)),this.setAria("role","presentation",t),t.css("float",r.showColumnLines&&!e?i:null)},_getIndicatorContainer:r=>r&&r.find(".".concat(Hn)),_getIndicatorElements(r){var e=this._getIndicatorContainer(r);return e&&e.children()},_renderIndicator(r){var e=r.container,t=r.indicator;e&&t&&e.append(t)},_updateIndicators(r){var e=this.getColumns(),t=this.getColumnElements(),i;if(!(!t||e.length!==t.length))for(var a=0;a<e.length;a++){i=t.eq(a),this._updateIndicator(i,e[a],r);var n=i.parent().data("options");n&&n.cells&&(n.cells[i.index()].column=e[a])}},_updateIndicator(r,e,t){if(!e.command)return this._applyColumnState({name:t,rootElement:r,column:e,showColumnLines:this.option("showColumnLines")})}};var Kh="dxDataGrid",Ll=Cr.inherit({_endUpdateCore(){},ctor(r){var e=this;e._updateLockCount=0,e.component=r,e._actions={},e._actionConfigs={},T(this.callbackNames()||[],function(t,i){var a=e.callbackFlags(i)||{};a.unique=!0,a.syncStrategy=!0,e[this]=ye(a)})},init(){},callbackNames(){},callbackFlags(){},publicMethods(){},beginUpdate(){this._updateLockCount++},endUpdate(){this._updateLockCount>0&&(this._updateLockCount--,this._updateLockCount||this._endUpdateCore())},option(r){var{component:e}=this,t=e._optionCache;return arguments.length===1&&t?(r in t||(t[r]=e.option(r)),t[r]):e.option.apply(e,arguments)},_silentOption(r,e){var{component:t}=this,i=t._optionCache;return i&&(i[r]=e),t._setOptionWithoutOptionChange(r,e)},localize(r){var e=this.component._optionCache;return e?(r in e||(e[r]=y.format(r)),e[r]):y.format(r)},on(){return this.component.on.apply(this.component,arguments)},off(){return this.component.off.apply(this.component,arguments)},optionChanged(r){r.name in this._actions&&(this.createAction(r.name,this._actionConfigs[r.name]),r.handled=!0)},getAction(r){return this._actions[r]},setAria(r,e,t){var i=t.get(0),a=r!=="role"&&r!=="id"?"aria-":"";i.setAttribute?i.setAttribute(a+r,e):t.attr(a+r,e)},_createComponent(){return this.component._createComponent.apply(this.component,arguments)},getController(r){return this.component._controllers[r]},createAction(r,e){if(H(r)){var t=this.component._createAction(r.bind(this),e);return function(i){t({event:i})}}this._actions[r]=this.component._createActionByOption(r,e),this._actionConfigs[r]=e},executeAction(r,e){var t=this._actions[r];return t&&t(e)},dispose(){var r=this;T(r.callbackNames()||[],function(){r[this].empty()})},addWidgetPrefix(r){var e=this.component.NAME;return"dx-".concat(e.slice(2).toLowerCase()).concat(r?"-".concat(r):"")},getWidgetContainerClass(){var r=this.component.NAME===Kh?null:"container";return this.addWidgetPrefix(r)},elementIsInsideGrid(r){var e=r.closest(".".concat(this.getWidgetContainerClass())).parent();return e.is(this.component.$element())}}),sn=Ll,Uh=sn.inherit({getView(r){return this.component._views[r]},getViews(){return this.component._views}}),kl=Ll.inherit({_isReady(){return this.component.isReady()},_endUpdateCore(){this.callBase(),!this._isReady()&&this._requireReady&&(this._requireRender=!1,this.component._requireResize=!1),this._requireRender&&(this._requireRender=!1,this.render(this._$parent))},_invalidate(r,e){this._requireRender=!0,this.component._requireResize=ht()&&(this.component._requireResize||r),this._requireReady=this._requireReady||e},_renderCore(){},_resizeCore(){},_parentElement(){return this._$parent},ctor(r){this.callBase(r),this.renderCompleted=ye(),this.resizeCompleted=ye()},element(){return this._$element},getElementHeight(){var r=this.element();if(!r)return 0;var e=parseFloat(r.css("marginTop"))||0,t=parseFloat(r.css("marginBottom"))||0,{offsetHeight:i}=r.get(0);return i+e+t},isVisible:()=>!0,getTemplate(r){return this.component._getTemplate(r)},render(r,e){var t=this._$element,i=this.isVisible();if(!(!t&&!r)&&(this._requireReady=!1,t||(t=this._$element=m("<div>").appendTo(r),this._$parent=r),t.toggleClass("dx-hidden",!i),i)){this.component._optionCache={};var a=this._renderCore(e);this.component._optionCache=void 0,a?a.done(()=>{this.renderCompleted.fire(e)}):this.renderCompleted.fire(e)}},resize(){this.isResizing=!0,this._resizeCore(),this.resizeCompleted.fire(),this.isResizing=!1},focus(r){this.element().get(0).focus({preventScroll:r})}}),Wn=1e6;function Gn(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={};return Object.entries(e).forEach(i=>{var[a,n]=i,o=r[a];if(o)if(H(n))t[a]=n(o);else{var s=o;t[a]=s.inherit(n)}}),t}function $h(r,e,t){var i=t.publicMethods();i&&T(i,(a,n)=>{if(t[n])if(!r[n])r[n]=function(){return t[n](...arguments)};else throw q.Error("E1005",n);else throw q.Error("E1006",e,n)})}function qh(r,e){var{modules:t}=e,{modulesOrder:i}=e;function a(u){var h={};return T(u,(c,p)=>{var g=new p(r);g.name=c,$h(r,c,g),h[c]=g}),h}i&&t.sort((u,h)=>{var c=i.indexOf(u.name),p=i.indexOf(h.name);return c<0&&(c=Wn),p<0&&(p=Wn),c-p});var n={},o={};t.forEach(u=>{var{name:h,controllers:c={},views:p={}}=u;Object.entries(c).forEach(g=>{var[v,f]=g,C;if(n[v])throw q.Error("E1001",h,v);if(!(!((C=f==null?void 0:f.subclassOf)===null||C===void 0)&&C.call(f,sn)))throw q.Error("E1002",h,v);n[v]=f}),Object.entries(p).forEach(g=>{var[v,f]=g,C;if(o[v])throw q.Error("E1003",h,v);if(!(!((C=f==null?void 0:f.subclassOf)===null||C===void 0)&&C.call(f,kl)))throw q.Error("E1004",h,v);o[v]=f})});var s=t.filter(u=>{var{extenders:h}=u;return!!h}),l=s.reduce((u,h)=>{var{extenders:c}=h;return L(L({},u),Gn(u,c==null?void 0:c.controllers))},n),d=s.reduce((u,h)=>{var{extenders:c}=h;return L(L({},u),Gn(u,c==null?void 0:c.views))},o);r._controllers=a(l),r._views=a(d)}var Xh=function(r,e,t){t=t||[],r._controllers&&T(r._controllers,function(){this[e]&&this[e].apply(this,t)}),r._views&&T(r._views,function(){this[e]&&this[e].apply(this,t)})};const W={modules:[],View:kl,ViewController:Uh,Controller:sn,registerModule(r,e){for(var{modules:t}=this,i=0;i<t.length;i++)if(t[i].name===r)return;e.name=r,t.push(e)},registerModulesOrder(r){this.modulesOrder=r},unregisterModule(r){this.modules=xl(this.modules,e=>e.name!==r)},processModules:qh,callModuleItemsMethod:Xh},Ml=Yu({format:function(r,e){var t=G(e)&&e!==""||He(e)||H(e),i=Fe(r)||oi(r);if(!t||!i)return _(r)?r.toString():"";if(H(e))return e(r);if(G(e)&&(e={type:e}),Fe(r))return Xr.format(r,e);if(oi(r))return ke.format(r,e)},getTimeFormat:function(r){return r?"longtime":"shorttime"},_normalizeFormat:function(r){return Array.isArray(r)?r.length===1?r[0]:function(e){return r.map(function(t){return ke.format(e,t)}).join(" ")}:r},getDateFormatByDifferences:function(r,e){var t=[],i=e&&r.millisecond&&!(r.year||r.month||r.day);return i?t.push(function(a){return a.getSeconds()+a.getMilliseconds()/1e3+"s"}):r.millisecond&&t.push("millisecond"),(r.hour||r.minute||!i&&r.second)&&t.unshift(this.getTimeFormat(r.second)),r.year&&r.month&&r.day?e&&e==="month"?"monthandyear":(t.unshift("shortdate"),this._normalizeFormat(t)):r.year&&r.month?"monthandyear":r.year&&r.quarter?"quarterandyear":r.year?"year":r.quarter?"quarter":r.month&&r.day?(e?t.unshift(function(a){return ke.getMonthNames("abbreviated")[a.getMonth()]+" "+ke.format(a,"day")}):t.unshift("monthandday"),this._normalizeFormat(t)):r.month?"month":r.day?(e?t.unshift("day"):t.unshift(function(a){return ke.format(a,"dayofweek")+", "+ke.format(a,"day")}),this._normalizeFormat(t)):this._normalizeFormat(t)},getDateFormatByTicks:function(r){var e,t,i;if(r.length>1)for(e=Nt.getDatesDifferences(r[0],r[1]),i=1;i<r.length-1;i++)t=Nt.getDatesDifferences(r[i],r[i+1]),e.count<t.count&&(e=t);else e={year:!0,month:!0,day:!0,hour:r[0].getHours()>0,minute:r[0].getMinutes()>0,second:r[0].getSeconds()>0,millisecond:r[0].getMilliseconds()>0};var a=this.getDateFormatByDifferences(e);return a},getDateFormatByTickInterval:function(r,e,t){var i,a=function(s,l,d){switch(l){case"year":case"quarter":s.month=d;case"month":s.day=d;case"week":case"day":s.hour=d;case"hour":s.minute=d;case"minute":s.second=d;case"second":s.millisecond=d}};t=G(t)?t.toLowerCase():t;var n=Nt.getDatesDifferences(r,e);r!==e&&function(s,l,d){!d.getMilliseconds()&&d.getSeconds()?d.getSeconds()-l.getSeconds()===1&&(s.millisecond=!0,s.second=!1):!d.getSeconds()&&d.getMinutes()?d.getMinutes()-l.getMinutes()===1&&(s.second=!0,s.minute=!1):!d.getMinutes()&&d.getHours()?d.getHours()-l.getHours()===1&&(s.minute=!0,s.hour=!1):!d.getHours()&&d.getDate()>1?d.getDate()-l.getDate()===1&&(s.hour=!0,s.day=!1):d.getDate()===1&&d.getMonth()?d.getMonth()-l.getMonth()===1&&(s.day=!0,s.month=!1):!d.getMonth()&&d.getFullYear()&&d.getFullYear()-l.getFullYear()===1&&(s.month=!0,s.year=!1)}(n,r>e?e:r,r>e?r:e),i=Nt.getDateUnitInterval(n),a(n,i,!0),i=Nt.getDateUnitInterval(t||"second"),a(n,i,!1),n[{week:"day"}[i]||i]=!0;var o=this.getDateFormatByDifferences(n);return o}});var jh=["year","month","day"],Yh=["year","month","day","hour","minute"],Pa=function(r){return r==="date"||r==="datetime"},Fi=function(r){var e,t=[],i=["year","month","day","hour","minute","second"],a=r.headerFilter&&r.headerFilter.groupInterval,n=a==="quarter"?"month":a;if(Pa(r.dataType)&&a!==null)return t=r.dataType==="datetime"?Yh:jh,e=i.indexOf(n),e>=0&&(t=i.slice(0,e),t.push(a)),t;if(_(a))return Array.isArray(a)?a:[a]};const ct=function(){var r=function(a,n){var o=a.dataField||a.selector;return n==="search"&&(o=a.displayField||a.calculateDisplayValue||o),o},e=function(a,n){var o,s,l,d=r(this,n);if(Array.isArray(a)&&_(a[0])&&_(a[1]))return s=[d,">=",a[0]],l=[d,"<=",a[1]],Pa(this.dataType)&&(u=a[1],u.getHours()+u.getMinutes()+u.getSeconds()+u.getMilliseconds()<1)&&(o=new Date(a[1].getTime()),this.dataType==="date"&&o.setDate(a[1].getDate()+1),l=[d,"<",o]),[s,"and",l];var u},t=function(a,n,o){var s,l,d,u=function(c){return oi(c)?[c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds()]:wr((""+c).split("/"),function(p,g){return g===1?Number(p)-1:Number(p)})}(a),h=r(this,o);switch(o==="headerFilter"?d=Fi(this)[u.length-1]:this.dataType==="datetime"&&(d="minute"),d){case"year":s=new Date(u[0],0,1),l=new Date(u[0]+1,0,1);break;case"month":s=new Date(u[0],u[1],1),l=new Date(u[0],u[1]+1,1);break;case"quarter":s=new Date(u[0],3*u[1],1),l=new Date(u[0],3*u[1]+3,1);break;case"hour":s=new Date(u[0],u[1],u[2],u[3]),l=new Date(u[0],u[1],u[2],u[3]+1);break;case"minute":s=new Date(u[0],u[1],u[2],u[3],u[4]),l=new Date(u[0],u[1],u[2],u[3],u[4]+1);break;case"second":s=new Date(u[0],u[1],u[2],u[3],u[4],u[5]),l=new Date(u[0],u[1],u[2],u[3],u[4],u[5]+1);break;default:s=new Date(u[0],u[1],u[2]),l=new Date(u[0],u[1],u[2]+1)}switch(n){case"<":return[h,"<",s];case"<=":return[h,"<",l];case">":return[h,">=",l];case">=":return[h,">=",s];case"<>":return[[h,"<",s],"or",[h,">=",l]];default:return[[h,">=",s],"and",[h,"<",l]]}},i=function(a,n,o){var s=r(this,o),l=Fi(this);if(o==="headerFilter"&&l&&_(a)){var d=(""+a).split("/"),u=Number(d[d.length-1]),h=l[d.length-1],c=[s,">=",u],p=[s,"<",u+h],g=[c,"and",p];return g}return[s,n||"=",a]};return{defaultCalculateFilterExpression:function(a,n,o){var s=this,l=r(s,o),d=s.calculateDisplayValue&&o==="search",u=d&&s.lookup&&s.lookup.dataType||s.dataType,h=null;if((o==="headerFilter"||o==="filterBuilder")&&a===null)h=[l,n||"=",null],u==="string"&&(h=[h,n==="="?"or":"and",[l,n||"=",""]]);else if(u==="string"&&(!s.lookup||d))h=[l,n||"contains",a];else{if(n==="between")return e.apply(s,[a,o]);if(Pa(u)&&_(a))return t.apply(s,arguments);if(u==="number")return i.apply(s,arguments);h=[l,n||"=",a]}return h},getGroupInterval:Fi}}();var Qh="dx-selection-disabled",Jh="dx-datagrid-group-opened",Zh="dx-datagrid-group-closed",ec="dx-datagrid-expand",tc="nodata",rc="infinite",Kn="virtual",ic="scrolling.legacyMode",Un="scrolling.mode",ac="scrolling.rowRenderingMode",nc={year:r=>r&&r.getFullYear(),month:r=>r&&r.getMonth()+1,day:r=>r&&r.getDate(),quarter:r=>r&&Math.floor(r.getMonth()/3)+1,hour:r=>r&&r.getHours(),minute:r=>r&&r.getMinutes(),second:r=>r&&r.getSeconds()},oc=function(){var r=arguments[1],e=this.calculateCellValue(r);if(!_(e))return null;if(Nl(this.dataType)){var t=arguments[0];return nc[t](e)}if(this.dataType==="number"){var i=arguments[0];return Math.floor(Number(e)/i)*i}},sc=function(r,e){return H(r)&&H(e)&&r.originalCallback&&e.originalCallback?r.originalCallback===e.originalCallback&&r.columnIndex===e.columnIndex:r===e};function Nl(r){return r==="date"||r==="datetime"}var $n=function(r){r.get(0).textContent="Â "},Pi=function(r){r=r||[];for(var e=Dt(r),t=0;t<r.length;t++)r&&r[t]&&r[t].isExpanded!==void 0&&(e[t].isExpanded=r[t].isExpanded),r&&r[t]&&r[t].groupInterval!==void 0&&(e[t].groupInterval=r[t].groupInterval);return e},zl=function(r,e){var t=Ml.format(r,e.format)||r&&r.toString()||"",i={value:r,valueText:e.getDisplayFormat?e.getDisplayFormat(t):t,target:e.target||"row",groupInterval:e.groupInterval};return e.customizeText?e.customizeText.call(e,i):i.valueText},qn=function(r,e){var t=r.displayFormat||r.columnCaption&&e["".concat(r.summaryType,"OtherColumn")]||e[r.summaryType];return zl(r.value,{format:r.valueFormat,getDisplayFormat:i=>t?At(t,i,r.columnCaption):i,customizeText:r.customizeText})},Xn=function(r){var e=r.data&&r.data(),t=e&&e.dxComponents,i=t&&t[0];return i&&e[i]},lc=function r(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(!r(e[i],t[i]))return!1;return!0}return H(e)&&e.columnIndex>=0&&H(t)&&t.columnIndex>=0?e.columnIndex===t.columnIndex&&Me(e.filterValue)===Me(t.filterValue)&&Me(e.selectedFilterOperation)===Me(t.selectedFilterOperation):Me(e)==Me(t)};function dc(r){return Array.isArray(r)||(r=[r]),r.map((e,t)=>G(e)?{selector:e,isExpanded:t<r.length-1}:e)}const I={renderNoDataText(r){if(r=r||this.element(),!!r){var e=this.addWidgetPrefix(tc),t=r.find(".".concat(e)).last(),i=this._dataController.isEmpty(),a=this._dataController.isLoading();t.length||(t=m("<span>").addClass(e)),t.parent().is(r)||t.appendTo(r),i&&!a?t.removeClass("dx-hidden").text(this._getNoDataText()):t.addClass("dx-hidden")}},renderLoadPanel(r,e,t){var i;this._loadPanel&&this._loadPanel.$element().remove(),i=this.option("loadPanel"),i&&(i.enabled==="auto"?!t:i.enabled)?(i=S({shading:!1,message:i.text,container:e},i),this._loadPanel=this._createComponent(m("<div>").appendTo(e),Fh,i)):this._loadPanel=null},calculateLoadPanelPosition(r){var e=m(ne());return J(r)>J(e)?{of:e,boundary:r,collision:"fit"}:{of:r}},getIndexByKey(r,e,t){var i=-1;if(r!==void 0&&Array.isArray(e)){t=arguments.length<=2?"key":t;for(var a=0;a<e.length;a++){var n=_(t)?e[a][t]:e[a];if(U(r,n)){i=a;break}}}return i},combineFilters(r,e){var t,i=[];e=e||"and";for(var a=0;a<r.length;a++)if(r[a]){if(((t=r[a])===null||t===void 0?void 0:t.length)===1&&r[a][0]==="!"){if(e==="and")return["!"];if(e==="or")continue}i.length&&i.push(e),i.push(r[a])}if(i.length===1&&(i=i[0]),i.length)return i},checkChanges(r,e){for(var t=0,i=0;i<e.length;i++)r[e[i]]&&t++;return r.length&&r.length===t},equalFilterParameters:lc,proxyMethod(r,e,t){r[e]||(r[e]=function(){var i=this._dataSource;return i?i[e].apply(i,arguments):t})},formatValue:zl,getFormatOptionsByColumn:(r,e)=>({format:r.format,getDisplayFormat:r.getDisplayFormat,customizeText:r.customizeText,target:e,trueText:r.trueText,falseText:r.falseText}),getDisplayValue(r,e,t,i){return r.displayValueMap&&r.displayValueMap[e]!==void 0?r.displayValueMap[e]:r.calculateDisplayValue&&t&&i!=="group"?r.calculateDisplayValue(t):r.lookup&&!(i==="group"&&(r.calculateGroupValue||r.calculateDisplayValue))?r.lookup.calculateCellValue(e):e},getGroupRowSummaryText(r,e){for(var t="(",i=0;i<r.length;i++){var a=r[i];t+=(i>0?", ":"")+qn(a,e)}return t+")"},getSummaryText:qn,normalizeSortingInfo:Pi,getFormatByDataType(r){switch(r){case"date":return"shortDate";case"datetime":return"shortDateShortTime";default:return}},getHeaderFilterGroupParameters(r,e){var t=[],i=r.dataField||r.name,a=ct.getGroupInterval(r);return a?(T(a,(n,o)=>{t.push(e?{selector:i,groupInterval:o,isExpanded:n<a.length-1}:oc.bind(r,o))}),t):(e?t=[{selector:i,isExpanded:!1}]:(t=function(n){var o=r.calculateCellValue(n);return(o===void 0||o==="")&&(o=null),o},r.sortingMethod&&(t=[{selector:t,compare:r.sortingMethod.bind(r)}])),t)},equalSortParameters(r,e,t){if(r=Pi(r),e=Pi(e),Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;for(var i=0;i<r.length;i++)if(!sc(r[i].selector,e[i].selector)||r[i].desc!==e[i].desc||r[i].groupInterval!==e[i].groupInterval||!t&&!!r[i].isExpanded!=!!e[i].isExpanded)return!1;return!0}return(!r||!r.length)==(!e||!e.length)},getPointsByColumns(r,e,t,i){for(var a=r.length,n=!1,o,s,l=i||0,d=[],u,h=0;h<=a;h++){h<a&&(o=r.eq(h),s=o.offset(),u=o.css("direction")==="rtl");var c={index:l,x:s?s.left+(!t&&u^h===a?Ee(o[0]).width:0):0,y:s?s.top+(t&&h===a?Ee(o[0]).height:0):0,columnIndex:l};if(!t&&h>0){var p=r.eq(h-1).offset();p.top<c.y&&(c.y=p.top)}e&&(n=e(c)),n||d.push(c),l++}return d},getExpandCellTemplate:()=>({allowRenderToDetachedContainer:!0,render(r,e){var t=m(r);if(_(e.value)&&!(e.data&&e.data.isContinuation)&&!e.row.isNewRow){var i=e.component.getView("rowsView");t.addClass(ec).addClass(Qh),m("<div>").addClass(e.value?Jh:Zh).appendTo(t),i.setAria("label",e.value?i.localize("dxDataGrid-ariaCollapse"):i.localize("dxDataGrid-ariaExpand"),t)}else $n(t)}}),setEmptyText:$n,isDateType:Nl,getSelectionRange(r){try{if(r)return{selectionStart:r.selectionStart,selectionEnd:r.selectionEnd}}catch{}return{}},setSelectionRange(r,e){try{r&&r.setSelectionRange&&r.setSelectionRange(e.selectionStart,e.selectionEnd)}catch{}},focusAndSelectElement(r,e){var t=e.is(":focus");b.trigger(e,"focus");var i=r.option("editing.selectTextOnEditStart"),a=e.get(0);if(!t&&i&&e.is(".dx-texteditor-input")&&!e.is("[readonly]")){var n=Xn(e.closest(".dx-texteditor"));P(n&&n._loadItemDeferred).done(()=>{a.select()})}},getWidgetInstance:Xn,getLastResizableColumnIndex(r,e){var t=r.some(s=>s&&!s.command&&!s.fixed&&s.allowResizing!==!1),i;for(i=r.length-1;r[i];i--){var a=r[i],n=e&&e[i],o=!t||a.allowResizing!==!1;if(!a.command&&!a.fixed&&n!=="adaptiveHidden"&&o)break}return i},isElementInCurrentGrid(r,e){if(e&&e.length){var t=e.closest(".".concat(r.getWidgetContainerClass())).parent();return t.is(r.component.$element())}return!1},isVirtualRowRendering(r){var e=r.option(ac),t=r.option(Un)===Kn,i=r.option(Un)===rc;return r.option(ic)===!1&&(t||i)?!0:e===Kn},getPixelRatio:r=>r.devicePixelRatio||1,getContentHeightLimit(r){return r.mozilla?8e6:15e6/this.getPixelRatio(ne())},normalizeLookupDataSource(r){var e;return r.items?e=r.items:(e=r.dataSource,H(e)&&!yi.isWrapped(e)&&(e=e({}))),Ei(e)},getWrappedLookupDataSource(r,e,t){if(!e)return[];var i=this.normalizeLookupDataSource(r.lookup);if(r.calculateCellValue!==r.defaultCalculateCellValue)return i;var a=e.remoteOperations().groupPaging,n=r.displayField&&G(r.displayField),o,s,l,d=(h,c)=>{var p,g=(p=c.skip)!==null&&p!==void 0?p:0,v=c.take?g+c.take:h.length;return h.slice(g,v)},u=L(L({},i),{__dataGridSourceFilter:t,load:h=>{var c=new O;return(p=>{var g=dc(n?[r.dataField,r.displayField]:r.dataField),v=new O,f=o&&(!a||p.skip===l&&p.take===s);return f?v.resolve(d(o,p)):(l=p.skip,s=p.take,e.load({filter:t,group:g,take:a?p.take:void 0,skip:a?p.skip:void 0}).done(C=>{o=C,v.resolve(a?C:d(C,p))}).fail(v.fail)),v})(h).done(p=>{if(p.length===0){c.resolve([]);return}var g=this.combineFilters(p.flatMap(f=>f.key).map(f=>[r.lookup.valueExpr,f]),"or"),v=new yr(L(L(L({},i),h),{filter:this.combineFilters([g,h.filter],"and"),paginate:!1}));v.load().done(c.resolve).fail(c.fail)}).fail(c.fail),c},key:r.lookup.valueExpr,byKey(h){var c=O();return this.load({filter:[r.lookup.valueExpr,"=",h]}).done(p=>{c.resolve(p[0])}),c.promise()}});return u},logHeaderFilterDeprecatedWarningIfNeed(r){var e=r._logDeprecatedOptionWarning.bind(r);_(r.option("headerFilter.allowSearch"))&&e("headerFilter.allowSearch",{since:"23.1",alias:"headerFilter.search.enabled"}),_(r.option("headerFilter.searchTimeout"))&&e("headerFilter.searchTimeout",{since:"23.1",alias:"headerFilter.search.timeout"});var t=r.NAME==="dxPivotGrid"?"dataSource.fields":"columns",i=r.option(t);if(Array.isArray(i)){var a=n=>{n.forEach(o=>{var s,l=o.headerFilter||{};_(l.allowSearch)&&e("".concat(t,"[].headerFilter.allowSearch"),{since:"23.1",alias:"".concat(t,"[].headerFilter.search.enabled")}),_(l.searchMode)&&e("".concat(t,"[].headerFilter.searchMode"),{since:"23.1",alias:"".concat(t,"[].headerFilter.search.mode")}),!((s=o.columns)===null||s===void 0)&&s.length&&a(o.columns)})};a(i)}}};var jn="scroll-container",uc="scrollable-simulated",hc="group-space",cc="content",pc="table",gc="table-fixed",vc="content-fixed",Ht="dx-row",Bi="dx-group-row",fc="dx-group-cell",Li="dx-master-detail-row",mc="filter-row",_c="dx-error-row",Cc="cell-updated-animation",Hl="0.0001px",ki="dxCellHintVisible",wc="dx-field-item-content",xc={render(r){r.container.append(r.content)}},yc=function(r,e){var t,i,a;function n(o){return setTimeout(()=>{t=i=null},o)}b.on(e,"touchstart touchend",".dx-row",o=>{clearTimeout(a),o.type==="touchstart"?(t=o.target,i=o.currentTarget,a=n(1e3)):a=n()}),b.on(e,[re,Tl,Y.down].join(" "),".dx-row",r.createAction(o=>{var{event:s}=o;t&&(s.target=t,s.currentTarget=i),m(s.target).closest("a").length||(o.rowIndex=r.getRowIndex(s.currentTarget),o.rowIndex>=0&&(o.rowElement=be(m(s.currentTarget)),o.columns=r.getColumns(),s.type===Y.down?r._rowPointerDown(o):s.type===re?r._rowClick(o):r._rowDblClick(o)))}))},Ar=function(r){return r==="auto"?"":Fe(r)?"".concat(r,"px"):r},Yn=function(r,e,t){r.style.width=r.style.maxWidth=e.width==="auto"?"":t},Ec=function(r,e){if(!(!r||!e)){var t=r.attributes,i=e.attributes,a;for(a=0;a<t.length;a++){var n=t[a].nodeName;e.hasAttribute(n)||r.removeAttribute(n)}for(a=0;a<i.length;a++)r.setAttribute(i[a].nodeName,i[a].nodeValue)}},Sc=function(r){r.resolve()},Wl=r=>typeof r=="number"?"".concat(r.toFixed(3),"px"):r==="adaptiveHidden"?Hl:r,bc=W.View.inherit(Gh);class br extends bc{setTableRole(e){}_createScrollableOptions(){var e=this.option("scrolling"),t=this.option("scrolling.useNative"),i=S({},e,{direction:"both",bounceEnabled:!1,useKeyboard:!1});return t===void 0&&(t=!0),t==="auto"?(delete i.useNative,delete i.useSimulatedScrollbar):(i.useNative=!!t,i.useSimulatedScrollbar=!t),i}_updateCell(e,t){t.rowType&&this._cellPrepared(e,t)}_createCell(e){var{column:t}=e,i=t.alignment||Bt(this.option("rtlEnabled")),a=z.createElement("td");a.style.textAlign=i;var n=m(a);return e.rowType==="data"&&t.headerId&&!t.type&&this.component.option("showColumnHeaders")&&this.setAria("describedby",t.headerId,n),t.cssClass&&n.addClass(t.cssClass),Array.isArray(t.elementAttr)&&t.elementAttr.forEach(o=>{var{name:s,value:l}=o;n.attr(s,l)}),t.command==="expand"&&(n.addClass(t.cssClass),n.addClass(this.addWidgetPrefix(hc))),t.colspan>1?n.attr("colSpan",t.colspan):!t.isBand&&t.visibleWidth!=="auto"&&this.option("columnAutoWidth")&&((t.width||t.minWidth)&&(a.style.minWidth=Ar(t.minWidth||t.width)),t.width&&Yn(a,t,Ar(t.width))),n}_createRow(e,t){t=t||"tr";var i=m("<".concat(t,">")).addClass(Ht);return this.setAria("role","row",i),i}_isAltRow(e){return e&&e.dataIndex%2===1}_createTable(e,t){var i=m("<table>").addClass(this.addWidgetPrefix(pc)).addClass(this.addWidgetPrefix(gc));if(e&&!t?(i.append(this._createColGroup(e)),te.safari&&i.append(m("<thead>").append("<tr>")),this.setTableRole(i)):this.setAria("hidden",!0,i),this.setAria("role","presentation",m("<tbody>").appendTo(i)),t)return i;te.mozilla&&b.on(i,"mousedown","td",n=>{n.ctrlKey&&n.preventDefault()}),this.option("cellHintEnabled")&&b.on(i,"mousemove",".dx-row > td",this.createAction(n=>{var o=n.event,s=m(o.target),l=m(o.currentTarget),d=l.parent(),u=this._columnsController.getVisibleColumns(),h=d.data("options"),c=l.index(),p=h&&h.cells&&h.cells[c],g=p?p.column:u[c],v=d.hasClass("dx-header-row"),f=d.hasClass("dx-data-row"),C=d.hasClass(Li),w=d.hasClass(Bi),x=d.hasClass(this.addWidgetPrefix(mc)),E=f&&(!g||g.cellTemplate),R=f&&p&&(h.isEditing||p.isEditing||(g==null?void 0:g.showEditorAlways)),D=v&&(!g||g.headerCellTemplate),V=w&&(!g||g.groupIndex&&g.groupCellTemplate),F=!C&&!x&&!R&&!E&&!D&&!V;if(F){s.data(ki)&&(s.removeAttr("title"),s.data(ki,!1));var B=s[0].scrollWidth-s[0].clientWidth;B>0&&!_(s.attr("title"))&&(s.attr("title",s.text()),s.data(ki,!0))}}));var a=n=>{var o=m(n.currentTarget),s=m(n.target).closest(".".concat(wc)),l=o.parent(),d=l.data("options"),u=d&&d.cells&&d.cells[o.index()];if(o.closest("table").is(n.delegateTarget)){var h=S({},u,{cellElement:be(o),event:n,eventType:n.type});if(h.rowIndex=this.getRowIndex(l),s.length){var c=s.data("dx-form-item");c.column&&(h.column=c.column,h.columnIndex=this._columnsController.getVisibleIndex(h.column.index))}return h}};return b.on(i,"mouseover",".dx-row > td",n=>{var o=a(n);o&&this.executeAction("onCellHoverChanged",o)}),b.on(i,"mouseout",".dx-row > td",n=>{var o=a(n);o&&this.executeAction("onCellHoverChanged",o)}),b.on(i,re,".dx-row > td",n=>{var o=a(n);o&&this.executeAction("onCellClick",o)}),b.on(i,Tl,".dx-row > td",n=>{var o=a(n);o&&this.executeAction("onCellDblClick",o)}),yc(this,i),i}_rowPointerDown(){}_rowClick(){}_rowDblClick(){}_createColGroup(e){for(var t=m("<colgroup>"),i=0;i<e.length;i++)for(var a=e[i].colspan||1,n=0;n<a;n++)t.append(this._createCol(e[i]));return t}_createCol(e){var t=e.visibleWidth||e.width;t==="adaptiveHidden"&&(t=Hl);var i=m("<col>");return Ta(i,t),i}renderDelayedTemplates(e){var t=this._delayedTemplates,i=t.filter(n=>!n.async),a=t.filter(n=>n.async);this._delayedTemplates=[],this._renderDelayedTemplatesCore(i,!1,e),this._renderDelayedTemplatesCoreAsync(a)}_renderDelayedTemplatesCoreAsync(e){if(e.length){var t=ne().setTimeout(()=>{this._templateTimeouts.delete(t),this._renderDelayedTemplatesCore(e,!0)});this._templateTimeouts.add(t)}}_renderDelayedTemplatesCore(e,t,i){for(var a=new Date;e.length;){var n=e.shift(),{options:o}=n,s=z.getRootNode(m(o.container).get(0)),l=this.needWaitAsyncTemplates();if((!t||m(o.container).closest(s).length||l)&&(i&&(o.change=i),n.template.render(o)),t&&new Date-a>30){this._renderDelayedTemplatesCoreAsync(e);break}}!e.length&&this._delayedTemplates.length&&this.renderDelayedTemplates()}_processTemplate(e,t){var i;if(e&&e.render&&!Vn(e))i={allowRenderToDetachedContainer:e.allowRenderToDetachedContainer,render(n){e.render(n.container,n.model,n.change),n.deferred&&n.deferred.resolve()}};else if(H(e))i={render(n){var o=e(be(n.container),n.model,n.change);o&&(o.nodeType||Vn(o))&&n.container.append(o),n.deferred&&n.deferred.resolve()}};else{var a=G(e)?e:m(e).attr("id");a?(this._templatesCache[a]||(this._templatesCache[a]=this.getTemplate(e)),i=this._templatesCache[a]):i=this.getTemplate(e)}return i}renderTemplate(e,t,i,a,n){var o,s=this._processTemplate(t,i),{column:l}=i,d=i.rowType==="data",u=new O,h={container:e,model:i,deferred:u,onRendered:()=>{this.isDisposed()?u.reject():u.resolve()}};if(s){i.component=this.component;var c=l&&(l.renderAsync&&d||this.option("renderAsync")&&(l.renderAsync!==!1&&(l.command||l.showEditorAlways)&&d||i.rowType==="filter")),p=(o=i.renderAsync)!==null&&o!==void 0?o:c;(s.allowRenderToDetachedContainer||a)&&!p?s.render(h):this._delayedTemplates.push({template:s,options:h,async:p}),this._templateDeferreds.add(u),b.on(e,fl,Sc.bind(null,u))}else u.reject();return u.promise().always(()=>{this._templateDeferreds.delete(u)})}_getBodies(e){return m(e).children("tbody").not(".dx-header").not(".dx-footer")}_needWrapRow(e){var t,i=!!this.option().rowTemplate;return i&&!!(!((t=this._getBodies(e))===null||t===void 0)&&t.filter(".".concat(Ht)).length)}_wrapRowIfNeed(e,t,i){var a=i?e||this._tableElement:this._tableElement||e,n=this._needWrapRow(a);if(n){var o=m("<tbody>").addClass(t.attr("class"));return this.setAria("role","presentation",o),o.append(t)}return t}_appendRow(e,t,i){i=i||xc,i.render({content:t,container:e})}_resizeCore(){var e=this._scrollLeft;e>=0&&(this._scrollLeft=0,this.scrollTo({left:e}))}_renderCore(e){var t=this.element().parent();(!t||t.parent().length)&&this.renderDelayedTemplates(e)}_renderTable(e){e=e||{},e.columns=this._columnsController.getVisibleColumns();var t=e.change&&e.change.changeType,i=this._createTable(e.columns,t==="append"||t==="prepend"||t==="update");return this._renderRows(i,e),i}_renderRows(e,t){for(var i=this._getRows(t.change),a=t.change&&t.change.columnIndices||[],n=t.change&&t.change.changeTypes||[],o=0;o<i.length;o++)this._renderRow(e,S({row:i[o],columnIndices:a[o],changeType:n[o]},t))}_renderRow(e,t){t.columnIndices||(t.row.cells=[]);var i=this._createRow(t.row),a=this._wrapRowIfNeed(e,i);t.changeType!=="remove"&&this._renderCells(i,t),this._appendRow(e,a);var n=S({columns:t.columns},t.row);this._addWatchMethod(n,t.row),this._rowPrepared(a,n,t.row)}_needRenderCell(e,t){return!t||t.indexOf(e)>=0}_renderCells(e,t){for(var i=0,{row:a}=t,{columns:n}=t,o=0;o<n.length;o++)this._needRenderCell(o,t.columnIndices)&&this._renderCell(e,S({column:n[o],columnIndex:i,value:a.values&&a.values[i],oldValue:a.oldValues&&a.oldValues[i]},t)),n[o].colspan>1?i+=n[o].colspan:i++}_updateCells(e,t,i){var a=e.children(),n=t.children(),o=this.option("highlightChanges"),s=this.addWidgetPrefix(Cc);i.forEach((l,d)=>{var u=a.eq(l),h=n.eq(d);u.replaceWith(h),o&&!h.hasClass("dx-command-expand")&&h.addClass(s)}),Ec(e.get(0),t.get(0))}_setCellAriaAttributes(e,t){if(t.rowType!=="freeSpace"){this.setAria("role","gridcell",e);var i=this._columnsController.getColumnIndexOffset(),a=t.columnIndex+i+1;this.setAria("colindex",a,e)}}_renderCell(e,t){var i=this._getCellOptions(t);if(t.columnIndices){if(t.row.cells){var a=t.row.cells.findIndex(o=>o.columnIndex===i.columnIndex);t.row.cells[a]=i}}else t.row.cells.push(i);var n=this._createCell(i);return this._setCellAriaAttributes(n,i),this._renderCellContent(n,i,t),e.get(0).appendChild(n.get(0)),n}_renderCellContent(e,t,i){var a=this._getCellTemplate(t);P(!a||this.renderTemplate(e,a,t,void 0,i.change)).done(()=>{this._updateCell(e,t)})}_getCellTemplate(e){}_getRows(e){return[]}_getCellOptions(e){var t={column:e.column,columnIndex:e.columnIndex,rowType:e.row.rowType,isAltRow:this._isAltRow(e.row)};return this._addWatchMethod(t),t}_addWatchMethod(e,t){if(this.option("repaintChangesOnly")){var i=[];return t=t||e,t.watch=t.watch||function(a,n,o){var s=a(t.data),l=function(d){d&&o&&o(d);var u=a(t.data);JSON.stringify(s)!==JSON.stringify(u)&&(d&&n(u),s=u)};return i.push(l),function(){var d=i.indexOf(l);d>=0&&i.splice(d,1)}},t.update=t.update||function(a,n){a&&(this.data=e.data=a.data,this.rowIndex=e.rowIndex=a.rowIndex,this.dataIndex=e.dataIndex=a.dataIndex,this.isExpanded=e.isExpanded=a.isExpanded,e.row&&!n&&(e.row=a)),i.forEach(o=>{o(a)})},t!==e&&(e.watch=t.watch.bind(t)),e}}_cellPrepared(e,t){t.cellElement=be(m(e)),this.executeAction("onCellPrepared",t)}_rowPrepared(e,t,i){ku(e.get(0),"options",t),t.rowElement=be(e),this.executeAction("onRowPrepared",t)}_columnOptionChanged(e){var{optionNames:t}=e;if(I.checkChanges(t,["width","visibleWidth"])){var i=this._columnsController.getVisibleColumns(),a=i.map(n=>n.visibleWidth||n.width);this.setColumnWidths({widths:a,optionNames:t});return}this._requireReady||this.render()}getCellIndex(e){var t=e.length?e[0].cellIndex:-1;return t}getTableElements(){return this._tableElement||m()}getTableElement(e){return this._tableElement}setTableElement(e,t){this._tableElement=e}optionChanged(e){switch(super.optionChanged(e),e.name){case"cellHintEnabled":case"onCellPrepared":case"onRowPrepared":case"onCellHoverChanged":case"keyboardNavigation":this._invalidate(!0,!0),e.handled=!0}}init(){this._scrollLeft=-1,this._columnsController=this.getController("columns"),this._dataController=this.getController("data"),this._delayedTemplates=[],this._templateDeferreds=new Set,this._templatesCache={},this._templateTimeouts=new Set,this.createAction("onCellClick"),this.createAction("onRowClick"),this.createAction("onCellDblClick"),this.createAction("onRowDblClick"),this.createAction("onCellHoverChanged",{excludeValidators:["disabled","readOnly"]}),this.createAction("onCellPrepared",{excludeValidators:["disabled","readOnly"],category:"rendering"}),this.createAction("onRowPrepared",{excludeValidators:["disabled","readOnly"],category:"rendering",afterExecute:e=>{this._afterRowPrepared(e)}}),this._columnsController.columnsChanged.add(this._columnOptionChanged.bind(this)),this._dataController&&this._dataController.changed.add(this._handleDataChanged.bind(this))}_afterRowPrepared(e){}_handleDataChanged(){}callbackNames(){return["scrollChanged"]}_updateScrollLeftPosition(){var e=this._scrollLeft;e>=0&&(this._scrollLeft=0,this.scrollTo({left:e}))}scrollTo(e){var t=this.element(),i=t&&t.children(".".concat(this.addWidgetPrefix(jn))).not(".".concat(this.addWidgetPrefix(vc)));_(e)&&_(e.left)&&this._scrollLeft!==e.left&&(this._scrollLeft=e.left,i&&i.scrollLeft(e.left))}_getContent(e){var t;return(t=this._tableElement)===null||t===void 0?void 0:t.parent()}_removeContent(e){var t=this._getContent(e);t!=null&&t.length&&t.remove()}_wrapTableInScrollContainer(e,t){var i=m("<div>"),a=this.option("scrolling.useNative");return(a===!1||a==="auto"&&!Mu)&&i.addClass(this.addWidgetPrefix(uc)),b.on(i,"scroll",()=>{var n=i.scrollLeft();n!==this._scrollLeft&&this.scrollChanged.fire({left:n},this.name)}),i.addClass(this.addWidgetPrefix(cc)).addClass(this.addWidgetPrefix(jn)).append(e).appendTo(this.element()),this.setAria("role","presentation",i),i}needWaitAsyncTemplates(){return this.option("templatesRenderAsynchronously")&&this.option("renderAsync")===!1}waitAsyncTemplates(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=new O,i=e||this.needWaitAsyncTemplates();if(!i)return t.resolve();var a=()=>P.apply(this,Array.from(this._templateDeferreds)).done(()=>{this.isDisposed()?t.reject():this._templateDeferreds.size>0?a():t.resolve()}).fail(t.reject);return a(),t.promise()}_updateContent(e,t,i){return this.waitAsyncTemplates().done(()=>{this._removeContent(i),this.setTableElement(e,i),this._wrapTableInScrollContainer(e,i)})}_findContentElement(){}_getWidths(e){if(!e)return[];var t=[],i=e.toArray();return i.forEach(a=>{var n=a.offsetWidth;if(a.getBoundingClientRect){var o=Ee(a);o.width>a.offsetWidth-1&&(n=o.width)}t.push(n)}),t}getColumnWidths(e){if((this.option("forceApplyBindings")||me)(),e=e??this.getTableElement(),e)for(var t=e.children("tbody:not(.dx-header)").children(),i=0;i<t.length;i++){var a=t.eq(i),n=a.hasClass(Bi),o=a.hasClass(Li),s=a.hasClass(_c),l=a.get(0).style.display!=="none"&&!a.hasClass("dx-state-invisible"),d=!n&&!o&&!s;if(l&&d){var u=a.children("td"),h=this._getWidths(u);return h}}return[]}getVisibleColumnIndex(e,t){return e}setColumnWidths(e){var{widths:t,optionNames:i}=e,a=this.getTableElement();if(!(!(a!=null&&a.length)||!t)){var n=this.getColumns(),o=this.option("columnAutoWidth"),s=a.children("colgroup").children("col");s.toArray().forEach(l=>l.removeAttribute("style")),n.forEach((l,d)=>{if(o&&l.width&&!l.command)for(var u=Ar(l.visibleWidth||l.width),h=Ar(l.minWidth||u),c=a.children().children(".dx-row").not(".".concat(Li)),p=0;p<c.length;p++){var g=c.eq(p),v=this.getVisibleColumnIndex(d,p),f=g.hasClass(Bi)?g.find("td[aria-colindex='".concat(v+1,"']:not(.").concat(fc,")")):g.find("td").eq(v),C=f.get(0);C&&(Yn(C,l,u),C.style.minWidth=h)}var w=Wl(t[d]);_(w)&&Ta(s.eq(d),w)})}}getCellElements(e){return this._getCellElementsCore(e)}_getCellElementsCore(e){if(!(e<0)){var t=this._getRowElements().eq(e);return t.children()}}_getCellElement(e,t){var i=this.getCellElements(e),a=this._getVisibleColumnIndex(i,e,t);if(!(!(i!=null&&i.length)||a<0)){var n=i.eq(a);return n.length>0?n:void 0}}_getRowElement(e){var t=this,i=m(),a=t.getTableElements();if(T(a,(n,o)=>{i=i.add(t._getRowElements(m(o)).eq(e))}),i.length)return i}getCellElement(e,t){var i=this._getCellElement(e,t);if(i)return be(i)}getRowElement(e){var t=this._getRowElement(e),i=[];if(t&&!be(t).get)for(var a=0;a<t.length;a++)i.push(t[a]);else i=t;return i}_getVisibleColumnIndex(e,t,i){if(G(i)){var a=this._columnsController.columnOption(i,"index");return this._columnsController.getVisibleIndex(a)}return i}getColumnElements(){}getColumns(e){return this._columnsController.getVisibleColumns(e)}getCell(e,t,i){var a=t||this._getRowElements(),n;if(a.length>0&&e.rowIndex>=0&&(this.option("scrolling.mode")!=="virtual"&&this.option("scrolling.rowRenderingMode")!=="virtual"&&(e.rowIndex=e.rowIndex<a.length?e.rowIndex:a.length-1),n=i||this.getCellElements(e.rowIndex),(n==null?void 0:n.length)>0))return n.eq(n.length>e.columnIndex?e.columnIndex:n.length-1)}getRowsCount(){var e=this.getTableElement();return e&&e.length===1?e[0].rows.length:0}_getRowElementsCore(e){if(e=e||this.getTableElement(),e){var t=this.option().rowTemplate||this.option("dataRowTemplate"),i=t&&e.find("> tbody.".concat(Ht));return i&&i.length?i:e.find("> tbody > "+".".concat(Ht,", > .").concat(Ht))}return m()}_getRowElements(e){return this._getRowElementsCore(e)}getRowIndex(e){return this._getRowElements().index(e)}getBoundingRect(){}getName(){}setScrollerSpacing(e){var t=this.element(),i=this.option("rtlEnabled");t&&t.css({paddingLeft:i?e:"",paddingRight:i?"":e})}isScrollbarVisible(e){var t=this.element(),i=this._tableElement;return t&&i?e?Te(i)-X(t)>0:le(i)-J(t)>0:!1}isDisposed(){var e;return(e=this.component)===null||e===void 0?void 0:e._disposed}dispose(){var e,t;if(ht()){var i=ne();(e=this._templateTimeouts)===null||e===void 0||e.forEach(a=>i.clearTimeout(a)),(t=this._templateTimeouts)===null||t===void 0||t.clear()}}}var Mi="text-content",Ic="headers",Tc="nowrap",Rc=".dx-row",Qn="dx-header-row",Oc="dx-column-lines",Ac="context-menu-sort-asc",Dc="context-menu-sort-desc",Vc="context-menu-sort-none",Fc="dx-cell-focus-disabled",Ni="dx-visibility-hidden",Jn="dx-text-content-alignment-",Pc="dx-sort-indicator",Bc="dx-sort-index-indicator",Lc=".dx-header-filter",kc="dx-header-filter-indicator",Mc="dx-header-multi-row",Nc="dx-link",Gl={defaultOptions:()=>({showColumnHeaders:!0,cellHintEnabled:!0}),views:{columnHeadersView:br.inherit(function(){var r=function(i,a,n){var o=m("<div>").addClass(i.addWidgetPrefix(Mi));i.setAria("role","presentation",o),e(i,a,n.column,o);var s=i.option("showColumnLines"),l=i.getController("columns").getHeaderContentAlignment(n.column.alignment);return o[s||l==="right"?"appendTo":"prependTo"](a)};function e(i,a,n,o){var s=i._getIndicatorElements(a,!0),l=i._getIndicatorElements(a),d=s&&s.length,u=i._getColumnAlignment(n.alignment),h=".".concat(i._getIndicatorClassName("sort")),c=".".concat(i._getIndicatorClassName("sortIndex")),p=l.filter(h),g=l.children().filter(c);o=o||a.children(".".concat(i.addWidgetPrefix(Mi))),o.toggleClass(Jn+u,d>0).toggleClass(Jn+(u==="left"?"right":"left"),d>0&&n.alignment==="center").toggleClass(Pc,!!p.length).toggleClass(Bc,!!g.length).toggleClass(kc,!!l.filter(".".concat(i._getIndicatorClassName("headerFilter"))).length)}var t={_createTable(){var i=this.callBase.apply(this,arguments);return b.on(i,"mousedown selectstart",this.createAction(a=>{var{event:n}=a;n.shiftKey&&n.preventDefault()})),i},_isLegacyKeyboardNavigation(){return this.option("useLegacyKeyboardNavigation")},_getDefaultTemplate(i){var a=this;return function(n,o){var{caption:s}=i,l=!i.command||s&&i.command!=="expand";if(i.command==="empty")a._renderEmptyMessage(n,o);else if(l){var d=r(a,n,o);d.text(s)}else i.command&&n.html("&nbsp;")}},_renderEmptyMessage(i,a){var n=this._getEmptyHeaderText();if(!n){i.html("&nbsp;");return}var o=r(this,i,a),s=n.includes("{0}");if(s){var[l,d]=n.split("{0}"),u=y.format("dxDataGrid-emptyHeaderColumnChooserText"),h=this.component.getView("columnChooserView"),c=m("<a>").text(u).addClass(Nc);b.on(c,"click",this.createAction(()=>h.showColumnChooser())),o.append(z.createTextNode(l)).append(c).append(z.createTextNode(d))}else o.text(n)},_getEmptyHeaderText(){var i=!!this.component.getView("columnChooserView").hasHiddenColumns(),a=!!this.component.getView("headerPanel").hasGroupedColumns();switch(!0){case(i&&a):return y.format("dxDataGrid-emptyHeaderWithColumnChooserAndGroupPanelText");case a:return y.format("dxDataGrid-emptyHeaderWithGroupPanelText");case i:return y.format("dxDataGrid-emptyHeaderWithColumnChooserText");default:return""}},_getHeaderTemplate(i){return i.headerCellTemplate||{allowRenderToDetachedContainer:!0,render:this._getDefaultTemplate(i)}},_processTemplate(i,a){var n=this,o,{column:s}=a,l=n.callBase(i);return a.rowType==="header"&&l&&s.headerCellTemplate&&!s.command?o={render(d){var u=r(n,d.container,d.model);l.render(S({},d,{container:u}))}}:o=l,o},_handleDataChanged(i){i.changeType==="refresh"&&(this._isGroupingChanged||this._requireReady)&&(this._isGroupingChanged=!1,this.render())},_renderCell(i,a){var n=this.callBase(i,a);return a.row.rowType==="header"&&(n.addClass(Fc),this._isLegacyKeyboardNavigation()||a.column&&!a.column.type&&n.attr("tabindex",this.option("tabindex")||0)),n},_setCellAriaAttributes(i,a){this.callBase(i,a),a.rowType==="header"&&(a.column.type||this.setAria("role","columnheader",i),a.column&&!a.column.command&&!a.column.isBand&&(i.attr("id",a.column.headerId),this.setAria("label","".concat(y.format("dxDataGrid-ariaColumn")," ").concat(a.column.caption),i)))},_createRow(i){var a=this.callBase.apply(this,arguments);return a.toggleClass(Oc,this.option("showColumnLines")),i.rowType==="header"&&(a.addClass(Qn),this._isLegacyKeyboardNavigation()||tr("columnHeaders",this,a,"td",this._handleActionKeyDown.bind(this))),a},_handleActionKeyDown(i){var{event:a}=i,n=m(a.target);if(this._lastActionElement=a.target,n.is(Lc)){var o=this.getController("headerFilter"),s=n.closest("td"),l=this.getColumnIndexByElement(s);l>=0&&o.showHeaderFilterMenu(l,!1)}else{var d=n.closest(Rc);this._processHeaderAction(a,d)}a.preventDefault()},_renderCore(){var i=this.element(),a={};if(!(this._tableElement&&!this._dataController.isLoaded()&&!this._hasRowElements)){i.addClass(this.addWidgetPrefix(Ic)).toggleClass(this.addWidgetPrefix(Tc),!this.option("wordWrapEnabled")).empty(),this.setAria("role","presentation",i);var n=this._updateContent(this._renderTable({change:a}),a);return this.getRowCount()>1&&i.addClass(Mc),this.callBase.apply(this,arguments),n}},_renderRows(){(this._dataController.isLoaded()||this._hasRowElements)&&(this.callBase.apply(this,arguments),this._hasRowElements=!0)},_renderRow(i,a){var n=this.getRowCount()===1?null:a.row.rowIndex;a.columns=this.getColumns(n),this.callBase(i,a)},_createCell(i){var{column:a}=i,n=this.callBase.apply(this,arguments);return a.rowspan>1&&i.rowType==="header"&&n.attr("rowSpan",a.rowspan),n},_getRows(){var i=[],a=this.getRowCount();if(this.option("showColumnHeaders"))for(var n=0;n<a;n++)i.push({rowType:"header",rowIndex:n});return i},_getCellTemplate(i){if(i.rowType==="header")return this._getHeaderTemplate(i.column)},_columnOptionChanged(i){var{changeTypes:a}=i,{optionNames:n}=i;if(a.grouping||a.groupExpanding){a.grouping&&(this._isGroupingChanged=!0);return}this.callBase(i),(n.width||n.visible)&&this.resizeCompleted.fire()},_isElementVisible:i=>i&&i.visible,_alignCaptionByCenter(i){var a=this._getIndicatorContainer(i,!0);a&&a.length&&(a.filter(".".concat(Ni)).remove(),a=this._getIndicatorContainer(i),a.clone().addClass(Ni).css("float","").insertBefore(i.children(".".concat(this.addWidgetPrefix(Mi)))))},_updateCell(i,a){a.rowType==="header"&&a.column.alignment==="center"&&this._alignCaptionByCenter(i),this.callBase.apply(this,arguments)},_updateIndicator(i,a,n){var o=this.callBase.apply(this,arguments);return a.alignment==="center"&&this._alignCaptionByCenter(i),e(this,i,a),o},_getIndicatorContainer(i,a){var n=this.callBase(i);return a?n:n.filter(":not(.".concat(Ni,")"))},_isSortableElement:()=>!0,getHeadersRowHeight(){var i=this.getTableElement(),a=i&&i.find(".".concat(Qn));return a&&a.toArray().reduce((n,o)=>n+J(o),0)||0},getHeaderElement(i){var a=this.getColumnElements();return a&&a.eq(i)},getColumnElements(i,a){var n=this,o,s=n._columnsController,l=n.getRowCount();if(n.option("showColumnHeaders")){if(l>1&&(!_(i)||_(a))){var d=[],u=_(a)?s.getChildrenByBandColumn(a,!0):s.getVisibleColumns();return T(u,(h,c)=>{var p=_(i)?i:s.getRowIndex(c.index);o=n._getCellElement(p,s.getVisibleIndex(c.index,p)),o&&d.push(o.get(0))}),m(d)}if(!i||i<l)return n.getCellElements(i||0)}},getColumnIndexByElement(i){var a=this.getCellIndex(i),n=i.closest(".dx-row"),{rowIndex:o}=n[0],s=this.getColumns(o)[a];return s?s.index:-1},getVisibleColumnIndex(i,a){var n=this.getColumns()[i];return n?this._columnsController.getVisibleIndex(n.index,a):-1},getColumnWidths(){var i=this.getColumnElements();return i&&i.length?this._getWidths(i):this.callBase.apply(this,arguments)},allowDragging(i){var a=i&&this._columnsController.getRowIndex(i.index),n=this.getColumns(a),o=this.option("allowColumnReordering")||this._columnsController.isColumnOptionUsed("allowReordering");return o&&i.allowReordering&&n.length>1},getBoundingRect(){var i=this.getColumnElements();if(i&&i.length){var a=this.getTableElement().offset();return{top:a.top}}return null},getName:()=>"headers",getColumnCount(){var i=this.getColumnElements();return i?i.length:0},isVisible(){return this.option("showColumnHeaders")},optionChanged(i){switch(i.name){case"showColumnHeaders":case"wordWrapEnabled":case"showColumnLines":this._invalidate(!0,!0),i.handled=!0;break;default:this.callBase(i)}},getHeight(){return this.getElementHeight()},getContextMenuItems(i){var a=this,{column:n}=i;if(i.row&&(i.row.rowType==="header"||i.row.rowType==="detailAdaptive")){var o=a.option("sorting");if(o&&o.mode!=="none"&&n&&n.allowSorting){var s=function(l){setTimeout(()=>{a._columnsController.changeSortOrder(n.index,l.itemData.value)})};return[{text:o.ascendingText,value:"asc",disabled:n.sortOrder==="asc",icon:Ac,onItemClick:s},{text:o.descendingText,value:"desc",disabled:n.sortOrder==="desc",icon:Dc,onItemClick:s},{text:o.clearText,value:"none",disabled:!n.sortOrder,icon:Vc,onItemClick:s}]}}},getRowCount(){return this._columnsController&&this._columnsController.getRowCount()},setRowsOpacity(i,a,n){var o,s,l=this.getRowCount(),d=this._columnsController.getColumns(),u=d&&d[i],h=u&&u.isBand&&u.index,c=(g,v)=>{g.ownerBand===h&&(s.eq(v).css({opacity:a}),g.isBand&&this.setRowsOpacity(g.index,a,o+1))};if(_(h)){for(n=n||0,o=n;o<l;o++)if(s=this.getCellElements(o),s){var p=this.getColumns(o);p.forEach(c)}}}};return t}())}};const A=L(L(L({},W),I),{modules:[]});Gl.views.columnHeadersView;A.registerModule("columnHeaders",Gl);var Kl=["filterValues","filterType","fixed","fixedPosition"],hi=["visibleIndex","dataField","name","dataType","width","visible","sortOrder","lastSortOrder","sortIndex","groupIndex","filterValue","bufferedFilterValue","selectedFilterOperation","bufferedSelectedFilterOperation","added"].concat(Kl),zc={visibleWidth:!0,bestFitWidth:!0,bufferedFilterValue:!0},Hc="dx-command-expand",Zn=Number.MAX_SAFE_INTEGER||9007199254740991,Xe="groupExpand",Wc="detailExpand",zi=/columns\[(\d+)\]\.?/gi,Gc={visible:!0,showInColumnChooser:!0},Kc={number:["=","<>","<",">","<=",">=","between"],string:["contains","notcontains","startswith","endswith","=","<>"],date:["=","<>","<",">","<=",">=","between"],datetime:["=","<>","<",">","<=",">=","between"]},Uc={visibleIndex:!0,groupIndex:!0,grouped:!0,sortIndex:!0,sortOrder:!0},xt="group",yt="columnChooser",Ul=function(r){r.filterOperations=r.defaultFilterOperations},$c=1,bi=function(r,e,t,i){var a={};if(e){G(e)&&(e={dataField:e}),r.setName(e);var n={};if(e.command)n=Ue(a,e);else{a=r.getCommonSettings(e),t&&t.name&&t.dataField&&(e=S({},e,{dataField:t.dataField}));var o=r._createCalculatedColumnOptions(e,i);e.type||(n={headerId:"dx-col-".concat($c++)}),n=Ue(n,Gc),Ue(n,a),Ue(n,o),Ue(n,e),Ue(n,{selector:null})}return e.filterOperations===e.defaultFilterOperations&&Ul(n),n}},Et=function r(e,t,i){var a=[];return t&&T(t,(n,o)=>{var s=e._columnsUserState&&ln(o,e._columnsUserState[n])&&e._columnsUserState[n],l=bi(e,o,s,i);l&&(i&&(l.ownerBand=i),a.push(l),l.columns&&(a=a.concat(r(e,l.columns,l)),delete l.columns,l.hasColumns=!0))}),a},lt=function(r,e){for(var t=[],i=e[r];i;)t.unshift(i),r=i.index,i=e[r];return t},qc=function r(e,t,i){var a=[],n=t[e];if(n)for(var o=0;o<n.length;o++){var s=n[o];(!_(s.groupIndex)||s.showWhenGrouped)&&(a.push(s),i&&s.isBand&&(a=a.concat(r(s.index,t,i))))}return a},Xc=function(r,e){var t,i,a=r.getBandColumnsCache(),n=function(s){var l=t?t.index:void 0;return s.ownerBand===l};if(a.isPlain)t=r._columns[e[0]];else{i=r._columns.filter(n);for(var o=0;o<e.length;o++)t=i[e[o]],t&&(i=r._columns.filter(n))}return t},jc=function(r,e){var t=[],i,a=r.getBandColumnsCache(),n=function(s){return s.ownerBand===e.ownerBand};if(a.isPlain){var o=r._columns.indexOf(e);o>=0&&(t=["columns[".concat(o,"]")])}else for(i=r._columns.filter(n);i.length&&i.indexOf(e)!==-1;)t.unshift("columns[".concat(i.indexOf(e),"]")),e=a.columnParentByIndex[e.index],i=e?r._columns.filter(n):[];return t.join(".")},Yc=function r(e,t){var i=0,a=e.getChildrenByBandColumn(t,!0);return T(a,(n,o)=>{o.isBand?(o.colspan=o.colspan||r(e,o.index),i+=o.colspan||1):i+=1}),i},Qc=function(r,e,t){for(var i,a=0;a<e.length;a++){var n=e[a];(n.visible||n.command)&&(n.isBand&&(n.colspan=n.colspan||Yc(r,n.index)),(!n.isBand||!n.colspan)&&(i=r.getRowCount(),!n.command&&(!_(n.groupIndex)||n.showWhenGrouped)&&(i-=lt(n.index,t.columnParentByIndex).length),i>1&&(n.rowspan=i)))}},Hi=function(r){var e=Qu(r);return e!=="string"&&e!=="boolean"&&e!=="number"&&e!=="date"&&e!=="object"&&(e=void 0),e},eo=function(r,e){switch(r){case"date":case"datetime":return di.getDateSerializationFormat(e);case"number":if(G(e))return"string";if(Fe(e))return null}},to=function(r,e){r.deserializeValue||(I.isDateType(e)&&(r.deserializeValue=function(t){return di.deserializeDate(t)},r.serializeValue=function(t){return G(t)?t:di.serializeDate(t,this.serializationFormat)}),e==="number"&&(r.deserializeValue=function(t){var i=parseFloat(t);return isNaN(i)?t:i},r.serializeValue=function(t,i){return i==="filter"?t:_(t)&&this.serializationFormat==="string"?t.toString():t}))},Jc=function(r,e){switch(r){case"number":return"right";case"boolean":return"center";default:return Bt(e)}},Zc=function(r){return r.value===!0?this.trueText||"true":r.value===!1?this.falseText||"false":r.valueText||""},ro=function(r){if(r==="boolean")return Zc},ep=function(r,e){for(var t=r._getFirstItems(e),i,a={},n=[],o=0;o<t.length;o++)if(t[o])for(i in t[o])(!H(t[o][i])||yi.isWrapped(t[o][i]))&&(a[i]=!0);for(i in a)if(i.indexOf("__")!==0){var s=bi(r,i);n.push(s)}return n},$l=function(r){T(r._columns,(e,t)=>{t.index=e}),T(r._columns,(e,t)=>{Q(t.ownerBand)&&(t.ownerBand=t.ownerBand.index)}),T(r._commandColumns,(e,t)=>{t.index=-(e+1)})},ql=function(r,e){ii(r._columns,"groupIndex",e,t=>{var{grouped:i}=t;return delete t.grouped,i})},tp=function(r,e){T(r._columns,(t,i)=>{_(i.sortIndex)&&!ci(i.sortOrder)&&delete i.sortIndex}),ii(r._columns,"sortIndex",e,t=>!_(t.groupIndex)&&ci(t.sortOrder))},rp=function(r,e){for(var t,i=[],a=r.getBandColumnsCache(),n=[],o=r._columns.filter(d=>!d.command),s=0;s<o.length;s++){t=o[s];var l=lt(s,a.columnParentByIndex);l.length?n.push(t):i.push(t)}ii(n,"visibleIndex",e),ii(i,"visibleIndex",e)},Wi=function(r,e,t){var i=Q(e)?e.rowIndex:null,a=t===xt?r.getGroupColumns():t===yt?r.getChooserColumns():r.getVisibleColumns(i),n;return e=Q(e)?e.columnIndex:e,n=a[e],n&&n.type===Xe&&(n=r._columns.filter(o=>n.type===o.type)[0]||n),n&&_(n.index)?n.index:-1},ip=function(r,e,t){var i=r.getGroupColumns(),a;if(t>=0)for(a=0;a<i.length;a++)i[a].groupIndex>=t&&i[a].groupIndex++;else for(t=0,a=0;a<i.length;a++)t=Math.max(t,i[a].groupIndex+1);return t};function ln(r,e){return r&&e&&e.name===(r.name||r.dataField)&&(e.dataField===r.dataField||r.name)}var io=function(r){var e=r._columnsUserState,t=r._ignoreColumnOptionNames||[],i=r._columns,a={},n=[],o=!0,s=[],l,d,u;function h(v,f){if(f)for(var C=0;C<hi.length;C++){var w=hi[C];t.includes(w)||(w==="dataType"?v[w]=v[w]||f[w]:Kl.includes(w)?w in f&&(v[w]=f[w]):(w==="selectedFilterOperation"&&f[w]&&(v.defaultSelectedFilterOperation=v[w]||null),v[w]=f[w]))}}function c(v,f){for(var C=f.name||f.dataField,w=a[C]||0,x=0;x<v.length;x++)if(ln(f,v[x]))if(w)w--;else return a[C]=a[C]||0,a[C]++,x;return-1}if(e){for(u=0;u<i.length;u++)d=c(e,i[u]),o=o&&d>=0,s.push(d);for(u=0;u<i.length;u++)l=i[u],d=s[u],(r._hasUserState||o)&&h(l,e[d]),d>=0&&_(e[d].initialIndex)?n[d]=l:n.push(l);var p=!1;for(u=0;u<e.length;u++){var g=e[u];g.added&&c(i,g)<0&&(l=bi(r,g.added),h(l,g),n.push(l),g.added.columns&&(p=!0))}p&&($l(r),n=Et(r,n)),St(r,n)}},nt=function(r,e){$l(r),ql(r,e),tp(r,e),Xl(r),rp(r,e)},Ii=function(r){r.resetColumnsCache()};function St(r,e){r._previousColumns=r._columns,r._columns=e,Ii(r),r.updateColumnDataTypes()}var Re=function(r,e,t,i){var a,n=r._columnChanges||{optionNames:{length:0},changeTypes:{length:0},columnIndex:i};t=t||"all",t=t.split(".")[0];var{changeTypes:o}=n;e&&!o[e]&&(o[e]=!0,o.length++);var{optionNames:s}=n;t&&!s[t]&&(s[t]=!0,s.length++),(i===void 0||i!==n.columnIndex)&&(_(i)&&((a=n.columnIndices)!==null&&a!==void 0||(n.columnIndices=[]),_(n.columnIndex)&&n.columnIndices.push(n.columnIndex),n.columnIndices.push(i)),delete n.columnIndex),r._columnChanges=n,Ii(r)},Wt=function(r){var e=r.option("onColumnsChanging"),t=r._columnChanges,i=["dataField","lookup","dataType","columns"];r.isInitialized()&&!r._updateLockCount&&t&&(e&&(r._updateLockCount++,e(S({component:r.component},t)),r._updateLockCount--),r._columnChanges=void 0,a=t.optionNames,a&&i.some(n=>a[n])?(r._reinitAfterLookupChanges=t==null?void 0:t.optionNames.lookup,r.reinit(),r._reinitAfterLookupChanges=void 0):r.columnsChanged.fire(t));var a},ap=function(r,e,t,i){var a=i>=0;if(t>=0)a||(e.lastSortOrder=e.sortOrder);else{var n=r.option("sorting.mode"),o=e.lastSortOrder;if(n==="single"){var s=r._columns.some(l=>l!==e&&_(l.sortIndex));s&&(o=void 0)}e.sortOrder=o}},np=function(r,e){var{value:t}=e,{optionName:i}=e,{prevValue:a}=e,{fullOptionName:n}=e,o="".concat(n,".").concat(i);!zc[i]&&r._skipProcessingColumnsChange!==o&&(r._skipProcessingColumnsChange=o,r.component._notifyOptionChanged(o,t,a),r._skipProcessingColumnsChange=!1)},Gi=function(r,e,t,i,a){var n=de(t),o=e.index,s,l,d;if(arguments.length===3)return n(e,{functionsAsIs:!0});var u=n(e,{functionsAsIs:!0});if(!U(u,i,{maxDepth:5})){t==="groupIndex"||t==="calculateGroupValue"?(l="grouping",ap(r,e,i,u)):t==="sortIndex"||t==="sortOrder"||t==="calculateSortValue"?l="sorting":l="columns";var h=Ju(t);h(e,i,{functionsAsIs:!0});var c=jc(r,e);Uc[t]&&(nt(r,e),i=n(e)),(t==="name"||t==="allowEditing")&&r._checkColumns(),!_(u)&&!_(i)&&t.indexOf("buffer")!==0&&(a=!0),a?Ii(r):(!hi.includes(t)&&t!=="visibleWidth"&&(s=r.option("columns"),d=r.getColumnByPath(c,s),G(d)&&(d=s[o]={dataField:d}),d&&ln(d,e)&&h(d,i,{functionsAsIs:!0})),Re(r,l,t,o)),c&&np(r,{fullOptionName:c,optionName:t,value:i,prevValue:u})}};function ci(r){return r==="asc"||r==="desc"}var op=function(r){var e=r._getExpandColumnOptions();r.addCommandColumn(e)},sp=function(r,e){if(this.dataField){var t=this.dataField.split("."),i=t.length-1;this.serializeValue&&(e=this.serializeValue(e));for(var a=0;a<i;a++){var n=t[a];r=r[n]=r[n]||{}}r[t[i]]=e}},lp=function r(e,t,i){var a=[];return t=t||0,e[t]&&T(e[t],(n,o)=>{(o.ownerBand===i||o.type===Xe)&&(!o.isBand||!o.colspan?(!o.command||t<1)&&a.push(o):a.push.apply(a,r(e,t+1,o.index)))}),a},dp=function(r){var e=1,t=r.getBandColumnsCache(),{columnParentByIndex:i}=t;return r._columns.forEach(a=>{var n=lt(a.index,i),o=n.filter(s=>!s.visible);a.visible&&!o.length&&(e=Math.max(e,n.length+1))}),e},Ba=(r,e)=>{var t=r._columns.filter(i=>i.type===e.type);return!!t.length},ao=function(r,e){var t=r.option("rtlEnabled");return e.command&&!Ba(r,e)||!e.fixedPosition?t?"right":"left":e.fixedPosition},no=function(r,e,t,i){var a,n=this.getRowCount(),o=r[i]&&r[i].rowspan,s=e.filter(l=>l.type===t);return r.forEach((l,d)=>{l.type===t&&(a=d,o=r[d+1]?r[d+1].rowspan:n)}),o>1&&(s=wr(s,l=>S({},l,{rowspan:o}))),s.unshift.apply(s,_(a)?[a,1]:[i,0]),r.splice.apply(r,s),o||1},up=function(r){var e;for(e=0;r>1;e++)r/=10;return e},oo=function(r,e){for(var t=r?r.toString():"0";t.length<e;)t="0".concat(t);return t},so=(r,e,t,i)=>{for(var a,n,o=e.slice().map(p=>S({},p)),s=r._isColumnFixing(),l=t.slice().map(p=>S({fixed:s},p)),d=p=>t.reduce((g,v,f)=>{var C=i&&p.type===Xe?"expand":p.type;return v.type===C||v.command===p.command?f:g},-1),u=p=>p.command!==t[n].command,h=0;h<e.length;h++)if(a=e[h],n=a&&(a.type||a.command)?d(a):-1,n>=0)if(i)o[h]=S({fixed:s},t[n],a),a.type!==Xe&&(l=l.filter(u));else{var c={visibleIndex:a.visibleIndex,index:a.index,headerId:a.headerId,allowFixing:a.groupIndex===0,allowReordering:a.groupIndex===0,groupIndex:a.groupIndex};o[h]=S({},a,t[n],a.type===Xe&&c)}return e.length&&i&&l.length&&(o=o.concat(l)),o},lo=(r,e)=>_(e.fixed)||!e.type?e.fixed:r._isColumnFixing(),hp=r=>{r.forEach(e=>{_(e.ownerBand)&&(e.ownerBand=r[e.ownerBand])})},Xl=r=>{r._bandColumnsCache=void 0},uo=(r,e)=>{var t=G(e)&&e.substr(0,e.indexOf(":")),i;if(e!==void 0)return t&&(e=e.substr(t.length+1)),t?i=r.filter(a=>"".concat(a[t])===e)[0]:["index","name","dataField","caption"].some(a=>(i=r.filter(n=>n[a]===e)[0],!!i)),i},cp=(r,e)=>{if(e!=="asc"&&e!=="desc")return r;var t=e==="asc"?1:-1;return r.sort((i,a)=>{var n=i.caption||"",o=a.caption||"";return t*n.localeCompare(o)}),r},pp=function(r,e){var t=Xr.parse(r);if(Fe(t)){var i=Xr.format(t,e),a=Xr.format(t,"decimal");if(i===r||a===r)return t}};class gp extends W.Controller{_getExpandColumnOptions(){return{type:"expand",command:"expand",width:"auto",cssClass:Hc,allowEditing:!1,allowGrouping:!1,allowSorting:!1,allowResizing:!1,allowReordering:!1,allowHiding:!1}}_getFirstItems(e){var t,i=[];return e&&e.items().length>0&&(t=I.normalizeSortingInfo(e.group()).length,i=function a(n,o){if(!n||!o)return n;for(var s=0;s<n.length;s++){var l=a(n[s].items||n[s].collapsedItems,o-1);if(l&&l.length)return l}}(e.items(),t)||[]),i}_endUpdateCore(){!this._skipProcessingColumnsChange&&Wt(this)}init(e){var t=this.option("columns");this._commandColumns=this._commandColumns||[],this._columns=this._columns||[],this._isColumnsFromOptions=!!t,this._isColumnsFromOptions?(St(this,t?Et(this,t):[]),io(this)):St(this,this._columnsUserState?Et(this,this._columnsUserState):this._columns),op(this),this._dataSourceApplied?this.applyDataSource(this._dataSource,!0,e):nt(this),this._checkColumns()}callbackNames(){return["columnsChanged"]}getColumnByPath(e,t){var i,a=[];return e.replace(zi,(n,o)=>(a.push(parseInt(o)),"")),a.length&&(t?i=a.reduce((n,o)=>n&&n.columns&&n.columns[o],{columns:t}):i=Xc(this,a)),i}optionChanged(e){var t;switch(e.name){case"adaptColumnWidthByRatio":e.handled=!0;break;case"dataSource":e.value!==e.previousValue&&!this.option("columns")&&(!Array.isArray(e.value)||!Array.isArray(e.previousValue))&&(this._columns=[]);break;case"columns":t=this._skipProcessingColumnsChange,e.handled=!0,this._skipProcessingColumnsChange||(e.name===e.fullName?(this._columnsUserState=null,this._ignoreColumnOptionNames=null,this.init()):(this._columnOptionChanged(e),t=!0)),t&&this._updateRequireResize(e);break;case"commonColumnSettings":case"columnAutoWidth":case"allowColumnResizing":case"allowColumnReordering":case"columnFixing":case"grouping":case"groupPanel":case"regenerateColumnsByVisibleItems":case"customizeColumns":case"columnHidingEnabled":case"dateSerializationFormat":case"columnResizingMode":case"columnMinWidth":case"columnWidth":e.handled=!0;var i=e.fullName==="columnWidth"&&["width"];this.reinit(i);break;case"rtlEnabled":this.reinit();break;default:super.optionChanged(e)}}_columnOptionChanged(e){var t={},i=this.getColumnByPath(e.fullName),a=e.fullName.replace(zi,"");i&&(a?t[a]=e.value:t=e.value,this._skipProcessingColumnsChange=e.fullName,this.columnOption(i.index,t),this._skipProcessingColumnsChange=!1)}_updateRequireResize(e){var{component:t}=this;e.fullName.replace(zi,"")==="width"&&t._updateLockCount&&(t._requireResize=!0)}publicMethods(){return["addColumn","deleteColumn","columnOption","columnCount","clearSorting","clearGrouping","getVisibleColumns","getVisibleColumnIndex"]}applyDataSource(e,t,i){var a=e&&e.isLoaded();if(this._dataSource=e,!this._dataSourceApplied||this._dataSourceColumnsCount===0||t||this.option("regenerateColumnsByVisibleItems")){if(a){if(!this._isColumnsFromOptions){var n=ep(this,e);n.length&&(St(this,n),this._dataSourceColumnsCount=this._columns.length,io(this))}return this.updateColumns(e,t,i)}this._dataSourceApplied=!1,nt(this)}else if(a&&!this.isAllDataTypesDefined(!0)&&this.updateColumnDataTypes(e))return Re(this,"columns"),Wt(this),new O().reject().promise()}reset(){this._dataSource=null,this._dataSourceApplied=!1,this._dataSourceColumnsCount=void 0,this.reinit()}resetColumnsCache(){this._visibleColumns=void 0,this._fixedColumns=void 0,this._rowCount=void 0,Xl(this)}reinit(e){this._columnsUserState=this.getUserState(),this._ignoreColumnOptionNames=e||null,this.init(),e&&(this._ignoreColumnOptionNames=null)}isInitialized(){return!!this._columns.length||!!this.option("columns")}isDataSourceApplied(){return this._dataSourceApplied}getCommonSettings(e){var t,i,a=(!e||!e.type)&&this.option("commonColumnSettings")||{},n=(t=this.option("grouping"))!==null&&t!==void 0?t:{},o=(i=this.option("groupPanel"))!==null&&i!==void 0?i:{};return S({allowFixing:this.option("columnFixing.enabled"),allowResizing:this.option("allowColumnResizing")||void 0,allowReordering:this.option("allowColumnReordering"),minWidth:this.option("columnMinWidth"),width:this.option("columnWidth"),autoExpandGroup:n.autoExpandAll,allowCollapsing:n.allowCollapsing,allowGrouping:o.allowColumnDragging&&o.visible||n.contextMenuEnabled},a)}isColumnOptionUsed(e){for(var t=0;t<this._columns.length;t++)if(this._columns[t][e])return!0}isAllDataTypesDefined(e){var t=this._columns;if(!t.length)return!1;for(var i=0;i<t.length;i++)if(!(!t[i].dataField&&t[i].calculateCellValue===t[i].defaultCalculateCellValue)&&(!t[i].dataType||e&&t[i].deserializeValue&&t[i].serializationFormat===void 0))return!1;return!0}getColumns(){return this._columns}isBandColumnsUsed(){return this.getColumns().some(e=>e.isBand)}getGroupColumns(){var e=[];return T(this._columns,function(){_(this.groupIndex)&&(e[this.groupIndex]=this)}),e}_shouldReturnVisibleColumns(){return!0}_compileVisibleColumns(e){return this._visibleColumns=this._visibleColumns||this._compileVisibleColumnsCore(),e=_(e)?e:this._visibleColumns.length-1,this._visibleColumns[e]||[]}getVisibleColumns(e,t){return this._shouldReturnVisibleColumns()?this._compileVisibleColumns.apply(this,arguments):[]}getFixedColumns(e){return this._fixedColumns=this._fixedColumns||this._getFixedColumnsCore(),e=_(e)?e:this._fixedColumns.length-1,this._fixedColumns[e]||[]}getFilteringColumns(){return this.getColumns().filter(e=>(e.dataField||e.name)&&(e.allowFiltering||e.allowHeaderFiltering)).map(e=>{var t=S(!0,{},e);return _(t.dataField)||(t.dataField=t.name),t.filterOperations=e.filterOperations!==e.defaultFilterOperations?t.filterOperations:null,t})}getColumnIndexOffset(){return 0}_getFixedColumnsCore(){var e=[],t=this.getRowCount(),i=this._isColumnFixing(),a={command:"transparent"},n=0,o,s,l;if(i)for(var d=0;d<=t;d++){o=0,l=null,s=null;for(var u=this.getVisibleColumns(d,!0),h=0;h<u.length;h++){var c=u[h-1],p=u[h];p.fixed?c&&c.fixed&&ao(this,c)!==ao(this,p)?_(s)||(s=h):l=p.fixedPosition:(d===0&&(p.isBand&&p.colspan?n+=p.colspan:n++),o++,_(s)||(s=h))}if(d===0&&(o===0||o>=u.length))return[];_(s)||(s=l==="right"?0:u.length),e[d]=u.slice(0),a.colspan||(a.colspan=n),e[d].splice(s,o,a)}return e.map(g=>g.map(v=>{var f=L({},v);return f.headerId&&(f.headerId+="-fixed"),f}))}_isColumnFixing(){var e=this.option("columnFixing.enabled");return!e&&T(this._columns,(t,i)=>{if(i.fixed)return e=!0,!1}),e}_getExpandColumnsCore(){return this.getGroupColumns()}getExpandColumns(){var e=this._getExpandColumnsCore(),t,i=e.filter(s=>s.groupIndex===0)[0],a=i&&i.fixed,n=this._isColumnFixing(),o=this.option("rtlEnabled");return e.length&&(t=this.columnOption("command:expand")),e=wr(e,s=>S({},s,{visibleWidth:null,minWidth:null,cellTemplate:_(s.groupIndex)?null:s.cellTemplate,headerCellTemplate:null,fixed:!_(s.groupIndex)||!a?n:!0,fixedPosition:o?"right":"left"},t,{index:s.index,type:s.type||Xe})),e}getBandColumnsCache(){if(!this._bandColumnsCache){var e=this._columns,t={},i={},a=!0;e.forEach(n=>{var{ownerBand:o}=n,s=Q(o)?o.index:o,l=e[s];n.hasColumns&&(a=!1),n.colspan&&(n.colspan=void 0),n.rowspan&&(n.rowspan=void 0),l?i[n.index]=l:s=-1,t[s]=t[s]||[],t[s].push(n)}),this._bandColumnsCache={isPlain:a,columnChildrenByIndex:t,columnParentByIndex:i}}return this._bandColumnsCache}_isColumnVisible(e){return e.visible&&this.isParentColumnVisible(e.index)}_isColumnInGroupPanel(e){return _(e.groupIndex)&&!e.showWhenGrouped}hasVisibleDataColumns(){var e=this._columns;return e.some(t=>{var i=this._isColumnVisible(t),a=this._isColumnInGroupPanel(t),n=!!t.command;return i&&!a&&!n})}_compileVisibleColumnsCore(){var e=this.getBandColumnsCache(),t=so(this,this._columns,this._commandColumns,!0);Qc(this,t,e);var i=this._getIndexedColumns(t),a=this._getVisibleColumnsFromIndexed(i),n=!this.hasVisibleDataColumns();return n&&this._columns.length&&a[a.length-1].push({command:"empty"}),a}_getIndexedColumns(e){for(var t=this.option("rtlEnabled"),i=this.getRowCount(),a=up(e.length),n=this.getBandColumnsCache(),o=[],s=[],l=0;l<i;l+=1)s[l]=[{}],o[l]=[{},{},{}];return e.forEach(d=>{var u,h,c,p,{visibleIndex:g}=d,v,f=lt(d.index,n.columnParentByIndex),C=this._isColumnVisible(d),w=this._isColumnInGroupPanel(d);if(C&&!w){var x=f.length;if(g<0)g=-g,v=s[x];else if(d.fixed=(h=(u=f[0])===null||u===void 0?void 0:u.fixed)!==null&&h!==void 0?h:d.fixed,d.fixedPosition=(p=(c=f[0])===null||c===void 0?void 0:c.fixedPosition)!==null&&p!==void 0?p:d.fixedPosition,d.fixed){var E=!!d.command&&!Ba(this,d),R=d.fixedPosition==="right";t&&!E&&(R=!R),v=R?o[x][2]:o[x][0]}else v=o[x][1];if(f.length){g=oo(g,a);for(var D=f.length-1;D>=0;D-=1)g=oo(f[D].visibleIndex,a)+g}v[g]=v[g]||[],v[g].push(d)}}),{positiveIndexedColumns:o,negativeIndexedColumns:s}}_getVisibleColumnsFromIndexed(e){for(var t=this,{positiveIndexedColumns:i,negativeIndexedColumns:a}=e,n=[],o=this.getRowCount(),s=so(this,this.getExpandColumns(),this._columns),l=0,d=0,u=function(c){n.push([]),Fn(a[c],(v,f)=>{n[c].unshift.apply(n[c],f)});var p=n[c].length,g=i[c];g.forEach(v=>{Fn(v,(f,C)=>{n[c].push.apply(n[c],C)})}),d<=c&&(d+=no.call(t,n[c],s,Wc,p)),l<=c&&(l+=no.call(t,n[c],s,Xe,p))},h=0;h<o;h+=1)u(h);return n.push(lp(n)),n}getInvisibleColumns(e,t){var i=this,a=[],n;return e=e||i._columns,T(e,(o,s)=>{if(s.ownerBand===t){if(s.isBand){s.visible?n=i.getInvisibleColumns(i.getChildrenByBandColumn(s.index),s.index):n=i.getChildrenByBandColumn(s.index),n.length&&(a.push(s),a=a.concat(n));return}s.visible||a.push(s)}}),a}getChooserColumns(e){var t=e?this.getColumns():this.getInvisibleColumns(),i=t.filter(n=>n.showInColumnChooser),a=this.option("columnChooser.sortOrder");return cp(i,a)}allowMoveColumn(e,t,i,a){var n=Wi(this,e,i),o=this._columns[n];return o&&(o.allowReordering||o.allowGrouping||o.allowHiding)?i===a?i===yt?!1:(e=Q(e)?e.columnIndex:e,t=Q(t)?t.columnIndex:t,e!==t&&e+1!==t):i===xt&&a!==yt||a===xt?o&&o.allowGrouping:i===yt||a===yt?o&&o.allowHiding:!0:!1}moveColumn(e,t,i,a){var n={},o,s=Wi(this,e,i),l=Wi(this,t,a),d;if(s>=0){var u=this._columns[s];if(t=Q(t)?t.columnIndex:t,d=l>=0?this._columns[l].groupIndex:-1,_(u.groupIndex)&&i===xt&&(d>u.groupIndex&&d--,a!==xt?n.groupIndex=void 0:(o=u.groupIndex,delete u.groupIndex,ql(this))),a===xt)n.groupIndex=ip(this,u,d),u.groupIndex=o;else if(t>=0){var h=this._columns[l];!h||u.ownerBand!==h.ownerBand||lo(this,u)^lo(this,h)?n.visibleIndex=Zn:n.visibleIndex=h.visibleIndex}var c=a!==yt;u.visible!==c&&(n.visible=c),this.columnOption(u.index,n)}}changeSortOrder(e,t){var i={},a=this.option("sorting"),n=a&&a.mode,o=n==="single"||!t,s=n==="single"||n==="multiple",l=this._columns[e];s&&l&&l.allowSorting&&(o&&!_(l.groupIndex)&&T(this._columns,function(d){d!==e&&this.sortOrder&&(_(this.groupIndex)||delete this.sortOrder,delete this.sortIndex)}),ci(t)?l.sortOrder!==t&&(i.sortOrder=t):t==="none"?l.sortOrder&&(i.sortIndex=void 0,i.sortOrder=void 0):function(d){if(t==="ctrl"){if(!("sortOrder"in d&&"sortIndex"in d))return!1;i.sortOrder=void 0,i.sortIndex=void 0}else _(d.groupIndex)||_(d.sortIndex)?i.sortOrder=d.sortOrder==="desc"?"asc":"desc":i.sortOrder="asc";return!0}(l)),this.columnOption(l.index,i)}getSortDataSourceParameters(e){var t=[],i=[];return T(this._columns,function(){(this.dataField||this.selector||this.calculateCellValue)&&_(this.sortIndex)&&!_(this.groupIndex)&&(t[this.sortIndex]=this)}),T(t,function(){var a=this&&this.sortOrder;if(ci(a)){var n={selector:this.calculateSortValue||this.displayField||this.calculateDisplayValue||e&&this.selector||this.dataField||this.calculateCellValue,desc:this.sortOrder==="desc"};this.sortingMethod&&(n.compare=this.sortingMethod.bind(this)),i.push(n)}}),i.length>0?i:null}getGroupDataSourceParameters(e){var t=[];return T(this.getGroupColumns(),function(){var i=this.calculateGroupValue||this.displayField||this.calculateDisplayValue||e&&this.selector||this.dataField||this.calculateCellValue;if(i){var a={selector:i,desc:this.sortOrder==="desc",isExpanded:!!this.autoExpandGroup};this.sortingMethod&&(a.compare=this.sortingMethod.bind(this)),t.push(a)}}),t.length>0?t:null}refresh(e){var t=[];return T(this._columns,function(){var{lookup:i}=this;if(i&&!this.calculateDisplayValue){if(e&&i.valueMap)return;i.update&&t.push(i.update())}}),P.apply(m,t).done(Ii.bind(null,this))}_updateColumnOptions(e,t){e.selector=e.selector||function(n){return e.calculateCellValue(n)},this._reinitAfterLookupChanges&&this._previousColumns?(e.selector.columnIndex=t,e.selector.originalCallback=this._previousColumns[t].selector.originalCallback):(e.selector.columnIndex=t,e.selector.originalCallback=e.selector),T(["calculateSortValue","calculateGroupValue","calculateDisplayValue"],(n,o)=>{var s=e[o];if(H(s))if(s.originalCallback)e[o].context.column=e;else{var l={column:e};e[o]=function(d){return s.call(l.column,d)},e[o].originalCallback=s,e[o].columnIndex=t,e[o].context=l}}),G(e.calculateDisplayValue)&&(e.displayField=e.calculateDisplayValue,e.calculateDisplayValue=de(e.displayField)),e.calculateDisplayValue&&(e.displayValueMap=e.displayValueMap||{}),to(e,e.dataType);var{lookup:i}=e;i&&to(i,i.dataType);var a=i?i.dataType:e.dataType;a&&(e.alignment=e.alignment||Jc(a,this.option("rtlEnabled")),e.format=e.format||I.getFormatByDataType(a),e.customizeText=e.customizeText||ro(a),e.defaultFilterOperations=e.defaultFilterOperations||!i&&Kc[a]||[],_(e.filterOperations)||Ul(e),e.defaultFilterOperation=e.filterOperations&&e.filterOperations[0]||"=",e.showEditorAlways=_(e.showEditorAlways)?e.showEditorAlways:a==="boolean"&&!e.cellTemplate&&!e.lookup)}updateColumnDataTypes(e){var t=this,i=t.option("dateSerializationFormat"),a=t._getFirstItems(e),n=!1;return T(t._columns,(o,s)=>{var l,d,u,h,c,{lookup:p}=s;if(I.isDateType(s.dataType)&&s.serializationFormat===void 0&&(s.serializationFormat=i),p&&I.isDateType(p.dataType)&&s.serializationFormat===void 0&&(p.serializationFormat=i),s.calculateCellValue&&a.length){if(!s.dataType||p&&!p.dataType){for(l=0;l<a.length;l++)d=s.calculateCellValue(a[l]),s.dataType||(c=Hi(d),u=u||c,u&&c&&u!==c&&(u="string")),p&&!p.dataType&&(c=Hi(I.getDisplayValue(s,d,a[l])),h=h||c,h&&c&&h!==c&&(h="string"));(u||h)&&(u&&(s.dataType=u),p&&h&&(p.dataType=h),n=!0)}if(s.serializationFormat===void 0||p&&p.serializationFormat===void 0)for(l=0;l<a.length;l++)d=s.calculateCellValue(a[l],!0),s.serializationFormat===void 0&&(s.serializationFormat=eo(s.dataType,d)),p&&p.serializationFormat===void 0&&(p.serializationFormat=eo(p.dataType,p.calculateCellValue(d,!0)))}t._updateColumnOptions(s,o)}),n}_customizeColumns(e){var t=this.option("customizeColumns");if(t){var i=e.some(a=>Q(a.ownerBand));i&&nt(this),t(e),St(this,Et(this,e))}}updateColumns(e,t,i){if(t||this.updateSortingGrouping(e),!e||e.isLoaded()){var a=e?e.sort()||[]:this.getSortDataSourceParameters(),n=e?e.group()||[]:this.getGroupDataSourceParameters(),o=e==null?void 0:e.lastLoadOptions().filter;i||this._customizeColumns(this._columns),nt(this);var s=this._columns;return P(this.refresh(!0)).always(()=>{this._columns===s&&(this._updateChanges(e,{sorting:a,grouping:n,filtering:o}),Wt(this))})}}_updateChanges(e,t){e&&(this.updateColumnDataTypes(e),this._dataSourceApplied=!0),I.equalSortParameters(t.sorting,this.getSortDataSourceParameters())||Re(this,"sorting"),I.equalSortParameters(t.grouping,this.getGroupDataSourceParameters())||Re(this,"grouping");var i=this.getController("data");i&&!I.equalFilterParameters(t.filtering,i.getCombinedFilter())&&Re(this,"filtering"),Re(this,"columns")}updateSortingGrouping(e,t){var i=this,a,n,o=function(c,p,g){T(c,(v,f)=>{if(delete f[g],p)for(var C=0;C<p.length;C++){var{selector:w}=p[C],{isExpanded:x}=p[C];if(w===f.dataField||w===f.name||w===f.selector||w===f.calculateCellValue||w===f.calculateGroupValue||w===f.calculateDisplayValue){t?f.sortOrder="sortOrder"in f?f.sortOrder:p[C].desc?"desc":"asc":f.sortOrder=f.sortOrder||(p[C].desc?"desc":"asc"),x!==void 0&&(f.autoExpandGroup=x),f[g]=C;break}}})};if(e){a=I.normalizeSortingInfo(e.sort());var s=I.normalizeSortingInfo(e.group()),l=i.getGroupDataSourceParameters(),d=i.getSortDataSourceParameters(),u=!I.equalSortParameters(s,l,!0),h=!u&&!I.equalSortParameters(s,l);i._columns.length||(T(s,(c,p)=>{i._columns.push(p.selector)}),T(a,(c,p)=>{H(p.selector)||i._columns.push(p.selector)}),St(i,Et(i,i._columns))),(t||!l&&!i._hasUserState)&&(u||h)&&(o(i._columns,s,"groupIndex"),t&&(u&&Re(i,"grouping"),h&&Re(i,"groupExpanding"),n=!0)),(t||!d&&!i._hasUserState)&&!I.equalSortParameters(a,d)&&(o(i._columns,a,"sortIndex"),t&&(Re(i,"sorting"),n=!0)),n&&Wt(i)}}updateFilter(e,t,i,a){if(!Array.isArray(e))return e;if(e=S([],e),i=e.columnIndex!==void 0?e.columnIndex:i,a=e.filterValue!==void 0?e.filterValue:a,G(e[0])&&e[0]!=="!"){var n=this.columnOption(e[0]);t?yl().forceIsoDateParsing&&n&&n.serializeValue&&e.length>1&&(e[e.length-1]=n.serializeValue(e[e.length-1],"filter")):n&&n.selector&&(e[0]=n.selector,e[0].columnIndex=n.index)}else H(e[0])&&(e[0].columnIndex=i,e[0].filterValue=a,e[0].selectedFilterOperation=e.selectedFilterOperation);for(var o=0;o<e.length;o++)e[o]=this.updateFilter(e[o],t,i,a);return e}columnCount(){return this._columns?this._columns.length:0}columnOption(e,t,i,a){var n=this,o=n._columns.concat(n._commandColumns),s=uo(o,e);if(s){if(arguments.length===1)return S({},s);if(G(t)){if(arguments.length===2)return Gi(n,s,t);Gi(n,s,t,i,a)}else Q(t)&&T(t,(l,d)=>{Gi(n,s,l,d,a)});Wt(n)}}clearSorting(){var e=this.columnCount();this.beginUpdate();for(var t=0;t<e;t++)this.columnOption(t,"sortOrder",void 0),delete uo(this._columns,t).sortOrder;this.endUpdate()}clearGrouping(){var e=this.columnCount();this.beginUpdate();for(var t=0;t<e;t++)this.columnOption(t,"groupIndex",void 0);this.endUpdate()}getVisibleIndex(e,t){for(var i=this.getVisibleColumns(t),a=i.length-1;a>=0;a--)if(i[a].index===e)return a;return-1}getVisibleIndexByColumn(e,t){var i=this.getVisibleColumns(t),a=i.filter(n=>n.index===e.index&&n.command===e.command)[0];return i.indexOf(a)}getVisibleColumnIndex(e,t){var i=this.columnOption(e,"index");return this.getVisibleIndex(i,t)}addColumn(e){var t=bi(this,e),i=this._columns.length;this._columns.push(t),t.isBand&&(this._columns=Et(this,this._columns),t=this._columns[i]),t.added=e,nt(this,t),this.updateColumns(this._dataSource),this._checkColumns()}deleteColumn(e){var t=this.columnOption(e);if(t&&t.index>=0){if(hp(this._columns),this._columns.splice(t.index,1),t.isBand){var i=this.getChildrenByBandColumn(t.index).map(a=>a.index);this._columns=this._columns.filter(a=>i.indexOf(a.index)<0)}nt(this),this.updateColumns(this._dataSource)}}addCommandColumn(e){var t=this._commandColumns.filter(i=>i.command===e.command)[0];t||(t=e,this._commandColumns.push(t))}getUserState(){var e=this._columns,t=[],i;function a(n,o){e[i][o]!==void 0&&(t[i][o]=e[i][o])}for(i=0;i<e.length;i++)t[i]={},T(hi,a);return t}setName(e){e.name=e.name||e.dataField||e.type}setUserState(e){var t=this._dataSource,i=this.option("stateStoring.ignoreColumnOptionNames");if(e==null||e.forEach(this.setName),!i){i=[];var a=this.getCommonSettings();this.option("columnChooser.enabled")||i.push("visible"),this.option("sorting.mode")==="none"&&i.push("sortIndex","sortOrder"),a.allowGrouping||i.push("groupIndex"),a.allowFixing||i.push("fixed","fixedPosition"),a.allowResizing||i.push("width","visibleWidth");var n=!this.option("filterPanel.visible");!this.option("filterRow.visible")&&n&&i.push("filterValue","selectedFilterOperation"),!this.option("headerFilter.visible")&&n&&i.push("filterValues","filterType")}this._columnsUserState=e,this._ignoreColumnOptionNames=i,this._hasUserState=!!e,Re(this,"filtering"),this.init(!0),t&&(t.sort(this.getSortDataSourceParameters()),t.group(this.getGroupDataSourceParameters()))}_checkColumns(){var e={},t=!1,i=[];this._columns.forEach(a=>{var n,{name:o}=a,s=(n=a.columns)===null||n===void 0?void 0:n.length,l=a.allowEditing&&(a.dataField||a.setCellValue)&&!s;o?(e[o]&&i.push('"'.concat(o,'"')),e[o]=!0):l&&(t=!0)}),i.length&&q.log("E1059",i.join(", ")),t&&q.log("E1060")}_createCalculatedColumnOptions(e,t){var i={},{dataField:a}=e;if((Array.isArray(e.columns)&&e.columns.length||e.isBand)&&(i.isBand=!0,a=null),a){if(G(a)){var n=de(a);i={caption:hr(a),calculateCellValue(o,s){var l=n(o);return this.deserializeValue&&!s?this.deserializeValue(l):l},setCellValue:sp,parseValue(o){var s,l;return this.dataType==="number"?G(o)&&this.format?s=pp(o.trim(),this.format):_(o)&&Fe(o)&&(s=Number(o)):this.dataType==="boolean"?o===this.trueText?s=!0:o===this.falseText&&(s=!1):I.isDateType(this.dataType)?(l=ke.parse(o,this.format),l&&(s=l)):s=o,s}}}i.allowFiltering=!0}else i.allowFiltering=!!e.calculateFilterExpression;return i.calculateFilterExpression=function(){return ct.defaultCalculateFilterExpression.apply(this,arguments)},i.defaultFilterOperation="=",i.createFilterExpression=function(o,s){var l;return this.calculateFilterExpression&&(l=this.calculateFilterExpression.apply(this,arguments)),H(l)&&(l=[l,"=",!0]),l&&(l.columnIndex=this.index,l.filterValue=o,l.selectedFilterOperation=s),l},(!a||!G(a))&&S(!0,i,{allowSorting:!1,allowGrouping:!1,calculateCellValue:()=>null}),t&&(i.allowFixing=!1),e.dataType&&(i.userDataType=e.dataType),e.selectedFilterOperation&&!("defaultSelectedFilterOperation"in i)&&(i.defaultSelectedFilterOperation=e.selectedFilterOperation),e.lookup&&(i.lookup={calculateCellValue(o,s){return this.valueExpr&&(o=this.valueMap&&this.valueMap[o]),this.deserializeValue&&!s?this.deserializeValue(o):o},updateValueMap(){if(this.valueMap={},this.items)for(var o=de(this.valueExpr),s=de(this.displayExpr),l=0;l<this.items.length;l++){var d=this.items[l],u=s(d);this.valueMap[o(d)]=u,this.dataType=this.dataType||Hi(u)}},update(){var o=this,{dataSource:s}=o;if(s)if(H(s)&&!yi.isWrapped(s)&&(s=s({})),He(s)||s instanceof nh||Array.isArray(s)){if(o.valueExpr){var l=Ei(s);return l.paginate=!1,s=new yr(l),s.load().done(d=>{o.items=d,o.updateValueMap&&o.updateValueMap()})}}else q.log("E1016");else o.updateValueMap&&o.updateValueMap()}}),i.resizedCallbacks=ye(),e.resized&&i.resizedCallbacks.add(e.resized.bind(e)),T(i,o=>{if(H(i[o])&&o.indexOf("default")!==0){var s="default".concat(o.charAt(0).toUpperCase()).concat(o.substr(1));i[s]=i[o]}}),i}getRowCount(){return this._rowCount=this._rowCount||dp(this),this._rowCount}getRowIndex(e,t){var i=this._columns[e],a=this.getBandColumnsCache();return i&&(t||i.visible&&!(i.command||_(i.groupIndex)))?lt(e,a.columnParentByIndex).length:0}getChildrenByBandColumn(e,t){var i=this.getBandColumnsCache(),a=qc(e,i.columnChildrenByIndex,!t);return t?a.filter(n=>n.visible&&!n.command).sort((n,o)=>n.visibleIndex-o.visibleIndex):a}isParentBandColumn(e,t){var i=!1,a=this._columns[e],n=this.getBandColumnsCache(),o=a&&lt(e,n.columnParentByIndex);return o&&T(o,(s,l)=>{if(l.index===t)return i=!0,!1}),i}isParentColumnVisible(e){var t=!0,i=this.getBandColumnsCache(),a=e>=0&&lt(e,i.columnParentByIndex);return a&&T(a,(n,o)=>(t=t&&o.visible,t)),t}getColumnId(e){return e.command&&e.type===Xe?Ba(this,e)?"type:".concat(e.type):"command:".concat(e.command):e.index}getCustomizeTextByDataType(e){return ro(e)}getHeaderContentAlignment(e){var t=this.option("rtlEnabled");return t?e==="left"?"right":"left":e}}var ho={defaultOptions:()=>({commonColumnSettings:{allowFiltering:!0,allowHiding:!0,allowSorting:!0,allowEditing:!0,encodeHtml:!0,trueText:y.format("dxDataGrid-trueText"),falseText:y.format("dxDataGrid-falseText")},allowColumnReordering:!1,allowColumnResizing:!1,columnResizingMode:"nextColumn",columnMinWidth:void 0,columnWidth:void 0,adaptColumnWidthByRatio:!0,columns:void 0,regenerateColumnsByVisibleItems:!1,customizeColumns:null,dateSerializationFormat:void 0}),controllers:{columns:gp}};A.registerModule("columns",{defaultOptions:()=>S(!0,{},ho.defaultOptions(),{commonColumnSettings:{allowExporting:!0}}),controllers:ho.controllers});var co=function(r,e,t){var i=r._dataSource;if(i){if(t!==void 0){var a=r._getPagingOptionValue(e);if(a!==t){e==="pageSize"&&i.pageIndex(0),i[e](t),r._skipProcessingPagingChange=!0,r.option("paging.".concat(e),t),r._skipProcessingPagingChange=!1;var n=i.pageIndex();return r._isPaging=e==="pageIndex",i[e==="pageIndex"?"load":"reload"]().done(()=>{r._isPaging=!1,r.pageChanged.fire(n)})}return O().resolve().promise()}return i[e]()}return 0},vp=W.Controller.inherit(El);let fp=class extends vp{init(){var e=this;e._items=[],e._cachedProcessedItems=null,e._columnsController=this.getController("columns"),e._isPaging=!1,e._currentOperationTypes=null,e._dataChangedHandler=t=>{e._currentOperationTypes=this._dataSource.operationTypes(),e._handleDataChanged(t),e._currentOperationTypes=null},e._columnsChangedHandler=e._handleColumnsChanged.bind(e),e._loadingChangedHandler=e._handleLoadingChanged.bind(e),e._loadErrorHandler=e._handleLoadError.bind(e),e._customizeStoreLoadOptionsHandler=e._handleCustomizeStoreLoadOptions.bind(e),e._changingHandler=e._handleChanging.bind(e),e._dataPushedHandler=e._handleDataPushed.bind(e),e._columnsController.columnsChanged.add(e._columnsChangedHandler),e._isLoading=!1,e._isCustomLoading=!1,e._repaintChangesOnly=void 0,e._changes=[],e.createAction("onDataErrorOccurred"),e.dataErrorOccurred.add(t=>e.executeAction("onDataErrorOccurred",{error:t})),e._refreshDataSource()}_getPagingOptionValue(e){return this._dataSource[e]()}callbackNames(){return["changed","loadingChanged","dataErrorOccurred","pageChanged","dataSourceChanged","pushed"]}callbackFlags(e){if(e==="dataErrorOccurred")return{stopOnFalse:!0}}publicMethods(){return["beginCustomLoading","endCustomLoading","refresh","filter","clearFilter","getCombinedFilter","keyOf","byKey","getDataByKeys","pageIndex","pageSize","pageCount","totalCount","_disposeDataSource","getKeyByRowIndex","getRowIndexByKey","getDataSource","getVisibleRows","repaintRows"]}reset(){this._columnsController.reset(),this._items=[],this._refreshDataSource()}_handleDataSourceChange(e){if(e.value===e.previousValue||this.option("columns")&&Array.isArray(e.value)&&Array.isArray(e.previousValue)){var t=e.value!==e.previousValue;if(t){var i=this.store();i&&(i._array=e.value)}return this.needToRefreshOnDataSourceChange(e)&&this.refresh(this.option("repaintChangesOnly")),!0}return!1}needToRefreshOnDataSourceChange(e){return!0}optionChanged(e){var t=this,i,a;function n(){e.handled=!0}if(e.name==="dataSource"&&e.name===e.fullName&&this._handleDataSourceChange(e)){n();return}switch(e.name){case"cacheEnabled":case"repaintChangesOnly":case"highlightChanges":case"loadingTimeout":n();break;case"remoteOperations":case"keyExpr":case"dataSource":case"scrolling":n(),t.reset();break;case"paging":if(i=t.dataSource(),i&&(a=t._setPagingOptions(i),a)){var o=i.pageIndex();this._isPaging=a.isPageIndexChanged,i.load().done(()=>{this._isPaging=!1,t.pageChanged.fire(o)})}n();break;case"rtlEnabled":t.reset();break;case"columns":i=t.dataSource(),i&&i.isLoading()&&e.name===e.fullName&&(this._useSortingGroupingFromColumns=!0,i.load());break;default:super.optionChanged(e)}}isReady(){return!this._isLoading}getDataSource(){return this._dataSource&&this._dataSource._dataSource}getCombinedFilter(e){return this.combinedFilter(void 0,e)}combinedFilter(e,t){if(!this._dataSource)return e;var i=e??this._dataSource.filter(),a=this._columnsController.isDataSourceApplied()||this._columnsController.isAllDataTypesDefined();if(a){var n=this._calculateAdditionalFilter();i=n?I.combineFilters([n,i]):i}var o=this._dataSource.remoteOperations().filtering||t;return i=this._columnsController.updateFilter(i,o),i}waitReady(){return this._updateLockCount?(this._readyDeferred=new O,this._readyDeferred):P()}_endUpdateCore(){var e=this._changes;if(e.length){this._changes=[];var t=e.every(i=>i.repaintChangesOnly);this.updateItems(e.length===1?e[0]:{repaintChangesOnly:t})}this._readyDeferred&&(this._readyDeferred.resolve(),this._readyDeferred=null)}_handleCustomizeStoreLoadOptions(e){var t,i=this._columnsController,a=this._dataSource,{storeLoadOptions:n}=e;e.isCustomLoading&&!n.isLoadingAll||(n.filter=this.combinedFilter(n.filter),((t=n.filter)===null||t===void 0?void 0:t.length)===1&&n.filter[0]==="!"&&(e.data=[],e.extra=e.extra||{},e.extra.totalCount=0),i.isDataSourceApplied()||i.updateColumnDataTypes(a),this._columnsUpdating=!0,i.updateSortingGrouping(a,!this._useSortingGroupingFromColumns),this._columnsUpdating=!1,n.sort=i.getSortDataSourceParameters(),n.group=i.getGroupDataSourceParameters(),a.sort(n.sort),a.group(n.group),n.sort=i.getSortDataSourceParameters(!a.remoteOperations().sorting),e.group=i.getGroupDataSourceParameters(!a.remoteOperations().grouping))}_handleColumnsChanged(e){var t=this,{changeTypes:i}=e,{optionNames:a}=e,n,o,s;if(i.sorting||i.grouping)t._dataSource&&!t._columnsUpdating&&(t._dataSource.group(t._columnsController.getGroupDataSourceParameters()),t._dataSource.sort(t._columnsController.getSortDataSourceParameters()),t.reload());else if(i.columns&&(o=t._columnsController.columnOption(e.columnIndex,"filterValues"),(a.filterValues||a.filterType&&Array.isArray(o)||a.filterValue||a.selectedFilterOperation||a.allowFiltering)&&(n=t._columnsController.columnOption(e.columnIndex,"filterValue"),(Array.isArray(o)||e.columnIndex===void 0||_(n)||!a.selectedFilterOperation||a.filterValue)&&(t._applyFilter(),s=!0)),!t._needApplyFilter&&!I.checkChanges(a,["width","visibleWidth","filterValue","bufferedFilterValue","selectedFilterOperation","filterValues","filterType"])&&t._columnsController.columnsChanged.add(function d(u){var h;t._columnsController.columnsChanged.remove(d),t.updateItems({repaintChangesOnly:!1,virtualColumnsScrolling:(h=u==null?void 0:u.changeTypes)===null||h===void 0?void 0:h.virtualColumnsScrolling})}),_(a.visible))){var l=t._columnsController.columnOption(e.columnIndex);l&&(_(l.filterValue)||_(l.filterValues))&&(t._applyFilter(),s=!0)}!s&&i.filtering&&t.reload()}_handleDataChanged(e){var t=this,i=t._dataSource,a=t._columnsController,n=!1;this._useSortingGroupingFromColumns=!1,i&&!t._isDataSourceApplying&&(t._isDataSourceApplying=!0,P(t._columnsController.applyDataSource(i)).done(()=>{t._isLoading&&t._handleLoadingChanged(!1),n&&e&&e.isDelayed&&(e.isDelayed=!1),t._isDataSourceApplying=!1;var o=t._needApplyFilter;t._needApplyFilter=!1,o&&!t._isAllDataTypesDefined&&(s=t._calculateAdditionalFilter(),s&&s.length)?(q.log("W1005",t.component.NAME),t._applyFilter()):t.updateItems(e,!0);var s}).fail(()=>{t._isDataSourceApplying=!1}),t._isDataSourceApplying&&(n=!0,t._handleLoadingChanged(!0)),t._needApplyFilter=!t._columnsController.isDataSourceApplied(),t._isAllDataTypesDefined=a.isAllDataTypesDefined())}_handleLoadingChanged(e){this._isLoading=e,this._fireLoadingChanged()}_handleLoadError(e){this.dataErrorOccurred.fire(e)}_handleDataPushed(e){this.pushed.fire(e)}fireError(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.dataErrorOccurred.fire(q.Error.apply(q,t))}_setPagingOptions(e){var t=this.option("paging.pageIndex"),i=this.option("paging.pageSize"),a=this.option("paging.enabled"),n=this.option("scrolling.mode"),o=n==="infinite",s=n==="virtual",l=a||s||o,d=!1,u=!1,h=!1;return e.requireTotalCount(!o),a!==void 0&&e.paginate()!==l&&(e.paginate(l),d=!0),i!==void 0&&e.pageSize()!==i&&(e.pageSize(i),u=!0),t!==void 0&&e.pageIndex()!==t&&(e.pageIndex(t),h=!0),d||u||h?{isPaginateChanged:d,isPageSizeChanged:u,isPageIndexChanged:h}:!1}_getSpecificDataSourceOption(){var e=this.option("dataSource");return Array.isArray(e)?{store:{type:"array",data:e,key:this.option("keyExpr")}}:e}_initDataSource(){var e=this._dataSource;super._initDataSource();var t=this._dataSource;if(this._useSortingGroupingFromColumns=!0,this._cachedProcessedItems=null,t){var i=this._setPagingOptions(t);this._isPaging=i==null?void 0:i.isPageIndexChanged,this.setDataSource(t)}else e&&this.updateItems()}_loadDataSource(){var e=this,t=e._dataSource,i=new O;return P(this._columnsController.refresh(!0)).always(()=>{t?t.load().done(function(){e._isPaging=!1,i.resolve.apply(i,arguments)}).fail(i.reject):i.resolve()}),i.promise()}_beforeProcessItems(e){return e.slice(0)}getRowIndexDelta(){return 0}getDataIndex(e){var t=this._items,i=e.changeType==="append"&&t.length>0?t[t.length-1]:null;return _(i==null?void 0:i.dataIndex)?i.dataIndex+1:0}_processItems(e,t){var i=this,a=i.getRowIndexDelta(),{changeType:n}=t,o=i._columnsController.getVisibleColumns(null,n==="loadingAll"),s=this.getDataIndex(t),l={visibleColumns:o,dataIndex:s},d=[];return T(e,(u,h)=>{_(h)&&(l.rowIndex=u-a,h=i._processItem(h,l),d.push(h))}),d}_processItem(e,t){return e=this._generateDataItem(e,t),e=this._processDataItem(e,t),e.dataIndex=t.dataIndex++,e}_generateDataItem(e,t){return{rowType:"data",data:e,key:this.keyOf(e)}}_processDataItem(e,t){return e.values=this.generateDataValues(e.data,t.visibleColumns),e}generateDataValues(e,t,i){for(var a=[],n,o=0;o<t.length;o++){var s=t[o];n=i?void 0:null,s.command||(s.calculateCellValue?n=s.calculateCellValue(e):s.dataField&&(n=e[s.dataField])),a.push(n)}return a}_applyChange(e){e.changeType==="update"?this._applyChangeUpdate(e):this.items().length&&e.repaintChangesOnly&&e.changeType==="refresh"?this._applyChangesOnly(e):e.changeType==="refresh"&&this._applyChangeFull(e)}_applyChangeFull(e){this._items=e.items.slice(0)}_getRowIndices(e){var t=e.rowIndices.slice(0),i=this.getRowIndexDelta();t.sort((o,s)=>o-s);for(var a=0;a<t.length;a++){var n=t[a];e.allowInvisibleRowIndices&&(n+=i),n<0&&(t.splice(a,1),a--)}return t}_applyChangeUpdate(e){var t=this,{items:i}=e,a=t._getRowIndices(e),n=t.getRowIndexDelta(),o=t.option("repaintChangesOnly"),s=-1,l=0,d;e.items=[],e.rowIndices=[],e.columnIndices=[],e.changeTypes=[];var u=function(h,c,p){var g=h&&c&&U(h.key,c.key);return g&&p&&(g=h.rowType===c.rowType&&(c.rowType!=="detail"||h.isEditing===c.isEditing)),g};T(a,(h,c)=>{var p;if(c+=l+n,s!==c){s=c;var g=t._items[c],v=t._items[c+1],f=i[c],C=i[c+1],w=u(g,v)||u(f,C);if(f&&(f.rowIndex=c,e.items.push(f)),g&&f&&u(g,f,w))d="update",t._items[c]=f,g.visible!==f.visible?e.items.splice(-1,1,{visible:f.visible}):o&&!e.isFullUpdate&&(p=t._partialUpdateRow(g,f,c-n));else if(f&&!g||C&&u(g,C,w))d="insert",t._items.splice(c,0,f),l++;else if(g&&!f||v&&u(f,v,w))d="remove",t._items.splice(c,1),l--,s=-1;else if(f)d="update",t._items[c]=f;else return;e.rowIndices.push(c-n),e.changeTypes.push(d),e.columnIndices.push(p)}})}_isCellChanged(e,t,i,a,n){if(JSON.stringify(e.values[a])!==JSON.stringify(t.values[a]))return!0;function o(s,l){return s.modifiedValues?s.modifiedValues[l]!==void 0:!1}return o(e,a)!==o(t,a)}_getChangedColumnIndices(e,t,i,a){var n;if(e.rowType===t.rowType){if(t.rowType!=="group"&&t.rowType!=="groupFooter"&&(n=[],t.rowType!=="detail"))for(var o=0;o<e.values.length;o++)this._isCellChanged(e,t,i,o,a)&&n.push(o);t.rowType==="group"&&t.isExpanded===e.isExpanded&&e.cells&&(n=e.cells.map((s,l)=>{var d;return((d=s.column)===null||d===void 0?void 0:d.type)!=="groupExpand"?l:-1}).filter(s=>s>=0))}return n}_partialUpdateRow(e,t,i,a){var n=this._getChangedColumnIndices(e,t,i,a);return n!=null&&n.length&&this.option("dataRowTemplate")&&(n=void 0),n&&(e.cells&&e.cells.forEach((o,s)=>{var l=n.indexOf(s)>=0;!l&&o&&o.update&&o.update(t)}),t.update=e.update,t.watch=e.watch,t.cells=e.cells,a&&(t.oldValues=e.values),e.update&&e.update(t)),n}_isItemEquals(e,t){var i,a,n,o;if(JSON.stringify(e.values)!==JSON.stringify(t.values)||["modified","isNewRow","removed","isEditing"].some(u=>e[u]!==t[u]))return!1;if(e.rowType==="group"||e.rowType==="groupFooter"){var s=e.isExpanded===t.isExpanded,l=JSON.stringify(e.summaryCells)===JSON.stringify(t.summaryCells),d=((i=e.data)===null||i===void 0?void 0:i.isContinuation)===((a=t.data)===null||a===void 0?void 0:a.isContinuation)&&((n=e.data)===null||n===void 0?void 0:n.isContinuationOnNextPage)===((o=t.data)===null||o===void 0?void 0:o.isContinuationOnNextPage);if(!s||!l||!d)return!1}return!0}_applyChangesOnly(e){var t,i=[],a=[],n=[],o=[],s={},l=(t=e==null?void 0:e.isLiveUpdate)!==null&&t!==void 0?t:!0;function d(p){if(p)return"".concat(p.rowType,",").concat(JSON.stringify(p.key))}var u=this._items,h=u.slice();e.items.forEach((p,g)=>{var v=d(p);s[v]=g,p.rowIndex=g});var c=oh(h,e.items,d,(p,g)=>this._isItemEquals(p,g)?(p.cells&&(p.update&&p.update(g),p.cells.forEach(v=>{v&&v.update&&v.update(g,!0)})),!0):!1);if(!c){this._applyChangeFull(e);return}c.forEach(p=>{switch(p.type){case"update":var{index:g}=p,v=p.data,{oldItem:f}=p,C=this._partialUpdateRow(f,v,g,l);i.push(g),n.push("update"),o.push(v),u[g]=v,a.push(C);break;case"insert":i.push(p.index),n.push("insert"),o.push(p.data),a.push(void 0),u.splice(p.index,0,p.data);break;case"remove":i.push(p.index),n.push("remove"),u.splice(p.index,1),o.push(p.oldItem),a.push(void 0)}}),e.repaintChangesOnly=!0,e.changeType="update",e.rowIndices=i,e.columnIndices=a,e.changeTypes=n,e.items=o,h.length&&(e.isLiveUpdate=!0),this._correctRowIndices(p=>{var g=this._rowIndexOffset||0,v=this.getRowIndexOffset(),f=h[p-g],C=d(f),w=s[C];return w>=0?w+v-p:0})}_correctRowIndices(e){}_afterProcessItems(e,t){return e}_updateItemsCore(e){var t,i=this._dataSource,a=e.changeType||"refresh";if(e.changeType=a,i){var n=this._cachedProcessedItems;e.useProcessedItemsCache&&n?t=n:(t=e.items||i.items(),t=this._beforeProcessItems(t),t=this._processItems(t,e),this._cachedProcessedItems=t),t=this._afterProcessItems(t,e),e.items=t;var o=this._items.length===t.length&&this._items;this._applyChange(e);var s=this.getRowIndexDelta();T(this._items,(l,d)=>{var u;d.rowIndex=l-s,o&&(d.cells=(u=o[l].cells)!==null&&u!==void 0?u:[]);var h=t[l];h&&(d.loadIndex=h.loadIndex)}),this._rowIndexOffset=this.getRowIndexOffset()}else this._items=[]}_handleChanging(e){var t=this.getVisibleRows(),i=this.dataSource();i&&e.changes.forEach(a=>{if(a.type==="insert"&&a.index>=0){for(var n=0,o=0;o<a.index;o++){var s=t[o];s&&(s.rowType==="data"||s.rowType==="group")&&n++}a.index=n}})}updateItems(e,t){var i;if(e=e||{},this._repaintChangesOnly!==void 0)e.repaintChangesOnly=(i=e.repaintChangesOnly)!==null&&i!==void 0?i:this._repaintChangesOnly,e.needUpdateDimensions=e.needUpdateDimensions||this._needUpdateDimensions;else if(e.changes)e.repaintChangesOnly=this.option("repaintChangesOnly");else if(t){var a=this.dataSource().operationTypes();e.repaintChangesOnly=a&&!a.grouping&&!a.filtering&&this.option("repaintChangesOnly"),e.isDataChanged=!0,a&&(a.reload||a.paging||a.groupExpanding)&&(e.needUpdateDimensions=!0)}if(this._updateLockCount&&!e.cancel){this._changes.push(e);return}this._updateItemsCore(e),!e.cancel&&this._fireChanged(e)}loadingOperationTypes(){var e=this.dataSource();return e&&e.loadingOperationTypes()||{}}_fireChanged(e){this._currentOperationTypes&&(e.operationTypes=this._currentOperationTypes,this._currentOperationTypes=null),fe(()=>{this.changed.fire(e)})}isLoading(){return this._isLoading||this._isCustomLoading}_fireLoadingChanged(){this.loadingChanged.fire(this.isLoading(),this._loadingText)}_calculateAdditionalFilter(){return null}_applyFilter(){var e=this._dataSource;if(e)return e.pageIndex(0),this._isFilterApplying=!0,this.reload().done(()=>{this._isFilterApplying&&this.pageChanged.fire()})}resetFilterApplying(){this._isFilterApplying=!1}filter(e){var t=this._dataSource,i=t&&t.filter();if(arguments.length===0)return i;e=arguments.length>1?Array.prototype.slice.call(arguments,0):e,!I.equalFilterParameters(i,e)&&(t&&t.filter(e),this._applyFilter())}clearFilter(e){var t=this._columnsController,i=function(a){for(var n=t.columnCount(),o=0;o<n;o++)t.columnOption(o,a,void 0)};if(this.component.beginUpdate(),arguments.length>0)switch(e){case"dataSource":this.filter(null);break;case"search":this.searchByText("");break;case"header":i("filterValues");break;case"row":i("filterValue")}else this.filter(null),this.searchByText(""),i("filterValue"),i("bufferedFilterValue"),i("filterValues");this.component.endUpdate()}_fireDataSourceChanged(){var e=this;e.changed.add(function t(){e.changed.remove(t),e.dataSourceChanged.fire()})}_getDataSourceAdapter(){}_createDataSourceAdapterCore(e,t){var i=this._getDataSourceAdapter(),a=i.create(this.component);return a.init(e,t),a}isLocalStore(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.store();return e instanceof en}isCustomStore(e){return e=e||this.store(),e instanceof sh}_createDataSourceAdapter(e){var t=this.option("remoteOperations"),i=e.store(),a={filtering:!0,sorting:!0,paging:!0,grouping:!0,summary:!0};return Q(t)&&t.groupPaging&&(t=S({},a,t)),t==="auto"&&(t=this.isLocalStore(i)||this.isCustomStore(i)?{}:{filtering:!0,sorting:!0,paging:!0}),t===!0&&(t=a),this._createDataSourceAdapterCore(e,t)}setDataSource(e){var t=this._dataSource;!e&&t&&(t.cancelAll(),t.changed.remove(this._dataChangedHandler),t.loadingChanged.remove(this._loadingChangedHandler),t.loadError.remove(this._loadErrorHandler),t.customizeStoreLoadOptions.remove(this._customizeStoreLoadOptionsHandler),t.changing.remove(this._changingHandler),t.pushed.remove(this._dataPushedHandler),t.dispose(this._isSharedDataSource)),e&&(e=this._createDataSourceAdapter(e)),this._dataSource=e,e&&(this._fireDataSourceChanged(),this._isLoading=!e.isLoaded(),this._needApplyFilter=!0,this._isAllDataTypesDefined=this._columnsController.isAllDataTypesDefined(),e.changed.add(this._dataChangedHandler),e.loadingChanged.add(this._loadingChangedHandler),e.loadError.add(this._loadErrorHandler),e.customizeStoreLoadOptions.add(this._customizeStoreLoadOptionsHandler),e.changing.add(this._changingHandler),e.pushed.add(this._dataPushedHandler))}items(e){return this._items}isEmpty(){return!this.items().length}pageCount(){return this._dataSource?this._dataSource.pageCount():1}dataSource(){return this._dataSource}store(){var e=this._dataSource;return e&&e.store()}loadAll(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this,a=new O,n=i._dataSource;if(n)if(e){var o={data:e,isCustomLoading:!0,storeLoadOptions:{isLoadingAll:!0},loadOptions:{filter:t?null:i.getCombinedFilter(),group:n.group(),sort:n.sort()}};n._handleDataLoaded(o),P(o.data).done(l=>{var d;l=i._beforeProcessItems(l),a.resolve(i._processItems(l,{changeType:"loadingAll"}),(d=o.extra)===null||d===void 0?void 0:d.summary)}).fail(a.reject)}else if(n.isLoading())a.reject();else{var s=S({},n.loadOptions(),{isLoadingAll:!0,requireTotalCount:!1});n.load(s).done((l,d)=>{l=i._beforeProcessItems(l),l=i._processItems(l,{changeType:"loadingAll"}),a.resolve(l,d&&d.summary)}).fail(a.reject)}else a.resolve([]);return a}getKeyByRowIndex(e,t){var i=this.items(t)[e];if(i)return i.key}getRowIndexByKey(e,t){return I.getIndexByKey(e,this.items(t))}keyOf(e){var t=this.store();if(t)return t.keyOf(e)}byKey(e){var t=this.store(),i=this.getRowIndexByKey(e),a;if(t)return i>=0&&(a=new O().resolve(this.items()[i].data)),a||t.byKey(e)}key(){var e=this.store();if(e)return e.key()}getRowIndexOffset(e){return 0}getDataByKeys(e){var t=this,i=new O,a=[],n=[];return T(e,(o,s)=>{a.push(t.byKey(s).done(l=>{n[o]=l}))}),P.apply(m,a).always(()=>{i.resolve(n)}),i}pageIndex(e){return co(this,"pageIndex",e)}pageSize(e){return co(this,"pageSize",e)}beginCustomLoading(e){this._isCustomLoading=!0,this._loadingText=e||"",this._fireLoadingChanged()}endCustomLoading(){this._isCustomLoading=!1,this._loadingText=void 0,this._fireLoadingChanged()}refresh(e){e===!0?e={reload:!0,changesOnly:!0}:e||(e={lookup:!0,selection:!0,reload:!0});var t=this,i=t.getDataSource(),{changesOnly:a}=e,n=new O,o=function(){t._repaintChangesOnly=!!a};return P(!e.lookup||t._columnsController.refresh()).always(()=>{e.load||e.reload?(i&&i.on("customizeLoadResult",o),P(t.reload(e.reload,a)).always(()=>{i&&i.off("customizeLoadResult",o),t._repaintChangesOnly=void 0}).done(n.resolve).fail(n.reject)):(t.updateItems({repaintChangesOnly:e.changesOnly}),n.resolve())}),n.promise()}getVisibleRows(){return this.items()}_disposeDataSource(){this.setDataSource(null)}dispose(){this._disposeDataSource(),super.dispose()}repaintRows(e,t){e=Array.isArray(e)?e:[e],(e.length>1||_(e[0]))&&this.updateItems({changeType:"update",rowIndices:e,isFullUpdate:!t})}skipProcessingPagingChange(e){return this._skipProcessingPagingChange&&(e==="paging.pageIndex"||e==="paging.pageSize")}getUserState(){return{searchText:this.option("searchPanel.text"),pageIndex:this.pageIndex(),pageSize:this.pageSize()}}getCachedStoreData(){return this._dataSource&&this._dataSource.getCachedStoreData()}isLastPageLoaded(){var e=this.pageIndex(),t=this.pageCount();return e===t-1}load(){var e;return(e=this._dataSource)===null||e===void 0?void 0:e.load()}reload(e,t){var i;return(i=this._dataSource)===null||i===void 0?void 0:i.reload(e,t)}push(){var e;return(e=this._dataSource)===null||e===void 0?void 0:e.push(...arguments)}itemsCount(){var e;return this._dataSource?(e=this._dataSource)===null||e===void 0?void 0:e.itemsCount():0}totalItemsCount(){var e;return this._dataSource?(e=this._dataSource)===null||e===void 0?void 0:e.totalItemsCount():0}hasKnownLastPage(){var e;return this._dataSource?(e=this._dataSource)===null||e===void 0?void 0:e.hasKnownLastPage():!0}isLoaded(){var e;return this._dataSource?(e=this._dataSource)===null||e===void 0?void 0:e.isLoaded():!0}totalCount(){var e;return this._dataSource?(e=this._dataSource)===null||e===void 0?void 0:e.totalCount():0}};var jl={defaultOptions:()=>({loadingTimeout:0,dataSource:null,cacheEnabled:!0,repaintChangesOnly:!1,highlightChanges:!1,onDataErrorOccurred:null,remoteOperations:"auto",paging:{enabled:!0,pageSize:void 0,pageIndex:void 0}}),controllers:{data:fp}};const mp=W.Controller.inherit(function(){function r(s,l){if(s&&(s=s.slice(0),l))for(var d=0;d<s.length;d++)s[d]=S({key:s[d].key},s[d]),s[d].items=r(s[d].items,l-1);return s}function e(s,l,d){var u={reload:!0,fullReload:!0};return l&&(u={sorting:!I.equalSortParameters(s.sort,l.sort),grouping:!I.equalSortParameters(s.group,l.group,!0),groupExpanding:!I.equalSortParameters(s.group,l.group)||l.groupExpand,filtering:!I.equalFilterParameters(s.filter,l.filter),pageIndex:s.pageIndex!==l.pageIndex,skip:s.skip!==l.skip,take:s.take!==l.take,pageSize:s.pageSize!==l.pageSize,fullReload:d,reload:!1,paging:!1},u.reload=d||u.sorting||u.grouping||u.filtering,u.paging=u.pageIndex||u.pageSize||u.take),u}function t(s,l){var d=I.normalizeSortingInfo(s.group||s.storeLoadOptions.group||s.loadOptions.group).length,u=[];if(i(u,s,d))return u;l&&function(h,c,p){var g,v,f=h.length,{storeLoadOptions:C}=c;if(C.skip!==void 0&&C.take&&!p){var w=[];i(w,c,p,!0);var x=w.length;(f||x)&&(c.skip=(g=c.skip)!==null&&g!==void 0?g:C.skip,c.take=(v=c.take)!==null&&v!==void 0?v:C.take),f&&(C.skip+=f,C.take-=f,c.cachedDataPartBegin=h),x&&(C.take-=x,c.cachedDataPartEnd=w.reverse())}}(u,s,d)}function i(s,l,d,u){var h,c,p,g,v,{storeLoadOptions:f}=l,C=(c=(h=l.take)!==null&&h!==void 0?h:f.take)!==null&&c!==void 0?c:0,w=(p=l.cachedData)===null||p===void 0?void 0:p.items;if(C&&w){for(var x=(v=(g=l.skip)!==null&&g!==void 0?g:f.skip)!==null&&v!==void 0?v:0,E=0;E<C;E++){var R=u?C-1-E:E,D=R+x,V=w[D];if(V===void 0&&D in w)return!0;var F=a(l,V,d,R,C);if(F)s.push(F);else return!1}return!0}return!1}function a(s,l,d,u,h){if(d&&l){var c=u===0&&s.skips||[],p=u===h-1&&s.takes||[];return function g(v,f,C,w){if(f&&v){var x=L({},v),E=C[0]||0,R=w[0],{items:D}=v;if(D){if(R===void 0&&!D[E])return;x.items=[],C.length&&(x.isContinuation=!0),R&&(x.isContinuationOnNextPage=v.count>R);for(var V=0;R===void 0?D[V+E]:V<R;V++){var F=D[V+E],B=V+1===R,k=g(F,f-1,V===0?C.slice(1):[],B?w.slice(1):[]);if(k!==void 0)x.items.push(k);else return}}return x}return v}(l,d,c,p)}return l}function n(s,l,d,u){if(d&&l){var h=L({},l);delete h.isContinuation,delete h.isContinuationOnNextPage;var c=u[0]||0;return l.items&&(h.items=(s==null?void 0:s.items)||{},l.items.forEach((p,g)=>{var v=g+c,f=g===0?u.slice(1):[];h.items[v]=n(h.items[v],p,d-1,f)})),h}return l}var o={init(s,l){var d=this;d._dataSource=s,d._remoteOperations=l||{},d._isLastPage=!s.isLastPage(),d._hasLastPage=!1,d._currentTotalCount=0,d._cachedData={items:{}},d._lastOperationTypes={},d._eventsStrategy=s._eventsStrategy,d._totalCountCorrection=0,d._isLoadingAll=!1,d.changed=ye(),d.loadingChanged=ye(),d.loadError=ye(),d.customizeStoreLoadOptions=ye(),d.changing=ye(),d.pushed=ye(),d._dataChangedHandler=d._handleDataChanged.bind(d),d._customizeStoreLoadOptionsHandler=d._handleCustomizeStoreLoadOptions.bind(d),d._dataLoadedHandler=d._handleDataLoaded.bind(d),d._loadingChangedHandler=d._handleLoadingChanged.bind(d),d._loadErrorHandler=d._handleLoadError.bind(d),d._pushHandler=d._handlePush.bind(d),d._changingHandler=d._handleChanging.bind(d),s.on("changed",d._dataChangedHandler),s.on("customizeStoreLoadOptions",d._customizeStoreLoadOptionsHandler),s.on("customizeLoadResult",d._dataLoadedHandler),s.on("loadingChanged",d._loadingChangedHandler),s.on("loadError",d._loadErrorHandler),s.on("changing",d._changingHandler),s.store().on("beforePush",d._pushHandler),T(s,(u,h)=>{!d[u]&&H(h)&&(d[u]=function(){return this._dataSource[u].apply(this._dataSource,arguments)})})},remoteOperations(){return this._remoteOperations},dispose(s){var l=this._dataSource,d=l.store();l.off("changed",this._dataChangedHandler),l.off("customizeStoreLoadOptions",this._customizeStoreLoadOptionsHandler),l.off("customizeLoadResult",this._dataLoadedHandler),l.off("loadingChanged",this._loadingChangedHandler),l.off("loadError",this._loadErrorHandler),l.off("changing",this._changingHandler),d&&d.off("beforePush",this._pushHandler),s||l.dispose()},refresh(s,l){var d=this._dataSource;l.reload&&(this.resetCurrentTotalCount(),this._isLastPage=!d.paginate(),this._hasLastPage=this._isLastPage)},resetCurrentTotalCount(){this._currentTotalCount=0,this._totalCountCorrection=0},resetCache(){this._cachedStoreData=void 0,this._cachedPagingData=void 0},resetPagesCache(){this._cachedData={items:{}}},_needClearStoreDataCache(){var s=this.remoteOperations(),l=e(this._lastLoadOptions||{},{}),d=Object.keys(s).every(u=>!l[u]||!s[u]);return!d},push(s,l){var d=this.store();this._needClearStoreDataCache()&&(this._cachedStoreData=void 0),this._cachedPagingData=void 0,this.resetPagesCache(!0),this._cachedStoreData&&jr({keyInfo:d,data:this._cachedStoreData,changes:s}),l||this._applyBatch(s),this.pushed.fire(s)},getDataIndexGetter(){if(!this._dataIndexGetter){var s,l,d=this.store();this._dataIndexGetter=u=>{var h=l&&l!==this._cachedStoreData;if(!s||h){l=this._cachedStoreData||[],s={};for(var c=0;c<l.length;c++)s[cr(d.keyOf(l[c]))]=c}return s[cr(d.keyOf(u))]}}return this._dataIndexGetter},_getKeyInfo(){return this.store()},_needToCopyDataObject:()=>!0,_applyBatch(s,l){var d=this._getKeyInfo(),u=this._dataSource,h=I.normalizeSortingInfo(this.group()).length,c=this.option("editing.refreshMode")==="reshape",p=this.option("scrolling.mode")==="virtual";s=s.filter(C=>!u.paginate()||C.type!=="insert"||C.index!==void 0);var g=()=>h?this.itemsCount():this.items().length,v=g();jr({keyInfo:d,data:this._items,changes:s,groupCount:h,useInsertIndex:!0,skipCopying:!this._needToCopyDataObject()}),jr({keyInfo:d,data:u.items(),changes:s,groupCount:h,useInsertIndex:!0,skipCopying:!this._needToCopyDataObject()});var f=this._currentTotalCount>0||(l||!c)&&p;f&&(this._totalCountCorrection+=g()-v),s.splice(0,s.length)},_handlePush(s){var{changes:l}=s;this.push(l,!0)},_handleChanging(s){this.changing.fire(s),this._applyBatch(s.changes,!0)},_needCleanCacheByOperation(s,l){var d=["filtering","sorting","paging"],u=d.indexOf(s),h=u>=0?d.slice(u):[s];return h.some(c=>l[c])},_customizeRemoteOperations(s,l){var d=this._cachedStoreData,u=this._cachedPagingData,h=this._cachedData;(s.storeLoadOptions.filter&&!s.remoteOperations.filtering||s.storeLoadOptions.sort&&!s.remoteOperations.sorting)&&(s.remoteOperations={filtering:s.remoteOperations.filtering,summary:s.remoteOperations.summary}),l.fullReload?(d=void 0,u=void 0,h={items:{}}):(l.reload?(u=void 0,h={items:{}}):l.groupExpanding&&(h={items:{}}),T(l,(c,p)=>{p&&this._needCleanCacheByOperation(c,s.remoteOperations)&&(d=void 0,u=void 0)})),u&&(s.remoteOperations.paging=!1),s.cachedStoreData=d,s.cachedPagingData=u,s.cachedData=h,s.isCustomLoading||(this._cachedStoreData=d,this._cachedPagingData=u,this._cachedData=h)},_handleCustomizeStoreLoadOptions(s){var l;this._handleDataLoading(s),((l=s.data)===null||l===void 0?void 0:l.length)!==0&&(s.data=t(s,!0)||s.cachedStoreData)},_handleDataLoading(s){var l=this._dataSource,d=this._lastLoadOptions;this.customizeStoreLoadOptions.fire(s),s.delay=this.option("loadingTimeout"),s.originalStoreLoadOptions=s.storeLoadOptions,s.remoteOperations=S({},this.remoteOperations());var u=!this.isLoaded()&&!this._isRefreshing;this.option("integrationOptions.renderedOnServer")&&!this.isLoaded()&&(s.delay=void 0);var h=S({pageIndex:this.pageIndex(),pageSize:this.pageSize()},s.storeLoadOptions),c=e(h,d,u);if(this._customizeRemoteOperations(s,c),!s.isCustomLoading){var p=this._isRefreshing;s.pageIndex=l.pageIndex(),s.lastLoadOptions=h,s.operationTypes=c,this._loadingOperationTypes=c,this._isRefreshing=!0,P(p||this._isRefreshed||this.refresh(s,c)).done(()=>{this._lastOperationId===s.operationId&&(this._isRefreshed=!0,this.load().always(()=>{this._isRefreshed=!1}))}).fail(()=>{l.cancel(s.operationId)}).always(()=>{this._isRefreshing=!1}),l.cancel(this._lastOperationId),this._lastOperationId=s.operationId,this._isRefreshing&&l.cancel(this._lastOperationId)}this._handleDataLoadingCore(s)},_handleDataLoadingCore(s){var{remoteOperations:l}=s;s.loadOptions={};var d=s.cachedData.extra,u={filter:!l.filtering,sort:!l.sorting,group:!l.grouping,summary:!l.summary,skip:!l.paging,take:!l.paging,requireTotalCount:d&&"totalCount"in d||!l.paging,langParams:!l.filtering||!l.sorting};T(s.storeLoadOptions,(h,c)=>{u[h]&&(s.loadOptions[h]=c,delete s.storeLoadOptions[h])}),d&&(s.extra=d)},_handleDataLoaded(s){var l,d,{loadOptions:u}=s,h=s.remoteOperations&&!s.remoteOperations.paging,{cachedData:c}=s,{storeLoadOptions:p}=s,g=this.option("cacheEnabled")!==!1&&p,v=g&&!s.isCustomLoading&&c&&(!h||p.group),f=g&&h,C=f&&!s.isCustomLoading;if(!u){this._dataSource.cancel(s.operationId);return}h&&(s.skip=u.skip,s.take=u.take,delete u.skip,delete u.take),u.group&&(u.group=s.group||u.group);var w=I.normalizeSortingInfo(s.group||p.group||u.group).length;s.cachedDataPartBegin&&(s.data=s.cachedDataPartBegin.concat(s.data)),s.cachedDataPartEnd&&(s.data=s.data.concat(s.cachedDataPartEnd)),(!v||!t(s))&&(f&&s.cachedPagingData?s.data=r(s.cachedPagingData,w):(C&&(this._cachedStoreData?s.mergeStoreLoadData&&(s.data=this._cachedStoreData=this._cachedStoreData.concat(s.data)):this._cachedStoreData=r(s.data,I.normalizeSortingInfo(p.group).length)),new en(s.data).load(u).done(x=>{s.data=x,C&&(this._cachedPagingData=r(s.data,w))}).fail(x=>{s.data=new O().reject(x)})),u.requireTotalCount&&h&&(s.extra=He(s.extra)?s.extra:{},s.extra.totalCount=s.data.length),s.extra&&s.extra.totalCount>=0&&(p.requireTotalCount===!1||u.requireTotalCount===!1)&&(s.extra.totalCount=-1),!u.data&&(p.requireTotalCount||((d=(l=s.extra)===null||l===void 0?void 0:l.totalCount)!==null&&d!==void 0?d:-1)>=0)&&(this._totalCountCorrection=0),this._handleDataLoadedCore(s),v&&(c.extra=c.extra||S({},s.extra),P(s.data).done(x=>{(function(E,R,D){for(var V,F,B,k,{storeLoadOptions:N}=E,j=(F=(V=E.skip)!==null&&V!==void 0?V:N.skip)!==null&&F!==void 0?F:0,K=(k=(B=E.take)!==null&&B!==void 0?B:N.take)!==null&&k!==void 0?k:0,ae=0;ae<K;ae++){var he=ae+j,Or=E.cachedData.items,Lu=ae===0&&E.skips||[];Or[he]=n(Or[he],R[ae],D,Lu)}})(s,x,w)}))),P(s.data).done(()=>{s.lastLoadOptions&&(this._lastLoadOptions=s.lastLoadOptions,Object.keys(s.operationTypes).forEach(x=>{this._lastOperationTypes[x]=this._lastOperationTypes[x]||s.operationTypes[x]}))}),s.storeLoadOptions=s.originalStoreLoadOptions},_handleDataLoadedCore(s){s.remoteOperations&&!s.remoteOperations.paging&&Array.isArray(s.data)&&(s.skip!==void 0&&(s.data=s.data.slice(s.skip)),s.take!==void 0&&(s.data=s.data.slice(0,s.take)))},_handleLoadingChanged(s){this.loadingChanged.fire(s)},_handleLoadError(s){this.loadError.fire(s),this.changed.fire({changeType:"loadError",error:s})},_loadPageSize(){return this.pageSize()},_handleDataChanged(s){var l,d=this._dataSource,u=!1,h=!s||_(s.changeType),c=this.itemsCount();h&&(this._isLastPage=!c||!this._loadPageSize()||c<this._loadPageSize(),this._isLastPage&&(this._hasLastPage=!0)),d.totalCount()>=0?d.pageIndex()>=this.pageCount()&&(d.pageIndex(this.pageCount()-1),this.pageIndex(d.pageIndex()),this.resetPagesCache(),d.load(),u=!0):h&&(l=d.pageIndex()*this.pageSize()+c,l>this._currentTotalCount&&(this._currentTotalCount=l,(d.pageIndex()===0||!this.option("scrolling.legacyMode"))&&(this._totalCountCorrection=0)),c===0&&d.pageIndex()>=this.pageCount()&&(d.pageIndex(this.pageCount()-1),this.option("scrolling.mode")!=="infinite"&&(d.load(),u=!0))),u||(this._operationTypes=this._lastOperationTypes,this._lastOperationTypes={},this.component._optionCache={},this.changed.fire(s),this.component._optionCache=void 0)},_scheduleCustomLoadCallbacks(s){var l=this;l._isCustomLoading=!0,s.always(()=>{l._isCustomLoading=!1})},loadingOperationTypes(){return this._loadingOperationTypes},operationTypes(){return this._operationTypes},lastLoadOptions(){return this._lastLoadOptions||{}},isLastPage(){return this._isLastPage},_dataSourceTotalCount(){return this._dataSource.totalCount()},totalCount(){return parseInt((this._currentTotalCount||this._dataSourceTotalCount())+this._totalCountCorrection)},totalCountCorrection(){return this._totalCountCorrection},itemsCount(){return this._dataSource.items().length},totalItemsCount(){return this.totalCount()},pageSize(){var s=this._dataSource;return!arguments.length&&!s.paginate()?0:s.pageSize.apply(s,arguments)},pageCount(){var s=this.totalItemsCount()-this._totalCountCorrection,l=this.pageSize();return l&&s>0?Math.max(1,Math.ceil(s/l)):1},hasKnownLastPage(){return this._hasLastPage||this._dataSource.totalCount()>=0},loadFromStore(s,l){var d=this._dataSource,u=new O;if(d)return l=l||d.store(),l.load(s).done((h,c)=>{h&&!Array.isArray(h)&&Array.isArray(h.data)&&(c=h,h=h.data),u.resolve(h,c)}).fail(u.reject),u},isCustomLoading(){return!!this._isCustomLoading},load(s){var l=this,d=l._dataSource,u=new O;if(s){var h=d.store(),c=d.loadOptions(),p={storeLoadOptions:S({},s,{langParams:c==null?void 0:c.langParams}),isCustomLoading:!0};return T(h._customLoadOptions()||[],(g,v)=>{v in p.storeLoadOptions||(p.storeLoadOptions[v]=c[v])}),this._isLoadingAll=s.isLoadingAll,l._scheduleCustomLoadCallbacks(u),d._scheduleLoadCallbacks(u),l._handleCustomizeStoreLoadOptions(p),function(g,v){_(v)?Zu(g,v):g()}(()=>{if(!d.store())return u.reject("canceled");P(p.data||l.loadFromStore(p.storeLoadOptions)).done((g,v)=>{p.data=g,p.extra=v||{},l._handleDataLoaded(p),s.requireTotalCount&&p.extra.totalCount===void 0&&(p.extra.totalCount=h.totalCount(p.storeLoadOptions)),P(p.data,p.extra.totalCount).done((f,C)=>{p.extra.totalCount=C,u.resolve(f,p.extra)}).fail(u.reject)}).fail(u.reject)},l.option("loadingTimeout")),u.fail(function(){l._eventsStrategy.fireEvent("loadError",arguments)}).always(()=>{this._isLoadingAll=!1}).promise()}return d.load()},reload(s){return s?this._dataSource.reload():this._dataSource.load()},getCachedStoreData(){return this._cachedStoreData}};return o}());var Ki=mp;const Ir={extend(r){Ki=Ki.inherit(r)},create:r=>new Ki(r)};var Ui,$i,_p=($i=(Ui=jl.controllers)===null||Ui===void 0?void 0:Ui.data)===null||$i===void 0?void 0:$i.inherit({_getDataSourceAdapter:()=>Ir,_getSpecificDataSourceOption(){var r=this.option("dataSource");return r&&!Array.isArray(r)&&this.option("keyExpr")&&q.log("W1011"),this.callBase()}});A.registerModule("data",{defaultOptions:jl.defaultOptions,controllers:{data:_p}});var po="dx-sort",go="dx-sort-none",Cp="dx-sort-up",wp="dx-sort-down",xp="dx-sort-index",vo="dx-sort-index-icon",yp="action";const Yl={_applyColumnState(r){var e,t,i=this.option("sorting.mode"),{rootElement:a}=r,{column:n}=r,o=this._getIndicatorContainer(a);if(r.name==="sort"){a.find(".".concat(po)).remove(),!o.children().length&&o.remove();var s=i!=="none"&&n.allowSorting;if(!_(n.groupIndex)&&(s||_(n.sortOrder))){e=n.sortOrder==="asc"?"ascending":"descending",t=this.callBase(r).toggleClass(Cp,n.sortOrder==="asc").toggleClass(wp,n.sortOrder==="desc");var l=this.getController&&!!this.getController("columns").columnOption("sortIndex:1");l&&this.option("sorting.showSortIndexes")&&n.sortIndex>=0&&(m("<span>").addClass(vo).text(n.sortIndex+1).appendTo(t),t.addClass(xp)),s&&r.rootElement.addClass(this.addWidgetPrefix(yp))}return _(n.sortOrder)?this.setAria("sort",e,a):this.setAria("sort","none",a),t}return this.callBase(r)},_getIndicatorClassName(r){return r==="sort"?po:r==="sortIndex"?vo:this.callBase(r)},_renderIndicator(r){var{column:e}=r,t=r.container,i=r.indicator;if(r.name==="sort"){var a=this.option("rtlEnabled");if(_(e.sortOrder)||i&&i.addClass(go),t.children().length&&(!a&&r.columnAlignment==="left"||a&&r.columnAlignment==="right")){t.prepend(i);return}}this.callBase(r)},_updateIndicator(r,e,t){if(!(t==="sort"&&_(e.groupIndex)))return this.callBase.apply(this,arguments)},_getIndicatorElements(r,e){var t=this.callBase(r);return e?t:t&&t.not(".".concat(go))}};var Ep="dxDataGridColumnHeadersView",Sp=S({},Yl,{_createRow(r){var e=this.callBase(r);return r.rowType==="header"&&b.on(e,$(re,Ep),"td",this.createAction(t=>{this._processHeaderAction(t.event,e)})),e},_processHeaderAction(r,e){if(m(r.currentTarget).parent().get(0)===e.get(0)){var t=this,i=null,a=m(r.currentTarget),n=a.parent().index(),o=-1;[].slice.call(t.getCellElements(n)).some((c,p)=>{if(c===a.get(0))return o=p,!0});var s=t._columnsController.getVisibleColumns(n),l=s[o],d=t.getController("editing"),u=t.option("editing.mode"),h=d&&d.isEditing()&&(u==="batch"||u==="cell");h||!t._isSortableElement(m(r.target))||l&&!_(l.groupIndex)&&!l.command&&(r.shiftKey?i="shift":ai(r)&&(i="ctrl"),setTimeout(()=>{t._columnsController.changeSortOrder(l.index,i)}))}},_renderCellContent(r,e){var{column:t}=e;!t.command&&e.rowType==="header"&&this._applyColumnState({name:"sort",rootElement:r,column:t,showColumnLines:this.option("showColumnLines")}),this.callBase.apply(this,arguments)},_columnOptionChanged(r){var{changeTypes:e}=r;if(e.length===1&&e.sorting){this._updateIndicators("sort");return}this.callBase(r)},optionChanged(r){switch(r.name){case"sorting":this._invalidate(),r.handled=!0;break;default:this.callBase(r)}}}),bp=S({},Yl,{_createGroupPanelItem(r,e){var t=this,i=t.callBase(...arguments);return b.on(i,$(re,"dxDataGridHeaderPanel"),t.createAction(()=>{t._processGroupItemAction(e.index)})),t._applyColumnState({name:"sort",rootElement:i,column:{alignment:t.option("rtlEnabled")?"right":"left",allowSorting:e.allowSorting,sortOrder:e.sortOrder==="desc"?"desc":"asc"},showColumnLines:!0}),i},_processGroupItemAction(r){setTimeout(()=>this.getController("columns").changeSortOrder(r))},optionChanged(r){switch(r.name){case"sorting":this._invalidate(),r.handled=!0;break;default:this.callBase(r)}}}),Ip={defaultOptions:()=>({sorting:{mode:"single",ascendingText:y.format("dxDataGrid-sortingAscendingText"),descendingText:y.format("dxDataGrid-sortingDescendingText"),clearText:y.format("dxDataGrid-sortingClearText"),showSortIndexes:!0}}),extenders:{views:{columnHeadersView:Sp,headerPanel:bp}}};A.registerModule("sorting",Ip);var Tp="rowsview",Rp="content",Op="nowrap",qi="dx-group-row",fo="dx-group-cell",Ap="dx-data-row",Dr="dx-freespace-row",Dp="dx-row-lines",mo="dx-column-lines",_o="dx-row-alt",Co="dx-last-row-border",Vp="dx-empty",Fp="row-inserted-animation",Pp=200;function wo(r){return r?Math.round(r.scrollWidth()-r.clientWidth()):0}function xo(r){var{rowType:e,column:t}=r;return e==="group"&&_(t.groupIndex)&&!t.showWhenGrouped&&!t.command}var Bp=function(r,e){var t=eh(e.text)&&e.rowType==="data",{text:i}=e,a=r.get(0);t?I.setEmptyText(r):e.column.encodeHtml?a.textContent=i:a.innerHTML=i},Lp=function(r){var e=r.getScrollable();return e?Math.ceil(parseFloat(m(e.content()).css("paddingBottom"))):0};class kp extends br{_getDefaultTemplate(e){switch(e.command){case"empty":return function(t){t.html("&nbsp;")};default:return Bp}}_getDefaultGroupTemplate(e){var t=this.option("summary.texts");return function(i,a){var{data:n}=a,o="".concat(a.column.caption,": ").concat(a.text),s=i.get(0);a.summaryItems&&a.summaryItems.length&&(o+=" ".concat(I.getGroupRowSummaryText(a.summaryItems,t))),n&&(a.groupContinuedMessage&&a.groupContinuesMessage?o+=" (".concat(a.groupContinuedMessage,". ").concat(a.groupContinuesMessage,")"):a.groupContinuesMessage?o+=" (".concat(a.groupContinuesMessage,")"):a.groupContinuedMessage&&(o+=" (".concat(a.groupContinuedMessage,")"))),e.encodeHtml?s.textContent=o:s.innerHTML=o}}_update(e){}_updateCell(e,t){xo(t)&&e.addClass(fo),super._updateCell.apply(this,arguments)}_getCellTemplate(e){var{column:t}=e,i;return xo(e)?i=t.groupCellTemplate||{allowRenderToDetachedContainer:!0,render:this._getDefaultGroupTemplate(t)}:(e.rowType==="data"||t.command)&&t.cellTemplate?i=t.cellTemplate:i={allowRenderToDetachedContainer:!0,render:this._getDefaultTemplate(t)},i}_createRow(e,t){var i=super._createRow.apply(this,arguments);if(e){var a=e.rowType==="group",n=e.rowType==="data";if(n&&i.addClass(Ap),n&&this.option("showRowLines")&&i.addClass(Dp),this.option("showColumnLines")&&i.addClass(mo),e.visible===!1&&i.hide(),a){i.addClass(qi);var o=e.isExpanded;this.setAria("role","row",i),this.setAria("expanded",_(o)&&o.toString(),i)}}return i}_rowPrepared(e,t,i){t.rowType==="data"&&(this.option("rowAlternationEnabled")&&(this._isAltRow(i)&&e.addClass(_o),t.watch&&t.watch(()=>this._isAltRow(i),a=>{e.toggleClass(_o,a)})),this._setAriaRowIndex(t,e),t.watch&&t.watch(()=>t.rowIndex,()=>this._setAriaRowIndex(t,e))),super._rowPrepared.apply(this,arguments)}_setAriaRowIndex(e,t){var{component:i}=this,a=i.option("scrolling.mode")==="standard"&&!I.isVirtualRowRendering(i),n=e.rowIndex+1;a?n=i.pageIndex()*i.pageSize()+n:n+=this._dataController.getRowIndexOffset(),this.setAria("rowindex",n,t)}_afterRowPrepared(e){var t=e.args[0],i=this._dataController,a=i.getVisibleRows()[t.rowIndex],n=this.option("integrationOptions.watchMethod");if(!(!t.data||t.rowType!=="data"||t.isNewRow||!this.option("twoWayBindingEnabled")||!n||!a)){var o=n(()=>i.generateDataValues(t.data,t.columns),()=>{i.repaintRows([a.rowIndex],this.option("repaintChangesOnly"))},{deep:!0,skipImmediate:!0});b.on(t.rowElement,fl,o)}}_renderScrollable(e){var t=this.element();if(t.children().length||t.append("<div>"),(e||!this._loadPanel)&&this._renderLoadPanel(t,t.parent(),this._dataController.isLocalStore()),(e||!this.getScrollable())&&this._dataController.isLoaded()){for(var i=this.getColumns(),a=!0,n=0;n<i.length;n++)if(!i[n].width&&!i[n].minWidth){a=!1;break}(this.option("columnAutoWidth")||this._hasHeight||a||this._columnsController._isColumnFixing())&&this._renderScrollableCore(t)}}_handleScroll(e){var t=this.option("rtlEnabled"),i=e.component.option("useNative");this._scrollTop=e.scrollOffset.top,this._scrollLeft=e.scrollOffset.left;var a=e.scrollOffset.left;t&&(this._scrollRight=wo(e.component)-this._scrollLeft,i&&(a=-this._scrollRight),this.isScrollbarVisible(!0)||(this._scrollLeft=-1)),this.scrollChanged.fire(L(L({},e.scrollOffset),{left:a}),this.name)}_renderScrollableCore(e){var t=this._createScrollableOptions(),i=this._handleScroll.bind(this);t.onScroll=i,this._scrollable=this._createComponent(e,Rt,t),this._scrollableContainer=this._scrollable&&m(this._scrollable.container())}_renderLoadPanel(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return I.renderLoadPanel.apply(this,arguments)}_renderContent(e,t,i){return e.empty().append(t),this._findContentElement()}_updateContent(e,t,i){return this._contentChanges.push({newTableElement:e,change:t,isFixedTableRendering:i}),this.waitAsyncTemplates().done(()=>{var a=this._contentChanges;this._contentChanges=[],a.forEach(n=>{var{newTableElement:o,change:s,isFixedTableRendering:l}=n,d=this.getTableElement(l),u=this._findContentElement(l),h=s==null?void 0:s.changeType,c=[],p=this.option("highlightChanges"),g=this.addWidgetPrefix(Fp);switch(h){case"update":T(s.rowIndices,(v,f)=>{var C,w=this._getRowElements(o).eq(v),x=(C=s.changeTypes)===null||C===void 0?void 0:C[v],E=s.items&&s.items[v];c.push(()=>{var R,D=this._getRowElements(d),V=D.eq(f);switch(x){case"update":if(E){var F=(R=s.columnIndices)===null||R===void 0?void 0:R[v];_(E.visible)&&E.visible!==V.is(":visible")?V.toggle(E.visible):F?this._updateCells(V,w,F):V.replaceWith(w)}break;case"insert":if(D.length)V.length?w.insertBefore(V):w.insertAfter(D.last());else if(d){var B=w.is("tbody")?d:d.children("tbody");w.prependTo(B)}p&&s.isLiveUpdate&&w.addClass(g);break;case"remove":V.remove()}})}),T(c,function(){this()}),o.remove();break;default:this.setTableElement(o,l),u.addClass(this.addWidgetPrefix(Rp)),this._renderContent(u,o,l)}})}).fail(()=>{this._contentChanges=[]})}_createEmptyRow(e,t,i){var a,n=this._createRow(),o=t?this.getFixedColumns():this.getColumns();n.addClass(e).toggleClass(mo,this.option("showColumnLines"));for(var s=0;s<o.length;s++)a=this._createCell({column:o[s],rowType:"freeSpace",columnIndex:s,columns:o}),Fe(i)&&a.css("height",i),n.append(a);return this.setAria("role","presentation",n),n}getFixedColumns(){throw new Error("Method not implemented.")}_appendEmptyRow(e,t,i){var a=this._getBodies(e),n=!a.length||t.is("tbody"),o=n?e:a;if(i==="top"){if(o.first().prepend(t),n){var s=o.children("colgroup");o.prepend(s)}}else o.last().append(t)}_renderFreeSpaceRow(e,t){var i=this._createEmptyRow(Dr);i=this._wrapRowIfNeed(e,i,(t==null?void 0:t.changeType)==="refresh"),this._appendEmptyRow(e,i)}_checkRowKeys(e){var t=this,i=t._getRows(e),a=t._dataController.store()&&t._dataController.store().key();a&&i.some(n=>{if(n.rowType==="data"&&n.key===void 0)return t._dataController.fireError("E1046",a),!0})}_needUpdateRowHeight(e){return e>0&&!this._rowHeight}_getRowsHeight(e){e=e||this._tableElement;var t=e.children("tbody").children().not(".dx-virtual-row").not(".".concat(Dr));return t.toArray().reduce((i,a)=>i+Ee(a).height,0)}_updateRowHeight(){var e=this.getTableElement(),t=this._dataController.items().length;if(e&&this._needUpdateRowHeight(t)){var i=this._getRowsHeight(e);this._rowHeight=i/t}}_findContentElement(e){var t=this.element(),i=this.getScrollable();if(t)return i&&(t=m(i.content())),t.children().first()}_getRowElements(e){var t=super._getRowElements(e);return t&&t.not(".".concat(Dr))}_getFreeSpaceRowElements(e){var t=e||this.getTableElements();return t&&t.children("tbody").children(".".concat(Dr))}_getNoDataText(){return this.option("noDataText")}_rowClick(e){var t=this._dataController.items()[e.rowIndex]||{};this.executeAction("onRowClick",S({evaluate(i){var a=de(i);return a(t.data)}},e,t))}_rowDblClick(e){var t=this._dataController.items()[e.rowIndex]||{};this.executeAction("onRowDblClick",S({},e,t))}_getColumnsCountBeforeGroups(e){for(var t=0;t<e.length;t++)if(e[t].type==="groupExpand")return t;return 0}_getGroupCellOptions(e){var t=this._getColumnsCountBeforeGroups(e.columns),i=(e.row.groupIndex||0)+t;return{columnIndex:i,colspan:e.columns.length-i-1}}_needWrapRow(){return super._needWrapRow.apply(this,arguments)||!!this.option("dataRowTemplate")}_renderCells(e,t){t.row.rowType==="group"?this._renderGroupedCells(e,t):t.row.values&&super._renderCells(e,t)}_renderGroupedCells(e,t){for(var{row:i}=t,a,{columns:n}=t,{rowIndex:o}=i,s,l=this._getGroupCellOptions(t),d=0;d<=l.columnIndex;d++)d===l.columnIndex&&n[d].allowCollapsing&&t.scrollingMode!=="infinite"?(s=!!i.isExpanded,a=n[d]):(s=null,a={command:"expand",cssClass:n[d].cssClass}),this._needRenderCell(d,t.columnIndices)&&this._renderCell(e,{value:s,row:i,rowIndex:o,column:a,columnIndex:d,columnIndices:t.columnIndices,change:t.change});var u=Bt(this.option("rtlEnabled")),h=S({},n[l.columnIndex],{command:null,type:null,cssClass:null,width:null,showWhenGrouped:!1,alignment:u});l.colspan>1&&(h.colspan=l.colspan),this._needRenderCell(l.columnIndex+1,t.columnIndices)&&this._renderCell(e,{value:i.values[i.groupIndex],row:i,rowIndex:o,column:h,columnIndex:l.columnIndex+1,columnIndices:t.columnIndices,change:t.change})}_renderRows(e,t){var i=this.option("scrolling.mode");super._renderRows(e,S({scrollingMode:i},t)),this._checkRowKeys(t.change),this._renderFreeSpaceRow(e,t.change),this._hasHeight||this.updateFreeSpaceRowHeight(e)}_renderDataRowByTemplate(e,t,i){var{row:a}=t,n=S({columns:t.columns},a),o=this._createRow(a,"tbody");o.appendTo(e),this.renderTemplate(o,i,n,!0,t.change),this._rowPrepared(o,n,t.row)}_renderRow(e,t){var{row:i}=t,{rowTemplate:a}=this.option(),n=this.option("dataRowTemplate");i.rowType==="data"&&n?this._renderDataRowByTemplate(e,t,n):(i.rowType==="data"||i.rowType==="group")&&!_(i.groupIndex)&&a?this.renderTemplate(e,a,S({columns:t.columns},i),!0):super._renderRow(e,t)}_renderTable(e){var t=this,i=super._renderTable(e);return _(t.getTableElement())?t._renderScrollable():(t.setTableElement(i),t._renderScrollable(!0),t.resizeCompleted.add(function a(){var n=t.getScrollable();n&&t.element().closest(ne().document).length&&(t.resizeCompleted.remove(a),n._visibilityChanged(!0))})),i}_createTable(){var e=super._createTable.apply(this,arguments);return(this.option().rowTemplate||this.option().dataRowTemplate)&&e.appendTo(this.component.$element()),e}_renderCore(e){var t=this.element();t.addClass(this.addWidgetPrefix(Tp)).toggleClass(this.addWidgetPrefix(Op),!this.option("wordWrapEnabled")),t.toggleClass(Vp,this._dataController.isEmpty()),this.setAria("role","presentation",t);var i=this._renderTable({change:e}),a=this._updateContent(i,e);return super._renderCore(e),this._lastColumnWidths=null,a}_getRows(e){return e&&e.items||this._dataController.items()}_getCellOptions(e){var{column:t}=e,{row:i}=e,{data:a}=i,n=i&&i.summaryCells,{value:o}=e,s=I.getDisplayValue(t,o,a,i.rowType),l=super._getCellOptions(e);if(l.value=o,l.oldValue=e.oldValue,l.displayValue=s,l.row=i,l.key=i.key,l.data=a,l.rowType=i.rowType,l.values=i.values,l.text=t.command?"":I.formatValue(s,t),l.rowIndex=i.rowIndex,l.summaryItems=n&&n[e.columnIndex],l.resized=t.resizedCallbacks,_(t.groupIndex)&&!t.command){var d=this.option("grouping.texts"),u=this.option("scrolling.mode");u!=="virtual"&&u!=="infinite"&&(l.groupContinuesMessage=a&&a.isContinuationOnNextPage&&d&&d.groupContinuesMessage,l.groupContinuedMessage=a&&a.isContinuation&&d&&d.groupContinuedMessage)}return l}_setRowsOpacityCore(e,t,i,a){var n=this._columnsController,o=n.getColumns(),s=o&&o[i],l=s&&s.isBand&&s.index;T(e,(d,u)=>{if(!m(u).hasClass(qi))for(var h=0;h<t.length&&!((Fe(l)&&n.isParentBandColumn(t[h].index,l)||t[h].index===i)&&(e.eq(d).children().eq(h).css({opacity:a}),!Fe(l)));h++);})}_getDevicePixelRatio(){return ne().devicePixelRatio}renderNoDataText(){return I.renderNoDataText.apply(this,arguments)}getCellOptions(e,t){var i=this._dataController.items()[e],a,n;return i&&(G(t)?n=this._columnsController.columnOption(t):n=this._columnsController.getVisibleColumns()[t],n&&(a=this._getCellOptions({value:n.calculateCellValue(i.data),rowIndex:i.rowIndex,row:i,column:n}))),a}getRow(e){if(e>=0){var t=this._getRowElements();if(t.length>e)return m(t[e])}}updateFreeSpaceRowHeight(e){var t=this._dataController,i=t.items(!0).length,a=this._findContentElement(),n=this._getFreeSpaceRowElements(e);if(n&&a&&t.totalCount()>=0){var o=!1;if(i>0)if(this._hasHeight)n.hide(),xe(()=>{var d=this.getScrollbarWidth(!0),u=J(this.element())-d,h=le(a),c=u-h>0,p=this._getRowsHeight(a.children().first()),g=e||this.getTableElements(),v=Math.ceil(parseFloat(g.css("borderTopWidth"))),f=this._getHeightCorrection(),C=u-p-v-f;c&&fe(()=>{n.css("height",C),o=!0,n.show()}),fe(()=>this._updateLastRowBorder(o))});else{var s=t.pageSize()-i,l=this.option("scrolling.mode");s>0&&t.pageCount()>1&&l!=="virtual"&&l!=="infinite"&&(Ai(n,s*this._rowHeight),o=!0),!o&&e?Ai(n,0):n.toggle(o),this._updateLastRowBorder(o)}else n.css("height",0),n.show(),this._updateLastRowBorder(!0)}}_getHeightCorrection(){var e=te.webkit&&this._getDevicePixelRatio()>=2,t=te.chrome&&te.version>=91,i=te.mozilla&&te.version>=70&&!this.option("showRowLines");return e||i||t?1:0}_columnOptionChanged(e){var{optionNames:t}=e;e.changeTypes.grouping||(t.width||t.visibleWidth)&&(super._columnOptionChanged(e),this._fireColumnResizedCallbacks())}getScrollable(){return this._scrollable}init(){var e=this,t=e.getController("data");super.init(),e._editorFactoryController=e.getController("editorFactory"),e._rowHeight=0,e._scrollTop=0,e._scrollLeft=-1,e._scrollRight=0,e._hasHeight=!1,e._contentChanges=[],t.loadingChanged.add((i,a)=>{e.setLoading(i,a)}),t.dataSourceChanged.add(()=>{this._scrollLeft>=0&&!this._dataController.isLoading()&&this._handleScroll({component:this.getScrollable(),forceUpdateScrollPosition:!0,scrollOffset:{top:this._scrollTop,left:this._scrollLeft}})})}_handleDataChanged(e){switch(e.changeType){case"refresh":case"prepend":case"append":case"update":this.render(null,e);break;default:this._update(e)}}publicMethods(){return["isScrollbarVisible","getTopVisibleRowData","getScrollbarWidth","getCellElement","getRowElement","getScrollable"]}contentWidth(){return X(this.element())-this.getScrollbarWidth()}getScrollbarWidth(e){var t=this._scrollableContainer&&this._scrollableContainer.get(0),i=0;return t&&(e?(i=t.clientHeight?t.offsetHeight-t.clientHeight:0,i+=Lp(this)):i=t.clientWidth?t.offsetWidth-t.clientWidth:0),i>0?i:0}_fireColumnResizedCallbacks(){for(var e=this._lastColumnWidths||[],t=[],i=this.getColumns(),a=0;a<i.length;a++)t[a]=i[a].visibleWidth,i[a].resizedCallbacks&&!_(i[a].groupIndex)&&e[a]!==t[a]&&i[a].resizedCallbacks.fire(t[a]);this._lastColumnWidths=t}_updateLastRowBorder(e){this.option("showBorders")&&this.option("showRowLines")&&!e?this.element().addClass(Co):this.element().removeClass(Co)}_updateScrollable(){var e=Rt.getInstance(this.element());e&&(e.update(),(e.option("useNative")||!(e!=null&&e.isRenovated()))&&this._updateHorizontalScrollPosition())}_updateHorizontalScrollPosition(){var e=this.getScrollable(),t=e&&e.scrollOffset().left,i=this.option("rtlEnabled");if(i){var a=wo(e),n=a-t;n!==this._scrollRight&&(this._scrollLeft=a-this._scrollRight)}this._scrollLeft>=0&&t!==this._scrollLeft&&e.scrollTo({x:this._scrollLeft})}_resizeCore(){var e=this;e._fireColumnResizedCallbacks(),e._updateRowHeight(),fe(()=>{e._renderScrollable(),e.renderNoDataText(),e.updateFreeSpaceRowHeight(),xe(()=>{e._updateScrollable()})})}scrollTo(e){var t=this.element(),i=t&&Rt.getInstance(t);i&&i.scrollTo(e)}height(e){var t=this.element();if(arguments.length===0)return t?le(t,!0):0;_(e)&&t&&(this.hasHeight(e!=="auto"),Ai(t,e))}hasHeight(e){if(arguments.length===0)return!!this._hasHeight;this._hasHeight=e}setLoading(e,t){var i=this._loadPanel,a=this._dataController,n=this.option("loadPanel")||{},o=a.isLoaded()?n.animation:null,s=this.element();if(ht()&&(!i&&t!==void 0&&a.isLocalStore()&&n.enabled==="auto"&&s&&(this._renderLoadPanel(s,s.parent()),i=this._loadPanel),i)){var l={message:t||n.text,animation:o,visible:e};e&&(l.position=I.calculateLoadPanelPosition(s)),clearTimeout(this._hideLoadingTimeoutID),i.option("visible")&&!e?this._hideLoadingTimeoutID=setTimeout(()=>{i.option(l)},Pp):i.option(l)}}setRowsOpacity(e,t){var i=this._getRowElements().not(".".concat(qi))||[];this._setRowsOpacityCore(i,this.getColumns(),e,t)}_getCellElementsCore(e){var t=super._getCellElementsCore.apply(this,arguments);if(t){var i=t.filter(".".concat(fo)).index();if(i>=0&&t.length>i+1)return t.slice(0,i+1)}return t}_getBoundaryVisibleItemIndex(e,t){var i=0,a=0,n=0,o=this._scrollTop,s=this._findContentElement(),l=s&&s.offset().top,d=this.getController("data"),u=d.items(),h=this.getTableElement();if(u.length&&h){var c=this._getRowElements(h).filter(":visible");if(!e){var p=le(this._hasHeight?this.element():ne());o+=p}for(i=0;i<u.length;i++){a=n;var g=m(c).eq(i);if(g.length&&(n=g.offset(),n=(e?n.top:n.top+le(g))-l,n>o)){i&&(t||2*o<Math.round(n+a))&&i--;break}}i&&i===u.length&&i--}return i}getTopVisibleItemIndex(e){return this._getBoundaryVisibleItemIndex(!0,e)}getBottomVisibleItemIndex(e){return this._getBoundaryVisibleItemIndex(!1,e)}getTopVisibleRowData(){var e=this.getTopVisibleItemIndex(),t=this._dataController.items();if(t[e])return t[e].data}_scrollToElement(e,t){var i=this.getScrollable();i&&i.scrollToElement(e,t)}optionChanged(e){switch(super.optionChanged(e),e.name){case"wordWrapEnabled":case"showColumnLines":case"showRowLines":case"rowAlternationEnabled":case"rowTemplate":case"dataRowTemplate":case"twoWayBindingEnabled":this._invalidate(!0,!0),e.handled=!0;break;case"scrolling":this._rowHeight=null,this._tableElement=null,e.handled=!0;break;case"rtlEnabled":this._rowHeight=null,this._tableElement=null;break;case"loadPanel":this._tableElement=null,this._invalidate(!0,e.fullName!=="loadPanel.enabled"),e.handled=!0;break;case"noDataText":this.renderNoDataText(),e.handled=!0}}dispose(){super.dispose(),clearTimeout(this._hideLoadingTimeoutID),this._scrollable&&this._scrollable.dispose()}setScrollerSpacing(){}_restoreErrorRow(){}}var Ql={defaultOptions:()=>({hoverStateEnabled:!1,scrolling:{useNative:"auto"},loadPanel:{enabled:"auto",text:y.format("Loading"),width:200,height:90,showIndicator:!0,indicatorSrc:"",showPane:!0},dataRowTemplate:null,columnAutoWidth:!1,noDataText:y.format("dxDataGrid-noDataText"),wordWrapEnabled:!1,showColumnLines:!0,showRowLines:!1,rowAlternationEnabled:!1,activeStateEnabled:!1,twoWayBindingEnabled:!0}),views:{rowsView:kp}};Ql.views.rowsView;A.registerModule("rows",Ql);var Mp="dx-context-menu",Np={columnHeadersView:"header",rowsView:"content",footerView:"footer",headerPanel:"headerPanel"},zp=["columnHeadersView","rowsView","footerView","headerPanel"],Hp=W.ViewController.inherit({init(){this.createAction("onContextMenuPreparing")},getContextMenuItems(r){if(!r)return!1;var e=this,t=m(r.target),i,a,n,o;return T(zp,function(){var s,l,d=e.getView(this);if(i=d&&d.element(),i&&(i.is(t)||i.find(t).length)){n=t.closest(".dx-row > td, .dx-row > tr"),a=n.parent();var u=d.getRowIndex(a),h=n[0]&&n[0].cellIndex,c=a.data("options"),p={event:r,targetElement:be(t),target:Np[this],rowIndex:u,row:d._getRows()[u],columnIndex:h,column:(l=(s=c==null?void 0:c.cells)===null||s===void 0?void 0:s[h])===null||l===void 0?void 0:l.column};if(p.items=d.getContextMenuItems&&d.getContextMenuItems(p),e.executeAction("onContextMenuPreparing",p),e._contextMenuPrepared(p),o=p.items,o)return!1}}),o},_contextMenuPrepared:me}),Wp=W.View.inherit({_renderCore(){var r=this,e=r.element().addClass(Mp);this.setAria("role","presentation",e),this._createComponent(e,fh,{onPositioning(t){var{event:i}=t,a=t.component,n=r.getController("contextMenu").getContextMenuItems(i);n?(a.option("items",n),i.stopPropagation()):t.cancel=!0},onItemClick(t){t.itemData.onItemClick&&t.itemData.onItemClick(t)},cssClass:r.getWidgetContainerClass(),target:r.component.$element()})}}),Gp={defaultOptions:()=>({onContextMenuPreparing:null}),controllers:{contextMenu:Hp},views:{contextMenuView:Wp}};A.registerModule("contextMenu",Gp);var Gt="dx-error-row",yo="dx-error-message",Kp="dx-closebutton",Up="action",$p=W.ViewController.inherit({init(){this._columnHeadersView=this.getView("columnHeadersView"),this._rowsView=this.getView("rowsView")},_createErrorRow(r,e){var t=this,i,a,n=this._renderErrorMessage(r);return e?(i=m("<tr>").addClass(Gt),a=m("<div>").addClass(Kp).addClass(t.addWidgetPrefix(Up)),b.on(a,re,t.createAction(o=>{var s=o.event,l,d=m(s.currentTarget).closest(".".concat(Gt)).index();s.stopPropagation(),T(e,(u,h)=>{l=m(h).children("tbody").children("tr").eq(d),t.removeErrorRow(l)}),t.getController("resizing")&&t.getController("resizing").fireContentReadyAction()})),m("<td>").attr({colSpan:t.getController("columns").getVisibleColumns().length,role:"presentation"}).prepend(a).append(n).appendTo(i),i):n},_renderErrorMessage(r){var e=r.url?r.message.replace(r.url,""):r.message||r,t=m("<div>").addClass(yo).text(e);return r.url&&m("<a>").attr("href",r.url).text(r.url).appendTo(t),t},renderErrorRow(r,e,t){var i=this,a,n;if(t)return t.find(".".concat(yo)).remove(),a=i._createErrorRow(r),t.prepend(a),a;var o=e>=0||!i._columnHeadersView.isVisible()?i._rowsView:i._columnHeadersView,s=o.getTableElements();T(s,(d,u)=>{if(a=i._createErrorRow(r,s),n=n||a,e>=0){var h=o._getRowElements(m(u)).eq(e);i.removeErrorRow(h.next()),a.insertAfter(h)}else{var c=m(u).children("tbody"),p=c.children("tr");i._columnHeadersView.isVisible()?(i.removeErrorRow(p.last()),m(u).append(a)):(i.removeErrorRow(p.first()),c.first().prepend(a))}});var l=i.getController("resizing");return l&&l.fireContentReadyAction(),n},removeErrorRow(r){if(!r){var e=this._columnHeadersView&&this._columnHeadersView.element();if(r=e&&e.find(".".concat(Gt)),!r||!r.length){var t=this._rowsView.element();r=t&&t.find(".".concat(Gt))}}r&&r.hasClass(Gt)&&r.remove()},optionChanged(r){switch(r.name){case"errorRowEnabled":r.handled=!0;break;default:this.callBase(r)}}}),qp={defaultOptions:()=>({errorRowEnabled:!0}),controllers:{errorHandling:$p},extenders:{controllers:{data:{init(){var r=this,e=r.getController("errorHandling");r.callBase(),r.dataErrorOccurred.add((t,i)=>{r.option("errorRowEnabled")&&e.renderErrorRow(t,void 0,i)}),r.changed.add(t=>{if(!(t&&t.changeType==="loadError")){var i=r.getController("errorHandling"),a=r.getController("editing");a&&!a.hasChanges()&&i&&i.removeErrorRow()}})}}}}};A.registerModule("errorHandling",qp);var Eo="borders",Xp="table-fixed",jp="important-margin",Jl="dx-gridbase-container",Yp="tr.dx-group-row",Vr="adaptiveHidden",dn=["columnsSeparatorView","blockSeparatorView","trackerView","headerPanel","columnHeadersView","rowsView","footerView","columnChooserView","filterPanelView","pagerView","draggingHeaderView","contextMenuView","errorView","headerFilterView","filterBuilderView"],Kt=function(r){return G(r)&&r.endsWith("%")},Qp=function(r){return G(r)&&r.endsWith("px")},Zl=function(r,e){var t=r._rowsView.contentWidth(),i=r._getTotalWidth(e,t);return t-i},Jp=function(r,e,t,i){return Zl(r,i.map((a,n)=>n===e?t:a))},Zp=function(r,e){zh(r,!0),I.setSelectionRange(r,e)},eg={_initPostRenderHandlers(){this._refreshSizesHandler||(this._refreshSizesHandler=r=>{var e=new O().resolve(null),t=r==null?void 0:r.changeType,i=r==null?void 0:r.isDelayed,a=t&&t!=="updateSelection"&&t!=="updateFocusedRow"&&t!=="pageIndex"&&!i;this._dataController.changed.remove(this._refreshSizesHandler),this._checkSize()&&(e=this._refreshSizes(r)),a&&P(e).done(()=>{this._setAriaLabel(),this.fireContentReadyAction()})},this._dataController.changed.add(()=>{this._dataController.changed.add(this._refreshSizesHandler)}))},_refreshSizes(r){var e,t=new O().resolve(null),i=r==null?void 0:r.changeType,a=r==null?void 0:r.isDelayed,n=this._dataController.items();if(!r||i==="refresh"||i==="prepend"||i==="append")a||(t=this.resize());else if(i==="update"){if(((e=r.changeTypes)===null||e===void 0?void 0:e.length)===0)return t;(n.length>1||r.changeTypes[0]!=="insert")&&!(n.length===0&&r.changeTypes[0]==="remove")&&!r.needUpdateDimensions?(t=new O,this._waitAsyncTemplates().done(()=>{xe(()=>fe(()=>xe(()=>{this._setScrollerSpacing(),this._rowsView.resize(),t.resolve()})))}).fail(t.reject)):t=this.resize()}return t},fireContentReadyAction(){this.component._fireContentReadyAction()},_getWidgetAriaLabel:()=>"dxDataGrid-ariaDataGrid",_setAriaLabel(){var r=Math.max(0,this._dataController.totalItemsCount());this.component.setAria("label",y.format(this._getWidgetAriaLabel(),r,this.component.columnCount()),this.component.$element().children(".".concat(Jl)))},_getBestFitWidths(){var r,e=this._rowsView,t=this._columnHeadersView,i=e.getColumnWidths();if(!(i!=null&&i.length)){var a=t.getTableElement();t.setTableElement((r=e.getTableElement())===null||r===void 0?void 0:r.children(".dx-header")),i=t.getColumnWidths(),t.setTableElement(a)}return i},_setVisibleWidths(r,e){var t=this._columnsController;t.beginUpdate(),T(r,(i,a)=>{var n=t.getColumnId(a);t.columnOption(n,"visibleWidth",e[i])}),t.endUpdate()},_toggleBestFitModeForView(r,e,t){if(!(!r||!r.isVisible())){var i=this._rowsView.getTableElements(),a=r.getTableElements();T(i,(n,o)=>{var s,l=m(o),d=a.eq(n);d&&d.length&&(t?s=d.children("tbody").appendTo(l):s=l.children(".".concat(e)).appendTo(d),s.toggleClass(e,t),s.toggleClass(this.addWidgetPrefix("best-fit"),t))})}},_toggleBestFitMode(r){var e=this._rowsView.getTableElement(),t=this._rowsView.getTableElements().eq(1);e&&(e.css("tableLayout",r?"auto":"fixed"),e.children("colgroup").css("display",r?"none":""),T(t.find(Yp),(i,a)=>{m(a).css("display",r?"none":"")}),t.toggleClass(this.addWidgetPrefix(Xp),!r),this._toggleBestFitModeForView(this._columnHeadersView,"dx-header",r),this._toggleBestFitModeForView(this._footerView,"dx-footer",r),this._needStretch()&&(e.get(0).style.width=r?"auto":""))},_toggleContentMinHeight(r){var e=this._rowsView.getScrollable(),t=this._rowsView._findContentElement();(e==null?void 0:e.option("useNative"))===!1&&t.css({minHeight:r?I.getContentHeightLimit(te):""})},_synchronizeColumns(){var r=this._columnsController,e=r.getVisibleColumns(),t=this.option("columnAutoWidth"),i=this.option("wordWrapEnabled"),a=e.some(p=>!_(p.width)),n=this._needBestFit(),o=!1,s,l=!1,d=[],u,h;!n&&T(e,(p,g)=>{if(g.width==="auto")return n=!0,!1}),T(e,(p,g)=>{if(g.minWidth)return o=!0,!1}),this._setVisibleWidths(e,[]);var c=this.component.$element();n&&(u=z.getActiveElement(c.get(0)),h=I.getSelectionRange(u),this._toggleBestFitMode(!0),s=!0),this._toggleContentMinHeight(i),c&&c.get(0)&&this._maxWidth&&(delete this._maxWidth,c[0].style.maxWidth=""),xe(()=>{if(n?(d=this._getBestFitWidths(),T(e,(g,v)=>{var f=r.getColumnId(v);r.columnOption(f,"bestFitWidth",d[g],!0)})):o&&(d=this._getBestFitWidths()),T(e,function(g){var{width:v}=this;v!=="auto"&&(_(v)?d[g]=Fe(v)||Qp(v)?parseFloat(v):v:t||(d[g]=void 0))}),s&&(this._toggleBestFitMode(!1),s=!1,u&&u!==z.getActiveElement())){var p=Ee(u).bottom<0;p||Zp(u,h)}l=this._correctColumnWidths(d,e),t&&(function(){var g;T(e,(v,f)=>{f.type==="groupExpand"&&(g=d[v])}),T(e,(v,f)=>{f.type==="groupExpand"&&g&&(d[v]=g)})}(),this._needStretch()&&this._processStretch(d,e)),fe(()=>{(n||l||a)&&this._setVisibleWidths(e,d),i&&this._toggleContentMinHeight(!1)})})},_needBestFit(){return this.option("columnAutoWidth")},_needStretch(){return this._columnsController.getVisibleColumns().some(r=>r.width==="auto"&&!r.command)},_getAverageColumnsWidth(r){var e=Zl(this,r),t=r.filter(i=>i===void 0).length;return e/t},_correctColumnWidths(r,e){var t=this,i,a=!1,n=!1,o=!1,s=t.component.$element(),l=t._hasWidth,d=function(){var f=i,C=e[f],w=r[f]===Vr,x=r[f],{minWidth:E}=C;if(E){if(x===void 0){var R=t._getAverageColumnsWidth(r);x=R}else if(Kt(x)){var D=Jp(t,f,E,r);D<0&&(x=-1)}}var V=t._getRealColumnWidth(f,r.map((F,B)=>f===B?x:F));E&&!w&&V<E&&(r[f]=E,o=!0,i=-1),_(C.width)||(n=!0),Kt(C.width)&&(a=!0)};for(i=0;i<e.length;i++)d();if(!n&&r.length){var u=t._rowsView.element(),h=t._rowsView.contentWidth(),c=t._rowsView.getScrollbarWidth(),p=t._getTotalWidth(r,h);if(p<h){var g=I.getLastResizableColumnIndex(e,r);if(g>=0&&(r[g]="auto",o=!0,l===!1&&!a)){var v=t.option("showBorders")?Math.ceil(Te(u)-Nu(u)):0;t._maxWidth=p+c+v,s.css("maxWidth",t._maxWidth)}}}return o},_processStretch(r,e){var t=this._rowsView.contentWidth(),i=this._getTotalWidth(r,t),a={length:0};if(r.length){T(e,function(d){(this.width||r[d]===Vr)&&(a[d]=!0,a.length++)});var n=t-i,o=Math.floor(n/(r.length-a.length)),s=n-o*(r.length-a.length);if(n>=0)for(var l=0;l<r.length;l++)a[l]||(r[l]+=o,s>0&&(s<1?(r[l]+=s,s=0):(r[l]++,s--)))}},_getRealColumnWidth(r,e,t){var i=1,a=e[r];if(!Kt(a))return parseFloat(a);var n=e.reduce((d,u,h)=>Kt(u)?d+parseFloat(u):d,0),o=e.reduce((d,u)=>!u||u===Vr||Kt(u)?d:d+parseFloat(u),0);t=t||this._rowsView.contentWidth();var s=t-o,l=n*t/100;return o>0&&l+o>=t&&(i=l>s?s/l:1),parseFloat(a)*t*i/100},_getTotalWidth(r,e){for(var t=0,i=0;i<r.length;i++){var a=r[i];a&&a!==Vr&&(t+=this._getRealColumnWidth(i,r,e))}return Math.ceil(t)},_getGroupElement(){return this.component.$element().children().get(0)},updateSize(r){var e=m(r),t=this.addWidgetPrefix(jp);if(this._hasHeight===void 0&&e&&e.is(":visible")&&X(e)){var i=e.children(".".concat(this.getWidgetContainerClass()));i.length&&i.detach(),this._hasHeight=!!J(e);var a=X(e);e.addClass(t),this._hasWidth=X(e)===a,e.removeClass(t),i.length&&i.appendTo(e)}},publicMethods:()=>["resize","updateDimensions"],_waitAsyncTemplates(){var r,e,t;return P((r=this._columnHeadersView)===null||r===void 0?void 0:r.waitAsyncTemplates(!0),(e=this._rowsView)===null||e===void 0?void 0:e.waitAsyncTemplates(!0),(t=this._footerView)===null||t===void 0?void 0:t.waitAsyncTemplates(!0))},resize(){if(!this.component._requireResize){var r=new O;return this._waitAsyncTemplates().done(()=>{P(this.updateDimensions()).done(r.resolve).fail(r.reject)}).fail(r.reject),r.promise()}},updateDimensions(r){var e=this;if(e._initPostRenderHandlers(),!!e._checkSize(r)){var t=e._resizeDeferred,i=e._resizeDeferred=new O;return P(t).always(()=>{fe(()=>{e._dataController.isLoaded()&&e._synchronizeColumns(),e._resetGroupElementHeight(),xe(()=>{fe(()=>{xe(()=>{e._updateDimensionsCore()})})})}).done(i.resolve).fail(i.reject)}),i.promise()}},_resetGroupElementHeight(){var r=this._getGroupElement(),e=this._rowsView.getScrollable();r&&r.style.height&&(!e||!e.scrollTop())&&(r.style.height="")},_checkSize(r){var e=this.component.$element(),t=e.is(":visible"),i=this._lastWidth!==X(e)||this._lastHeight!==J(e)||this._devicePixelRatio!==ne().devicePixelRatio;return t&&(!r||i)},_setScrollerSpacingCore(){var r=this,e=r._rowsView.getScrollbarWidth(),t=r._rowsView.getScrollbarWidth(!0);fe(()=>{r._columnHeadersView&&r._columnHeadersView.setScrollerSpacing(e),r._footerView&&r._footerView.setScrollerSpacing(e),r._rowsView.setScrollerSpacing(e,t)})},_setScrollerSpacing(){var r=this._rowsView.getScrollable(),e=this.option("scrolling.useNative")===!0;!r||e?fe(()=>{xe(()=>{this._setScrollerSpacingCore()})}):this._setScrollerSpacingCore()},_updateDimensionsCore(){var r=this,e=r._dataController,t=r.getController("editorFactory"),i=r._rowsView,a=r.component.$element(),n=this._getGroupElement(),o=J(a),s=r.option("height")||a.get(0).style.height,l=!!s&&s!=="auto",d=parseInt(a.css("maxHeight")),u=d&&o>=d,h=n&&n.scrollHeight===n.offsetHeight;r.updateSize(a),fe(()=>{var c=r._hasHeight||!!d||l;if(i.hasHeight(c),u&&!h&&m(n).css("height",d),!e.isLoaded()){i.setLoading(e.isLoading());return}xe(()=>{r._updateLastSizes(a),r._setScrollerSpacing(),T(dn,(p,g)=>{var v=r.getView(g);v&&v.resize()}),t&&t.resize()})})},_updateLastSizes(r){this._lastWidth=X(r),this._lastHeight=J(r),this._devicePixelRatio=ne().devicePixelRatio},optionChanged(r){switch(r.name){case"width":case"height":this.component._renderDimensions(),this.resize();case"renderAsync":r.handled=!0;return;default:this.callBase(r)}},init(){this._dataController=this.getController("data"),this._columnsController=this.getController("columns"),this._columnHeadersView=this.getView("columnHeadersView"),this._footerView=this.getView("footerView"),this._rowsView=this.getView("rowsView")}},tg=W.ViewController.inherit(eg),rg=W.ViewController.inherit({_scrollChangedHandler(r,e,t){for(var i=0;i<r.length;i++)r[i]&&r[i].name!==t&&r[i].scrollTo({left:e.left,top:e.top})},init(){for(var r=[this.getView("columnHeadersView"),this.getView("footerView"),this.getView("rowsView")],e=0;e<r.length;e++){var t=r[e];t&&t.scrollChanged.add(this._scrollChangedHandler.bind(this,r))}}}),ig=W.View.inherit({_endUpdateCore(){this.component._requireResize&&(this.component._requireResize=!1,this._resizingController.resize())},init(){this._resizingController=this.getController("resizing"),this._dataController=this.getController("data")},getView(r){return this.component._views[r]},element(){return this._groupElement},optionChanged(r){_(this._groupElement)&&r.name==="showBorders"?(this._groupElement.toggleClass(this.addWidgetPrefix(Eo),!!r.value),r.handled=!0):this.callBase(r)},_renderViews(r){var e=this;T(dn,(t,i)=>{var a=e.getView(i);a&&a.render(r)})},_getTableRoleName:()=>"group",render(r){var e=!this._groupElement,t=this._groupElement||m("<div>").addClass(this.getWidgetContainerClass());t.addClass(Jl),t.toggleClass(this.addWidgetPrefix(Eo),!!this.option("showBorders")),this.setAria("role","presentation",r),this.component.setAria("role",this._getTableRoleName(),t),this._rootElement=r||this._rootElement,e&&(this._groupElement=t,ht()&&this.getController("resizing").updateSize(r),t.appendTo(r)),this._renderViews(t)},update(){var r=this._rootElement,e=this._groupElement,t=this.getController("resizing");r&&e&&(t.resize(),this._dataController.isLoaded()&&this._resizingController.fireContentReadyAction())}}),ag={defaultOptions:()=>({showBorders:!1,renderAsync:!1}),controllers:{resizing:tg,synchronizeScrolling:rg},views:{gridView:ig},VIEW_NAMES:dn};A.registerModule("gridView",ag);var ng="header-panel",So="toolbar-button",og="-ariaToolbar",bo=["addRowButton","applyFilterButton","columnChooserButton","exportButton","groupPanel","revertButton","saveButton","searchPanel"];class sg extends br{_getToolbarItems(){return[]}_getButtonContainer(){return m("<div>").addClass(this.addWidgetPrefix(So))}_getToolbarButtonClass(e){var t=e?" ".concat(e):"";return this.addWidgetPrefix(So)+t}_getToolbarOptions(){var e=this.option("toolbar"),t={toolbarOptions:{items:this._getToolbarItems(),visible:e==null?void 0:e.visible,disabled:e==null?void 0:e.disabled,onItemRendered(n){var o=n.itemData.onItemRendered;o&&o(n)}}},i=e==null?void 0:e.items;if(t.toolbarOptions.items=this._normalizeToolbarItems(t.toolbarOptions.items,i),this.executeAction("onToolbarPreparing",t),t.toolbarOptions&&!_(t.toolbarOptions.visible)){var a=t.toolbarOptions.items;t.toolbarOptions.visible=!!(a!=null&&a.length)}return t.toolbarOptions}_normalizeToolbarItems(e,t){e.forEach(s=>{if(!bo.includes(s.name))throw new Error("Default toolbar item '".concat(s.name,"' is not added to DEFAULT_TOOLBAR_ITEM_NAMES"))});var i={location:"after"},a=Array.isArray(t);if(!_(t))return e;a||(t=[t]);var n={};e.forEach(s=>{n[s.name]=s});var o=t.map(s=>(G(s)&&(s={name:s}),_(s.name)&&(_(n[s.name])?s=S(!0,{},n[s.name],s):bo.includes(s.name)&&(s=L(L({},s),{visible:!1}))),S(!0,{},i,s)));return a?o:o[0]}_renderCore(){if(this._toolbar)this._toolbar.option(this._toolbarOptions);else{var e=this.element();e.addClass(this.addWidgetPrefix(ng));var t=y.format(this.component.NAME+og),i=m("<div>").attr("aria-label",t).appendTo(e);this._toolbar=this._createComponent(i,_h,this._toolbarOptions)}}_columnOptionChanged(){}_handleDataChanged(){this._requireReady&&this.render()}_isDisabledDefinedByUser(e){var t,i=(t=this.option("toolbar"))===null||t===void 0?void 0:t.items,a=i==null?void 0:i.find(n=>(n==null?void 0:n.name)===e);return _(a==null?void 0:a.disabled)}init(){super.init(),this.createAction("onToolbarPreparing",{excludeValidators:["disabled","readOnly"]})}render(){this._toolbarOptions=this._getToolbarOptions(),super.render.apply(this,arguments)}setToolbarItemDisabled(e,t){var i,a=this._toolbar,n=this._isDisabledDefinedByUser(e);if(!(!a||n)){var o=(i=a.option("items"))!==null&&i!==void 0?i:[],s=o.findIndex(d=>d.name===e);if(!(s<0)){var l=a.option("items[".concat(s,"]"));a.option("items[".concat(s,"].disabled"),t),l.options&&a.option("items[".concat(s,"].options.disabled"),t)}}}updateToolbarDimensions(){var e;(e=this._toolbar)===null||e===void 0||e.updateDimensions()}getHeaderPanel(){return this.element()}getHeight(){return this.getElementHeight()}optionChanged(e){if(e.name==="onToolbarPreparing"&&(this._invalidate(),e.handled=!0),e.name==="toolbar"&&(e.handled=!0,this._toolbar)){var t=th(e.fullName),i=e.fullName.replace(/^toolbar\./,"");if(t.length===1){var a=this._getToolbarOptions();this._toolbar.option(a)}else if(t[1]==="items")if(t.length===2){var n=this._getToolbarOptions();this._toolbar.option("items",n.items)}else if(t.length===3){var o=this._normalizeToolbarItems(this._getToolbarItems(),e.value);this._toolbar.option(i,o)}else t.length>=4&&this._toolbar.option(i,e.value);else this._toolbar.option(i,e.value)}super.optionChanged(e)}isVisible(){return!!(this._toolbarOptions&&this._toolbarOptions.visible)}allowDragging(){}hasGroupedColumns(){}}var ed={defaultOptions:()=>({}),views:{headerPanel:sg},extenders:{controllers:{resizing:{_updateDimensionsCore(){this.callBase.apply(this,arguments),this.getView("headerPanel").updateToolbarDimensions()}}}}};ed.views.headerPanel;A.registerModule("headerPanel",ed);var lg=".dx-row",dg="Specifying grid templates with the jQuery selector name is now deprecated. Use the DOM Node or the jQuery object that references this selector instead.";A.registerModulesOrder(["stateStoring","columns","selection","editorFactory","columnChooser","grouping","editing","editingRowBased","editingFormBased","editingCellBased","masterDetail","validating","adaptivity","data","virtualScrolling","columnHeaders","filterRow","headerPanel","headerFilter","sorting","search","rows","pager","columnsResizingReordering","contextMenu","keyboardNavigation","errorHandling","summary","columnFixing","export","gridView"]);var td=dr.inherit({_activeStateUnit:lg,_getDefaultOptions(){var r=this.callBase();return T(A.modules,function(){H(this.defaultOptions)&&S(!0,r,this.defaultOptions())}),r},_setDeprecatedOptions(){this.callBase(),S(this._deprecatedOptions,{useKeyboard:{since:"19.2",alias:"keyboardNavigation.enabled"},rowTemplate:{since:"21.2",message:'Use the "dataRowTemplate" option instead'},"columnChooser.allowSearch":{since:"23.1",message:'Use the "columnChooser.search.enabled" option instead'},"columnChooser.searchTimeout":{since:"23.1",message:'Use the "columnChooser.search.timeout" option instead'}})},_defaultOptionsRules(){return this.callBase().concat([{device:{platform:"ios"},options:{showRowLines:!0}},{device:()=>wi(),options:{showRowLines:!0,showColumnLines:!1,headerFilter:{height:315},editing:{useIcons:!0},selection:{showCheckBoxesMode:"always"}}},{device:()=>te.webkit,options:{loadingTimeout:30,loadPanel:{animation:{show:{easing:"cubic-bezier(1, 0, 1, 0)",duration:500,from:{opacity:0},to:{opacity:1}}}}}},{device:r=>r.deviceType!=="desktop",options:{grouping:{expandMode:"rowClick"}}}])},_init(){this.callBase(),I.logHeaderFilterDeprecatedWarningIfNeed(this),A.processModules(this,A),A.callModuleItemsMethod(this,"init")},_clean:me,_optionChanged(r){A.callModuleItemsMethod(this,"optionChanged",[r]),r.handled||this.callBase(r)},_dimensionChanged(){this.updateDimensions(!0)},_visibilityChanged(r){r&&this.updateDimensions()},_initMarkup(){this.callBase.apply(this,arguments),this.getView("gridView").render(this.$element())},_renderContentImpl(){this.getView("gridView").update()},_renderContent(){var r=this;fe(()=>{r._renderContentImpl()})},_getTemplate(r){var e=r;return G(e)&&e.startsWith("#")&&(e=m(r),rh.warn(dg)),this.callBase(e)},_dispose(){this.callBase(),A.callModuleItemsMethod(this,"dispose")},isReady(){return this.getController("data").isReady()},beginUpdate(){this.callBase(),A.callModuleItemsMethod(this,"beginUpdate")},endUpdate(){A.callModuleItemsMethod(this,"endUpdate"),this.callBase()},getController(r){return this._controllers[r]},getView(r){return this._views[r]},focus(r){this.getController("keyboardNavigation").focus(r)}});td.registerModule=A.registerModule.bind(A);_r("dxDataGrid",td);var ug=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/,hg=function r(e){e&&T(e,(t,i)=>{if(He(i)||Array.isArray(i))r(i);else if(typeof i=="string"){var a=ug.exec(i);a&&(e[t]=new Date(Date.UTC(+a[1],+a[2]-1,+a[3],+a[4],+a[5],+a[6])))}})},cg=W.ViewController.inherit(function(){var r=function(t){var i=t.type==="sessionStorage"?zu():ne().localStorage;if(!i)throw new Error("E1007");return i},e=function(t){return _(t.storageKey)?t.storageKey:"storage"};return{_loadState(){var t=this.option("stateStoring");if(t.type==="custom")return t.customLoad&&t.customLoad();try{return JSON.parse(r(t).getItem(e(t)))}catch(i){q.log("W1022","State storing",i.message)}},_saveState(t){var i=this.option("stateStoring");if(i.type==="custom"){i.customSave&&i.customSave(t);return}try{r(i).setItem(e(i),JSON.stringify(t))}catch(a){q.log(a.message)}},publicMethods:()=>["state"],isEnabled(){return this.option("stateStoring.enabled")},init(){var t=this;return t._state={},t._isLoaded=!1,t._isLoading=!1,t._windowUnloadHandler=function(){t._savingTimeoutID!==void 0&&t._saveState(t.state())},b.on(ne(),"unload",t._windowUnloadHandler),t},isLoaded(){return this._isLoaded},isLoading(){return this._isLoading},load(){this._isLoading=!0;var t=bt(this._loadState());return t.always(()=>{this._isLoaded=!0,this._isLoading=!1}).done(i=>{i!==null&&!xr(i)&&this.state(i)}),t},state(t){if(!arguments.length)return S(!0,{},this._state);this._state=S({},t),hg(this._state)},save(){var t=this;clearTimeout(t._savingTimeoutID),t._savingTimeoutID=setTimeout(()=>{t._saveState(t.state()),t._savingTimeoutID=void 0},t.option("stateStoring.savingTimeout"))},optionChanged(t){switch(t.name){case"stateStoring":this.isEnabled()&&!this.isLoading()&&this.load(),t.handled=!0;break;default:this.callBase(t)}},dispose(){clearTimeout(this._savingTimeoutID),b.off(ne(),"unload",this._windowUnloadHandler)}}}());const pg={StateStoringController:cg};var gg=r=>{var e=r.getView("pagerView"),t=r.getController("data"),i={allowedPageSizes:e?e.getPageSizes():void 0,filterPanel:{filterEnabled:r.option("filterPanel.filterEnabled")},filterValue:r.option("filterValue"),focusedRowKey:r.option("focusedRowEnabled")?r.option("focusedRowKey"):void 0};return S(i,t.getUserState())},vg=r=>{var e=r.getController("columns"),t=r.getController("selection"),i=r.getController("export"),a=r.getController("data");e&&e.columnsChanged.add(()=>{r.updateState({columns:e.getUserState()})}),t&&t.selectionChanged.add(n=>{r.updateState({selectedRowKeys:n.selectedRowKeys,selectionFilter:n.selectionFilter})}),a&&(r._initialPageSize=r.option("paging.pageSize"),r._initialFilterValue=r.option("filterValue"),a.changed.add(()=>{var n=gg(r);r.updateState(n)})),i&&i.selectionOnlyChanged.add(()=>{r.updateState({exportSelectionOnly:i.selectionOnly()})})},fg=null,mg=(r,e)=>{var t=r.getController("filterSync"),i=r.getController("columns"),a=e.columns||e.filterValue!==void 0;return t?a?e.filterValue||t.getFilterValueFromColumns(e.columns):r._initialFilterValue||t.getFilterValueFromColumns(i.getColumns()):fg},_g={defaultOptions:()=>({stateStoring:{enabled:!1,storageKey:null,type:"localStorage",customLoad:null,customSave:null,savingTimeout:2e3}}),controllers:{stateStoring:pg.StateStoringController},extenders:{views:{rowsView:{init(){var r=this,e=r.getController("data");r.callBase(),e.stateLoaded.add(()=>{if(e.isLoaded()&&!e.getDataSource()){r.setLoading(!1),r.renderNoDataText();var t=r.component.getView("columnHeadersView");t&&t.render(),r.component._fireContentReadyAction()}})}}},controllers:{stateStoring:{init(){this.callBase.apply(this,arguments),vg(this)},isLoading(){return this.callBase()||this.getController("data").isStateLoading()},state(r){var e=this.callBase.apply(this,arguments);return r!==void 0&&this.applyState(S(!0,{},r)),e},updateState(r){if(this.isEnabled()){var e=this.state(),t=S({},e,r),i=cr(e),a=cr(t);U(i,a)||(r=S(!0,{},r),S(this._state,r),this.save())}else S(this._state,r)},applyState(r){var e,{allowedPageSizes:t}=r,{searchText:i}=r,{selectedRowKeys:a}=r,{selectionFilter:n}=r,o=this.getController("export"),s=this.getController("columns"),l=this.getController("data"),d=this.option("scrolling.mode"),u=d==="virtual"||d==="infinite",h=this.option("pager.visible")===!0&&this.option("pager.showPageSizeSelector"),c=(e=this.getView("rowsView"))===null||e===void 0?void 0:e.hasHeight();this.component.beginUpdate(),s&&s.setUserState(r.columns),o&&o.selectionOnly(r.exportSelectionOnly),this.option("selection.deferred")||this.option("selectedRowKeys",a||[]),this.option("selectionFilter",n),t&&this.option("pager.allowedPageSizes")==="auto"&&(this.option("pager").allowedPageSizes=t),this.option("focusedRowEnabled")&&(this.option("focusedRowIndex",-1),this.option("focusedRowKey",r.focusedRowKey||null)),this.component.endUpdate(),this.option("searchPanel.text",i||""),this.option("filterValue",mg(this,r)),this.option("filterPanel.filterEnabled",r.filterPanel?r.filterPanel.filterEnabled:!0),this.option("paging.pageIndex",(!u||c)&&r.pageIndex||0),this.option("paging.pageSize",(!u||h)&&_(r.pageSize)?r.pageSize:this._initialPageSize),l&&l.reset()}},columns:{_shouldReturnVisibleColumns(){var r=this.callBase.apply(this,arguments),e=this.getController("stateStoring");return r&&(!e.isEnabled()||e.isLoaded())}},data:{callbackNames(){return this.callBase().concat(["stateLoaded"])},_refreshDataSource(){var{callBase:r}=this,e=this.getController("stateStoring");if(e.isEnabled()&&!e.isLoaded()){clearTimeout(this._restoreStateTimeoutID);var t=new O;return this._restoreStateTimeoutID=setTimeout(()=>{e.load().always(()=>{this._restoreStateTimeoutID=null}).done(()=>{r.call(this),this.stateLoaded.fire(),t.resolve()}).fail(i=>{this.stateLoaded.fire(),this._handleLoadError(i||"Unknown error"),t.reject()})}),t.promise()}this.isStateLoading()||r.call(this)},isLoading(){var r=this.getController("stateStoring");return this.callBase()||r.isLoading()},isStateLoading(){return _(this._restoreStateTimeoutID)},isLoaded(){return this.callBase()&&!this.isStateLoading()},dispose(){clearTimeout(this._restoreStateTimeoutID),this.callBase()}},selection:{_fireSelectionChanged(r){var e=this.getController("stateStoring"),t=this.option("selection.deferred");e.isLoading()&&t||this.callBase.apply(this,arguments)}}}}};A.registerModule("stateStoring",_g);var rd="dx-editor-cell",Cg="dx-row",Io="dx-selection",tt="dx-select-checkbox",wg="dx-select-checkboxes-hidden",id="dx-command-select",xg="dx-selection-disabled",ad="dx-data-row",Ve="selection.showCheckBoxesMode",rr="selection.mode",To=function(r,e){var t=r.getController("selection"),i=r.getView("rowsView"),a=m(e.target).closest(".".concat(ad)),n=i.getRowIndex(a);n<0||(r.option(Ve)==="onLongTap"?t.isSelectionWithCheckboxes()?t.stopSelectionWithCheckboxes():t.startSelectionWithCheckboxes():(r.option(Ve)==="onClick"&&t.startSelectionWithCheckboxes(),r.option(Ve)!=="always"&&t.changeItemSelection(n,{control:!0})))},yg=function(r,e){var t=0,i=r._dataController.store(),a=i&&i.key(),n=Array.isArray(a);if(!e.length)return!1;if(n&&Array.isArray(e[0])&&e[1]==="and"){for(var o=0;o<e.length;o++)if(Array.isArray(e[o])){if(e[o][0]!==a[t]||e[o][1]!=="=")return!0;t++}return!1}return a!==e[0]},Eg=(r,e)=>{var{component:t}=e,i=t.getView("rowsView");t.option("renderAsync")&&!t.option("selection.deferred")&&(e.value=t.isRowSelected(e.row.key)),i.renderSelectCheckBoxContainer(m(r),e)},Sg=(r,e)=>{var{column:t}=e,i=m(r),a=e.component.getView("columnHeadersView");i.addClass(rd),a._renderSelectAllCheckBox(i,t),a._attachSelectAllCheckBoxClickEvent(i)};class bg extends W.Controller{init(){var e,{deferred:t,selectAllMode:i,mode:a}=(e=this.option("selection"))!==null&&e!==void 0?e:{};this.option("scrolling.mode")==="infinite"&&!t&&a==="multiple"&&i==="allPages"&&q.log("W1018"),this._dataController=this.getController("data"),this._selectionMode=a,this._isSelectionWithCheckboxes=!1,this._selection=this._createSelection(),this._updateSelectColumn(),this.createAction("onSelectionChanged",{excludeValidators:["disabled","readOnly"]}),this._dataPushedHandler||(this._dataPushedHandler=this._handleDataPushed.bind(this),this._dataController.pushed.add(this._dataPushedHandler))}_handleDataPushed(e){this._deselectRemovedOnPush(e),this._updateSelectedOnPush(e)}_deselectRemovedOnPush(e){var t=this.option("selection.deferred"),i=e.filter(n=>n.type==="remove").map(n=>n.key);if(t){var a=this._dataController.items().filter(n=>n.isSelected).map(n=>n.key);i=i.filter(n=>a.find(o=>U(o,n)))}i.length&&this.deselectRows(i)}_updateSelectedOnPush(e){var t=this.option("selection.deferred");if(!t){var i=e.filter(n=>n.type==="update"),a=this.getSelectedRowsData();jr({keyInfo:this._selection.options,data:a,changes:i})}}_getSelectionConfig(){var e,t=this._dataController,i=this.getController("columns"),a=(e=this.option("selection"))!==null&&e!==void 0?e:{},{deferred:n}=a,o=this.option("scrolling.mode"),s=o==="virtual"||o==="infinite",l=this.option("selection.allowSelectAll"),d=this.option("scrolling.legacyMode");return{selectedKeys:this.option("selectedRowKeys"),mode:this._selectionMode,deferred:n,maxFilterLengthInRequest:a.maxFilterLengthInRequest,selectionFilter:this.option("selectionFilter"),ignoreDisabledItems:!0,allowLoadByRange(){var u=i.getGroupColumns().length>0;return s&&!d&&!u&&l&&!n},key:()=>t==null?void 0:t.key(),keyOf:u=>t==null?void 0:t.keyOf(u),dataFields(){var u;return(u=t.dataSource())===null||u===void 0?void 0:u.select()},load(u){var h;return((h=t.dataSource())===null||h===void 0?void 0:h.load(u))||new O().resolve([])},plainItems:()=>t.items(!0),isItemSelected:u=>u.selected,isSelectableItem:u=>(u==null?void 0:u.rowType)==="data"&&!u.isNewRow,getItemData:u=>_(u==null?void 0:u.rowType)?(u==null?void 0:u.oldData)||(u==null?void 0:u.data):u,filter:()=>t.getCombinedFilter(n),totalCount:()=>t.totalCount(),getLoadOptions(u,h,c){var p,g,{sort:v,filter:f}=(g=(p=t.dataSource())===null||p===void 0?void 0:p.lastLoadOptions())!==null&&g!==void 0?g:{},C=Math.min(u,h),w=Math.max(u,h);_(c)&&(C=Math.min(c,C),w=Math.max(c,w));var x=w-C+1;return{skip:C,take:x,filter:f,sort:v}},onSelectionChanged:this._updateSelectedItems.bind(this)}}_updateSelectColumn(){var e=this.getController("columns"),t=this.isSelectColumnVisible();e.addCommandColumn({type:"selection",command:"select",visible:t,visibleIndex:-1,dataType:"boolean",alignment:"center",cssClass:id,width:"auto",cellTemplate:Eg,headerCellTemplate:Sg}),e.columnOption("command:select","visible",t)}_createSelection(){var e=this._getSelectionConfig();return new lh(e)}_fireSelectionChanged(e){var t=this.option("selection.deferred")?{selectionFilter:this.option("selectionFilter")}:{selectedRowKeys:this.option("selectedRowKeys")};this.selectionChanged.fire(t),e&&this.executeAction("onSelectionChanged",e)}_updateCheckboxesState(e){var{isDeferredMode:t}=e,{selectionFilter:i}=e,{selectedItemKeys:a}=e,{removedItemKeys:n}=e;this.option(Ve)==="onClick"&&((t?i&&yg(this,i):a.length>1)?this.startSelectionWithCheckboxes():(t?i&&!i.length:a.length===0&&n.length)&&this.stopSelectionWithCheckboxes())}_updateSelectedItems(e){var t,i=this.option("selection.deferred"),a=this._selection.selectionFilter(),n=this._dataController,o=n.items(!0),s=n.items();if(o){var l=this.isSelectionWithCheckboxes(),d=this.getChangedItemIndexes(o),u=this.getChangedItemIndexes(s);this._updateCheckboxesState({selectedItemKeys:e.selectedItemKeys,removedItemKeys:e.removedItemKeys,selectionFilter:a,isDeferredMode:i}),(d.length||l!==this.isSelectionWithCheckboxes())&&n.updateItems({changeType:"updateSelection",itemIndexes:u}),i?(this.option("selectionFilter",a),t={}):(e.addedItemKeys.length||e.removedItemKeys.length)&&(this._selectedItemsInternalChange=!0,this.option("selectedRowKeys",e.selectedItemKeys.slice(0)),this._selectedItemsInternalChange=!1,t={selectedRowsData:e.selectedItems.slice(0),selectedRowKeys:e.selectedItemKeys.slice(0),currentSelectedRowKeys:e.addedItemKeys.slice(0),currentDeselectedRowKeys:e.removedItemKeys.slice(0)}),this._fireSelectionChanged(t)}}getChangedItemIndexes(e){for(var t=[],i=this.option("selection.deferred"),a=0,{length:n}=e;a<n;a++){var o=e[a],s=this.isRowSelected(i?o.data:o.key);this._selection.isDataItem(o)&&o.isSelected!==s&&t.push(a)}return t}callbackNames(){return["selectionChanged"]}optionChanged(e){switch(super.optionChanged(e),e.name){case"selection":var t=this._selectionMode;if(this.init(),e.fullName!=="selection.showCheckBoxesMode"){var i=this._selectionMode,a=this.option("selectedRowKeys");t!==i&&(i==="single"?a.length>1&&(a=[a[0]]):i!=="multiple"&&(a=[])),this.selectRows(a).always(()=>{this._fireSelectionChanged()})}this.getController("columns").updateColumns(),e.handled=!0;break;case"selectionFilter":this._selection.selectionFilter(e.value),e.handled=!0;break;case"selectedRowKeys":var n=e.value||[];Array.isArray(n)&&!this._selectedItemsInternalChange&&(this.component.getDataSource()||!n.length)&&this.selectRows(n),e.handled=!0}}publicMethods(){return["selectRows","deselectRows","selectRowsByIndexes","getSelectedRowKeys","getSelectedRowsData","clearSelection","selectAll","deselectAll","startSelectionWithCheckboxes","stopSelectionWithCheckboxes","isRowSelected"]}isRowSelected(e){return this._selection.isItemSelected(e)}isSelectColumnVisible(){return this.option(rr)==="multiple"&&(this.option(Ve)==="always"||this.option(Ve)==="onClick"||this._isSelectionWithCheckboxes)}_isOnePageSelectAll(){return this.option("selection.selectAllMode")==="page"}isSelectAll(){return this._selection.getSelectAllState(this._isOnePageSelectAll())}selectAll(){return this.option(Ve)==="onClick"&&this.startSelectionWithCheckboxes(),this._selection.selectAll(this._isOnePageSelectAll())}deselectAll(){return this._selection.deselectAll(this._isOnePageSelectAll())}clearSelection(){return this.selectedItemKeys([])}refresh(){var e,t=(e=this.option("selectedRowKeys"))!==null&&e!==void 0?e:[];return!this.option("selection.deferred")&&t.length?this.selectedItemKeys(t):new O().resolve().promise()}selectedItemKeys(e,t,i,a){return this._selection.selectedItemKeys(e,t,i,a)}getSelectedRowKeys(){return this._selection.getSelectedItemKeys()}selectRows(e,t){return this.selectedItemKeys(e,t)}deselectRows(e){return this.selectedItemKeys(e,!0,!0)}selectRowsByIndexes(e){var t=this._dataController.items(),i=[];return Array.isArray(e)||(e=Array.prototype.slice.call(arguments,0)),T(e,function(){var a=t[this];a&&a.rowType==="data"&&i.push(a.key)}),this.selectRows(i)}getSelectedRowsData(){return this._selection.getSelectedItems()}loadSelectedItemsWithFilter(){return this._selection.loadSelectedItemsWithFilter()}changeItemSelection(e,t,i){t=t||{},this.isSelectionWithCheckboxes()&&(t.control=!0);var a=e+this._dataController.getRowIndexOffset()-this._dataController.getRowIndexOffset(!0);return this._selection.changeItemSelection(a,t,i)}focusedItemIndex(e){if(_(e))this._selection._focusedItemIndex=e;else return this._selection._focusedItemIndex}isSelectionWithCheckboxes(){return this.option(rr)==="multiple"&&(this.option(Ve)==="always"||this._isSelectionWithCheckboxes)}startSelectionWithCheckboxes(){return this.option(rr)==="multiple"&&!this.isSelectionWithCheckboxes()?(this._isSelectionWithCheckboxes=!0,this._updateSelectColumn(),!0):!1}stopSelectionWithCheckboxes(){return this._isSelectionWithCheckboxes?(this._isSelectionWithCheckboxes=!1,this._updateSelectColumn(),!0):!1}}var Ig={defaultOptions:()=>({selection:{mode:"none",showCheckBoxesMode:"onClick",allowSelectAll:!0,selectAllMode:"allPages",maxFilterLengthInRequest:1500,deferred:!1},selectionFilter:[],selectedRowKeys:[]}),controllers:{selection:bg},extenders:{controllers:{data:{init(){var r=this.getController("selection"),e=this.option("selection.deferred");this.callBase.apply(this,arguments),e&&r._updateCheckboxesState({isDeferredMode:!0,selectionFilter:this.option("selectionFilter")})},_loadDataSource(){var r=this;return r.callBase().always(()=>{r.getController("selection").refresh()})},_processDataItem(r,e){var t=this.getController("selection"),i=t.isSelectColumnVisible(),a=e.isDeferredSelection=e.isDeferredSelection===void 0?this.option("selection.deferred"):e.isDeferredSelection,n=this.callBase.apply(this,arguments);if(n.isSelected=t.isRowSelected(a?n.data:n.key),i&&n.values){for(var o=0;o<e.visibleColumns.length;o++)if(e.visibleColumns[o].command==="select"){n.values[o]=n.isSelected;break}}return n},refresh(r){var e=this,t=new O;return this.callBase.apply(this,arguments).done(()=>{!r||r.selection?e.getController("selection").refresh().done(t.resolve).fail(t.reject):t.resolve()}).fail(t.reject),t.promise()},_handleDataChanged(r){this.callBase.apply(this,arguments),(!r||r.changeType==="refresh")&&!this._repaintChangesOnly&&this.getController("selection").focusedItemIndex(-1)},_applyChange(r){if(r&&r.changeType==="updateSelection"){r.items.forEach((e,t)=>{var i=this._items[t];i&&(i.isSelected=e.isSelected,i.values=e.values)});return}return this.callBase.apply(this,arguments)},_endUpdateCore(){var r=this._changes,e=r.length>1&&r.every(i=>i.changeType==="updateSelection");if(e){var t=r.map(i=>i.itemIndexes||[]).reduce((i,a)=>i.concat(a));this._changes=[{changeType:"updateSelection",itemIndexes:t}]}this.callBase.apply(this,arguments)}},contextMenu:{_contextMenuPrepared(r){var e=r.event;e.originalEvent&&e.originalEvent.type!=="dxhold"||r.items&&r.items.length>0||To(this,e)}}},views:{columnHeadersView:{init(){this.callBase(),this.getController("selection").selectionChanged.add(this._updateSelectAllValue.bind(this))},_updateSelectAllValue(){var r=this.element(),e=r&&r.find(".".concat(tt));if(r&&e.length&&this.option("selection.mode")==="multiple"){var t=this.getController("selection").isSelectAll(),i=t!==!1,a=this.option("selection.allowSelectAll")?!this.getController("data").isEmpty():i;e.dxCheckBox("instance").option({visible:a,value:t})}},_handleDataChanged(r){this.callBase(r),(!r||r.changeType==="refresh"||r.repaintChangesOnly&&r.changeType==="update")&&this.waitAsyncTemplates().done(()=>{this._updateSelectAllValue()})},_renderSelectAllCheckBox(r,e){var t=this,i=t.getController("selection"),a=t.getController("data").isEmpty(),n=m("<div>").appendTo(r).addClass(tt);return t.setAria("label",y.format("dxDataGrid-ariaSelectAll"),n),t.getController("editorFactory").createEditor(n,S({},e,{parentType:"headerRow",dataType:"boolean",value:i.isSelectAll(),editorOptions:{visible:!a&&(t.option("selection.allowSelectAll")||i.isSelectAll()!==!1)},tabIndex:t.option("useLegacyKeyboardNavigation")?-1:t.option("tabIndex")||0,setValue(o,s){var l=t.option("selection.allowSelectAll");s.component.option("visible",l||s.component.option("value")!==!1),!(!s.event||i.isSelectAll()===o)&&(s.value&&!l?s.component.option("value",!1):s.value?i.selectAll():i.deselectAll(),s.event.preventDefault())}})),n},_attachSelectAllCheckBoxClickEvent(r){b.on(r,re,this.createAction(e=>{var{event:t}=e;m(t.target).closest(".".concat(tt)).length||b.trigger(m(t.currentTarget).children(".".concat(tt)),re),t.preventDefault()}))}},rowsView:{renderSelectCheckBoxContainer(r,e){e.rowType==="data"&&!e.row.isNewRow?(r.addClass(rd),this._attachCheckBoxClickEvent(r),this._renderSelectCheckBox(r,e)):I.setEmptyText(r)},_renderSelectCheckBox(r,e){var t=m("<div>").addClass(tt).appendTo(r);return this.setAria("label",y.format("dxDataGrid-ariaSelectRow"),t),this.getController("editorFactory").createEditor(t,S({},e.column,{parentType:"dataRow",dataType:"boolean",lookup:null,value:e.value,setValue(i,a){var n;((n=a==null?void 0:a.event)===null||n===void 0?void 0:n.type)==="keydown"&&b.trigger(a.element,re,a)},row:e.row})),t},_attachCheckBoxClickEvent(r){b.on(r,re,this.createAction(function(e){var t=this.getController("selection"),{event:i}=e,a=this.getRowIndex(m(i.currentTarget).closest(".".concat(Cg)));a>=0&&(t.startSelectionWithCheckboxes(),t.changeItemSelection(a,{shift:i.shiftKey}),m(i.target).closest(".".concat(tt)).length&&this.getController("data").updateItems({changeType:"updateSelection",itemIndexes:[a]}))}))},_update(r){var e=this,t=e.getTableElements();r.changeType==="updateSelection"?t.length>0&&(T(t,(i,a)=>{T(r.itemIndexes||[],(n,o)=>{var s;if(r.items[o]&&(s=e._getRowElements(m(a)).eq(o),s.length)){var{isSelected:l}=r.items[o];s.toggleClass(Io,l===void 0?!1:l).find(".".concat(tt)).dxCheckBox("option","value",l),e.setAria("selected",l,s)}})}),e._updateCheckboxesClass()):e.callBase(r)},_createTable(){var r=this,e=r.option("selection.mode"),t=r.callBase.apply(r,arguments);return e!=="none"&&((r.option(Ve)==="onLongTap"||!Hu)&&b.on(t,$(Sl.name,"dxDataGridRowsView"),".".concat(ad),r.createAction(i=>{To(r.component,i.event),i.event.stopPropagation()})),b.on(t,"mousedown selectstart",r.createAction(i=>{var{event:a}=i;a.shiftKey&&a.preventDefault()}))),t},_createRow(r){var e=this.callBase.apply(this,arguments);if(r){var{isSelected:t}=r;t&&e.addClass(Io);var i=this.option(rr);i!=="none"&&this.setAria("selected",t,e)}return e},_rowClick(r){var e=r.event,t=m(e.target).closest(".".concat(xg)).length;this.isClickableElement(m(e.target))||(!t&&(this.option(rr)!=="multiple"||this.option(Ve)!=="always")&&this.getController("selection").changeItemSelection(r.rowIndex,{control:ai(e),shift:e.shiftKey})&&(e.preventDefault(),r.handled=!0),this.callBase(r))},isClickableElement(r){var e=r.closest(".".concat(id)).length;return!!e},_renderCore(r){var e=this.callBase(r);return this._updateCheckboxesClass(),e},_updateCheckboxesClass(){var r=this.getTableElements(),e=this.getController("selection"),t=e.isSelectColumnVisible()&&!e.isSelectionWithCheckboxes();T(r,(i,a)=>{m(a).toggleClass(wg,t)})}}}}};A.registerModule("selection",Ig);var Tg="column-chooser",nd="column-chooser-button",Ro="notouch-action",Rg="column-chooser-list",Og="column-chooser-plain",Ag="column-chooser-mode-drag",Dg="column-chooser-mode-select",od="column-chooser",Oo="dx-column-chooser-item",Vg=["showInColumnChooser","caption","allowHiding","visible","cssClass","ownerBand"],Fg=function(r,e){var t=[],i=r.isSelectMode(),a=r.option("columnChooser.selection.recursive");return e.length&&T(e,(n,o)=>{var s={text:o.caption,cssClass:o.cssClass,allowHiding:o.allowHiding,expanded:!0,id:o.index,disabled:o.allowHiding===!1,parentId:_(o.ownerBand)?o.ownerBand:null},l=a&&o.hasColumns;i&&!l&&(s.selected=o.visible),t.push(s)}),t},Pg={renderShowColumnChooserButton(r){var e=this,t=e.addWidgetPrefix(nd),i=e.option("columnChooser.enabled"),a=r.find(".".concat(t)),n;i?a.length?a.show():(n=m("<div>").addClass(t).appendTo(r),e._createComponent(n,pr,{icon:od,onClick(){e.getView("columnChooserView").showColumnChooser()},hint:e.option("columnChooser.title"),integrationOptions:{}})):a.hide()},getPosition(){var r=this.getView("rowsView"),e=this.option("columnChooser.position");return _(e)?e:{my:"right bottom",at:"right bottom",of:r&&r.element(),collision:"fit",offset:"-2 -2",boundaryOffset:"2 2"}}},Bg=W.ViewController.inherit(Pg),Lg={_resizeCore:me,_isWinDevice:()=>!!_e.real().win,_initializePopupContainer(){var r=this,e=r.addWidgetPrefix(Tg),t=r.element().addClass(e),i=r.option("columnChooser"),a=ml(),n=Wu(a),o=wi(a),s={visible:!1,shading:!1,showCloseButton:!1,dragEnabled:!0,resizeEnabled:!0,wrapperAttr:{class:e},toolbarItems:[{text:i.title,toolbar:"top",location:n||o?"before":"center"}],position:r.getController("columnChooser").getPosition(),width:i.width,height:i.height,rtlEnabled:r.option("rtlEnabled"),onHidden(){r._isWinDevice()&&m("body").removeClass(r.addWidgetPrefix(Ro))},container:i.container};n||o?S(s,{showCloseButton:!0}):s.toolbarItems[s.toolbarItems.length]={shortcut:"cancel"},_(this._popupContainer)?this._popupContainer.option(s):(r._popupContainer=r._createComponent(t,vt,s),r._popupContainer.on("optionChanged",l=>{l.name==="visible"&&r.renderCompleted.fire()})),this.setPopupAttributes()},setPopupAttributes(){var r=this.isSelectMode(),e=this._columnsController.isBandColumnsUsed();this._popupContainer.setAria({role:"dialog",label:y.format("dxDataGrid-columnChooserTitle")}),this._popupContainer.$wrapper().toggleClass(this.addWidgetPrefix(Ag),!r).toggleClass(this.addWidgetPrefix(Dg),r),this._popupContainer.$content().addClass(this.addWidgetPrefix(Rg)),r&&!e&&this._popupContainer.$content().addClass(this.addWidgetPrefix(Og))},_renderCore(r){if(this._popupContainer){var e=!this.isSelectMode();!this._columnChooserList||r==="full"?this._renderTreeView():e&&this._updateItems()}},_renderTreeView(){var r,e,t,i=this,a=this._popupContainer.$content(),n=this.option("columnChooser"),o=this.isSelectMode(),s=_(n.allowSearch)?n.allowSearch:(r=n.search)===null||r===void 0?void 0:r.enabled,l=_(n.searchTimeout)?n.searchTimeout:(e=n.search)===null||e===void 0?void 0:e.timeout,d={dataStructure:"plain",activeStateEnabled:!0,focusStateEnabled:!0,hoverStateEnabled:!0,itemTemplate:"item",showCheckBoxesMode:"none",rootValue:null,searchEnabled:s,searchTimeout:l,searchEditorOptions:(t=n.search)===null||t===void 0?void 0:t.editorOptions};if(this._isWinDevice()&&(d.useNativeScrolling=!1),S(d,o?this._prepareSelectModeConfig():this._prepareDragModeConfig()),this._columnChooserList)d.searchEnabled||(d.searchValue=""),this._columnChooserList.option(d),this._updateItems();else{this._columnChooserList=this._createComponent(a,tn,d),this._updateItems();var u=0;this._columnChooserList.on("optionChanged",h=>{var c=h.component.getScrollable();u=c.scrollTop()}),this._columnChooserList.on("contentReady",h=>{xe(()=>{var c=h.component.getScrollable();c.scrollTo({y:u}),i.renderCompleted.fire()})})}},_prepareDragModeConfig(){var r=this.option("columnChooser");return{noDataText:r.emptyPanelText,activeStateEnabled:!1,focusStateEnabled:!1,hoverStateEnabled:!1,itemTemplate(e,t,i){m(i).text(e.text).parent().addClass(e.cssClass).addClass(Oo)}}},_prepareSelectModeConfig(){var r=this,e=this.option("columnChooser.selection")||{},t=!1;return{selectByClick:e.selectByClick,selectNodesRecursive:e.recursive,showCheckBoxesMode:e.allowSelectAll?"selectAll":"normal",onSelectionChanged:i=>{if(!t){var a=(n=>{var o=(s,l)=>s.reduce((d,u)=>(d.push(u),u.children.length&&o(u.children,d),d),l);return o(n,[])})(i.component.getNodes());i.component.beginUpdate(),t=!0,((n,o)=>{o.filter(s=>s.itemData.allowHiding===!1).forEach(s=>n.component.selectItem(s.key))})(i,a),i.component.endUpdate(),t=!1,r.component.beginUpdate(),this._isUpdatingColumnVisibility=!0,(n=>{n.forEach(o=>{var s=o.itemData.id,l=o.selected!==!1;r._columnsController.columnOption(s,"visible",l)})})(a),r.component.endUpdate(),this._isUpdatingColumnVisibility=!1}}}},_updateItems(){var r=this.isSelectMode(),e=this._columnsController.getChooserColumns(r),t=Fg(this,e);this._columnChooserList.option("items",t)},_updateItemsSelection(r){var e=r==null?void 0:r.map(t=>this._columnsController.columnOption(t));this._columnChooserList.beginUpdate(),e==null||e.forEach(t=>{var{visible:i,index:a}=t;i?this._columnChooserList.selectItem(a):this._columnChooserList.unselectItem(a)}),this._columnChooserList.endUpdate()},_columnOptionChanged(r){this.callBase(r);var e=this.isSelectMode();if(e&&this._columnChooserList&&this._isUpdatingColumnVisibility!==!0){var{optionNames:t}=r,i=t.visible&&t.length===1,a=_(r.columnIndex)?[r.columnIndex]:r.columnIndices,n=Vg.some(o=>t[o])||r.changeTypes.columns&&t.all;n&&(this._updateItemsSelection(a),i||this._updateItems())}},optionChanged(r){switch(r.name){case"columnChooser":this._initializePopupContainer(),this.render(null,"full");break;default:this.callBase(r)}},getColumnElements(){var r=[],e=this.isSelectMode(),t=this._columnsController.getChooserColumns(e),i=this._popupContainer&&this._popupContainer.$content(),a=i&&i.find(".dx-treeview-node");return a&&t.forEach(n=>{var o=a.filter("[data-item-id = '".concat(n.index,"']")),s=o.length?o.children(".".concat(Oo)).get(0):null;r.push(s)}),m(r)},getName:()=>"columnChooser",getColumns(){return this._columnsController.getChooserColumns()},allowDragging(r){var e=this._columnsController.isParentColumnVisible(r.index),t=!r.visible&&r.allowHiding;return this.isColumnChooserVisible()&&e&&t},allowColumnHeaderDragging(r){var e=!this.isSelectMode();return e&&this.isColumnChooserVisible()&&r.allowHiding},getBoundingRect(){var r=this._popupContainer&&this._popupContainer.$overlayContent();if(r&&r.is(":visible")){var e=r.offset();return{left:e.left,top:e.top,right:e.left+Te(r),bottom:e.top+le(r)}}return null},showColumnChooser(){this._popupContainer||(this._initializePopupContainer(),this.render()),this._popupContainer.show(),this._isWinDevice()&&m("body").addClass(this.addWidgetPrefix(Ro))},hideColumnChooser(){this._popupContainer&&this._popupContainer.hide()},isColumnChooserVisible(){var r=this._popupContainer;return r&&r.option("visible")},isSelectMode(){return this.option("columnChooser.mode")==="select"},hasHiddenColumns(){var r=this.option("columnChooser.enabled"),e=this.getColumns().filter(t=>!t.visible);return r&&e.length},publicMethods:()=>["showColumnChooser","hideColumnChooser"]},kg=br.inherit(Lg),un={defaultOptions:()=>({columnChooser:{enabled:!1,search:{enabled:!1,timeout:500,editorOptions:{}},selection:{allowSelectAll:!1,selectByClick:!1,recursive:!1},position:void 0,mode:"dragAndDrop",width:250,height:260,title:y.format("dxDataGrid-columnChooserTitle"),emptyPanelText:y.format("dxDataGrid-columnChooserEmptyText"),container:void 0}}),controllers:{columnChooser:Bg},views:{columnChooserView:kg},extenders:{views:{headerPanel:{_getToolbarItems(){var r=this.callBase();return this._appendColumnChooserItem(r)},_appendColumnChooserItem(r){var e=this,t=e.option("columnChooser.enabled");if(t){var i=e.option("columnChooser.title"),a={widget:"dxButton",options:{icon:od,onClick:function(){e.component.getView("columnChooserView").showColumnChooser()},hint:i,text:i,onInitialized:function(n){m(n.element).addClass(e._getToolbarButtonClass(e.addWidgetPrefix(nd)))},elementAttr:{"aria-haspopup":"dialog"}},showText:"inMenu",location:"after",name:"columnChooserButton",locateInMenu:"auto",sortIndex:40};r.push(a)}return r},optionChanged(r){switch(r.name){case"columnChooser":this._invalidate(),r.handled=!0;break;default:this.callBase(r)}},isVisible(){var r=this.option("columnChooser.enabled");return this.callBase()||r}},columnHeadersView:{allowDragging(r){var e=this.component.getView("columnChooserView"),t=!e.isSelectMode(),i=e.isColumnChooserVisible();return t&&i&&r.allowHiding||this.callBase(r)}}},controllers:{columns:{allowMoveColumn(r,e,t,i){var a=this.option("columnChooser.mode")==="select",n=a&&i==="columnChooser";return n?!1:this.callBase(r,e,t,i)}}}}};un.controllers.columnChooser;un.views.columnChooserView;A.registerModule("columnChooser",un);function dt(r,e){for(var t=Dt(e.group),i=[],a=0;a<r.length;a++)i.push([t[a].selector,"=",r[a]]);return e.filter&&i.push(e.filter),I.combineFilters(i)}function sd(r,e,t){for(var i=Dt(e.group),a=[],n=t?r.length-1:0;n<r.length;n++){for(var o=[],s=0;s<=n;s++){var{selector:l}=i[s];if(n===s&&(r[s]===null||r[s]===!1||r[s]===!0))r[s]===!1?o.push([l,"=",i[s].desc?!0:null]):(r[s]?!i[s].desc:i[s].desc)?o.push([l,"<>",r[s]]):(o.push([l,"<>",null]),o.push([l,"=",null]));else{var d=[l,n===s?i[s].desc?">":"<":"=",r[s]];d[1]==="<"?o.push([d,"or",[l,"=",null]]):o.push(d)}}a.push(A.combineFilters(o))}return a=A.combineFilters(a,"or"),A.combineFilters([a,e.filter])}var ld=Cr.inherit(function(){var r=function(t,i){var{hash:a}=t;return a&&a[JSON.stringify(i)]},e=function(t,i){var a=0,n=t.length-1;if(!t.length)return 0;do{var o=n+a>>1;t[o].offset>i?n=o:a=o}while(n-a>1);var s;for(s=a;s<=n&&!(t[s].offset>i);s++);return s};return{ctor(t){this._dataSource=t,this.reset()},reset(){this._groupsInfo=[],this._totalCountCorrection=0},totalCountCorrection(){return this._totalCountCorrection},updateTotalItemsCount(t){this._totalCountCorrection=t||0},isGroupItemCountable(t){return!this._isVirtualPaging()||!t.isContinuation},_isVirtualPaging(){var t=this._dataSource.option("scrolling.mode");return t==="virtual"||t==="infinite"},itemsCount(){var t=this._dataSource,i=t._dataSource,a=A.normalizeSortingInfo(i.group()||[]).length,n=function o(s,l,d){var u=0;if(l)if(!d)u=l.length;else for(var h=0;h<l.length;h++)s.isGroupItemCountable(l[h])&&u++,u+=o(s,l[h].items,d-1);return u}(this,i.items(),a);return n},foreachGroups(t,i,a,n,o){var s=this;return function l(d,u,h,c){var p=[];function g(x,E,R,D){var V=E&&x(E,R);return V&&D.push(V),V}for(var v=0;v<d.length;v++){if(c.push(d[v].data),!h&&g(u,d[v].data,c,p)===!1)return!1;if(!d[v].data||d[v].data.isExpanded||a){var{children:f}=d[v],C=f.length&&l(f,u,h,c);if(C&&p.push(C),C===!1)return!1}if(h&&g(u,d[v].data,c,p)===!1)return!1;(!d[v].data||d[v].data.offset!==d[v].offset)&&(n=!0),c.pop()}var w=o&&c.slice(0);return n&&P.apply(m,p).always(()=>{s._updateGroupInfoOffsets(d,w)})}(s._groupsInfo,t,i,[])},_updateGroupInfoOffsets(t,i){i=i||[];for(var a=0;a<t.length;a++){var n=t[a];if(n.data&&n.data.offset!==n.offset){n.offset=n.data.offset;for(var o=0;o<i.length;o++)i[o].offset=n.offset}}t.sort((s,l)=>s.offset-l.offset)},findGroupInfo(t){for(var i,a=this._groupsInfo,n=0;a&&n<t.length;n++)i=r(a,t[n]),a=i&&i.children;return i&&i.data},addGroupInfo(t){for(var i,{path:a}=t,n=this._groupsInfo,o=0;o<a.length;o++){if(i=r(n,a[o]),!i){i={key:a[o],offset:t.offset,data:{offset:t.offset,isExpanded:!0,path:a.slice(0,o+1)},children:[]};var s=e(n,t.offset);n.splice(s,0,i),n.hash=n.hash||{},n.hash[JSON.stringify(i.key)]=i}o===a.length-1&&(i.data=t,i.offset!==t.offset&&this._updateGroupInfoOffsets(n)),n=i.children}},allowCollapseAll:()=>!0,refresh(t){var{storeLoadOptions:i}=t,a=Dt(i.group||[]),n="_group"in this?Dt(this._group||[]):a,o=Math.min(n.length,a.length);this._group=i.group;for(var s=0;s<o;s++)if(n[s].selector!==a[s].selector){o=s;break}o?function l(d,u,h){for(var c=0;c<d.length;c++)u+1>=h?d[c].children=[]:l(d[c].children,u+1,h)}(this._groupsInfo,0,o):this.reset()},handleDataLoading(){},handleDataLoaded(t,i){i(t)},handleDataLoadedCore(t,i){i(t)}}}());function Xi(r,e,t,i){if(i=i||0,e>1&&t>0){var a=r-Math.floor(r/e)*e||e;return a+=t-i-2,a<0&&(a+=e),Math.floor(a/(e-i-1))}return 0}var Ao=ld.inherit(function(){var r=function(h,c,p){return h.foreachGroups((g,v)=>{if(g.isExpanded)return c(g,v)},!0,!1,p,p)},e=function h(c,p,g,v,f,C,w){var x;if(v.items=v.items||[],v.paths=v.paths||[],v.count=v.count||0,v.lastCount=v.lastCount||0,!!g)for(var E=0;E<p.length;E++){var R=p[E];if(R.items!==void 0){if(f.push(R.key),C)x=!0;else{var D=c.findGroupInfo(f);x=D&&D.isExpanded}x?R.items?h(c,R.items,g-1,v,f,C,w):g===1&&R.count&&(!C||w)&&(v.items.push(R),v.paths.push(f.slice(0)),v.count+=v.lastCount,v.lastCount=R.count):(R.collapsedItems=R.items,R.items=null),f.pop()}}},t=function(h,c,p,g,v){var f=h.findGroupInfo(g),C;f?(p?f.count=c.count>0?c.count:c.items&&c.items.length||0:c.count=f.count||c.count,f.offset=v):(p&&(C=c.count>0?c.count:c.items.length),h.addGroupInfo({isExpanded:h._isGroupExpanded(g.length-1),path:g.slice(0),offset:v,count:C||0}))},i=function h(c,p,g,v,f,C,w){var x=p.group?p.group.length:0,E=x===v,R=p.remoteOperations.paging,D=0,V=0,F;if(f=f||0,C=C||[],R&&!w&&(D=f===0?p.skip||0:p.skips[f-1]||0),f>=v)return g.length;for(var B=0;B<g.length;B++){var k=g[B];if(k){if(C.push(k.key),!k.count&&!k.items||k.items===void 0||(t(c,k,E,C,D+B),F=k.items?h(c,p,k.items,v,f+1,C,B):k.count||-1,F<0))return-1;V+=F,C.pop()}}return V},a=function(h,c){return h&&h.length&&h[c]&&!!h[c].isExpanded},n=function(h,c,p){for(var g,v=p,f=0;f<h.length;f++)g=h[f].offset+1,f>0&&(g+=h[f-1].childrenTotalCount,c&&(g+=Xi(v,c,g,f-1)*f)),v+=g;return v};function o(h,c,p,g){var v=c.items[g],f=h.skips&&h.skips[p],C=h.takes&&h.takes[p],w=g===c.items.length-1,x=g===0,E=x&&f||0,R=v.count>C+E;x&&f!==void 0&&(v.isContinuation=!0),w&&C!==void 0&&R&&(v.isContinuationOnNextPage=!0)}function s(h){return!Array.isArray(h)}function l(h){s(h.data)||(h.data=new O)}function d(h,c,p,g,v,f){c.isCustomLoading||(g={},e(h,f,p,g,[]),function(w,x,E){var R=E-1,D=w.group?w.group.length:0;x.skip=w.skips&&w.skips[R],w.takes&&w.takes[R]!==void 0&&(D===E?x.take=x.count?x.count-(x.skip||0):0:x.take=0,x.take+=w.takes[R])}(c,g,p));var C=c.group?c.group.length:0;g.paths.length&&C-p>0?(l(c),function(w,x,E,R,D,V){var F=x.group||[],B=F[D+1],k=[];T(E.paths,N=>{var j,K={requireTotalCount:!1,requireGroupCount:!0,group:[B],groupSummary:x.storeLoadOptions.groupSummary,filter:dt(E.paths[N],{filter:x.storeLoadOptions.filter,group:F}),select:x.storeLoadOptions.select,langParams:(j=x.storeLoadOptions)===null||j===void 0?void 0:j.langParams};N===0&&(K.skip=E.skip||0),N===E.paths.length-1&&(K.take=E.take);var ae=K.take===0?[]:w._dataSource.loadFromStore(K);P(ae).done(he=>{var Or=E.items[N];o(x,E,D,N),Or.items=he}),k.push(ae)}),P.apply(null,k).done(()=>{i(w,x,V,R+1),d(w,x,R+1,E,D+1,V)})}(h,c,g,p,v,f)):g.paths.length&&c.storeLoadOptions.group?(l(c),function(w,x,E,R){var D=[],V=x.group||[];T(E.paths,(N,j)=>{D.push(dt(j,{group:x.isCustomLoading?x.storeLoadOptions.group:V}))});var{filter:F}=x.storeLoadOptions;x.storeLoadOptions.isLoadingAll||(F=A.combineFilters([F,A.combineFilters(D,"or")]));var B=S({},x.storeLoadOptions,{requireTotalCount:!1,requireGroupCount:!1,group:null,sort:V.concat(A.normalizeSortingInfo(x.storeLoadOptions.sort||[])),filter:F}),k=w._dataSource.isLastLevelGroupItemsPagingLocal();k||(B.skip=E.skip,B.take=E.take),P(E.take===0?[]:w._dataSource.loadFromStore(B)).done(N=>{k&&(N=w._dataSource.sortLastLevelGroupItems(N,V,E.paths),N=E.skip?N.slice(E.skip):N,N=E.take?N.slice(0,E.take):N),T(E.items,(j,K)=>{var ae=K.count-(j===0&&E.skip||0),he=N.splice(0,ae);o(x,E,V.length-1,j),K.items=he}),x.data.resolve(R)}).fail(x.data.reject)}(h,c,g,f)):s(c.data)&&c.data.resolve(f)}var u=function(h,c){var p=new O,g=!!(c.group&&c.group.length),v=S({skip:0,take:1,requireGroupCount:g,requireTotalCount:!g},c,{group:g?c.group:null});return h.load(v).done((f,C)=>{var w=C&&(g?C.groupCount:C.totalCount);if(!isFinite(w)){p.reject(si.Error(g?"E4022":"E4021"));return}p.resolve(w)}).fail(p.reject.bind(p)),p};return{updateTotalItemsCount(h){var c=0,p=h.extra&&h.extra.totalCount||0,g=h.extra&&h.extra.groupCount||0,v=this._dataSource.pageSize(),f=this._isVirtualPaging();r(this,C=>{C.childrenTotalCount=0}),r(this,(C,w)=>{var x=n(w,f?0:v,c),E=C.count+C.childrenTotalCount;f||(E+=Xi(x,v,E,w.length-1)),w[w.length-2]?w[w.length-2].childrenTotalCount+=E:c+=E}),this.callBase(c-p+g)},_isGroupExpanded(h){var c=this._dataSource.group();return a(c,h)},_updatePagingOptions(h,c){var p=this._isVirtualPaging(),g=this._dataSource.pageSize(),v=[],f=[],C=0,w=0;h.take&&(r(this,x=>{x.childrenTotalCount=0,x.skipChildrenTotalCount=0}),r(this,(x,E)=>{var R,D=0,V=0,F=n(E,p?0:g,w),B=0,k=0,N=x.count+x.childrenTotalCount,j=N;c&&c(x,F);var K=h.skip-F;F<=h.skip+h.take&&N&&(R=h.take,p||(B=Xi(F,g,N,E.length-1),N+=B*E.length,j+=B,g&&K>=0&&(D=E.length,V=E.length-1,k=Math.floor(K/g))),K>=0?(F+N>h.skip&&v.unshift(K-k*D-x.skipChildrenTotalCount),F+N>=h.skip+R&&f.unshift(R-D-x.childrenTotalCount+x.skipChildrenTotalCount)):F+N>=h.skip+R&&f.unshift(R+K-x.childrenTotalCount)),F<=h.skip&&(E[E.length-2]?E[E.length-2].skipChildrenTotalCount+=Math.min(j,K+1-k*V):C+=Math.min(j,K+1)),F<=h.skip+R&&(N=Math.min(j,K+R-(k+1)*V),E[E.length-2]?E[E.length-2].childrenTotalCount+=N:w+=N)}),h.skip-=C,h.take-=w-C),h.skips=v,h.takes=f},changeRowExpand(h){var c=this.findGroupInfo(h),p=this._dataSource,g=p.remoteOperations().groupPaging,v=A.normalizeSortingInfo(p.group());return c?(c.isExpanded=!c.isExpanded,g&&c.isExpanded&&h.length<v.length?u(p,{filter:dt(h,{filter:p.lastLoadOptions().filter,group:p.group()}),group:[v[h.length]],select:p.select()}).done(f=>{c.count=f}):new O().resolve()):new O().reject()},handleDataLoading(h){var{storeLoadOptions:c}=h,p=A.normalizeSortingInfo(c.group||h.loadOptions.group);if(!(h.isCustomLoading||!p.length)){if(h.remoteOperations.grouping){var g=this._dataSource.remoteOperations().paging;c.group=A.normalizeSortingInfo(c.group),c.group.forEach((v,f)=>{var C=f===c.group.length-1;v.isExpanded=!g||!C})}h.group=h.group||p,h.remoteOperations.paging?(h.skip=c.skip,h.take=c.take,c.requireGroupCount=!0,c.group=p.slice(0,1),this._updatePagingOptions(h),c.skip=h.skip,c.take=h.take):(h.skip=h.loadOptions.skip,h.take=h.loadOptions.take,this._updatePagingOptions(h))}},handleDataLoadedCore(h,c){var p=A.normalizeSortingInfo(h.storeLoadOptions.group||h.loadOptions.group).length,g=h.group?h.group.length:0,v,f={};if(h.isCustomLoading)c(h),e(this,h.data,p,f,[],h.isCustomLoading,h.storeLoadOptions.isLoadingAll);else{if(h.remoteOperations.paging||this.foreachGroups(C=>{C.count=0}),v=i(this,h,h.data,p),v<0){h.data=new O().reject(q.Error("E1037"));return}if(h.remoteOperations.paging||p&&h.extra&&h.loadOptions.requireTotalCount&&(h.extra.totalCount=v,h.extra.groupCount=h.data.length),g&&h.storeLoadOptions.requireGroupCount&&!isFinite(h.extra.groupCount)){h.data=new O().reject(si.Error("E4022"));return}this.updateTotalItemsCount(h),h.remoteOperations.paging||this._updatePagingOptions(h),c(h),h.remoteOperations.paging||this._processPaging(h,p)}d(this,h,p,f,0,h.data)},_processSkips(h,c,p){if(p){var g=h[0],v=c[0],f=g&&g.items;v!==void 0&&(g.isContinuation=!0,f&&(g.items=f.slice(v),this._processSkips(g.items,c.slice(1),p-1)))}},_processTakes(h,c,p,g,v){if(!(!g||!h)){v=v||[];var f=h[h.length-1],C=f&&f.items,w=p[0],x=c[0];if(f){var E=f.count-(f.isContinuation&&x||0)||C.length;w!==void 0&&E>w&&(f.isContinuationOnNextPage=!0,v.forEach(R=>{R.isContinuationOnNextPage=!0}),C&&(C=C.slice(0,w),f.items=C)),v.push(f),this._processTakes(C,c.slice(1),p.slice(1),g-1,v)}}},_processPaging(h,c){this._processSkips(h.data,h.skips,c),this._processTakes(h.data,h.skips,h.takes,c)},isLastLevelGroupItemsPagingLocal:()=>!1,sortLastLevelGroupItems:h=>h,refresh(h,c){var p=this,g=p._dataSource,{storeLoadOptions:v}=h,f=h.group||h.storeLoadOptions.group,C=A.normalizeSortingInfo(p._group),w,x;function E(R,D){D.length===x+1&&(R.isExpanded=w)}for(x=0;x<C.length;x++)w=a(f,x),a(p._group,x)!==w&&p.foreachGroups(E);if(p.callBase.apply(this,arguments),f&&h.remoteOperations.paging&&c.reload)return r(p,R=>{var D=u(g,{filter:dt(R.path,{filter:v.filter,group:f}),group:f.slice(R.path.length),select:v.select}),V=u(g,{filter:sd(R.path,{filter:v.filter,group:f},!0),group:f.slice(R.path.length-1,R.path.length),select:v.select});return P(V,D).done((F,B)=>{F=parseInt(F.length?F[0]:F),B=parseInt(B.length?B[0]:B),R.offset=F,R.count!==B&&(R.count=B,p.updateTotalItemsCount(h))})},!0)}}}()),ji=function(r,e){var t=new O,i=S({skip:0,take:1,requireTotalCount:!0},e);return r.load(i).done((a,n)=>{t.resolve(n&&n.totalCount)}).fail(t.reject.bind(t)),t},Do=ld.inherit(function(){var r=function(n,o,s){return n.foreachGroups(l=>{if(!l.isExpanded)return o(l)},!1,!1,s,!0)},e=function(n,o){var s=0,l=o||0;return o&&(r(n,d=>{if(d.offset-s>=o)return!1;s+=d.count-1}),l+=s),l},t=function(n,o){if(n.length!==o.length)return!1;for(var s=0;s<n.length;s++)if(!dh(null,n[s],o[s]))return!1;return!0},i=function n(o,s,l,d,u){if(s){for(var h=0;h<s.length;h++){var c=s[h];if("key"in c&&c.items!==void 0){l.push(c.key),u&&t(u.path,l)&&!c.isContinuation&&(u.offset=d);var p=o.findGroupInfo(l);p&&!c.isContinuation&&(p.offset=d),p&&!p.isExpanded?d+=p.count:d=n(o,c.items,l,d,u),l.pop()}else d++}return d}},a=function n(o,s){var l=o.count||o.items.length;if(!o.count&&s>1){l=0;for(var d=0;d<o.items.length;d++)l+=n(o.items[d],s-1)}return l};return{handleDataLoading(n){var{storeLoadOptions:o}=n,s=[],l=0,d=!1,u,{group:h}=n.loadOptions,c=0;if(function(g,v){if(v.group){var f=A.normalizeSortingInfo(v.group),C=A.normalizeSortingInfo(g.sort);g.sort=li.arrangeSortingInfo(f,C),delete v.group}}(o,n.loadOptions),n.group=n.group||h,!n.isCustomLoading){var p=S({},o);p.skip=e(this,o.skip),p.skip&&p.take&&h&&(p.skip--,p.take++,d=!0),p.take&&h&&(u=p.take,p.take++),r(this,g=>{if(g.offset>=p.skip+p.take+c)return!1;g.offset>=p.skip+c&&g.count&&(c+=g.count-1,s.push(g),l+=g.count)}),T(s,function(){p.filter=function(g,v,f){for(var C=A.normalizeSortingInfo(f||v.group),w=[],x=0;x<g.length;x++){for(var E=[],R=0;R<=x;R++)E.push([C[R].selector,x===R?"<>":"=",g[R]]);w.push(A.combineFilters(E))}return w=A.combineFilters(w,"or"),A.combineFilters([w,v.filter])}(this.path,p,h)}),n.storeLoadOptions=p,n.collapsedGroups=s,n.collapsedItemsCount=l,n.skip=p.skip||0,n.skipFirstItem=d,n.take=u}},handleDataLoaded(n,o){var{collapsedGroups:s}=n,l=A.normalizeSortingInfo(n.group),d=l.length;function u(g,v,f,C,w){if(!(!g||!v.length||!f.length)){var x,E,R=Me(v[0],!0);for(E=0;E<g.length&&(x=Me(g[E].key,!0),!(w>=C.offset||R===x));E++)w+=a(g[E],f.length);(!g.length||R!==x)&&g.splice(E,0,{key:v[0],items:[],count:v.length===1?C.count:void 0}),u(g[E].items,v.slice(1),f.slice(1),C,w)}}if(n.collapsedItemsCount&&n.extra&&n.extra.totalCount>=0&&(n.extra._totalCountWasIncreasedByCollapsedItems||(n.extra.totalCount+=n.collapsedItemsCount,n.extra._totalCountWasIncreasedByCollapsedItems=!0)),o(n),d){var{data:h}=n,c=Er(h);if(li.multiLevelGroup(c,l).enumerate().done(g=>{h=g}),s)for(var p=0;p<s.length;p++)u(h,s[p].path,l,s[p],n.skip);n.isCustomLoading||function g(v,f,C,w,x,E){for(var R=0,D=!1,V=0;V<f.length;V++){var F=f[V];if(F.items!==void 0){C.push(F.key);var B=v.findGroupInfo(C);if(B&&!B.isExpanded)F.collapsedItems=F.items,F.items=null,w+=B.count,E--,E<0&&R++,x&&(D=!0);else if(F.items){var k=g(v,F.items,C,w,x,E);x&&(k.offset-w>1?F.isContinuation=!0:D=!0),w=k.offset,E=k.take,E<0&&(F.items.length?F.isContinuationOnNextPage=!0:R++)}C.pop()}else x&&(D=!0),w++,E--,E<0&&R++;x=!1}return D&&f.splice(0,1),R&&f.splice(-R,R),{offset:w,take:E}}(this,h,[],n.skip,n.skipFirstItem,n.take),n.data=h}},isGroupItemCountable:n=>n.items===null,updateTotalItemsCount(){var n=0;r(this,o=>{o.count&&(n-=o.count-1)}),this.callBase(n)},changeRowExpand(n){var o=this,s=o._dataSource,l=s.beginPageIndex?s.beginPageIndex():s.pageIndex(),d=s.items(),u=e(o,l*s.pageSize()),h=o.findGroupInfo(n),c;return h&&!h.isExpanded?c=new O().resolve(h.count):c=ji(s,{filter:dt(n,{filter:s.filter(),group:s.group()})}),P(c).done(p=>{p=parseInt(p.length?p[0]:p),h?(i(o,d,[],u),h.isExpanded=!h.isExpanded,h.count=p):(h={offset:-1,count:p,path:n,isExpanded:!1},i(o,d,[],u,h),h.offset>=0&&o.addGroupInfo(h)),o.updateTotalItemsCount()}).fail(function(){s._eventsStrategy.fireEvent("loadError",arguments)})},allowCollapseAll:()=>!1,refresh(n,o){var s=this,{storeLoadOptions:l}=n,d=s._dataSource;if(this.callBase.apply(this,arguments),o.reload)return r(s,u=>{var h=ji(d,{filter:dt(u.path,l)}),c=ji(d,{filter:sd(u.path,l)});return P(c,h).done((p,g)=>{p=parseInt(p.length?p[0]:p),g=parseInt(g.length?g[0]:g),u.offset=p,u.count!==g&&(u.count=g,s.updateTotalItemsCount())})},!0)}}}()),Yi="dx-datagrid-group-panel",Mg="dx-group-panel-message",Fr="dx-group-panel-item",Vo="dx-toolbar-label",Ng="dx-toolbar-item",zg="dx-datagrid-expand",Hg="dx-group-row",Wg=".dx-header-filter",Gg={init(){this.callBase.apply(this,arguments),this._initGroupingHelper()},_initGroupingHelper(r){var e=this._grouping,t=this.option("grouping.autoExpandAll"),i=this.option("focusedRowEnabled"),a=r?r.remoteOperations:this.remoteOperations(),n=a.filtering&&a.sorting&&a.paging;n&&!a.grouping&&(t||!i)?(!e||e instanceof Ao)&&(this._grouping=new Do(this)):(!e||e instanceof Do)&&(this._grouping=new Ao(this))},totalItemsCount(){var r=this.callBase();return r>0&&this._dataSource.group()&&this._dataSource.requireTotalCount()?r+this._grouping.totalCountCorrection():r},itemsCount(){return this._dataSource.group()?this._grouping.itemsCount()||0:this.callBase.apply(this,arguments)},allowCollapseAll(){return this._grouping.allowCollapseAll()},isGroupItemCountable(r){return this._grouping.isGroupItemCountable(r)},isRowExpanded(r){var e=this._grouping.findGroupInfo(r);return e?e.isExpanded:!this._grouping.allowCollapseAll()},collapseAll(r){return this._collapseExpandAll(r,!1)},expandAll(r){return this._collapseExpandAll(r,!0)},_collapseExpandAll(r,e){var t=this._dataSource,i=t.group(),a=A.normalizeSortingInfo(i||[]);if(a.length){for(var n=0;n<a.length;n++)r===void 0||r===n?a[n].isExpanded=e:i&&i[n]&&(a[n].isExpanded=i[n].isExpanded);t.group(a),this._grouping.foreachGroups((o,s)=>{(r===void 0||r===s.length-1)&&(o.isExpanded=e)},!1,!0),this.resetPagesCache()}return!0},refresh(){return this.callBase.apply(this,arguments),this._grouping.refresh.apply(this._grouping,arguments)},changeRowExpand(r){var e=this._dataSource;if(e.group())return e.beginLoading(),this._lastLoadOptions&&(this._lastLoadOptions.groupExpand=!0),this._changeRowExpandCore(r).always(()=>{e.endLoading()})},_changeRowExpandCore(r){return this._grouping.changeRowExpand(r)},_hasGroupLevelsExpandState(r,e){if(r&&Array.isArray(r)){for(var t=0;t<r.length;t++)if(r[t].isExpanded===e)return!0}},_customizeRemoteOperations(r,e){var{remoteOperations:t}=r;r.storeLoadOptions.group?(t.grouping&&!r.isCustomLoading&&(!t.groupPaging||this._hasGroupLevelsExpandState(r.storeLoadOptions.group,!0))&&(t.paging=!1),!t.grouping&&(!t.sorting||!t.filtering||r.isCustomLoading||this._hasGroupLevelsExpandState(r.storeLoadOptions.group,!1))&&(t.paging=!1)):!r.isCustomLoading&&t.paging&&e.grouping&&this.resetCache(),this.callBase.apply(this,arguments)},_handleDataLoading(r){return this.callBase(r),this._initGroupingHelper(r),this._grouping.handleDataLoading(r)},_handleDataLoaded(r){return this._grouping.handleDataLoaded(r,this.callBase.bind(this))},_handleDataLoadedCore(r){return this._grouping.handleDataLoadedCore(r,this.callBase.bind(this))}};Ir.extend(Gg);var Kg={init(){this.callBase(),this.createAction("onRowExpanding"),this.createAction("onRowExpanded"),this.createAction("onRowCollapsing"),this.createAction("onRowCollapsed")},_beforeProcessItems(r){var e=this._columnsController.getGroupColumns();return r=this.callBase(r),r.length&&e.length&&(r=this._processGroupItems(r,e.length)),r},_processItem(r,e){return _(r.groupIndex)&&G(r.rowType)&&r.rowType.indexOf("group")===0?(r=this._processGroupItem(r,e),e.dataIndex=0):r=this.callBase.apply(this,arguments),r},_processGroupItem:r=>r,_processGroupItems(r,e,t){var i=this._columnsController.getGroupColumns(),a=i[i.length-e];if(!t){var n=this.option("scrolling.mode");t={collectContinuationItems:n!=="virtual"&&n!=="infinite",resultItems:[],path:[],values:[]}}var{resultItems:o}=t;if(t.data&&(t.collectContinuationItems||!t.data.isContinuation)&&o.push({rowType:"group",data:t.data,groupIndex:t.path.length-1,isExpanded:!!t.data.items,key:t.path.slice(0),values:t.values.slice(0)}),r)if(e===0)o.push.apply(o,r);else for(var s=0;s<r.length;s++){var l=r[s];l&&"items"in l?(t.data=l,t.path.push(l.key),t.values.push(a&&a.deserializeValue&&!a.calculateDisplayValue?a.deserializeValue(l.key):l.key),this._processGroupItems(l.items,e-1,t),t.data=void 0,t.path.pop(),t.values.pop()):o.push(l)}return o},publicMethods(){return this.callBase().concat(["collapseAll","expandAll","isRowExpanded","expandRow","collapseRow"])},collapseAll(r){var e=this._dataSource;e&&e.collapseAll(r)&&(e.pageIndex(0),e.reload())},expandAll(r){var e=this._dataSource;e&&e.expandAll(r)&&(e.pageIndex(0),e.reload())},changeRowExpand(r){var e=this,t=e.isRowExpanded(r),i={key:r,expanded:t};return e.executeAction(t?"onRowCollapsing":"onRowExpanding",i),i.cancel?new O().resolve():P(e._changeRowExpandCore(r)).done(()=>{i.expanded=!t,e.executeAction(t?"onRowCollapsed":"onRowExpanded",i)})},_changeRowExpandCore(r){var e=this,t=this._dataSource,i=new O;return t?P(t.changeRowExpand(r)).done(()=>{e.load().done(i.resolve).fail(i.reject)}).fail(i.reject):i.resolve(),i},isRowExpanded(r){var e=this._dataSource;return e&&e.isRowExpanded(r)},expandRow(r){return this.isRowExpanded(r)?new O().resolve():this.changeRowExpand(r)},collapseRow(r){return this.isRowExpanded(r)?this.changeRowExpand(r):new O().resolve()},optionChanged(r){r.name==="grouping"&&(r.name="dataSource"),this.callBase(r)}},hn=function(r,e){var t=this._columnsController;switch(e.itemData.value){case"group":var i=t._dataSource.group()||[];t.columnOption(r.dataField,"groupIndex",i.length);break;case"ungroup":t.columnOption(r.dataField,"groupIndex",-1);break;case"ungroupAll":this.component.clearGrouping()}},dd=r=>{var e=r==null?void 0:r.visible;return e==="auto"?_e.current().deviceType==="desktop":!!e},ud=(r,e)=>{var t=dd(r),i=(r==null?void 0:r.allowColumnDragging)&&e.allowGrouping;return t&&!!i},Ug={_getToolbarItems(){var r=this.callBase();return this._appendGroupingItem(r)},_appendGroupingItem(r){if(this._isGroupPanelVisible()){var e=!1,t={template:()=>{var i=m("<div>").addClass(Yi);return this._updateGroupPanelContent(i),tr("groupPanel",this,i,void 0,this._handleActionKeyDown.bind(this)),i},name:"groupPanel",onItemRendered:()=>{e&&this.renderCompleted.fire(),e=!0},location:"before",locateInMenu:"never",sortIndex:1};r.push(t),this.updateToolbarDimensions()}return r},_handleActionKeyDown(r){var{event:e}=r,t=m(e.target),i=t.closest(".".concat(Fr)).index(),a=this._columnsController.getGroupColumns()[i],n=a&&a.index;t.is(Wg)?this.getController("headerFilter").showHeaderFilterMenu(n,!0):this._processGroupItemAction(n),e.preventDefault()},_isGroupPanelVisible(){return dd(this.option("groupPanel"))},_renderGroupPanelItems(r,e){var t=this;r.empty(),T(e,(i,a)=>{t._createGroupPanelItem(r,a)}),nn(this)},_createGroupPanelItem(r,e){var t=m("<div>").addClass(e.cssClass).addClass(Fr).data("columnData",e).appendTo(r).text(e.caption);return Hh(this,t),t},_columnOptionChanged(r){if(!this._requireReady&&!A.checkChanges(r.optionNames,["width","visibleWidth"])){var e=this.element(),t=e&&e.find(".".concat(Yi));t&&t.length&&(this._updateGroupPanelContent(t),this.updateToolbarDimensions(),this.renderCompleted.fire())}this.callBase()},_updateGroupPanelContent(r){var e=this.getController("columns").getGroupColumns(),t=this.option("groupPanel");this._renderGroupPanelItems(r,e),t.allowColumnDragging&&!e.length&&(m("<div>").addClass(Mg).text(t.emptyPanelText).appendTo(r),r.closest(".".concat(Ng)).addClass(Vo),r.closest(".".concat(Vo)).css("maxWidth","none"))},allowDragging(r){var e=this.option("groupPanel");return ud(e,r)},getColumnElements(){var r=this.element();return r&&r.find(".".concat(Fr))},getColumns(){return this.getController("columns").getGroupColumns()},getBoundingRect(){var r=this.element();if(r&&r.find(".".concat(Yi)).length){var e=r.offset();return{top:e.top,bottom:e.top+J(r)}}return null},getName:()=>"group",getContextMenuItems(r){var e=this.option("grouping.contextMenuEnabled"),t=m(r.targetElement).closest(".".concat(Fr)),i;if(t.length&&(r.column=t.data("columnData")),e&&r.column){var{column:a}=r,n=_(a.allowGrouping)?a.allowGrouping:!0;if(n){var o=_(a.groupIndex)&&a.groupIndex>-1,s=this.option("grouping.texts"),l=hn.bind(this,a);i=[{text:s.ungroup,value:"ungroup",disabled:!o,onItemClick:l},{text:s.ungroupAll,value:"ungroupAll",onItemClick:l}]}}return i},isVisible(){return this.callBase()||this._isGroupPanelVisible()},hasGroupedColumns(){return this._isGroupPanelVisible()&&!!this.getColumns().length},optionChanged(r){r.name==="groupPanel"?(this._invalidate(),r.handled=!0):this.callBase(r)}},$g={getContextMenuItems(r){var e=this.option("grouping.contextMenuEnabled"),t;if(e&&r.row&&r.row.rowType==="group"){var i=this._columnsController,a=i.columnOption("groupIndex:".concat(r.row.groupIndex));if(a&&a.allowGrouping){var n=this.option("grouping.texts"),o=hn.bind(this,a);t=[],t.push({text:n.ungroup,value:"ungroup",onItemClick:o},{text:n.ungroupAll,value:"ungroupAll",onItemClick:o})}}return t},_rowClick(r){var e=this.option("grouping.expandMode"),t=this.option("scrolling.mode"),i=t!=="infinite"&&e==="rowClick"&&m(r.event.target).closest(".".concat(Hg)).length,a=m(r.event.target).closest(".".concat(zg)).length;(i||a)&&this._changeGroupRowState(r),this.callBase(r)},_changeGroupRowState(r){var e=this.getController("data"),t=e.items()[r.rowIndex],i=this._columnsController.columnOption("groupIndex:".concat(t.groupIndex),"allowCollapsing");(t.rowType==="data"||t.rowType==="group"&&i!==!1)&&(e.changeRowExpand(t.key,!0),r.event.preventDefault(),r.handled=!0)}},qg={getContextMenuItems(r){var e=this.option("grouping.contextMenuEnabled"),t=this.callBase(r);if(e&&r.row&&(r.row.rowType==="header"||r.row.rowType==="detailAdaptive")){var{column:i}=r;if(!i.command&&(!_(i.allowGrouping)||i.allowGrouping)){var a=this.option("grouping.texts"),n=_(i.groupIndex)&&i.groupIndex>-1,o=hn.bind(this,i);t=t||[],t.push({text:a.groupByThisColumn,value:"group",beginGroup:!0,disabled:n,onItemClick:o}),i.showWhenGrouped&&t.push({text:a.ungroup,value:"ungroup",disabled:!n,onItemClick:o}),t.push({text:a.ungroupAll,value:"ungroupAll",onItemClick:o})}}return t},allowDragging(r){var e=this.option("groupPanel");return ud(e,r)||this.callBase(r)}};A.registerModule("grouping",{defaultOptions:()=>({grouping:{autoExpandAll:!0,allowCollapsing:!0,contextMenuEnabled:!1,expandMode:"buttonClick",texts:{groupContinuesMessage:y.format("dxDataGrid-groupContinuesMessage"),groupContinuedMessage:y.format("dxDataGrid-groupContinuedMessage"),groupByThisColumn:y.format("dxDataGrid-groupHeaderText"),ungroup:y.format("dxDataGrid-ungroupHeaderText"),ungroupAll:y.format("dxDataGrid-ungroupAllText")}},groupPanel:{visible:!1,emptyPanelText:y.format("dxDataGrid-groupPanelEmptyText"),allowColumnDragging:!0}}),extenders:{controllers:{data:Kg,columns:{_getExpandColumnOptions(){var r=this.callBase.apply(this,arguments);return r.cellTemplate=A.getExpandCellTemplate(),r}},editing:{_isProcessedItem:r=>_(r.groupIndex)&&G(r.rowType)&&r.rowType.indexOf("group")===0}},views:{headerPanel:Ug,rowsView:$g,columnHeadersView:qg}}});var Xg="dx-master-detail-cell",Fo="dx-master-detail-row",jg="dx-cell-focus-disabled",Yg="dx-row-lines",Qg={defaultOptions:()=>({masterDetail:{enabled:!1,autoExpandAll:!1,template:null}}),extenders:{controllers:{columns:{_getExpandColumnsCore(){var r=this.callBase();return this.option("masterDetail.enabled")&&r.push({type:"detailExpand",cellTemplate:I.getExpandCellTemplate()}),r}},data:function(){var r=function(e){e._expandedItems=[],e._isExpandAll=e.option("masterDetail.autoExpandAll")};return{init(){r(this),this.callBase()},expandAll(e){e<0?(this._isExpandAll=!0,this._expandedItems=[],this.updateItems()):this.callBase.apply(this,arguments)},collapseAll(e){e<0?(this._isExpandAll=!1,this._expandedItems=[],this.updateItems()):this.callBase.apply(this,arguments)},isRowExpanded(e){var t=I.getIndexByKey(e,this._expandedItems);return Array.isArray(e)?this.callBase.apply(this,arguments):!!(this._isExpandAll^(t>=0&&this._expandedItems[t].visible))},_getRowIndicesForExpand(e){var t=this.getRowIndexByKey(e);return[t,t+1]},_changeRowExpandCore(e){var t;if(Array.isArray(e))t=this.callBase.apply(this,arguments);else{var i=I.getIndexByKey(e,this._expandedItems);if(i>=0){var{visible:a}=this._expandedItems[i];this._expandedItems[i].visible=!a}else this._expandedItems.push({key:e,visible:!0});this.updateItems({changeType:"update",rowIndices:this._getRowIndicesForExpand(e)}),t=new O().resolve()}return t},_processDataItem(e,t){var i=this.callBase.apply(this,arguments);return i.isExpanded=this.isRowExpanded(i.key),t.detailColumnIndex===void 0&&(t.detailColumnIndex=-1,T(t.visibleColumns,(a,n)=>{if(n.command==="expand"&&!_(n.groupIndex))return t.detailColumnIndex=a,!1})),t.detailColumnIndex>=0&&(i.values[t.detailColumnIndex]=i.isExpanded),i},_processItems(e,t){var i=this,{changeType:a}=t,n=[];return e=i.callBase.apply(i,arguments),a==="loadingAll"?e:(a==="refresh"&&(i._expandedItems=xl(i._expandedItems,o=>o.visible)),T(e,(o,s)=>{n.push(s);var l=I.getIndexByKey(s.key,i._expandedItems);s.rowType==="data"&&(s.isExpanded||l>=0)&&!s.isNewRow&&n.push({visible:s.isExpanded,rowType:"detail",key:s.key,data:s.data,values:[]})}),n)},optionChanged(e){var t,i;if(e.name==="masterDetail"){switch(e.name="dataSource",e.fullName){case"masterDetail":var a=e.value||{},n=e.previousValue||{};t=a.enabled!==n.enabled,i=a.autoExpandAll!==n.autoExpandAll;break;case"masterDetail.template":r(this);break;case"masterDetail.enabled":t=!0;break;case"masterDetail.autoExpandAll":i=!0}(t||i)&&r(this)}this.callBase(e)}}}(),resizing:{fireContentReadyAction(){this.callBase.apply(this,arguments),this._updateParentDataGrids(this.component.$element())},_updateParentDataGrids(r){var e=r.closest(".".concat(Fo));e.length&&P(this._updateMasterDataGrid(e,r)).done(()=>{this._updateParentDataGrids(e.parent())})},_updateMasterDataGrid(r,e){var t=m(r).data("options"),i=m(r).closest(".".concat(this.getWidgetContainerClass())).parent().data("dxDataGrid");if(t&&i)return this._updateMasterDataGridCore(i,t)},_updateMasterDataGridCore(r,e){var t=O();if(r.getView("rowsView").isFixedColumns())this._updateFixedMasterDetailGrids(r,e.rowIndex,m(e.rowElement)).done(t.resolve);else{if(r.option("scrolling.useNative")===!0){r.updateDimensions().done(()=>t.resolve(!0));return}var i=r.getScrollable();i?i==null||i.update().done(()=>t.resolve()):t.resolve()}return t.promise()},_updateFixedMasterDetailGrids(r,e,t){var i=O(),a=m(r.getRowElement(e)),n=m(r.getView("rowsView").getTableElements()),o=(a==null?void 0:a.length)===2&&J(a.eq(0))!==J(a.eq(1)),s=(n==null?void 0:n.length)===2&&J(n.eq(0))!==J(n.eq(1));if(o||s){var l=X(t);return r.updateDimensions().done(()=>{var d=this.option("columnAutoWidth")&&r.option("scrolling.useNative")===!0,u=d&&l!==X(t);d&&u?this.updateDimensions().done(()=>i.resolve(!0)):i.resolve(!0)}),i.promise()}return O().resolve()},_toggleBestFitMode(r){if(this.callBase.apply(this,arguments),this.option("masterDetail.template")){var e=this._rowsView.getTableElement();e&&e.find(".dx-master-detail-cell").css("maxWidth",r?0:"")}}}},views:{rowsView:{_getCellTemplate(r){var{column:e}=r,t=this.getController("editing"),i=t&&t.isEditRow(r.rowIndex),a;return e.command==="detail"&&!i?a=this.option("masterDetail.template")||{allowRenderToDetachedContainer:!1,render:this._getDefaultTemplate(e)}:a=this.callBase.apply(this,arguments),a},_isDetailRow:r=>r&&r.rowType&&r.rowType.indexOf("detail")===0,_createRow(r){var e=this.callBase.apply(this,arguments);return r&&this._isDetailRow(r)&&(this.option("showRowLines")&&e.addClass(Yg),e.addClass(Fo),_(r.visible)&&e.toggle(r.visible)),e},_renderCells(r,e){var{row:t}=e,i,a=this._columnsController.getVisibleColumns();t.rowType&&this._isDetailRow(t)?this._needRenderCell(0,e.columnIndices)&&(i=this._renderCell(r,{value:null,row:t,rowIndex:t.rowIndex,column:{command:"detail"},columnIndex:0,change:e.change}),i.addClass(jg).addClass(Xg).attr("colSpan",a.length)):this.callBase.apply(this,arguments)}}}}};A.registerModule("masterDetail",Qg);var{isWrapped:Jg}=yi,Zg="checkbox-size",ev="dx-editor-inline-block",hd=function(){var r=function(u,h){return S(u,{readOnly:h.readOnly,placeholder:h.placeholder,inputAttr:{id:h.id,"aria-labelledby":h["aria-labelledby"]},tabIndex:h.tabIndex},h.editorOptions)},e=function(){return te.mozilla||_e.real().ios},t=function(u){var h={},c=e(),p=u.sharedData||h;return r({placeholder:u.placeholder,width:u.width,value:u.value,onValueChanged:function(g){var v=u.parentType==="filterRow"||u.parentType==="searchPanel",f=g.event&&(g.event.type==="input"||g.event.type==="keyup"),C=function(w,x){u&&u.setValue(w.value,x)};clearTimeout(h.valueChangeTimeout),f&&v?p.valueChangeTimeout=h.valueChangeTimeout=setTimeout(function(){C(g,h.valueChangeTimeout!==p.valueChangeTimeout)},_(u.updateValueTimeout)?u.updateValueTimeout:0):C(g)},onKeyDown:function(g){c&&Ie(g.event)==="enter"&&b.trigger(m(g.component._input()),"change")},valueChangeEvent:"change"+(u.parentType==="filterRow"?" keyup input":"")},u)},i=function(u){u.editorName="dxDateBox",u.editorOptions=r({value:u.value,onValueChanged:function(h){u.setValue(h.value)},onKeyDown:function(h){var{component:c,event:p}=h,g=c.option("useMaskBehavior");(e()||g)&&Ie(p)==="enter"&&(c.blur(),c.focus())},displayFormat:u.format,type:u.dataType,dateSerializationFormat:null,width:u.parentType==="filterBuilder"?void 0:"auto"},u)},a=function(u){var h=t(u),c=u.parentType==="searchPanel";u.editorType&&u.editorType!=="dxTextBox"?h.value=u.value:h.value=(p=u.value,_(p)?p.toString():"");var p;h.valueChangeEvent+=c?" keyup input search":"",h.mode=h.mode||(c?"search":"text"),u.editorName="dxTextBox",u.editorOptions=h},n=function(u){var h=t(u);h.value=_(u.value)?u.value:null,u.editorName="dxNumberBox",u.editorOptions=h};function o(u){var h=u.lookup,c,p,g,v=u.parentType==="filterRow";if(h){var f;c=de(h.displayExpr),p=h.dataSource,H(p)&&!Jg(p)&&(p=p(u.row||{}),function(w){if(w.row&&w.row.watch&&w.parentType==="dataRow"){var x=w.editorOptions||{};w.editorOptions=x;var E,R=x.onInitialized;x.onInitialized=function(F){R&&R.apply(this,arguments),E=F.component,E.on("disposing",V)};var D,V=w.row.watch(()=>(D=w.lookup.dataSource(w.row),D&&D.filter),()=>{E.option("dataSource",D)},F=>{w.row=F})}}(u)),(Q(p)||Array.isArray(p))&&(p=Ei(p),v&&(g=p.postProcess,p.postProcess=function(w){return this.pageIndex()===0&&(w=w.slice(0),w.unshift(null)),g?g.call(this,w):w}));var C=!!(h.allowClearing&&!v);u.editorName=(f=u.editorType)!==null&&f!==void 0?f:"dxSelectBox",u.editorOptions=r({searchEnabled:!0,value:u.value,valueExpr:u.lookup.valueExpr,searchExpr:u.lookup.searchExpr||u.lookup.displayExpr,allowClearing:C,showClearButton:C,displayExpr:function(w){return w===null?u.showAllText:c(w)},dataSource:p,onValueChanged:function(w){var x=[w.value];!v&&x.push(w.component.option("text")),u.setValue.apply(this,x)}},u)}}function s(u){u.editorName="dxCheckBox",u.editorOptions=r({elementAttr:{id:u.id},value:_(u.value)?u.value:void 0,hoverStateEnabled:!u.readOnly,focusStateEnabled:!u.readOnly,activeStateEnabled:!1,onValueChanged:function(h){u.setValue&&u.setValue(h.value,h)}},u)}var l=u=>{u.editorName=u.editorType,u.editorOptions=r({value:u.value,onValueChanged:function(h){u.setValue(h.value)}},u)},d=u=>{var h={dxDateBox:i,dxCheckBox:s,dxNumberBox:n,dxTextBox:a};if(u.lookup)o(u);else if(u.editorType){var c;((c=h[u.editorType])!==null&&c!==void 0?c:l)(u)}else switch(u.dataType){case"date":case"datetime":i(u);break;case"boolean":(function(p){p.parentType==="filterRow"||p.parentType==="filterBuilder"?o(S(p,{lookup:{displayExpr:function(g){if(g===!0)return p.trueText||"true";if(g===!1)return p.falseText||"false"},dataSource:[!0,!1]}})):s(p)})(u);break;case"number":n(u);break;default:a(u)}};return{createEditor:function(u,h){h.cancel=!1,h.editorElement=be(u),_(h.tabIndex)||(h.tabIndex=this.option("tabIndex")),d(h),this.executeAction("onEditorPreparing",h),!h.cancel&&(h.parentType==="dataRow"&&!h.isOnForm&&!_(h.editorOptions.showValidationMark)&&(h.editorOptions.showValidationMark=!1),function(c,p){var g=m(p.editorElement);if(p.editorName&&p.editorOptions&&g[p.editorName]){if((p.editorName==="dxCheckBox"||p.editorName==="dxSwitch")&&(p.isOnForm||(g.addClass(c.addWidgetPrefix(Zg)),g.parent().addClass(ev))),c._createComponent(g,p.editorName,p.editorOptions),p.editorName==="dxDateBox"){var v=g.dxDateBox("instance"),f=v._supportedKeys().enter;v.registerKeyHandler("enter",C=>(v.option("opened")&&f(C),!0))}p.editorName==="dxTextArea"&&g.dxTextArea("instance").registerKeyHandler("enter",function(C){Ie(C)==="enter"&&!C.ctrlKey&&!C.shiftKey&&C.stopPropagation()})}}(this,h),this.executeAction("onEditorPrepared",h))}}}(),tv="dx-editor-inline-block",Qi="dx-cell-focus-disabled",Po="focus-overlay",rv="content",Ji="dx-focused",iv="dx-row",cd="dxDataGridEditorFactory",Bo=$([Y.down,"focusin",re].join(" "),cd),Zi="dx-hidden",av=W.ViewController.inherit(hd);let nv=class extends av{_getFocusedElement(e){var t=this.option("focusedRowEnabled")?"tr[tabindex]:focus":"tr[tabindex]:not(.dx-data-row):focus",i="td[tabindex]:focus, ".concat(t,", input:focus, textarea:focus, .dx-lookup-field:focus, .dx-checkbox:focus, .dx-switch:focus, .dx-dropdownbutton .dx-buttongroup:focus, .dx-adaptive-item-text:focus"),a=e.find(i);return this.elementIsInsideGrid(a)&&a}_getFocusCellSelector(){return".dx-row > td"}_updateFocusCore(){var e=this.component&&this.component.$element();if(e){var t=this._getFocusedElement(e);if(t&&t.length){var i;if(!t.hasClass(Qi)&&!t.hasClass(iv)){var a=t.closest("".concat(this._getFocusCellSelector(),", .").concat(Qi));a.get(0)!==t.get(0)&&(i=this._needHideBorder(a),t=a)}if(t.length&&!t.hasClass(Qi)){this.focus(t,i);return}}}this.loseFocus()}_needHideBorder(e){return e.hasClass(tv)}_updateFocus(e){var t=this,i=e&&e.event&&m(e.event.target).hasClass(t.addWidgetPrefix(Po));t._isFocusOverlay=t._isFocusOverlay||i,clearTimeout(t._updateFocusTimeoutID),t._updateFocusTimeoutID=setTimeout(()=>{delete t._updateFocusTimeoutID,t._isFocusOverlay||t._updateFocusCore(),t._isFocusOverlay=!1})}_updateFocusOverlaySize(e,t){e.hide();var i=Ra.calculate(e,S({collision:"fit"},t));i.h.oversize>0&&bn(e,Te(e)-i.h.oversize),i.v.oversize>0&&In(e,le(e)-i.v.oversize),e.show()}callbackNames(){return["focused"]}focus(e,t){var i=this;if(e===void 0)return i._$focusedElement;e&&(e.is(i._$focusedElement)||i._$focusedElement&&i._$focusedElement.removeClass(Ji),i._$focusedElement=e,clearTimeout(i._focusTimeoutID),i._focusTimeoutID=setTimeout(()=>{delete i._focusTimeoutID,i.renderFocusOverlay(e,t),e.addClass(Ji),i.focused.fire(e)}))}refocus(){var e=this.focus();this.focus(e)}renderFocusOverlay(e,t){if(I.isElementInCurrentGrid(this,e)){if(this._$focusOverlay||(this._$focusOverlay=m("<div>").addClass(this.addWidgetPrefix(Po))),t)this._$focusOverlay.addClass(Zi);else if(e.length){var i=te.mozilla?"right bottom":"left top",a=e.closest(".".concat(this.addWidgetPrefix(rv))),n=Ee(e.get(0));this._$focusOverlay.removeClass(Zi).appendTo(a),In(this._$focusOverlay,n.bottom-n.top+1),bn(this._$focusOverlay,n.right-n.left+1);var o={precise:!0,my:i,at:i,of:e,boundary:a.length&&a};this._updateFocusOverlaySize(this._$focusOverlay,o),Ra.setup(this._$focusOverlay,o),this._$focusOverlay.css("visibility","visible")}}}resize(){var e=this._$focusedElement;e&&this.focus(e)}loseFocus(){this._$focusedElement&&this._$focusedElement.removeClass(Ji),this._$focusedElement=null,this._$focusOverlay&&this._$focusOverlay.addClass(Zi)}init(){this.createAction("onEditorPreparing",{excludeValidators:["disabled","readOnly"],category:"rendering"}),this.createAction("onEditorPrepared",{excludeValidators:["disabled","readOnly"],category:"rendering"}),this._updateFocusHandler=this._updateFocusHandler||this.createAction(this._updateFocus.bind(this)),this._subscribedContainerRoot=this._getContainerRoot(),b.on(this._subscribedContainerRoot,Bo,this._updateFocusHandler),this._attachContainerEventHandlers()}_getContainerRoot(){var e,t=(e=this.component)===null||e===void 0?void 0:e.$element(),i=z.getRootNode(t==null?void 0:t.get(0));return i.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&!i.host?z.getDocument():i}_attachContainerEventHandlers(){var e=this,t=e.component&&e.component.$element();t&&b.on(t,$("keydown",cd),i=>{Ie(i)==="tab"&&e._updateFocusHandler(i)})}dispose(){clearTimeout(this._focusTimeoutID),clearTimeout(this._updateFocusTimeoutID),b.off(this._subscribedContainerRoot,Bo,this._updateFocusHandler)}};var ov={defaultOptions:()=>({}),controllers:{editorFactory:nv}};A.registerModule("editorFactory",ov);var Pr=ne(),sv={text:"OK",onClick:function(){return!0}},ft="dx-dialog",lv="".concat(ft,"-wrapper"),dv="".concat(ft,"-root"),uv="".concat(ft,"-content"),hv="".concat(ft,"-message"),cv="".concat(ft,"-buttons"),pv="".concat(ft,"-button"),Lo="dx-button",gv=function(r){var e,t=new O;r=r||{};var i=m("<div>").addClass(ft).appendTo(Gu()),a="message"in r,n="messageHtml"in r;a&&q.log("W1013");var o=String(n?r.messageHtml:r.message),s=r.title?null:new Lt,l=m("<div>").addClass(hv).html(o).attr("id",s),d=[];T(r.buttons||[sv],function(){var c=new Ku(this.onClick,{context:u});d.push({toolbar:"bottom",location:_e.current().android?"after":"center",widget:"dxButton",options:S({},this,{onClick:function(){var p=c.execute(...arguments);h(p)}})})});var u=new vt(i,S({title:(e=r.title)!==null&&e!==void 0?e:"",showTitle:Da(r.showTitle,!0),dragEnabled:Da(r.dragEnabled,!0),height:"auto",width:r.width,showCloseButton:r.showCloseButton||!1,ignoreChildEvents:!1,container:i,visualContainer:Pr,dragAndResizeArea:Pr,onContentReady:function(c){c.component.$content().addClass(uv).append(l),s&&c.component.$overlayContent().attr("aria-labelledby",s)},onShowing:function(c){c.component.bottomToolbar().addClass(cv).find(".".concat(Lo)).addClass(pv),_l()},onShown:function(c){var p=c.component.bottomToolbar().find(".".concat(Lo)).first();b.trigger(p,"focus")},onHiding:function(){t.reject()},onHidden:function(c){var{element:p}=c;m(p).remove()},toolbarItems:d,animation:{show:{type:"pop",duration:400},hide:{type:"pop",duration:400,to:{opacity:0,scale:0},from:{opacity:1,scale:1}}},rtlEnabled:yl().rtlEnabled,position:{boundaryOffset:{h:10,v:0}}},r.popupOptions));u.$wrapper().addClass(lv),r.position&&u.option("position",r.position),u.$wrapper().addClass(dv);function h(c){t.resolve(c),u.hide()}return{show:function(){if(_e.real().deviceType==="phone"){var c=J(Pr)>X(Pr),p=c?"90%":"60%";u.option({width:p})}return u.show(),t.promise()},hide:h}},vv=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",t=arguments.length>2?arguments[2]:void 0,i=He(r)?r:{title:e,messageHtml:r,showTitle:t,buttons:[{text:y.format("Yes"),onClick:function(){return!0}},{text:y.format("No"),onClick:function(){return!1}}],dragEnabled:t};return gv(i).show()},Ti="dx-editor-cell",$e="dx-row",fv="dx-cell-modified",ko="dx-selection",pi="edit-form",Oe="insert",Be="remove",Yr="editing.popup",ea="editing.form",ve="editing.editRowKey",ut="editing.editColumnName",pd="targetComponent",gd="input:not([type='hidden'])",cn="[tabindex]:not([disabled]), ".concat(gd,":not([disabled])"),Vt="batch",Qe="row",gr="cell",Mt="form",pn="popup",Mo="first",Br="last",No="pageBottom",ta="pageTop",zo="viewportBottom",vd="viewportTop",mv=[Vt,Qe,gr,Mt,pn],_v=[Qe,Mt,pn],Cv=[Vt,Qe,gr],wv=[Qe,Mt],xv="readonly",yv="dx-link",Ev="dx-link-icon",Sv="dx-selection",bv="dx-edit-button",fd="dx-command-edit",Ho="".concat(fd,"-with-icons"),Ke="__DX_INSERT_INDEX__",Iv="dx-row-inserted",Tv="dx-row-modified",Wo="dx-cell-modified",Rv="dxDataGridEditing",Ov="dx-cell-focus-disabled",Ut="update",Av="click",Dv={save:"dx-link-save",cancel:"dx-link-cancel",edit:"dx-link-edit",undelete:"dx-link-undelete",delete:"dx-link-delete",add:"dx-link-add"},Vv={save:"save",cancel:"revert",edit:"edit",undelete:"revert",delete:"trash",add:"add"},Fv={edit:"editRow",delete:"deleteRow",undelete:"undeleteRow",save:"saveEditData",cancel:"cancelEditData",add:"addRowByRowIndex"},Pv={add:"allowAdding",edit:"allowUpdating",delete:"allowDeleting"},Bv=["edit","save","cancel","delete","undelete"],Le="editing.changes",Lv="focus-overlay",kv="addrow-button",Mv="dx-dropdowneditor-overlay",Nv="dx-data-row",zv="dx-row-removed",Hv=!!Rt.IS_RENOVATED_WIDGET,md="edit-form-item",Wv="edit-popup",Gv="edit-popup-form",Kv=Hv?"dx-scrollable":"dx-scrollable-container",Uv="dx-button",$v="form-buttons-container",Go="dx-edit-row",La="_DX_KEY_",qv=36,Lr=function(r){return function(e){var t=e instanceof Error?e:new Error(e&&String(e)||"Unknown error");r.reject(t)}},_d=function(r,e){return e.isEditing||r&&e.column.allowEditing},Ko=function(r,e){var t=!!e.column.command,i=_d(r,e),a=!t&&(i||e.column.showEditorAlways);return e.rowType==="data"&&a},Xv=r=>{var e=r.component.option("editing.texts")||{};return{save:e.saveRowChanges,cancel:e.cancelRowChanges,edit:e.editRow,undelete:e.undeleteRow,delete:e.deleteRow,add:e.addRowToNode}},jv=()=>"".concat(La).concat(new Lt),Yv=r=>typeof r=="string"&&r.startsWith(La)&&r.length===La.length+qv,Ct=(r,e)=>{var t=-1;return r.some((i,a)=>{if(Cd(i)===e)return t=a,!0}),t};function Cd(r){return Q(r)?r.name:r}function Qv(r){return r&&(r.is("input")||r.is("textarea"))}var Jv=r=>{var e,{column:t}=r;return r.isCustomEditorType?r.editorType:(e=t.formItem)===null||e===void 0?void 0:e.editorType},wd=(r,e)=>{r.forEach(t=>{t.items||t.tabs?wd(t.items||t.tabs,e):e(t)})};class Zv extends W.ViewController{init(){this._columnsController=this.getController("columns"),this._dataController=this.getController("data"),this._rowsView=this.getView("rowsView"),this._lastOperation=null,this._changes=[],this._deferreds&&this._deferreds.forEach(e=>{e.reject("cancel")}),this._deferreds=[],this._dataChangedHandler||(this._dataChangedHandler=this._handleDataChanged.bind(this),this._dataController.changed.add(this._dataChangedHandler)),this._saveEditorHandler||(this.createAction("onInitNewRow",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowInserting",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowInserted",{excludeValidators:["disabled","readOnly"]}),this.createAction("onEditingStart",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowUpdating",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowUpdated",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowRemoving",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowRemoved",{excludeValidators:["disabled","readOnly"]}),this.createAction("onSaved",{excludeValidators:["disabled","readOnly"]}),this.createAction("onSaving",{excludeValidators:["disabled","readOnly"]}),this.createAction("onEditCanceling",{excludeValidators:["disabled","readOnly"]}),this.createAction("onEditCanceled",{excludeValidators:["disabled","readOnly"]})),this._updateEditColumn(),this._updateEditButtons(),this._internalState||(this._internalState=[]),this.component._optionsByReference[ve]=!0,this.component._optionsByReference[Le]=!0}getEditMode(){var e=this.option("editing.mode");return mv.includes(e)?e:Qe}_getDefaultEditorTemplate(){return(e,t)=>{var i=m("<div>").appendTo(e),a=S({},t.column,{value:t.value,setValue:t.setValue,row:t.row,parentType:"dataRow",width:null,readOnly:!t.setValue,isOnForm:t.isOnForm,id:t.id}),n=Cv.includes(this.getEditMode());n&&(a["aria-labelledby"]=t.column.headerId),this.getController("editorFactory").createEditor(i,a)}}_getNewRowPosition(){var e=this.option("editing.newRowPosition"),t=this.option("scrolling.mode");if(t==="virtual")switch(e){case ta:return vd;case No:return zo;default:return e}return e}getChanges(){return this.option(Le)}getInsertRowCount(){var e=this.option(Le);return e.filter(t=>t.type==="insert").length}resetChanges(){var e=this.getChanges(),t=e==null?void 0:e.length;t&&this._silentOption(Le,[])}_getInternalData(e){return this._internalState.filter(t=>U(t.key,e))[0]}_addInternalData(e){var t=this._getInternalData(e.key);return t?S(t,e):(this._internalState.push(e),e)}_getOldData(e){var t;return(t=this._getInternalData(e))===null||t===void 0?void 0:t.oldData}getUpdatedData(e){var t=this._dataController.keyOf(e),i=this.getChanges(),a=I.getIndexByKey(t,i);return i[a]?st(e,i[a].data):e}getInsertedData(){return this.getChanges().filter(e=>e.data&&e.type===Oe).map(e=>e.data)}getRemovedData(){return this.getChanges().filter(e=>this._getOldData(e.key)&&e.type===Be).map(e=>this._getOldData(e.key))}_fireDataErrorOccurred(e){if(e!=="cancel"){var t=this.getPopupContent();this._dataController.dataErrorOccurred.fire(e,t)}}_needToCloseEditableCell(e){}_closeEditItem(e){}_handleDataChanged(e){}_isDefaultButtonVisible(e,t){var i=!0;switch(e.name){case"delete":i=this.allowDeleting(t);break;case"undelete":i=!1}return i}_isButtonVisible(e,t){var{visible:i}=e;return _(i)?H(i)?i.call(e,{component:t.component,row:t.row,column:t.column}):i:this._isDefaultButtonVisible(e,t)}_isButtonDisabled(e,t){var{disabled:i}=e;return H(i)?i.call(e,{component:t.component,row:t.row,column:t.column}):!!i}_getButtonConfig(e,t){var i=Q(e)?e:{},a=Cd(e),n=Xv(t),o=Fv[a],s=this.option("editing"),l=Pv[a],d=l?s[l]:!0;return S({name:a,text:n[a],cssClass:Dv[a]},{onClick:o&&(u=>{var{event:h}=u;h.stopPropagation(),h.preventDefault(),setTimeout(()=>{t.row&&d&&this[o]&&this[o](t.row.rowIndex)})})},i)}_getEditingButtons(e){var t,i=!!e.column.buttons,a=(e.column.buttons||[]).slice();return i?(t=Ct(a,"edit"),t>=0&&(Ct(a,"save")<0&&a.splice(t+1,0,"save"),Ct(a,"cancel")<0&&a.splice(Ct(a,"save")+1,0,"cancel")),t=Ct(a,"delete"),t>=0&&Ct(a,"undelete")<0&&a.splice(t+1,0,"undelete")):a=Bv.slice(),a.map(n=>this._getButtonConfig(n,e))}_renderEditingButtons(e,t,i,a){t.forEach(n=>{this._isButtonVisible(n,i)&&this._createButton(e,n,i,a)})}_getEditCommandCellTemplate(){return(e,t,i)=>{var a=m(e);if(t.rowType==="data"){var n=this._getEditingButtons(t);this._renderEditingButtons(a,n,t,i),t.watch&&t.watch(()=>n.map(o=>({visible:this._isButtonVisible(o,t),disabled:this._isButtonDisabled(o,t)})),()=>{a.empty(),this._renderEditingButtons(a,n,t)})}else I.setEmptyText(a)}}isRowBasedEditMode(){var e=this.getEditMode();return _v.includes(e)}getFirstEditableColumnIndex(){var e=this.getController("columns"),t,i=e.getVisibleColumns();return T(i,(a,n)=>{if(n.allowEditing)return t=a,!1}),t}getFirstEditableCellInRow(e){var t=this.getView("rowsView"),i=this.getFirstEditableColumnIndex();return t==null?void 0:t._getCellElement(e||0,i)}getFocusedCellInRow(e){return this.getFirstEditableCellInRow(e)}getIndexByKey(e,t){return I.getIndexByKey(e,t)}hasChanges(e){for(var t=this.getChanges(),i=!1,a=0;a<(t==null?void 0:t.length);a++)if(t[a].type&&(!_(e)||this._dataController.getRowIndexByKey(t[a].key)===e)){i=!0;break}return i}dispose(){super.dispose(),clearTimeout(this._inputFocusTimeoutID),b.off(z.getDocument(),Y.up,this._pointerUpEditorHandler),b.off(z.getDocument(),Y.down,this._pointerDownEditorHandler),b.off(z.getDocument(),re,this._saveEditorHandler)}_silentOption(e,t){e==="editing.changes"&&(this._changes=Ue([],t)),super._silentOption(e,t)}optionChanged(e){if(e.name==="editing"){var{fullName:t}=e;if(t===ve)this._handleEditRowKeyChange(e);else if(t===Le){var i=U(e.value,this._changes,{maxDepth:4});i||(this._changes=Ue([],e.value),this._handleChangesChange(e))}else e.handled||(this._columnsController.reinit(),this.init(),this.resetChanges(),this._resetEditColumnName(),this._resetEditRowKey());e.handled=!0}else super.optionChanged(e)}_handleEditRowKeyChange(e){var t=this._dataController.getRowIndexByKey(e.value),i=this._getEditRowIndexCorrection(),a=this._dataController.getRowIndexByKey(e.previousValue)+i;_(e.value)?e.value!==e.previousValue&&this._editRowFromOptionChanged(t,a):this.cancelEditData()}_handleChangesChange(e){var t=this._dataController,i=e.value;!e.value.length&&!e.previousValue.length||(i.forEach(a=>{var n;if(a.type==="insert")this._addInsertInfo(a);else{var o=t.getCachedStoreData()||((n=t.items())===null||n===void 0?void 0:n.map(l=>l.data)),s=I.getIndexByKey(a.key,o,t.key());this._addInternalData({key:a.key,oldData:o[s]})}}),t.updateItems({repaintChangesOnly:!0,isLiveUpdate:!1,isOptionChanged:!0}))}publicMethods(){return["addRow","deleteRow","undeleteRow","editRow","saveEditData","cancelEditData","hasEditData"]}refresh(){_(this._pageIndex)&&this._refreshCore.apply(this,arguments)}_refreshCore(e){}isEditing(){var e=_(this.option(ve));return e}isEditRow(e){return!1}_setEditRowKey(e,t){t?this._silentOption(ve,e):this.option(ve,e),this._refocusEditCell&&(this._refocusEditCell=!1,this._focusEditingCell())}_setEditRowKeyByIndex(e,t){var i=this._dataController.getKeyByRowIndex(e);if(i===void 0){this._dataController.fireError("E1043");return}this._setEditRowKey(i,t)}getEditRowIndex(){return this._getVisibleEditRowIndex()}getEditFormRowIndex(){return-1}isEditRowByIndex(e){var t=this._dataController.getKeyByRowIndex(e),i=_(t)&&U(this.option(ve),t);return i&&this._getVisibleEditRowIndex()===e}isEditCell(e,t){return this.isEditRowByIndex(e)&&this._getVisibleEditColumnIndex()===t}getPopupContent(){}_isProcessedItem(e){return!1}_getInsertRowIndex(e,t,i){var a=-1,n=this._dataController,o=this._getInsertAfterOrBeforeKey(t);return!_(o)&&e.length===0?a=0:_(o)&&e.some((s,l)=>{var d=i||this._isProcessedItem(s);if(Q(s)&&(d||_(s[Ke])?U(s.key,o)&&(a=l):U(n.keyOf(s),o)&&(a=l)),a>=0){var u=e[a+1];return u&&(u.rowType==="detail"||u.rowType==="detailAdaptive")&&_(t.insertAfterKey)?void 0:(_(t.insertAfterKey)&&(a+=1),!0)}}),a}_generateNewItem(e){var t,i={key:e},a=(t=this._getInternalData(e))===null||t===void 0?void 0:t.insertInfo;return a!=null&&a[Ke]&&(i[Ke]=a[Ke]),i}_getLoadedRowIndex(e,t,i){var a=this._getInsertRowIndex(e,t,i),n=this._dataController;if(a<0){var o=this._getNewRowPosition(),s=n.pageIndex(),l=this._getInsertAfterOrBeforeKey(t);o!==Br&&s===0&&!_(l)?a=0:o===Br&&n.isLastPageLoaded()&&(a=e.length)}return a}processItems(e,t){var{changeType:i}=t;this.update(i);var a=this.getChanges();return a.forEach(n=>{var o,s=n.type===Oe;if(s){var{key:l}=n,d=(o=this._getInternalData(l))===null||o===void 0?void 0:o.insertInfo;(!_(l)||!_(d))&&(d=this._addInsertInfo(n),l=d.key);var u=this._getLoadedRowIndex(e,n),h=this._generateNewItem(l);u>=0&&e.splice(u,0,h)}}),e}processDataItem(e,t,i){var a=t.visibleColumns,n=e.data[Ke]?e.data.key:e.key,o=this.getChanges(),s=I.getIndexByKey(n,o);e.isEditing=!1,s>=0&&this._processDataItemCore(e,o[s],n,a,i)}_processDataItemCore(e,t,i,a,n){var{data:o,type:s}=t;switch(s){case Oe:e.isNewRow=!0,e.key=i,e.data=o;break;case Ut:e.modified=!0,e.oldData=e.data,e.data=st(e.data,o),e.modifiedValues=n(o,a,!0);break;case Be:e.removed=!0}}_initNewRow(e){if(this.executeAction("onInitNewRow",e),e.promise){var t=new O;return P(bt(e.promise)).done(t.resolve).fail(Lr(t)).fail(i=>this._fireDataErrorOccurred(i)),t}}_createInsertInfo(){var e={};return e[Ke]=this._getInsertIndex(),e}_addInsertInfo(e,t){var i,a;e.key=this.getChangeKeyValue(e);var{key:n}=e;if(a=(i=this._getInternalData(n))===null||i===void 0?void 0:i.insertInfo,!_(a)){var o=this._getInsertAfterOrBeforeKey(e);a=this._createInsertInfo(),_(o)||this._setInsertAfterOrBeforeKey(e,t)}return this._addInternalData({insertInfo:a,key:n}),{insertInfo:a,key:n}}getChangeKeyValue(e){if(_(e.key))return e.key;var t=this._dataController.key(),i;return e.data&&t&&!Array.isArray(t)&&(i=e.data[t]),_(i)||(i=jv()),i}_setInsertAfterOrBeforeKey(e,t){var i=this._dataController,a=i.items(!0),n=this.getView("rowsView"),o=this._getNewRowPosition();switch(o){case Mo:case Br:break;case ta:case No:if(a.length){var s=o===ta?0:a.length-1;e[s===0?"insertBeforeKey":"insertAfterKey"]=a[s].key}break;default:var l=o===zo,d=l?n==null?void 0:n.getBottomVisibleItemIndex():n==null?void 0:n.getTopVisibleItemIndex(),u=i.getVisibleRows()[d];u&&(!u.isEditing&&u.rowType==="detail"||u.rowType==="detailAdaptive")&&d++;var h=i.getKeyByRowIndex(d);_(h)&&(e.insertBeforeKey=h)}}_getInsertIndex(){var e=0;return this.getChanges().forEach(t=>{var i,a=(i=this._getInternalData(t.key))===null||i===void 0?void 0:i.insertInfo;_(a)&&t.type===Oe&&a[Ke]>e&&(e=a[Ke])}),e+1}_getInsertAfterOrBeforeKey(e){var t;return(t=e.insertAfterKey)!==null&&t!==void 0?t:e.insertBeforeKey}_getPageIndexToInsertRow(){var e=this._getNewRowPosition(),t=this._dataController,i=t.pageIndex(),a=t.pageCount()-1;return e===Mo&&i!==0?0:e===Br&&i!==a?a:-1}addRow(e){var t=this._dataController,i=t.store();return i?this._addRow(e):(t.fireError("E1052",this.component.NAME),new O().reject())}_addRow(e){var t=this._dataController,i=t.store(),a=i&&i.key(),n={data:{}},o=this._getVisibleEditRowIndex(),s=new O;return this.refresh({allowCancelEditing:!0}),this._allowRowAdding()?(a||(n.data.__KEY__=String(new Lt)),P(this._initNewRow(n,e)).done(()=>{this._allowRowAdding()?P(this._addRowCore(n.data,e,o)).done(s.resolve).fail(s.reject):s.reject("cancel")}).fail(s.reject),s.promise()):(P(this._navigateToNewRow(o)).done(s.resolve).fail(s.reject),s.promise())}_allowRowAdding(e){var t=this._getInsertIndex();return!(t>1)}_addRowCore(e,t,i){var a={data:e,type:Oe},n=this._getVisibleEditRowIndex(),o=this._addInsertInfo(a,t),{key:s}=o;return this._setEditRowKey(s,!0),this._addChange(a),this._navigateToNewRow(i,a,n)}_navigateToNewRow(e,t,i){var a=new O,n=this._dataController,o=this.getController("focus");if(i=i??-1,t=t??this.getChanges().filter(h=>h.type===Oe)[0],!t)return a.reject("cancel").promise();var s=this._getPageIndexToInsertRow(),l=this._getLoadedRowIndex(n.items(),t,!0),d=h=>{P(o==null?void 0:o.navigateToRow(h)).done(()=>{l=n.getRowIndexByKey(t.key),a.resolve()})},u=this._getInsertAfterOrBeforeKey(t);return s>=0?n.pageIndex(s).done(()=>{d(t.key)}).fail(a.reject):l<0&&_(u)?d(u):(n.updateItems({changeType:"update",rowIndices:[e,i,l]}),l=n.getRowIndexByKey(t.key),l<0?d(t.key):a.resolve()),a.done(()=>{var h;(h=this._rowsView)===null||h===void 0||h.waitAsyncTemplates(!0).done(()=>{this._showAddedRow(l),this._afterInsertRow(t.key)})}),a.promise()}_showAddedRow(e){this._focusFirstEditableCellInRow(e)}_beforeFocusElementInRow(e){}_focusFirstEditableCellInRow(e){var t=this._dataController,i=this.getController("keyboardNavigation"),a=t.getKeyByRowIndex(e),n=this.getFirstEditableCellInRow(e);i==null||i.focus(n),this.option("focusedRowKey",a),this._editCellInProgress=!0,this._delayedInputFocus(n,()=>{e=t.getRowIndexByKey(a),this._editCellInProgress=!1,this._beforeFocusElementInRow(e)})}_isEditingStart(e){return this.executeAction("onEditingStart",e),e.cancel}_beforeUpdateItems(){}_getVisibleEditColumnIndex(){var e=this.option(ut);return _(e)?this._columnsController.getVisibleColumnIndex(e):-1}_setEditColumnNameByIndex(e,t){var i,a=this._columnsController.getVisibleColumns();this._setEditColumnName((i=a[e])===null||i===void 0?void 0:i.name,t)}_setEditColumnName(e,t){t?this._silentOption(ut,e):this.option(ut,e)}_resetEditColumnName(){this._setEditColumnName(null,!0)}_getEditColumn(){var e=this.option(ut);return this._getColumnByName(e)}_getColumnByName(e){var t=this._columnsController.getVisibleColumns(),i;return _(e)&&t.some(a=>{if(a.name===e)return i=a,!0}),i}_getVisibleEditRowIndex(e){var t=this._dataController,i=this.option(ve),a=t.getRowIndexByKey(i);return a===-1?a:a+this._getEditRowIndexCorrection(e)}_getEditRowIndexCorrection(e){var t=e?this._getColumnByName(e):this._getEditColumn(),i=(t==null?void 0:t.visibleWidth)==="adaptiveHidden";return i?1:0}_resetEditRowKey(){this._refocusEditCell=!1,this._setEditRowKey(null,!0)}_resetEditIndices(){this._resetEditColumnName(),this._resetEditRowKey()}editRow(e){var t,i=this._dataController,a=i.items(),n=a[e],o={data:n&&n.data,cancel:!1},s=this._getVisibleEditRowIndex();if(n){if(e===s)return!0;if(n.key===void 0){this._dataController.fireError("E1043");return}n.isNewRow||(o.key=n.key),!this._isEditingStart(o)&&(this.resetChanges(),this.init(),this._resetEditColumnName(),this._pageIndex=i.pageIndex(),this._addInternalData({key:n.key,oldData:(t=n.oldData)!==null&&t!==void 0?t:n.data}),this._setEditRowKey(n.key))}}_editRowFromOptionChanged(e,t){var i=[t,e];this._beforeUpdateItems(i,e,t),this._editRowFromOptionChangedCore(i,e)}_editRowFromOptionChangedCore(e,t,i){this._needFocusEditor=!0,this._dataController.updateItems({changeType:"update",rowIndices:e,cancel:i})}_focusEditorIfNeed(){}_showEditPopup(e,t){}_repaintEditPopup(){}_getEditPopupHiddenHandler(){return e=>{this.isEditing()&&this.cancelEditData()}}_getPopupEditFormTemplate(e){}_getSaveButtonConfig(){return{text:this.option("editing.texts.saveRowChanges"),onClick:this.saveEditData.bind(this)}}_getCancelButtonConfig(){return{text:this.option("editing.texts.cancelRowChanges"),onClick:this.cancelEditData.bind(this)}}_removeInternalData(e){var t=this._getInternalData(e),i=this._internalState.indexOf(t);i>-1&&this._internalState.splice(i,1)}_updateInsertAfterOrBeforeKeys(e,t){var i=e[t];e.forEach(a=>{var n=this._getInsertAfterOrBeforeKey(a);U(n,i.key)&&(a[_(a.insertAfterKey)?"insertAfterKey":"insertBeforeKey"]=this._getInsertAfterOrBeforeKey(i))})}_removeChange(e){if(e>=0){var t=[...this.getChanges()],{key:i}=t[e];this._removeInternalData(i),this._updateInsertAfterOrBeforeKeys(t,e),t.splice(e,1),this._silentOption(Le,t),U(this.option(ve),i)&&this._resetEditIndices()}}executeOperation(e,t){this._lastOperation&&this._lastOperation.reject(),this._lastOperation=e,this.waitForDeferredOperations().done(()=>{e.state()!=="rejected"&&(t(),this._lastOperation=null)}).fail(()=>{e.reject(),this._lastOperation=null})}waitForDeferredOperations(){return P(...this._deferreds)}_processCanceledEditingCell(){}_repaintEditCell(e,t,i){this._needFocusEditor=!0,!e||!e.showEditorAlways||t&&!t.showEditorAlways?(this._editCellInProgress=!0,this.getController("editorFactory").loseFocus(),this._dataController.updateItems({changeType:"update",rowIndices:[i,this._getVisibleEditRowIndex()]})):e!==t&&this._dataController.updateItems({changeType:"update",rowIndices:[]})}_delayedInputFocus(e,t,i){var a=()=>{if(t&&t(),e){var n=e.find(cn).first();I.focusAndSelectElement(this,n)}this._beforeFocusCallback=null};_e.real().ios||_e.real().android?a():(this._beforeFocusCallback&&this._beforeFocusCallback(),clearTimeout(this._inputFocusTimeoutID),i&&(this._beforeFocusCallback=t),this._inputFocusTimeoutID=setTimeout(a))}_focusEditingCell(e,t,i){var a=this.getView("rowsView"),n=this._getVisibleEditColumnIndex();t=t||a&&a._getCellElement(this._getVisibleEditRowIndex(),n),t&&this._delayedInputFocus(t,e,i)}deleteRow(e){this._checkAndDeleteRow(e)}_checkAndDeleteRow(e){var t=this.option("editing"),i=t==null?void 0:t.texts,a=t==null?void 0:t.confirmDelete,n=i==null?void 0:i.confirmDeleteMessage,o=this._dataController.items()[e],s=!this.isEditing()||o.isNewRow;if(o&&s)if(!a||!n)this._deleteRowCore(e);else{var l=i&&i.confirmDeleteTitle,d=_(l)&&l.length>0;vv(n,l,d).done(u=>{u&&this._deleteRowCore(e)})}}_deleteRowCore(e){var t=this._dataController,i=t.items()[e],a=i&&i.key,n=this._getVisibleEditRowIndex();this.refresh();var o=this.getChanges(),s=I.getIndexByKey(a,o);return s>=0?o[s].type===Oe?this._removeChange(s):this._addChange({key:a,type:Be}):this._addChange({key:a,oldData:i.data,type:Be}),this._afterDeleteRow(e,n)}_afterDeleteRow(e,t){return this.saveEditData()}undeleteRow(e){var t=this._dataController,i=t.items()[e],a=this._getVisibleEditRowIndex(),n=i&&i.key,o=this.getChanges();if(i){var s=I.getIndexByKey(n,o);if(s>=0){var{data:l}=o[s];xr(l)?this._removeChange(s):this._addChange({key:n,type:Ut}),t.updateItems({changeType:"update",rowIndices:[a,e]})}}}_fireOnSaving(){var e={cancel:!1,promise:null,changes:[...this.getChanges()]};this.executeAction("onSaving",e);var t=new O;return P(bt(e.promise)).done(()=>{t.resolve(e)}).fail(i=>{this._fireDataErrorOccurred(i),t.resolve({cancel:!0})}),t}_executeEditingAction(e,t,i){if(this.component._disposed)return null;var a=new O;return this.executeAction(e,t),P(bt(t.cancel)).done(n=>{n?setTimeout(()=>{a.resolve("cancel")}):i(t).done(a.resolve).fail(Lr(a))}).fail(Lr(a)),a}_processChanges(e,t,i,a){var n=this._dataController.store();T(a,(o,s)=>{var l=this._getOldData(s.key),{data:d,type:u}=s,h=L({},s),c,p;if(!this._beforeSaveEditData(s,o)){switch(u){case Be:p={data:l,key:s.key,cancel:!1},c=this._executeEditingAction("onRowRemoving",p,()=>n.remove(s.key).done(v=>{i.push({type:"remove",key:v})}));break;case Oe:p={data:d,cancel:!1},c=this._executeEditingAction("onRowInserting",p,()=>n.insert(p.data).done((v,f)=>{_(f)&&(h.key=f),v&&Q(v)&&v!==p.data&&(h.data=v),i.push({type:"insert",data:v,index:0})}));break;case Ut:p={newData:d,oldData:l,key:s.key,cancel:!1},c=this._executeEditingAction("onRowUpdating",p,()=>n.update(s.key,p.newData).done((v,f)=>{v&&Q(v)&&v!==p.newData&&(h.data=v),i.push({type:"update",key:f,data:v})}))}if(a[o]=h,c){var g=new O;c.always(v=>{t.push({key:s.key,result:v})}).always(g.resolve),e.push(g.promise())}}})}_processRemoveIfError(e,t){var i=e[t];return(i==null?void 0:i.type)===Be&&t>=0&&e.splice(t,1),!0}_processRemove(e,t,i){var a=e[t];if(!i||!a||a.type===Be)return this._processRemoveCore(e,t,!i||!a)}_processRemoveCore(e,t,i){return t>=0&&e.splice(t,1),!0}_processSaveEditDataResult(e){for(var t=!1,i=[...this.getChanges()],a=i.length,n=0;n<e.length;n++){var o=e[n].result,s=o==="cancel",l=I.getIndexByKey(e[n].key,i),d=i[l],u=o&&o instanceof Error;if(u){if(d&&this._addInternalData({key:d.key,error:o}),this._fireDataErrorOccurred(o),this._processRemoveIfError(i,l))break}else this._processRemove(i,l,s)&&(t=!s)}return i.length<a&&this._silentOption(Le,i),t}_fireSaveEditDataEvents(e){T(e,(t,i)=>{var{data:a,key:n,type:o}=i,s=this._addInternalData({key:n}),l={key:n,data:a};switch(s.error&&(l.error=s.error),o){case Be:this.executeAction("onRowRemoved",S({},l,{data:s.oldData}));break;case Oe:this.executeAction("onRowInserted",l);break;case Ut:this.executeAction("onRowUpdated",l)}}),this.executeAction("onSaved",{changes:e})}saveEditData(){var e=new O;return this.waitForDeferredOperations().done(()=>{if(this.isSaving()){this._resolveAfterSave(e);return}P(this._beforeSaveEditData()).done(t=>{if(t){this._resolveAfterSave(e,{cancel:t});return}this._saving=!0,this._saveEditDataInner().always(()=>{this._saving=!1,this._refocusEditCell&&this._focusEditingCell()}).done(e.resolve).fail(e.reject)}).fail(e.reject)}).fail(e.reject),e.promise()}_resolveAfterSave(e){var{cancel:t,error:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};P(this._afterSaveEditData(t)).done(()=>{e.resolve(i)}).fail(e.reject)}_saveEditDataInner(){var e=new O,t=[],i=[],a=[],n=this._dataController.dataSource();return P(this._fireOnSaving()).done(o=>{var{cancel:s,changes:l}=o;if(s)return e.resolve().promise();if(this._processChanges(i,t,a,l),i.length)return this._refocusEditCell=!0,n==null||n.beginLoading(),P(...i).done(()=>{this._processSaveEditDataResult(t)?this._endSaving(a,l,e):(n==null||n.endLoading(),e.resolve())}).fail(d=>{n==null||n.endLoading(),e.resolve(d)}),e.always(()=>{this._refocusEditCell=!0}).promise();this._cancelSaving(e)}).fail(e.reject),e.promise()}_beforeEndSaving(e){this._resetEditIndices()}_endSaving(e,t,i){var a=this._dataController.dataSource();this._beforeEndSaving(t),a==null||a.endLoading(),this._refreshDataAfterSave(e,t,i)}_cancelSaving(e){this.executeAction("onSaved",{changes:[]}),this._resolveAfterSave(e)}_refreshDataAfterSave(e,t,i){var a=this._dataController,n=this.option("editing.refreshMode"),o=n!=="reshape"&&n!=="repaint";o||a.push(e),P(a.refresh({selection:o,reload:o,load:n==="reshape",changesOnly:this.option("repaintChangesOnly")})).always(()=>{this._fireSaveEditDataEvents(t)}).done(()=>{this._resolveAfterSave(i)}).fail(s=>{this._resolveAfterSave(i,{error:s})})}isSaving(){return this._saving}_updateEditColumn(){var e=this._isEditColumnVisible(),t=this.option("editing.useIcons"),i=fd+(t?" ".concat(Ho):"");this._columnsController.addCommandColumn({type:"buttons",command:"edit",visible:e,cssClass:i,width:"auto",alignment:"center",cellTemplate:this._getEditCommandCellTemplate(),fixedPosition:"right"}),this._columnsController.columnOption("command:edit",{visible:e,cssClass:i})}_isEditColumnVisible(){var e=this.option("editing");return e.allowDeleting}_isEditButtonDisabled(){var e=this.hasChanges(),t=_(this.option("editing.editRowKey"));return!(t||e)}_updateEditButtons(){var e=this.getView("headerPanel"),t=this._isEditButtonDisabled();e&&(e.setToolbarItemDisabled("saveButton",t),e.setToolbarItemDisabled("revertButton",t))}_applyModified(e,t){e&&e.addClass(Wo)}_beforeCloseEditCellInBatchMode(e){}cancelEditData(){var e=this.getChanges(),t={cancel:!1,changes:e};this.executeAction("onEditCanceling",t),t.cancel||(this._cancelEditDataCore(),this.executeAction("onEditCanceled",{changes:e}))}_cancelEditDataCore(){var e=this._getVisibleEditRowIndex();this._beforeCancelEditData(),this.init(),this.resetChanges(),this._resetEditColumnName(),this._resetEditRowKey(),this._afterCancelEditData(e)}_afterCancelEditData(e){var t=this._dataController;t.updateItems({repaintChangesOnly:this.option("repaintChangesOnly")})}_hideEditPopup(){}hasEditData(){return this.hasChanges()}update(e){var t=this._dataController;t&&this._pageIndex!==t.pageIndex()&&(e==="refresh"&&this.refresh({isPageChanged:!0}),this._pageIndex=t.pageIndex()),this._updateEditButtons()}_getRowIndicesForCascadeUpdating(e,t){return t?[]:[e.rowIndex]}addDeferred(e){this._deferreds.includes(e)||(this._deferreds.push(e),e.always(()=>{var t=this._deferreds.indexOf(e);t>=0&&this._deferreds.splice(t,1)}))}_prepareChange(e,t,i){var a,n={},o=(a=e.row)===null||a===void 0?void 0:a.data,s=e.key,l=new O;if(s!==void 0){e.value=t;var d=bt(e.column.setCellValue(n,t,S(!0,{},o),i));d.done(()=>{l.resolve({data:n,key:s,oldData:o,type:Ut})}).fail(Lr(l)).fail(u=>this._fireDataErrorOccurred(u)),_(i)&&e.column.displayValueMap&&(e.column.displayValueMap[t]=i),this._updateRowValues(e),this.addDeferred(l)}return l}_updateRowValues(e){if(e.values){var t=this._dataController,i=t.getRowIndexByKey(e.key),a=t.getVisibleRows()[i];a&&(e.row.values=a.values,e.values=a.values),e.values[e.columnIndex]=e.value}}updateFieldValue(e,t,i,a){var n=e.key,o=new O;return n===void 0&&this._dataController.fireError("E1043"),e.column.setCellValue?this._prepareChange(e,t,i).done(s=>{P(this._applyChange(e,s,a)).always(()=>{o.resolve()})}):o.resolve(),o.promise()}_focusPreviousEditingCellIfNeed(e){if(this.hasEditData()&&!this.isEditCell(e.rowIndex,e.columnIndex))return this._focusEditingCell(),this._updateEditRow(e.row,!0),!0}_needUpdateRow(e){var t=this._columnsController.getVisibleColumns();e||(e=this._getEditColumn());var i=e&&e.setCellValue!==e.defaultSetCellValue,a=t.some(n=>n.calculateCellValue!==n.defaultCalculateCellValue);return i||a}_applyChange(e,t,i){var a=L(L({},e),{forceUpdateRow:i});return this._addChange(t,a),this._updateEditButtons(),this._applyChangeCore(e,a.forceUpdateRow)}_applyChangeCore(e,t){var i=e.column.setCellValue!==e.column.defaultSetCellValue,{row:a}=e;a&&(t||i?this._updateEditRow(a,t,i):a.update&&a.update())}_updateEditRowCore(e,t,i){this._dataController.updateItems({changeType:"update",rowIndices:this._getRowIndicesForCascadeUpdating(e,t)})}_updateEditRow(e,t,i){t?this._updateRowImmediately(e,t,i):this._updateRowWithDelay(e,i)}_updateRowImmediately(e,t,i){this._updateEditRowCore(e,!t,i),this._validateEditFormAfterUpdate(e,i),t||this._focusEditingCell()}_updateRowWithDelay(e,t){var i=new O;this.addDeferred(i),setTimeout(()=>{var a,n=((a=this._editForm)===null||a===void 0?void 0:a.element())||this.component.$element().get(0),o=m(z.getActiveElement(n)),s=this._rowsView.getCellIndex(o,e.rowIndex),l=o.get(0),d=I.getSelectionRange(l);if(this._updateEditRowCore(e,!1,t),this._validateEditFormAfterUpdate(e,t),s>=0){var u=this._rowsView._getCellElement(e.rowIndex,s);this._delayedInputFocus(u,()=>{setTimeout(()=>{var h;l=z.getActiveElement((h=this.component.$element())===null||h===void 0?void 0:h.get(0)),d.selectionStart>=0&&I.setSelectionRange(l,d)})})}i.resolve()})}_validateEditFormAfterUpdate(){}_addChange(e,t){var i,a=t==null?void 0:t.row,n=[...this.getChanges()],o=I.getIndexByKey(e.key,n);o<0&&(o=n.length,this._addInternalData({key:e.key,oldData:e.oldData}),delete e.oldData,n.push(e));var s=L({},n[o]);return s&&(e.data&&(s.data=st(s.data,e.data)),(!s.type||!e.data)&&e.type&&(s.type=e.type),a&&(a.oldData=this._getOldData(a.key),a.data=st(a.data,e.data))),n[o]=s,this._silentOption(Le,n),t&&s!==((i=this.getChanges())===null||i===void 0?void 0:i[o])&&(t.forceUpdateRow=!0),s}_getFormEditItemTemplate(e,t){return t.editCellTemplate||this._getDefaultEditorTemplate()}getColumnTemplate(e){var{column:t}=e,i=e.row&&e.row.rowIndex,a,n=this.isRowBasedEditMode(),o=this.isEditRow(i),s=this.isEditCell(i,e.columnIndex),l;if((t.showEditorAlways||t.setCellValue&&(o&&t.allowEditing||s))&&(e.rowType==="data"||e.rowType==="detailAdaptive")&&!t.command){var d=this.allowUpdating(e);((d||o)&&t.allowEditing||s)&&(o||!n)&&(t.showEditorAlways&&!n&&(l={cancel:!1,key:e.row.isNewRow?void 0:e.row.key,data:e.row.data,column:t},this._isEditingStart(l)),(!l||!l.cancel)&&(e.setValue=(u,h)=>{this.updateFieldValue(e,u,h)})),a=t.editCellTemplate||this._getDefaultEditorTemplate()}else t.command==="detail"&&e.rowType==="detail"&&o&&(a=this===null||this===void 0?void 0:this.getEditFormTemplate(e));return a}_createButton(e,t,i,a){var n=Vv[t.name],o=this.option("editing.useIcons"),s=this.option("useLegacyColumnButtonTemplate"),l=m("<a>").attr("href","#").addClass(yv).addClass(t.cssClass);if(t.template&&s)this._rowsView.renderTemplate(e,t.template,i,!0);else{if(t.template)l=m("<span>").addClass(t.cssClass);else if(o&&n||t.icon){n=t.icon||n;var d=Ch(n);d==="image"||d==="svg"?l=Va(n).addClass(t.cssClass):l.addClass("dx-icon".concat(d==="dxIcon"?"-":" ").concat(n)).attr("title",t.text),l.addClass(Ev),e.addClass(Ho);var u=this.getButtonLocalizationNames()[t.name];u&&l.attr("aria-label",y.format(u))}else l.text(t.text);_(t.hint)&&l.attr("title",t.hint),this._isButtonDisabled(t,i)?l.addClass("dx-state-disabled"):(!t.template||t.onClick)&&b.on(l,$("click",Rv),this.createAction(h=>{var c;(c=t.onClick)===null||c===void 0||c.call(t,S({},h,{row:i.row,column:i.column})),h.event.preventDefault(),h.event.stopPropagation()})),e.append(l,"&nbsp;"),t.template&&(i.renderAsync=!1,this._rowsView.renderTemplate(l,t.template,i,!0,a))}}getButtonLocalizationNames(){return{edit:"dxDataGrid-editingEditRow",save:"dxDataGrid-editingSaveRowChanges",delete:"dxDataGrid-editingDeleteRow",undelete:"dxDataGrid-editingUndeleteRow",cancel:"dxDataGrid-editingCancelRowChanges"}}prepareButtonItem(e,t,i,a){var n,o=(n=this.option("editing.texts"))!==null&&n!==void 0?n:{},s={revert:o.cancelAllChanges,save:o.saveAllChanges,addRow:o.addRow},l={revert:"cancel",save:"save",addRow:"addrow"}[t],d=s[t],u=(l==="save"||l==="cancel")&&this._isEditButtonDisabled();return{widget:"dxButton",options:{onInitialized:h=>{m(h.element).addClass(e._getToolbarButtonClass("".concat(bv," ").concat(this.addWidgetPrefix(l),"-button")))},icon:"edit-button-".concat(l),disabled:u,onClick:()=>{setTimeout(()=>{this[i]()})},text:d,hint:d},showText:"inMenu",name:"".concat(t,"Button"),location:"after",locateInMenu:"auto",sortIndex:a}}prepareEditButtons(e){var t,i=(t=this.option("editing"))!==null&&t!==void 0?t:{},a=[];return i.allowAdding&&a.push(this.prepareButtonItem(e,"addRow","addRow",20)),a}highlightDataCell(e,t){this.shouldHighlightCell(t)&&e.addClass(Wo)}_afterInsertRow(){}_beforeSaveEditData(e){if(e&&!_(e.key)&&_(e.type))return!0}_afterSaveEditData(){}_beforeCancelEditData(){}_allowEditAction(e,t){var i=this.option("editing.".concat(e));return H(i)&&(i=i({component:this.component,row:t.row})),i}allowUpdating(e,t){var i,a=(i=this.option("editing.startEditAction"))!==null&&i!==void 0?i:Av,n=arguments.length>1?a===t||t==="down":!0;return n&&this._allowEditAction("allowUpdating",e)}allowDeleting(e){return this._allowEditAction("allowDeleting",e)}isCellModified(e){var t,i,a,{columnIndex:n}=e,o=(i=(t=e==null?void 0:e.row)===null||t===void 0?void 0:t.modifiedValues)===null||i===void 0?void 0:i[n];return!((a=e==null?void 0:e.row)===null||a===void 0)&&a.isNewRow&&(o=e.value),o!==void 0}isNewRowInEditMode(){var e=this._getVisibleEditRowIndex(),t=this._dataController.items();return e>=0?t[e].isNewRow:!1}_isRowDeleteAllowed(){}shouldHighlightCell(e){var t=this.isCellModified(e);return t&&e.column.setCellValue&&(this.getEditMode()!==Qe||!e.row.isEditing)}}var ef={defaultOptions:()=>({editing:{mode:"row",refreshMode:"full",newRowPosition:vd,allowAdding:!1,allowUpdating:!1,allowDeleting:!1,useIcons:!1,selectTextOnEditStart:!1,confirmDelete:!0,texts:{editRow:y.format("dxDataGrid-editingEditRow"),saveAllChanges:y.format("dxDataGrid-editingSaveAllChanges"),saveRowChanges:y.format("dxDataGrid-editingSaveRowChanges"),cancelAllChanges:y.format("dxDataGrid-editingCancelAllChanges"),cancelRowChanges:y.format("dxDataGrid-editingCancelRowChanges"),addRow:y.format("dxDataGrid-editingAddRow"),deleteRow:y.format("dxDataGrid-editingDeleteRow"),undeleteRow:y.format("dxDataGrid-editingUndeleteRow"),confirmDeleteMessage:y.format("dxDataGrid-editingConfirmDeleteMessage"),confirmDeleteTitle:""},form:{colCount:2},popup:{},startEditAction:"click",editRowKey:null,editColumnName:null,changes:[]},useLegacyColumnButtonTemplate:!1}),controllers:{editing:Zv},extenders:{controllers:{data:{init(){this._editingController=this.getController("editing"),this.callBase()},reload(r,e){return!e&&this._editingController.refresh(),this.callBase.apply(this,arguments)},repaintRows(){if(!this.getController("editing").isSaving())return this.callBase.apply(this,arguments)},_updateEditRow(r){var e,t=this.option(ve),i=I.getIndexByKey(t,r),a=r[i];a&&(a.isEditing=!0,(e=this._updateEditItem)===null||e===void 0||e.call(this,a))},_updateItemsCore(r){this.callBase(r),this._updateEditRow(this.items(!0))},_applyChangeUpdate(r){this._updateEditRow(r.items),this.callBase(r)},_applyChangesOnly(r){this._updateEditRow(r.items),this.callBase(r)},_processItems(r,e){return r=this._editingController.processItems(r,e),this.callBase(r,e)},_processDataItem(r,e){return this._editingController.processDataItem(r,e,this.generateDataValues),this.callBase(r,e)},_processItem(r,e){return r=this.callBase(r,e),r.isNewRow&&(e.dataIndex--,delete r.dataIndex),r},_getChangedColumnIndices(r,e,t,i){if(!(r.isNewRow!==e.isNewRow||r.removed!==e.removed))return this.callBase.apply(this,arguments)},_isCellChanged(r,e,t,i,a){var n=this.getController("editing"),o=r.cells&&r.cells[i],s=n&&n.isEditCell(t,i);return a&&s?!1:o&&o.column&&!o.column.showEditorAlways&&o.isEditing!==s?!0:this.callBase.apply(this,arguments)},needToRefreshOnDataSourceChange(r){var e=this.getController("editing"),t=Array.isArray(r.value)&&r.value===r.previousValue&&e.isSaving();return!t},_handleDataSourceChange(r){var e=this.callBase(r),t=this.option("editing.changes"),i=r.value;if(Array.isArray(i)&&t.length){var a=i.map(l=>this.keyOf(l)),n=t.filter(l=>l.type==="insert"||a.some(d=>U(l.key,d)));n.length!==t.length&&this.option("editing.changes",n);var o=this.option("editing.editRowKey"),s=n.some(l=>l.type==="insert"&&U(o,l.key));!s&&a.every(l=>!U(o,l))&&this.option("editing.editRowKey",null)}return e}}},views:{rowsView:{init(){this.callBase(),this._editingController=this.getController("editing")},getCellIndex(r,e){if(!r.is("td")&&e>=0){var t=this.getCellElements(e),i=-1;return T(t,(a,n)=>{m(n).find(r).length&&(i=a)}),i}return this.callBase.apply(this,arguments)},publicMethods(){return this.callBase().concat(["cellValue"])},_getCellTemplate(r){var e=this._editingController.getColumnTemplate(r);return e||this.callBase(r)},_createRow(r){var e=this.callBase.apply(this,arguments);if(r){var t=!!r.removed,i=!!r.isNewRow,a=!!r.modified;i&&e.addClass(Iv),a&&e.addClass(Tv),(i||t)&&e.removeClass(Sv)}return e},_getColumnIndexByElement(r){for(var e=r.closest("table"),t=this.getTableElements();e.length&&!t.filter(e).length;)r=e.closest("td"),e=r.closest("table");return this._getColumnIndexByElementCore(r)},_getColumnIndexByElementCore(r){var e=r.closest(".".concat($e,"> td:not(.dx-master-detail-cell)"));return this.getCellIndex(e)},_editCellByClick(r,e){var t=this._editingController,i=m(r.event.target),a=this._getColumnIndexByElement(i),n=this._dataController.items()[r.rowIndex],o=t.allowUpdating({row:n},e)||n&&n.isNewRow,s=this._columnsController.getVisibleColumns()[a],l=t.isEditCell(r.rowIndex,a),d=o&&s&&(s.allowEditing||l),u=this.option("editing.startEditAction")||"click",h=s&&s.showEditorAlways;if(l)return!0;if(e==="down")return(_e.real().ios||_e.real().android)&&_l(),h&&d&&t.editCell(r.rowIndex,a);if(e==="click"&&u==="dblClick"){var c=n==null?void 0:n.isNewRow;t.closeEditCell(!1,c)}if(d&&e===u)return t.editCell(r.rowIndex,a)||t.isEditRow(r.rowIndex)},_rowPointerDown(r){this._pointerDownTimeout=setTimeout(()=>{this._editCellByClick(r,"down")})},_rowClick(r){var e=m(r.rowElement).hasClass(this.addWidgetPrefix(pi));r.event[pd]=this.component,!this._editCellByClick(r,"click")&&!e&&this.callBase.apply(this,arguments)},_rowDblClick(r){this._editCellByClick(r,"dblClick")||this.callBase.apply(this,arguments)},_cellPrepared(r,e){var t,i=this._editingController,a=!!e.column.command,n=e.setValue,o=i.isEditRow(e.rowIndex),s=_d(o,e);if(Ko(o,e)){var{alignment:l}=e.column;r.toggleClass(this.addWidgetPrefix(xv),!n).toggleClass(Ov,!n),l&&r.find(gd).first().css("textAlign",l)}s&&this._editCellPrepared(r);var d=!!(!((t=e.column)===null||t===void 0)&&t.cellTemplate);e.column&&!a&&(!d||i.shouldHighlightCell(e))&&i.highlightDataCell(r,e),this.callBase.apply(this,arguments)},_editCellPrepared:me,_formItemPrepared:me,_getCellOptions(r){var e=this.callBase(r);return e.isEditing=this._editingController.isEditCell(e.rowIndex,e.columnIndex),e},_createCell(r){var e=this.callBase(r),t=this._editingController.isEditRow(r.rowIndex);return Ko(t,r)&&e.addClass(Ti),e},cellValue(r,e,t,i){var a=this.getCellOptions(r,e);if(a){if(t===void 0)return a.value;this._editingController.updateFieldValue(a,t,i,!0)}},dispose(){this.callBase.apply(this,arguments),clearTimeout(this._pointerDownTimeout)},_renderCore(){return this.callBase.apply(this,arguments),this.waitAsyncTemplates(!0).done(()=>{this._editingController._focusEditorIfNeed()})}},headerPanel:{_getToolbarItems(){var r=this.callBase(),e=this.getController("editing").prepareEditButtons(this);return e.concat(r)},optionChanged(r){var{fullName:e}=r;switch(r.name){case"editing":var t=[Yr,Le,ut,ve],i=e&&!t.some(a=>a===e);i&&this._invalidate(),this.callBase(r);break;case"useLegacyColumnButtonTemplate":r.handled=!0;break;default:this.callBase(r)}},isVisible(){var r=this.getController("editing").option("editing");return this.callBase()||(r==null?void 0:r.allowAdding)}}}}};A.registerModule("editing",S(!0,{},ef,{extenders:{controllers:{data:{_changeRowExpandCore(r){var e=this._editingController;return Array.isArray(r)&&e&&e.refresh(),this.callBase.apply(this,arguments)}}}}}));var tf=r=>class extends r{isRowEditMode(){return this.getEditMode()===Qe}_afterCancelEditData(e){var t=this._dataController;this.isRowBasedEditMode()&&e>=0?t.updateItems({changeType:"update",rowIndices:[e,e+1]}):super._afterCancelEditData(e)}_isDefaultButtonVisible(e,t){var i=this.isRowBasedEditMode(),a=t.row&&U(t.row.key,this.option(ve));if(i)switch(e.name){case"edit":return!a&&this.allowUpdating(t);case"delete":return super._isDefaultButtonVisible(e,t)&&!a;case"save":case"cancel":return a;default:return super._isDefaultButtonVisible(e,t)}return super._isDefaultButtonVisible(e,t)}isEditRow(e){return this.isRowBasedEditMode()&&this.isEditRowByIndex(e)}_cancelSaving(e){this.isRowBasedEditMode()&&(this.hasChanges()||this._cancelEditDataCore()),super._cancelSaving(e)}_refreshCore(e){var{allowCancelEditing:t}=e??{};if(this.isRowBasedEditMode()){var i=this.getChanges().filter(a=>a.type==="update").length>0;this.init(),t&&i&&this._cancelEditDataCore()}super._refreshCore(e)}_isEditColumnVisible(){var e=super._isEditColumnVisible(),t=this.option("editing"),i=this.isRowEditMode(),a=t.allowUpdating||t.allowAdding;return e||i&&a}_focusEditorIfNeed(){var e=this.getEditMode();if(this._needFocusEditor){if(wv.includes(e)){var t=this.getFocusedCellInRow(this._getVisibleEditRowIndex());this._delayedInputFocus(t,()=>{t&&this.component.focus(t)})}this._needFocusEditor=!1}}},rf={extenders:{controllers:{editing:tf,data:{_getChangedColumnIndices(r,e,t,i){var a=this.getController("editing");if(!(a.isRowBasedEditMode()&&r.isEditing!==e.isEditing))return this.callBase.apply(this,arguments)}}},views:{rowsView:{_createRow(r){var e=this.callBase.apply(this,arguments);if(r){var t=this._editingController,i=t.isEditRow(r.rowIndex);i&&(e.addClass(Go),e.removeClass(ko),r.rowType==="detail"&&e.addClass(this.addWidgetPrefix(pi)))}return e},_update(r){this.callBase(r),r.changeType==="updateSelection"&&this.getTableElements().children("tbody").children(".".concat(Go)).removeClass(ko)}}}}};A.registerModule("editingRowBased",rf);var af=r=>class extends r{init(){this._editForm=null,this._updateEditFormDeferred=null,super.init()}isFormOrPopupEditMode(){return this.isPopupEditMode()||this.isFormEditMode()}isPopupEditMode(){var e=this.option("editing.mode");return e===pn}isFormEditMode(){var e=this.option("editing.mode");return e===Mt}getFirstEditableColumnIndex(){var e=this._firstFormItem;if(this.isFormEditMode()&&e){var t=this.option(ve),i=this._dataController.getRowIndexByKey(t),a=this._rowsView.getCellElements(i);return this._rowsView._getEditFormEditorVisibleIndex(a,e.column)}return super.getFirstEditableColumnIndex()}getEditFormRowIndex(){return this.isFormOrPopupEditMode()?this._getVisibleEditRowIndex():super.getEditFormRowIndex()}_isEditColumnVisible(){var e=super._isEditColumnVisible(),t=this.option("editing");return this.isFormOrPopupEditMode()&&t.allowUpdating||e}_handleDataChanged(e){var t,i;if(this.isPopupEditMode()){var a=this.option("editing.editRowKey"),n=(t=e==null?void 0:e.items)===null||t===void 0?void 0:t.some(s=>U(s.key,a)),o=((i=e.changeTypes)===null||i===void 0?void 0:i.length)&&e.changeTypes.every(s=>s==="insert");(e.changeType==="refresh"||n&&e.isOptionChanged)&&!o&&this._repaintEditPopup()}super._handleDataChanged(e)}getPopupContent(){var e,t=(e=this._editPopup)===null||e===void 0?void 0:e.option("visible");if(this.isPopupEditMode()&&t)return this._$popupContent}_showAddedRow(e){this.isPopupEditMode()?this._showEditPopup(e):super._showAddedRow(e)}_cancelEditDataCore(){super._cancelEditDataCore(),this.isPopupEditMode()&&this._hideEditPopup()}_updateEditRowCore(e,t,i){var a,n=this._editForm;this.isPopupEditMode()?this.option("repaintChangesOnly")?((a=e.update)===null||a===void 0||a.call(e,e),this._rowsView.renderDelayedTemplates()):n&&(this._updateEditFormDeferred=new O().done(()=>n.repaint()),this._updateLockCount||this._updateEditFormDeferred.resolve()):super._updateEditRowCore(e,t,i)}_showEditPopup(e,t){var i=_e.current().deviceType!=="desktop",a=this.addWidgetPrefix(Wv),n=S({showTitle:!1,fullScreen:i,wrapperAttr:{class:a},toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:this._getSaveButtonConfig()},{toolbar:"bottom",location:"after",widget:"dxButton",options:this._getCancelButtonConfig()}],contentTemplate:this._getPopupEditFormTemplate(e)},this.option(Yr));if(!this._editPopup){var o=m("<div>").appendTo(this.component.$element()).addClass(a);this._editPopup=this._createComponent(o,vt),this._editPopup.on("hiding",this._getEditPopupHiddenHandler()),this._editPopup.on("shown",s=>{var l;b.trigger(s.component.$content().find(cn).not(".".concat(Kv)).first(),"focus"),t&&((l=this._editForm)===null||l===void 0||l.repaint())})}this._editPopup.option(n),this._editPopup.show(),super._showEditPopup(e,t)}_getPopupEditFormTemplate(e){var t=this.component.getVisibleRows()[e],i={row:t,values:t.values,rowType:t.rowType,key:t.key,rowIndex:e};return this._rowsView._addWatchMethod(i,t),a=>{var n=this.getEditFormTemplate(),o=this._createComponent(m("<div>").appendTo(a),Rt);this._$popupContent=m(o.content()),n(this._$popupContent,i,{isPopupForm:!0}),this._rowsView.renderDelayedTemplates(),m(a).parent().attr("aria-label",this.localize("dxDataGrid-ariaEditForm"))}}_repaintEditPopup(){var e,t,i=this._getVisibleEditRowIndex();if(i>=0){var a=(e=this._editPopup)===null||e===void 0?void 0:e.option("animation");(t=this._editPopup)===null||t===void 0||t.option("animation",null),this._showEditPopup(i,!0),a!==void 0&&this._editPopup.option("animation",a)}}_hideEditPopup(){var e;(e=this._editPopup)===null||e===void 0||e.option("visible",!1)}optionChanged(e){if(e.name==="editing"&&this.isFormOrPopupEditMode()){var{fullName:t}=e;t.indexOf(ea)===0?(this._handleFormOptionChange(e),e.handled=!0):t.indexOf(Yr)===0&&(this._handlePopupOptionChange(e),e.handled=!0)}super.optionChanged(e)}_handleFormOptionChange(e){var t;if(this.isFormEditMode()){var i=this._getVisibleEditRowIndex();i>=0&&this._dataController.updateItems({changeType:"update",rowIndices:[i]})}else!((t=this._editPopup)===null||t===void 0)&&t.option("visible")&&e.fullName.indexOf(ea)===0&&this._repaintEditPopup()}_handlePopupOptionChange(e){var t=this._editPopup;if(t){var i=e.fullName.slice(Yr.length+1);i?t.option(i,e.value):t.option(e.value)}}renderFormEditorTemplate(e,t,i,a,n){var o=this,s=m(a),{column:l}=t,d=Jv(t),u=e==null?void 0:e.row.data,h=i.component,{label:c,labelMark:p,labelMode:g}=i.editorOptions||{},v=S({},e,{data:u,cellElement:null,isOnForm:!0,item:t,id:h.getItemID(t.name||t.dataField),column:S({},l,{editorType:d,editorOptions:S({label:c,labelMark:p,labelMode:g},l.editorOptions,t.editorOptions)}),columnIndex:l.index,setValue:!n&&l.allowEditing&&function(C,w){o.updateFieldValue(v,C,w)}});v.value=l.calculateCellValue(u);var f=this._getFormEditItemTemplate.bind(this)(v,l);return this._rowsView.renderTemplate(s,f,v,!!xi(s)).done(()=>{this._rowsView._updateCell(s,v)}),v}getFormEditorTemplate(e,t){var i=this.component.columnOption(t.dataField);return(a,n)=>{var o,s,l=m(n);(s=(o=e.row).watch)===null||s===void 0||s.call(o,()=>i.selector(e.row.data),()=>{var d=l.find(".dx-widget").first(),u=d.data("dxValidator"),h=u==null?void 0:u.option();l.contents().remove(),e=this.renderFormEditorTemplate.bind(this)(e,t,a,l),d=l.find(".dx-widget").first(),u=d.data("dxValidator"),h&&!u&&d.dxValidator({validationRules:h.validationRules,validationGroup:h.validationGroup,dataGetter:h.dataGetter})}),e=this.renderFormEditorTemplate.bind(this)(e,t,a,l)}}getEditFormOptions(e){var t,i=(t=this._getValidationGroupsInForm)===null||t===void 0?void 0:t.call(this,e),a=this.option("editing.form.customizeItem"),n=this.addWidgetPrefix(md),o=this.option("editing.form.items"),s={};if(o)wd(o,d=>{var u=(d==null?void 0:d.name)||(d==null?void 0:d.dataField);u&&(s[u]=!!d.editorType)});else{var l=this.getController("columns").getColumns();o=[],T(l,(d,u)=>{!u.isBand&&!u.type&&o.push({column:u,name:u.name,dataField:u.dataField})})}return S({},i,{items:o,formID:"dx-".concat(new Lt),customizeItem:d=>{var u,h=d.name||d.dataField;if((d.column||h)&&(u=d.column||this._columnsController.columnOption(d.name?"name:".concat(d.name):"dataField:".concat(d.dataField))),u){if(d.label=d.label||{},d.label.text=d.label.text||u.caption,u.dataType==="boolean"&&d.label.visible===void 0){var c=this.option("editing.form.labelMode");(c==="floating"||c==="static")&&(d.label.visible=!0)}d.template=d.template||this.getFormEditorTemplate(e,d),d.column=u,d.isCustomEditorType=s[h],u.formItem&&S(d,u.formItem),d.isRequired===void 0&&u.validationRules&&(d.isRequired=u.validationRules.some(g=>g.type==="required"),d.validationRules=[]);var p=_(d.visible)?d.visible:!0;!this._firstFormItem&&p&&(this._firstFormItem=d)}a==null||a.call(this,d),d.cssClass=G(d.cssClass)?"".concat(d.cssClass," ").concat(n):n}})}getEditFormTemplate(){return(e,t,i)=>{var a=this.option(ea),n=this.getEditFormOptions(t),o=m("<div>").appendTo(e),s=i==null?void 0:i.isPopupForm;if(this._firstFormItem=void 0,s&&o.addClass(this.addWidgetPrefix(Gv)),this._editForm=this._createComponent(o,Il,S({},a,n)),!s){var l=m("<div>").addClass(this.addWidgetPrefix($v)).appendTo(e);this._createComponent(m("<div>").appendTo(l),pr,this._getSaveButtonConfig()),this._createComponent(m("<div>").appendTo(l),pr,this._getCancelButtonConfig())}this._editForm.on("contentReady",()=>{var d;this._rowsView.renderDelayedTemplates(),(d=this._editPopup)===null||d===void 0||d.repaint()})}}getEditForm(){return this._editForm}_endUpdateCore(){var e;(e=this._updateEditFormDeferred)===null||e===void 0||e.resolve()}_beforeEndSaving(e){var t;super._beforeEndSaving(e),this.isPopupEditMode()&&((t=this._editPopup)===null||t===void 0||t.hide())}_processDataItemCore(e,t,i,a,n){var{type:o}=t;this.isPopupEditMode()&&o===Oe&&(e.visible=!1),super._processDataItemCore(e,t,i,a,n)}_editRowFromOptionChangedCore(e,t){var i=this.isPopupEditMode();super._editRowFromOptionChangedCore(e,t,i),i&&this._showEditPopup(t)}},nf={extenders:{controllers:{editing:af,data:{_updateEditItem(r){this._editingController.isFormEditMode()&&(r.rowType="detail")},_getChangedColumnIndices(r,e,t,i){if(!(i===!1&&e.isEditing&&this._editingController.isFormEditMode()))return this.callBase.apply(this,arguments)}}},views:{rowsView:{_renderCellContent(r,e){e.rowType==="data"&&this._editingController.isPopupEditMode()&&e.row.visible===!1||this.callBase.apply(this,arguments)},getCellElements(r){var e=this.callBase(r),t=this._editingController,i=t.getEditForm(),a=t.getEditFormRowIndex();return a===r&&e&&i?i.$element().find(".".concat(this.addWidgetPrefix(md),", .").concat(Uv)):e},_getVisibleColumnIndex(r,e,t){var i=this._editingController.getEditFormRowIndex();if(i===e&&G(t)){var a=this._columnsController.columnOption(t);return this._getEditFormEditorVisibleIndex(r,a)}return this.callBase.apply(this,arguments)},_getEditFormEditorVisibleIndex(r,e){var t=-1;return T(r,(i,a)=>{var n=m(a).find(".dx-field-item-content").data("dx-form-item");if(n!=null&&n.column&&e&&n.column.index===e.index)return t=i,!1}),t},_isFormItem(r){var e=r.rowType==="detail"||r.rowType==="detailAdaptive",t=r.rowType==="data"&&this._editingController.isPopupEditMode();return(e||t)&&r.item},_updateCell(r,e){this._isFormItem(e)?this._formItemPrepared(e,r):this.callBase(r,e)}}}}};A.registerModule("editingFormBased",nf);var of=r=>class extends r{init(){var e=!this._saveEditorHandler;if(super.init(),e){var t,i;this._pointerUpEditorHandler=()=>{var a;i=(a=this.getController("columnsResizer"))===null||a===void 0?void 0:a.isResizing()},this._pointerDownEditorHandler=a=>t=m(a.target),this._saveEditorHandler=this.createAction(function(a){var{event:n}=a,o=m(n.target),s=n[pd],{component:l}=this;if(Qv(t)&&!t.is(o))return;function d(v){if(!v)return!1;var f=v.closest(".".concat(Mv)),C=l.$element();return f.length>0&&C.closest(f).length===0}if(this.isCellOrBatchEditMode()&&!this._editCellInProgress){var u=d(o)||d(s==null?void 0:s.$element()),h=s&&!s._disposed&&s!==this.component,c=!!o.closest(".".concat(this.addWidgetPrefix(kv))).length,p=o.hasClass(this.addWidgetPrefix(Lv)),g=this.isCellEditMode();!i&&!u&&!p&&!(c&&g&&this.isEditing())&&(xi(o)||h)&&this._closeEditItem.bind(this)(o)}}),b.on(z.getDocument(),Y.up,this._pointerUpEditorHandler),b.on(z.getDocument(),Y.down,this._pointerDownEditorHandler),b.on(z.getDocument(),re,this._saveEditorHandler)}}isCellEditMode(){return this.option("editing.mode")===gr}isBatchEditMode(){return this.option("editing.mode")===Vt}isCellOrBatchEditMode(){return this.isCellEditMode()||this.isBatchEditMode()}_needToCloseEditableCell(e){var t,i=this.component.$element(),a=this.isEditing(),n=!i||!!e.closest(i).length;if(n){var o=e.closest(".".concat(Nv)).length;if(o){var s=this.getView("rowsView"),l=e.closest(".".concat($e,"> td")),d=s.getRowIndex(l.parent()),u=s.getCellElements(d);if(u!=null&&u.length){var h=u.index(l),c=this._columnsController.getVisibleColumns(),p=(t=c[h])===null||t===void 0?void 0:t.allowEditing,g=this.isEditCell(d,h);a=a&&!p&&!g}}}return a||super._needToCloseEditableCell(e)}_closeEditItem(e){this._needToCloseEditableCell(e)&&this.closeEditCell()}_focusEditorIfNeed(){var e;if(this._needFocusEditor&&this.isCellOrBatchEditMode()){var t=this._getVisibleEditColumnIndex(),i=(e=this._rowsView)===null||e===void 0?void 0:e._getCellElement(this._getVisibleEditRowIndex(),t);i&&!i.find(":focus").length?this._focusEditingCell(()=>{this._editCellInProgress=!1},i,!0):this._editCellInProgress=!1,this._needFocusEditor=!1}else super._focusEditorIfNeed()}isEditing(){if(this.isCellOrBatchEditMode()){var e=_(this.option(ve)),t=_(this.option(ut));return e&&t}return super.isEditing()}_handleEditColumnNameChange(e){var t=this._getVisibleEditRowIndex(e.previousValue);if(this.isCellOrBatchEditMode()&&t!==-1&&_(e.value)&&e.value!==e.previousValue){var i=this._columnsController.getVisibleColumnIndex(e.value),a=this._columnsController.getVisibleColumnIndex(e.previousValue);this._editCellFromOptionChanged(i,a,t)}}_addRow(e){if(this.isCellEditMode()&&this.hasChanges()){var t=new O;return this.saveEditData().done(()=>{this.hasChanges()?t.reject("cancel"):this.addRow(e).done(t.resolve).fail(t.reject)}),t.promise()}return super._addRow(e)}editCell(e,t){return this._editCell({rowIndex:e,columnIndex:t})}_editCell(e){var t=new O,i;return this.executeOperation(t,()=>{i=this._editCellCore(e),P(i).done(t.resolve).fail(t.reject)}),i!==void 0?i:t.promise()}_editCellCore(e){var t=this._dataController,i=_(e.oldColumnIndex)||_(e.oldRowIndex),{columnIndex:a,rowIndex:n,column:o,item:s}=this._getNormalizedEditCellOptions(e),l={data:s==null?void 0:s.data,cancel:!1,column:o};if(s.key===void 0){this._dataController.fireError("E1043");return}if(o&&(s.rowType==="data"||s.rowType==="detailAdaptive")&&!s.removed&&this.isCellOrBatchEditMode()){if(!i&&this.isEditCell(n,a))return!0;var d=n+t.getRowIndexOffset();return P(this._beforeEditCell(n,a,s)).done(u=>{u||this._prepareEditCell(l,s,a,d)||this._processCanceledEditingCell()})}return!1}_beforeEditCell(e,t,i){if(this.isCellEditMode()&&!i.isNewRow&&this.hasChanges()){var a=new O;return this.saveEditData().always(()=>{a.resolve(this.hasChanges())}),this.addDeferred(a),a}return!1}publicMethods(){var e=super.publicMethods();return e.concat(["editCell","closeEditCell"])}_getNormalizedEditCellOptions(e){var{oldColumnIndex:t,oldRowIndex:i,columnIndex:a,rowIndex:n}=e,o=this._columnsController,s=o.getVisibleColumns(),l=this._dataController.items(),d=l[n],u;_(t)?u=s[t]:u=this._getEditColumn(),_(i)||(i=this._getVisibleEditRowIndex()),G(a)&&(a=o.columnOption(a,"index"),a=o.getVisibleIndex(a));var h=s[a];return{oldColumn:u,columnIndex:a,oldRowIndex:i,rowIndex:n,column:h,item:d}}_prepareEditCell(e,t,i,a){var n;return t.isNewRow||(e.key=t.key),this._isEditingStart(e)?!1:(this._pageIndex=this._dataController.pageIndex(),this._setEditRowKey(t.key),this._setEditColumnNameByIndex(i),e.column.showEditorAlways||this._addInternalData({key:t.key,oldData:(n=t.oldData)!==null&&n!==void 0?n:t.data}),!0)}closeEditCell(e,t){var i=P(),a=this._getVisibleEditRowIndex();if(this.isCellOrBatchEditMode()){var n=new O;i=new O,this.executeOperation(n,()=>{this._closeEditCellCore(e,a,t).always(i.resolve)})}return i.promise()}_closeEditCellCore(e,t,i){var a=this._dataController,n=new O,o=n.promise();if(this.isCellEditMode()&&this.hasChanges()){if(!i)return this.saveEditData().done(l=>{if(!this.hasChanges()){this.closeEditCell(!!l).always(n.resolve);return}n.resolve()}),o}else if(this._resetEditRowKey(),this._resetEditColumnName(),t>=0){var s=[t];this._beforeCloseEditCellInBatchMode(s),e||a.updateItems({changeType:"update",rowIndices:s})}return n.resolve(),o}_resetModifiedClassCells(e){if(this.isBatchEditMode()){var t=this._columnsController.getVisibleColumns().length;e.forEach(i=>{for(var{key:a}=i,n=this._dataController.getRowIndexByKey(a),o=0;o<t;o++){var s=this._rowsView._getCellElement(n,o);s==null||s.removeClass(fv)}})}}_prepareChange(e,t,i){var a=m(e.cellElement);return this.isBatchEditMode()&&e.key!==void 0&&this._applyModified(a,e),super._prepareChange(e,t,i)}_cancelSaving(e){var t=this._dataController;this.isCellOrBatchEditMode()&&(this.isBatchEditMode()&&this._resetEditIndices(),t.updateItems()),super._cancelSaving(e)}optionChanged(e){var{fullName:t}=e;e.name==="editing"&&t===ut?(this._handleEditColumnNameChange(e),e.handled=!0):super.optionChanged(e)}_editCellFromOptionChanged(e,t,i){var a=this._columnsController.getVisibleColumns();e>-1&&fe(()=>{this._repaintEditCell(a[e],a[t],i)})}_handleEditRowKeyChange(e){var t;if(this.isCellOrBatchEditMode()){var i=this._getVisibleEditColumnIndex(),a=this._getEditRowIndexCorrection(),n=this._dataController.getRowIndexByKey(e.previousValue)+a;_(e.value)&&e.value!==e.previousValue&&((t=this._editCellFromOptionChanged)===null||t===void 0||t.call(this,i,i,n))}else super._handleEditRowKeyChange(e)}deleteRow(e){if(this.isCellEditMode()&&this.isEditing()){var{isNewRow:t}=this._dataController.items()[e],i=this._dataController.getKeyByRowIndex(e);this.closeEditCell(null,t).always(()=>{e=this._dataController.getRowIndexByKey(i),this._checkAndDeleteRow(e)})}else super.deleteRow(e)}_checkAndDeleteRow(e){this.isBatchEditMode()?this._deleteRowCore(e):super._checkAndDeleteRow(e)}_refreshCore(e){var{isPageChanged:t}=e??{},i=this.isBatchEditMode()||t&&this.option("scrolling.mode")!=="virtual";this.isCellOrBatchEditMode()?i&&(this._resetEditColumnName(),this._resetEditRowKey()):super._refreshCore(e)}_allowRowAdding(e){return this.isBatchEditMode()?!0:super._allowRowAdding(e)}_afterDeleteRow(e,t){var i=this._dataController;return this.isBatchEditMode()?(i.updateItems({changeType:"update",rowIndices:[t,e]}),new O().resolve()):super._afterDeleteRow(e,t)}_updateEditRow(e,t,i){this.isCellOrBatchEditMode()?this._updateRowImmediately(e,t,i):super._updateEditRow(e,t,i)}_isDefaultButtonVisible(e,t){if(this.isCellOrBatchEditMode()){var i=this.isBatchEditMode();switch(e.name){case"save":case"cancel":case"edit":return!1;case"delete":return super._isDefaultButtonVisible(e,t)&&(!i||!t.row.removed);case"undelete":return i&&this.allowDeleting(t)&&t.row.removed;default:return super._isDefaultButtonVisible(e,t)}}return super._isDefaultButtonVisible(e,t)}_isRowDeleteAllowed(){var e=super._isRowDeleteAllowed();return e||this.isBatchEditMode()}_beforeEndSaving(e){var t;this.isCellEditMode()?((t=e[0])===null||t===void 0?void 0:t.type)!=="update"&&super._beforeEndSaving(e):(this.isBatchEditMode()&&this._resetModifiedClassCells(e),super._beforeEndSaving(e))}prepareEditButtons(e){var t,i=(t=this.option("editing"))!==null&&t!==void 0?t:{},a=super.prepareEditButtons(e),n=i.allowUpdating||i.allowAdding||i.allowDeleting;return n&&this.isBatchEditMode()&&(a.push(this.prepareButtonItem(e,"save","saveEditData",21)),a.push(this.prepareButtonItem(e,"revert","cancelEditData",22))),a}_saveEditDataInner(){var e=this._dataController.getVisibleRows()[this.getEditRowIndex()],t=this._getEditColumn(),i=t==null?void 0:t.showEditorAlways,a=this.isCellEditMode()&&!(e!=null&&e.isNewRow),n;return a&&i&&(n=new O,this.addDeferred(n)),super._saveEditDataInner().always(n==null?void 0:n.resolve)}_applyChange(e,t,i){var a=this.isCellEditMode()&&e.row&&!e.row.isNewRow,{showEditorAlways:n}=e.column,o=e.column.setCellValue!==e.column.defaultSetCellValue,s=n&&!i&&a&&this.hasEditData()&&!this.isEditCell(e.rowIndex,e.columnIndex);if(s){this._focusEditingCell(),this._updateEditRow(e.row,!0,o);return}return super._applyChange(e,t,i)}_applyChangeCore(e,t){var{showEditorAlways:i}=e.column,a=this.isCellEditMode()&&e.row&&!e.row.isNewRow;if(i&&!t){if(a)return this._setEditRowKey(e.row.key,!0),this._setEditColumnNameByIndex(e.columnIndex,!0),this.saveEditData();if(this.isBatchEditMode())return t=this._needUpdateRow(e.column),super._applyChangeCore(e,t)}return super._applyChangeCore(e,t)}_processDataItemCore(e,t,i,a,n){var{data:o,type:s}=t;this.isBatchEditMode()&&s===Be&&(e.data=st(e.data,o)),super._processDataItemCore(e,t,i,a,n)}_processRemoveCore(e,t,i){if(!(this.isBatchEditMode()&&!i))return super._processRemoveCore(e,t,i)}_processRemoveIfError(e,t){if(!this.isBatchEditMode())return super._processRemoveIfError(e,t)}_beforeFocusElementInRow(e){super._beforeFocusElementInRow(e);var t=e>=0?e:0,i=this.getFirstEditableColumnIndex();i>=0&&this.editCell(t,i)}},sf={extenders:{controllers:{editing:of},views:{rowsView:{_createTable(){var r=this.callBase.apply(this,arguments),e=this._editingController;return e.isCellOrBatchEditMode()&&this.option("editing.allowUpdating")&&b.on(r,$(Sl.name,"dxDataGridRowsView"),"td:not(.".concat(Ti,")"),this.createAction(()=>{e.isEditing()&&e.closeEditCell()})),r},_createRow(r){var e=this.callBase.apply(this,arguments);if(r){var t=this._editingController,i=!!r.removed;t.isBatchEditMode()&&i&&e.addClass(zv)}return e}},headerPanel:{isVisible(){var r=this.getController("editing").option("editing");return this.callBase()||r&&(r.allowUpdating||r.allowDeleting)&&r.mode===Vt}}}}};A.registerModule("editingCellBased",sf);var xd="invalid",ra="revert-tooltip",Uo="dx-invalid-message",ia="invalid-message",$o="dx-invalid-message-always",lf="dx-revert-button",yd="validator",aa="dx-pending-indicator",qo="dx-validation-pending",Xo="content",jo="__DX_INSERT_INDEX__",df=2,uf="row",hf="form",na="batch",Yt="cell",cf="popup",pf="dx-group-cell",Ed=[cf,hf],gf="transparent",pe={valid:"valid",invalid:"invalid",pending:"pending"},Qt="insert",vf="remove",Jt="cancel",Zt=function(r){return _(r)&&r!==Jt},Yo=function(r,e){return r!==void 0||r===void 0&&e&&!e.isNewRow},ff=W.Controller.inherit({init(){this._editingController=this.getController("editing"),this.createAction("onRowValidating"),this._validationState||this.initValidationState()},initValidationState(){this._validationState=[],this._validationStateCache={}},_rowIsValidated(r){var e=this._getValidationData(r==null?void 0:r.key);return!!e&&!!e.validated},_getValidationData(r,e){var t=cr(r),i=Q(t),a;return i?a=this._validationState.filter(n=>U(n.key,r))[0]:a=this._validationStateCache[t],!a&&e&&(a={key:r,isValid:!0},this._validationState.push(a),i||(this._validationStateCache[t]=a)),a},_getBrokenRules(r,e){var t;return e?t=e.brokenRules||e.brokenRule&&[e.brokenRule]:t=r.brokenRules||[],t},_rowValidating(r,e){var t=new O,i=this._editingController.getChangeByKey(r==null?void 0:r.key),a=this._getBrokenRules(r,e),n=e?e.isValid:r.isValid,o={brokenRules:a,isValid:n,key:i.key,newData:i.data,oldData:this._editingController._getOldData(i.key),promise:null,errorText:this.getHiddenValidatorsErrorText(a)};return this.executeAction("onRowValidating",o),P(bt(o.promise)).always(()=>{r.isValid=o.isValid,r.errorText=o.errorText,t.resolve(o)}),t.promise()},getHiddenValidatorsErrorText(r){var e=[];return T(r,(t,i)=>{var{column:a}=i,n=a&&a.groupIndex!==void 0&&!a.showWhenGrouped,o=a&&a.visible;!i.validator.$element().parent().length&&(!o||n)&&e.push(i.message)}),e.join(", ")},validate(r){var e=!0,t=this._editingController,i=new O,a=[],n=t.getEditMode();if(r=r||n===uf,this._isValidationInProgress)return i.resolve(!1).promise();if(this._isValidationInProgress=!0,r){t.addDeferred(i);var o=t.getChanges();T(o,(l,d)=>{var{type:u,key:h}=d;if(u!=="remove"){var c=this._getValidationData(h,!0),p=this.validateGroup(c);a.push(p),p.done(g=>{c.validated=!0,e=e&&g.isValid})}})}else if(this._currentCellValidator){var s=this.validateGroup(this._currentCellValidator._findGroup());a.push(s),s.done(l=>{e=l.isValid})}return P(...a).done(()=>{this._isValidationInProgress=!1,i.resolve(e)}),i.promise()},validateGroup(r){var e=new O,t=r&&zt.getGroupConfig(r),i;return t!=null&&t.validators.length&&(this.resetRowValidationResults(r),i=zt.validateGroup(r)),P((i==null?void 0:i.complete)||i).done(a=>{P(this._rowValidating(r,a)).done(e.resolve)}),e.promise()},isRowDataModified:r=>!xr(r.data),updateValidationState(r){var e=this._editingController.getEditMode(),{key:t}=r,i=this._getValidationData(t,!0);if(Ed.includes(e))i.isValid=!0;else{if(r.type===Qt&&!this.isRowDataModified(r)){i.isValid=!0;return}this.setDisableApplyValidationResults(!0);var a=zt.getGroupConfig(i);if(a){var n=zt.validateGroup(i);P(n.complete||n).done(o=>{i.isValid=o.isValid,i.brokenRules=o.brokenRules})}else(!i.brokenRules||!i.brokenRules.length)&&(i.isValid=!0);this.setDisableApplyValidationResults(!1)}},setValidator(r){this._currentCellValidator=r},renderCellPendingIndicator(r){var e=r.find(".".concat(aa));if(!e.length){var t=r;e=m("<div>").appendTo(t).addClass(aa),this._createComponent(e,Oa),r.addClass(qo)}},disposeCellPendingIndicator(r){var e=r.find(".".concat(aa));if(e.length){var t=Oa.getInstance(e);t&&(t.dispose(),t.$element().remove()),r.removeClass(qo)}},validationStatusChanged(r){var{validator:e}=r,t=e.option("validationGroup"),{column:i}=e.option("dataGetter")();this.updateCellValidationResult({rowKey:t.key,columnIndex:i.index,validationResult:r})},validatorInitialized(r){r.component.on("validating",this.validationStatusChanged.bind(this)),r.component.on("validated",this.validationStatusChanged.bind(this))},validatorDisposing(r){var e=r.component,t=e.option("validationGroup"),{column:i}=e.option("dataGetter")(),a=this.getCellValidationResult({rowKey:t==null?void 0:t.key,columnIndex:i.index});Zt(a)&&a.status===pe.pending&&this.cancelCellValidationResult({change:t,columnIndex:i.index})},applyValidationResult(r,e){var{validator:t}=e,i=t.option("validationGroup"),{column:a}=t.option("dataGetter")();if(e.brokenRules&&e.brokenRules.forEach(d=>{d.columnIndex=a.index,d.column=a}),r){var n=this.getCellValidationResult({rowKey:i.key,columnIndex:a.index}),o=Zt(n)&&n.disabledPendingId===e.id;if(this._disableApplyValidationResults||o)return;if(e.status===pe.invalid){var s=r.find(":focus");Cl(s)||(b.trigger(s,"focus"),b.trigger(s,Y.down))}var l=!a.editCellTemplate&&this.getController("editorFactory").getEditorInstance(r);e.status===pe.pending?l?l.option("validationStatus",pe.pending):this.renderCellPendingIndicator(r):l?l.option("validationStatus",pe.valid):this.disposeCellPendingIndicator(r),r.toggleClass(this.addWidgetPrefix(xd),e.status===pe.invalid)}},_syncInternalEditingData(r){var e,t=this._editingController,i=t.getChangeByKey(r.key),a=t._getOldData(r.key),n=(e=r.row)===null||e===void 0?void 0:e.oldData;i&&n&&!a&&t._addInternalData({key:r.key,oldData:n})},createValidator(r,e){var t,i,a=this._editingController,{column:n}=r,{showEditorAlways:o}=n;if(!(_(n.command)||!n.validationRules||!Array.isArray(n.validationRules)||!n.validationRules.length)){var s=a.getIndexByKey(r.key,a.getChanges()),l=s>-1;if(!l){if(!o){var d=this.getController("columns"),u=(d==null?void 0:d.getVisibleColumns())||[];o=u.some(E=>E.showEditorAlways)}var h=U(this.option("editing.editRowKey"),r.key),c=a.isCellOrBatchEditMode()&&a.allowUpdating({row:r.row});l=h||c&&o,c&&o&&a._addInternalData({key:r.key,oldData:(i=(t=r.row)===null||t===void 0?void 0:t.oldData)!==null&&i!==void 0?i:r.data})}if(l){if(e&&!e.length){q.log("E1050");return}this._syncInternalEditingData(r);var p=this._getValidationData(r.key,!0),g=()=>{var E=a.getChangeByKey(p==null?void 0:p.key),R=n.calculateCellValue((E==null?void 0:E.data)||{});return R!==void 0?R:r.value},v=e&&e.hasClass("dx-widget");e&&e.addClass(this.addWidgetPrefix(yd));var f=new ch(e||m("<div>"),{name:n.caption,validationRules:S(!0,[],n.validationRules),validationGroup:p,adapter:v?null:{getValue:g,applyValidationResults:E=>{this.applyValidationResult(e,E)}},dataGetter(){var E=p==null?void 0:p.key,R=a.getChangeByKey(E),D=a._getOldData(E);return{data:st(D,R==null?void 0:R.data),column:n}},onInitialized:this.validatorInitialized.bind(this),onDisposing:this.validatorDisposing.bind(this)});if(v){var C=f.option("adapter");if(C){var w=C.bypass,x=()=>r.row.isNewRow&&!this._isValidationInProgress&&!a.isCellModified(r);C.getValue=g,C.validationRequestsCallbacks=[],C.bypass=()=>w.call(C)||x()}}return f}}},setDisableApplyValidationResults(r){this._disableApplyValidationResults=r},getDisableApplyValidationResults(){return this._disableApplyValidationResults},isCurrentValidatorProcessing(r){var{rowKey:e,columnIndex:t}=r;return this._currentCellValidator&&U(this._currentCellValidator.option("validationGroup").key,e)&&this._currentCellValidator.option("dataGetter")().column.index===t},validateCell(r){var e={rowKey:r.option("validationGroup").key,columnIndex:r.option("dataGetter")().column.index},t=this.getCellValidationResult(e),i=Zt(t),a=r.option("adapter");if(!i)t=r.validate();else{var n=a.getValue();U(n,t.value)||(t=r.validate())}var o=new O;return i&&t.status===pe.pending&&(this.updateCellValidationResult(e),a.applyValidationResults(t)),P(t.complete||t).done(s=>{i&&a.applyValidationResults(s),o.resolve(s)}),o.promise()},updateCellValidationResult(r){var{rowKey:e,columnIndex:t,validationResult:i}=r,a=this._getValidationData(e);if(a){a.validationResults||(a.validationResults={});var n;if(i){if(n=S({},i),a.validationResults[t]=n,i.status===pe.pending&&(this._editingController.getEditMode()===Yt&&(n.deferred=new O,n.complete.always(()=>{n.deferred.resolve()}),this._editingController.addDeferred(n.deferred)),this._disableApplyValidationResults)){n.disabledPendingId=i.id;return}}else n=a.validationResults[t];n&&n.disabledPendingId&&delete n.disabledPendingId}},getCellValidationResult(r){var{rowKey:e,columnIndex:t}=r,i,a=this._getValidationData(e,!0);return(i=a==null?void 0:a.validationResults)===null||i===void 0?void 0:i[t]},removeCellValidationResult(r){var{change:e,columnIndex:t}=r,i=this._getValidationData(e==null?void 0:e.key);i&&i.validationResults&&(this.cancelCellValidationResult({change:e,columnIndex:t}),delete i.validationResults[t])},cancelCellValidationResult(r){var{change:e,columnIndex:t}=r,i=this._getValidationData(e.key);if(e&&i.validationResults){var a=i.validationResults[t];a&&(a.deferred&&a.deferred.reject(Jt),i.validationResults[t]=Jt)}},resetRowValidationResults(r){r&&(r.validationResults&&delete r.validationResults,delete r.validated)},isInvalidCell(r){var{rowKey:e,columnIndex:t}=r,i=this.getCellValidationResult({rowKey:e,columnIndex:t});return Zt(i)&&i.status===pe.invalid},getCellValidator(r){var{rowKey:e,columnIndex:t}=r,i=this._getValidationData(e),a=i&&zt.getGroupConfig(i),n=a&&a.validators;return n&&n.filter(o=>{var{column:s}=o.option("dataGetter")();return s?s.index===t:!1})[0]},setCellValidationStatus(r){var e=this.getCellValidationResult({rowKey:r.key,columnIndex:r.column.index});_(e)?r.validationStatus=e!==Jt?e.status:Jt:delete r.validationStatus}}),mf={defaultOptions:()=>({editing:{texts:{validationCancelChanges:y.format("dxDataGrid-validationCancelChanges")}}}),controllers:{validating:ff},extenders:{controllers:{editing:{_addChange(r){var e=this.callBase.apply(this,arguments),t=this.getController("validating");return e&&r.type!==vf&&t.updateValidationState(e),e},_handleChangesChange(r){this.callBase.apply(this,arguments);var e=this.getController("validating");r.value.forEach(t=>{e._getValidationData(t.key)===void 0&&e.updateValidationState(t)})},_updateRowAndPageIndices(){var r=this,e=r.getView("rowsView").getTopVisibleItemIndex(),t=e;T(r.getChanges(),(i,a)=>{var{key:n,type:o}=a,s=this.getController("validating")._getValidationData(n);s&&!s.isValid&&s.pageIndex!==r._pageIndex&&(s.pageIndex=r._pageIndex,o===Qt?s.rowIndex=e:s.rowIndex=t,t++)})},_getValidationGroupsInForm(r){var e=this.getController("validating"),t=e._getValidationData(r.key,!0);return{validationGroup:t}},_validateEditFormAfterUpdate(r,e){e&&this._editForm&&this._editForm.validate(),this.callBase.apply(this,arguments)},_prepareEditCell(r){var e=this.callBase.apply(this,arguments),t=this.getController("validating");return e&&r.column.showEditorAlways&&t.updateValidationState({key:r.key}),e},processItems(r,e){var t=this.getChanges(),i=this.getController("data"),a=this.getController("validating");r=this.callBase(r,e);var n=r.length,o=function(s,l){var d={key:s.key},u=function(c,p){var g=-1,v=c.type===Qt,{key:f}=c;return T(p,(C,w)=>{if(U(f,v?w.key:i.keyOf(w)))return g=C,!1}),g}(s,r);if(!(u>=0)){l.rowIndex=l.rowIndex>n?l.rowIndex%n:l.rowIndex;var{rowIndex:h}=l;d[jo]=1,r.splice(h,0,d)}};return this.getEditMode()===na&&e!=="prepend"&&e!=="append"&&t.forEach(s=>{var{key:l}=s,d=a._getValidationData(l);d&&s.type&&d.pageIndex===this._pageIndex&&(s==null?void 0:s.pageIndex)!==this._pageIndex&&o(s,d)}),r},processDataItem(r){var e=r.data[jo],t=e?r.data.key:r.key,i=this.getEditMode();if(i===na&&e&&t){var a=this.getChanges(),n=I.getIndexByKey(t,a);if(n>=0){var o=a[n];if(o.type!==Qt){var s=this._getOldData(o.key);r.data=S(!0,{},s,o.data),r.key=t}}}this.callBase.apply(this,arguments)},_createInvisibleColumnValidators(r){var e=this,t=this.getController("validating"),i=this.getController("columns"),a=i.getColumns(),n=i.getInvisibleColumns().filter(d=>!d.isBand),o=i.getGroupColumns().filter(d=>!d.showWhenGrouped&&n.indexOf(d)===-1),s=[],l=(d,u)=>this._dataController.getRowIndexByKey(u)>=0&&n.indexOf(d)<0;return n.push(...o),Ed.includes(this.getEditMode())||T(a,(d,u)=>{r.forEach(h=>{var c;if(!l(u,h.key)){if(h.type===Qt)c=h.data;else if(h.type==="update"){var p=e._getOldData(h.key);if(!_(p))return;c=st(p,h.data)}if(c){var g=t.createValidator({column:u,key:h.key,value:u.calculateCellValue(c)});g&&s.push(g)}}})}),function(){s.forEach(d=>{d.dispose()})}},_beforeSaveEditData(r,e){var t=this.callBase.apply(this,arguments),i=this.getController("validating"),a=i._getValidationData(r==null?void 0:r.key);if(r){var n=r.type==="remove"||a.isValid;t=t||!n}else{var o=this._createInvisibleColumnValidators(this.getChanges());t=new O,this.executeOperation(t,()=>{i.validate(!0).done(s=>{switch(o(),this._updateRowAndPageIndices(),this.getEditMode()){case Yt:s||this._focusEditingCell();break;case na:s||(this._resetEditRowKey(),this._resetEditColumnName(),this.getController("data").updateItems())}t.resolve(!s)})})}return t.promise?t.promise():t},_beforeEditCell(r,e,t){var i=this.callBase(r,e,t);if(this.getEditMode()===Yt){var a=this._rowsView._getCellElement(r,e),n=a&&a.data("dxValidator"),o=a&&a.closest(".dx-row").data("options"),s=n&&n.option("adapter").getValue();if(n&&Yo(s,o)){var l=this.getController("validating"),d=new O;return P(l.validateCell(n),i).done((u,h)=>{d.resolve(u.status===pe.valid&&h)}),d.promise()}if(!n)return i}return!1},_afterSaveEditData(r){var e,t=this.getEditMode()===Yt;if(T(this.getChanges(),(l,d)=>{var u=this._showErrorRow(d);e=e||u}),e){var i=this._rowsView.getScrollable();i&&(i.update(),i.scrollToElement(e))}if(r&&t&&this._needUpdateRow()){var a=this.getEditRowIndex();this._dataController.updateItems({changeType:"update",rowIndices:[a]}),this._focusEditingCell()}else if(!r){var n=!0;if(t){var o=this.getController("columns").getColumns(),s=o.filter(l=>{var d;return l.showEditorAlways&&((d=l.validationRules)===null||d===void 0?void 0:d.length)>0}).length>0;n=!s}n&&this.getController("validating").initValidationState()}},_handleDataChanged(r){var e=this.getController("validating")._validationState;this.option("scrolling.mode")==="standard"&&this.resetRowAndPageIndices(),r.changeType==="prepend"&&T(e,(t,i)=>{i.rowIndex+=r.items.length}),this.callBase(r)},resetRowAndPageIndices(){var r=this.getController("validating")._validationState;T(r,(e,t)=>{t.pageIndex!==this._pageIndex&&(delete t.pageIndex,delete t.rowIndex)})},_beforeCancelEditData(){this.getController("validating").initValidationState(),this.callBase()},_showErrorRow(r){var e,t=this.getController("errorHandling"),i=this.getController("data").items(),a=this.getIndexByKey(r.key,i),n=this.getController("validating")._getValidationData(r.key);if(!(n!=null&&n.isValid)&&(n!=null&&n.errorText)&&a>=0)return e=this.getPopupContent(),t&&t.renderErrorRow(n==null?void 0:n.errorText,a,e)},updateFieldValue(r){var e=this.getController("validating"),t=new O;return e.removeCellValidationResult({change:this.getChangeByKey(r.key),columnIndex:r.column.index}),this.callBase.apply(this,arguments).done(()=>{var i=e.getCellValidator({rowKey:r.key,columnIndex:r.column.index});P(i&&e.validateCell(i)).done(a=>{this.getController("editorFactory").refocus(),t.resolve(a)})}),t.promise()},highlightDataCell(r,e){this.callBase.apply(this,arguments);var t=this.getController("validating");t.setCellValidationStatus(e);var i=!!e.setValue,a=this.isCellModified(e),n=_(e.validationStatus),o=a&&e.column.setCellValue||i&&!a&&!(e.row.isNewRow||!n);if(o){var s=r.data("dxValidator");s&&P(this.getController("validating").validateCell(s)).done(()=>{t.setCellValidationStatus(e)})}},getChangeByKey(r){var e=this.getChanges();return e[I.getIndexByKey(r,e)]},isCellModified(r){var e=this.callBase(r),t=this.getChangeByKey(r.key),i=!!r.row&&this.getController("validating").isInvalidCell({rowKey:r.key,columnIndex:r.column.index});return e||this.getController("validating")._rowIsValidated(t)&&i}},editorFactory:{_showRevertButton(r){var e,t=(e=this._revertTooltip)===null||e===void 0?void 0:e.$element();if(!r||!r.length){t==null||t.remove(),this._revertTooltip=void 0;return}if(!r.find(t).length){var i=r.closest(".".concat(this.addWidgetPrefix(Xo))),a=this.addWidgetPrefix(ra);t==null||t.remove(),t=m("<div>").addClass(a).appendTo(r);var n={animation:null,visible:!0,width:"auto",height:"auto",shading:!1,container:i,propagateOutsideClick:!0,hideOnOutsideClick:!1,wrapperAttr:{class:a},contentTemplate:()=>{var o=m("<div>").addClass(lf),s={icon:"revert",hint:this.option("editing.texts.validationCancelChanges"),onClick:()=>{this._editingController.cancelEditData()}};return new pr(o,s).$element()},position:{my:"left top",at:"right top",offset:"1 0",collision:"flip",boundaryOffset:"0 0",boundary:this._rowsView.element(),of:r},onPositioned:this._positionedHandler.bind(this)};this._revertTooltip=new Aa(t,n)}},_hideFixedGroupCell(r,e){var t,i,a=this._rowsView.isFixedColumns(),n=this._editingController.isFormOrPopupEditMode();if(a&&!n){var o=r.closest(".dx-row").next().data("options");o&&o.rowType==="group"&&(t=m(this._rowsView.getRowElement(o.rowIndex)).last(),i=t.find(".".concat(pf)),i.length&&i.get(0).style.visibility!=="hidden"&&(i.css("visibility","hidden"),e.onDisposing=function(){i.css("visibility","")}))}},_positionedHandler(r,e){if(!r.component.__skipPositionProcessing){var t=m(r.element).hasClass(this.addWidgetPrefix(ra)),i=!t&&this._rowsView.updateFreeSpaceRowHeight(),a=this._normalizeValidationMessagePositionAndMaxWidth(r,t,e);r.component.__skipPositionProcessing=!!(i||a),a?r.component.option(a):i&&r.component.repaint()}},_showValidationMessage(r,e,t){var i,a=r.find(".dx-dropdowneditor-overlay").data("dxPopup"),n=a&&a.option("visible"),o=n?"top right":"top ".concat(t),s=n?"top left":"bottom ".concat(t),l=((i=this._columnsController.getFixedColumns())===null||i===void 0?void 0:i.length)>0,d=l?this.getView("rowsView").element():r.closest(".".concat(this.addWidgetPrefix(Xo))),u="";e&&e.forEach(g=>{u+=(u.length?"<br/>":"")+ih(g)});var h=this.addWidgetPrefix(ia);this._rowsView.element().find(".".concat(h)).remove();var c=m("<div>").addClass(Uo).addClass($o).addClass(h).html(u).appendTo(r),p={container:d,shading:!1,width:"auto",height:"auto",visible:!0,animation:!1,propagateOutsideClick:!0,hideOnOutsideClick:!1,wrapperAttr:{class:"".concat(Uo," ").concat($o," ").concat(h)},position:{collision:"flip",boundary:this._rowsView.element(),boundaryOffset:"0 0",offset:{x:0,y:!n&&te.mozilla?-1:0},my:o,at:s,of:r},onPositioned:g=>{this._positionedHandler(g,n),this._shiftValidationMessageIfNeed(g.component.$content(),r)}};this._hideFixedGroupCell(r,p),new Aa(c,p)},_hideValidationMessage(){var r,e=(r=this._rowsView.element())===null||r===void 0?void 0:r.find(this._getValidationMessagesSelector());e==null||e.remove()},_normalizeValidationMessagePositionAndMaxWidth(r,e,t){var i=this._columnsController.getFixedColumns();if(!(!i||!i.length)){var a,n=!e&&(o=this,s=r.element,l=m(s).closest("tr").index(),d=m(o._rowsView.getRowElement(l)).first().children().filter(":not(.dx-hidden-cell)"),o._rowsView._getWidths(d).reduce((v,f)=>v+f,0)),o,s,l,d,u=r.component.$content(),h=Te(u,!0),c=!e&&h>n,p=this._rowsView.getCellIndex(m(r.element).closest("td")),g=function(v){var f,C;return v.some((w,x)=>{if(w.command===gf)return f=x===0?-1:x,C=x===v.length-1?-1:x+w.colspan-1,!0}),{startColumnIndex:f,endColumnIndex:C}}(i);return!e&&(p===g.startColumnIndex||c)?a={collision:"none flip",my:"top left",at:t?"top right":"bottom left"}:p===g.endColumnIndex&&(a={collision:"none flip",my:"top right",at:e||t?"top left":"bottom right"},e&&(a.offset="-1 0")),a&&{position:a,maxWidth:c?n-2:void 0}}},_shiftValidationMessageIfNeed(r,e){var t=this._revertTooltip&&this._revertTooltip.$content();if(t){var i=r.offset(),a=t.offset();if(i.top===a.top&&i.left+X(r)>a.left){var n=X(t)+df;r.css("left",a.left<e.offset().left?-n:n)}}},_getRevertTooltipsSelector(){var r=this.addWidgetPrefix(ra);return".dx-editor-cell .".concat(r)},_getValidationMessagesSelector(){var r=this.addWidgetPrefix(ia);return".dx-editor-cell .".concat(r,", .dx-cell-modified .").concat(r)},init(){this.callBase(),this._editingController=this.getController("editing"),this._columnsController=this.getController("columns"),this._rowsView=this.getView("rowsView")},loseFocus(r){r||this.getController("validating").setValidator(null),this.callBase()},updateCellState(r,e,t){var i,a=r==null?void 0:r.closest(this._getFocusCellSelector()),n=a!=null&&a.is("td")?a:null,o=a==null?void 0:a.closest(".dx-row").data("options"),s=o?this.getController("editing").getChangeByKey(o.key):null,l=n&&this.getController("columns").getVisibleColumns()[n.index()],d=((i=s==null?void 0:s.data)===null||i===void 0?void 0:i[l==null?void 0:l.name])!==void 0&&!this._editingController.isSaving();this._editingController.getEditMode()===Yt&&((e==null?void 0:e.status)===pe.invalid||d?this._showRevertButton(a):this._revertTooltip&&this._revertTooltip.$element().remove());var u=e&&e.status===pe.invalid;if(u&&n&&l&&e&&e.brokenRules){var h=[];e.brokenRules.forEach(c=>{c.message&&h.push(c.message)}),h.length&&this._showValidationMessage(a,h,l.alignment||"left")}!t&&this._rowsView.element()&&this._rowsView.updateFreeSpaceRowHeight()},focus(r,e){if(!arguments.length)return this.callBase();if(this._hideValidationMessage(),r!=null&&r.hasClass("dx-row")||r!=null&&r.hasClass("dx-master-detail-cell"))return this.callBase(r,e);var t=r==null?void 0:r.closest(this._getFocusCellSelector()),{callBase:i}=this,a=t&&(t.data("dxValidator")||r.find(".".concat(this.addWidgetPrefix(yd))).eq(0).data("dxValidator")),n=t&&t.closest(".dx-row").data("options"),o=this.getController("editing"),s=n?o.getChangeByKey(n.key):null,l=this.getController("validating"),d;if(a){l.setValidator(a);var u=a.option("adapter").getValue();if(Yo(u,n)||l._rowIsValidated(s))return o.waitForDeferredOperations().done(()=>{P(l.validateCell(a)).done(h=>{d=h;var{column:c}=d.validator.option("dataGetter")();s&&c&&!l.isCurrentValidatorProcessing({rowKey:s.key,columnIndex:c.index})||(d.status===pe.invalid&&(e=!0),this.updateCellState(r,d,e),i.call(this,r,e))})}),this.callBase(r,e)}return this.updateCellState(r,d,e),this.callBase(r,e)},getEditorInstance(r){var e=r.find(".dx-texteditor").eq(0);return I.getWidgetInstance(e)}},data:{_getValidationStatus(r){var e=Zt(r)?r.status:r;return e||pe.valid},_isCellChanged(r,e,t,i,a){var n,o,s=(n=r.cells)===null||n===void 0?void 0:n[i],l=this._getValidationStatus({status:s==null?void 0:s.validationStatus}),d=this.getController("validating"),u=d.getCellValidationResult({rowKey:r.key,columnIndex:i}),h=d._getValidationData(r.key),c=this._getValidationStatus(u),p=JSON.stringify(e.modifiedValues)!==JSON.stringify(r.modifiedValues),g=l!==c&&p,v=m(s==null?void 0:s.cellElement).hasClass(this.addWidgetPrefix(xd)),f=(o=s==null?void 0:s.column.validationRules)===null||o===void 0?void 0:o.length,C=r.isEditing!==e.isEditing&&f,w=g||h.isValid&&v;return C||w?!0:this.callBase.apply(this,arguments)}}},views:{rowsView:{updateFreeSpaceRowHeight(r){var e,t,i,a=this.element(),n=a&&a.find(".".concat(this.addWidgetPrefix(ia)," .dx-overlay-content"));if(this.callBase(r),n&&n.length&&(e=this._getRowElements(),i=this._getFreeSpaceRowElements(r),t=i.first(),t&&e.length===1&&(!t.is(":visible")||le(n)>le(t))))return i.show(),ur(i,le(n)),!0},_formItemPrepared(r,e){this.callBase.apply(this,arguments),xe(()=>{var t=e.find(".dx-widget").first(),i=t.length&&!t.children().length;i||this.getController("validating").createValidator(r,t)})},_cellPrepared(r,e){this.getController("editing").isFormOrPopupEditMode()||this.getController("validating").createValidator(e,r),this.callBase.apply(this,arguments)},_restoreErrorRow(r){var e=this.getController("editing");e&&e.hasChanges()&&this._getRowElements(r).each((t,i)=>{var a=m(i).data("options");if(a){var n=e.getChangeByKey(a.key);n&&e._showErrorRow(n)}})}}}}};A.registerModule("validating",mf);var oa="scrolling.legacyMode",Sd=r=>r.option("scrolling.loadTwoPagesOnStart")||r._controller.isVirtual()||r._controller.getViewportItemIndex()>0,Qr=r=>r._cache.length?r._cache[0].pageIndex:-1,ka=r=>r._cache.length?r._cache[r._cache.length-1].pageIndex:-1,gi=(r,e,t)=>{r._isChangedFiring=!0,e(t),r._isChangedFiring=!1},Qo=(r,e,t)=>{if(r._isDelayChanged)return r._isDelayChanged=!1,gi(r,e,t),!0},_f=r=>{var e=r._dataOptions.pageSize(),t=r.option("scrolling.preventPreload");if(t)return 0;var i=r._controller.viewportSize();if(r._controller.isVirtualMode()&&r.option("scrolling.removeInvisiblePages")){i=0;for(var a=r._controller.viewportSize()*r._controller.viewportItemSize(),n=r._controller.getContentOffset(),o=r._controller.getViewportPosition(),s=r._controller.virtualItemsCount(),l=r._dataOptions.totalItemsCount(),d=s.begin;d<l&&!(n>=o+a);d++){var u=r._controller.getItemSizes()[d]||r._controller.viewportItemSize();n+=u,n>=o&&i++}}return e&&i>0?Math.ceil(i/e):1},Jr=(r,e)=>{var t=r.option("scrolling.preloadEnabled"),i=_f(r),a=r._controller.isAppendMode();return i&&(e?i=t?1:0:(t&&i++,(a||!Sd(r))&&i--)),i},Cf=r=>{var e=-1,t=Qr(r),i=r._dataOptions;if(t<0)e=r._pageIndex;else if(!r._cache[r._pageIndex-t])e=r._pageIndex;else if(t>=0&&r._controller.viewportSize()>=0){if(t>0){var a=ka(r)+1===i.pageCount()&&r._cache.length<Jr(r)+1,n=a||r._pageIndex===t&&Jr(r,!0);n&&(e=t-1)}if(e<0){var o=t+r._cache.length<=r._pageIndex+Jr(r);o&&(e=t+r._cache.length)}}return r._loadingPageIndexes[e]&&(e=-1),e},wf=(r,e)=>{var t=r._dataOptions;if(e===r.pageIndex()||!t.isLoading()&&e<t.pageCount()||!t.hasKnownLastPage()&&e===t.pageCount())return t.pageIndex(e),r._loadingPageIndexes[e]=!0,P(t.load()).always(()=>{r._loadingPageIndexes[e]=!1})},Jo=(r,e,t,i,a)=>{var n=r._dataOptions,o=n.items().slice(),s=Q(t)?t:void 0,l=t==="prepend",d=n.viewportItems();t&&G(t)&&!r._isDelayChanged&&(s={changeType:t,items:o},a&&(s.removeCount=a.itemsCount,s.removeCount&&n.correctCount&&(s.removeCount=n.correctCount(d,s.removeCount,l))));var u=a?a.itemsLength:0;u&&n.correctCount&&(u=n.correctCount(d,u,l)),t==="append"?(d.push.apply(d,o),a&&d.splice(0,u)):l?(d.unshift.apply(d,o),a&&d.splice(-u)):r._dataOptions.viewportItems(o),n.updateLoading(),r._lastPageIndex=r.pageIndex(),r._isDelayChanged=i,i||gi(r,e,s)};class xf{constructor(e,t){this._dataOptions=t,this._controller=e,this._pageIndex=this._lastPageIndex=t.pageIndex(),this._cache=[],this._loadingPageIndexes={}}option(){return this._controller.option.apply(this._controller,arguments)}viewportItemIndexChanged(e){var t=this._dataOptions.pageSize(),i=this._dataOptions.pageCount(),a=this._controller.isVirtualMode(),n=this._controller.isAppendMode(),o=this._dataOptions.totalItemsCount(),s;if(t&&(a||n)&&o>=0){var l=this._controller.viewportSize();if(l&&e+l>=o&&!this._controller.isVirtual())if(this._dataOptions.hasKnownLastPage()){s=i-1;var d=o%t;s>0&&d>0&&d<l&&s--}else s=i;else{s=Math.floor(e/t);var u=i-1;s=Math.max(s,0),s=Math.min(s,u)}return this.pageIndex(s),this.load()}}pageIndex(e){var t=this._controller.isVirtualMode(),i=this._controller.isAppendMode();return this.option(oa)!==!1&&(t||i)?(e!==void 0&&(this._pageIndex=e),this._pageIndex):this._dataOptions.pageIndex(e)}beginPageIndex(e){var t=Qr(this);return t<0&&(t=e!==void 0?e:this.pageIndex()),t}endPageIndex(){var e=ka(this);return e>0?e:this._lastPageIndex}pageSize(){return this._dataOptions.pageSize()}load(){var e=this._dataOptions,t,i=this._controller.isVirtualMode(),a=this._controller.isAppendMode();if(this.option(oa)!==!1&&(i||a)){var n=Cf(this);if(n>=0){var o=wf(this,n);o&&(t=new O,o.done(()=>{var s=this._delayDeferred;s?s.done(t.resolve).fail(t.reject):t.resolve()}).fail(t.reject),e.updateLoading())}}else t=e.load();return!t&&this._lastPageIndex!==this.pageIndex()&&this._dataOptions.onChanged({changeType:"pageIndex"}),t||new O().resolve()}loadIfNeed(){var e=this._controller.isVirtualMode(),t=this._controller.isAppendMode();if((e||t)&&!this._dataOptions.isLoading()&&(!this._isChangedFiring||this._controller.isVirtual())){var i=this._controller.getViewportPosition();i>0?this._controller._setViewportPositionCore(i):this.load()}}handleDataChanged(e,t){var i=this._dataOptions,a=this._cache.length,n,o,s=this._controller.isVirtualMode(),l=this._controller.isAppendMode();if(t&&t.changes)gi(this,e,t);else if(this.option(oa)!==!1&&(s||l)){var d=Qr(this);if(d>=0&&(s&&d+this._cache.length!==i.pageIndex()&&d-1!==i.pageIndex()&&(a=0,this._cache=[]),l)){if(i.pageIndex()===0)this._cache=[];else if(i.pageIndex()<ka(this)){gi(this,e,{changeType:"append",items:[]});return}}var u={pageIndex:i.pageIndex(),itemsLength:i.items(!0).length,itemsCount:this.itemsCount(!0)};this.option("scrolling.removeInvisiblePages")&&s?o=this._cache.length>Math.max(Jr(this)+(this.option("scrolling.preloadEnabled")?1:0),2):Qo(this,e,{isDelayed:!0});var h;d===i.pageIndex()+1?(o&&(h=this._cache.pop()),n="prepend",this._cache.unshift(u)):(o&&(h=this._cache.shift()),n="append",this._cache.push(u));var c=s&&a===0&&Sd(this);Jo(this,e,this._cache.length>1?n:void 0,c,h),this._delayDeferred=this.load().done(()=>{Qo(this,e)&&this.load()})}else Jo(this,e,t)}getDelayDeferred(){return this._delayDeferred}itemsCount(e){var t=0,i=this._controller.isVirtualMode();return!e&&i?this._cache.forEach(a=>{t+=a.itemsCount}):t=this._dataOptions.itemsCount(),t}virtualItemsCount(){var e=Qr(this);e<0&&(e=this._dataOptions.pageIndex());var t=e*this._dataOptions.pageSize(),i=this._cache.length*this._dataOptions.pageSize(),a=Math.max(0,this._dataOptions.totalItemsCount()-i-t);return{begin:t,end:a}}reset(){this._loadingPageIndexes={},this._cache=[]}}var yf="infinite",bd="virtual",kr="scrolling.legacyMode",Zo=r=>r.option("scrolling.mode")===bd||r._isVirtual,Ef=r=>r.option("scrolling.mode")===yf&&!r._isVirtual;function Id(r,e,t){var i,a=[],n=[];t=t||r;function o(u){var h=u.element?u.$element():u,c=Ra.offset(h);return c?u.scrollTop()-(c.top-r.offset().top):r.offset().top}var s={on(u,h,c){u.on("scroll",c)},off(u,h,c){u.off("scroll",c)}};function l(u){var h=u.get(0).nodeName==="#document",c=u.get(0).nodeType===ne().Node.ELEMENT_NODE,p=u.data("dxScrollable"),g=s;if(!(!p&&(p=h&&m(ne())||c&&u.css("overflowY")==="auto"&&u,g=b,!p))){var v=function(f){return function(){var C=f.scrollTop()-o(f);C=C>0?C:0,e(C)}}(p);g.on(p,"scroll",v),a.push(f=>{var C=o(p),w=p.scrollTo?"scrollTo":"scrollTop";f-C>=0&&p[w](f+C)}),n.push(()=>{g.off(p,"scroll",v)})}}var d=u=>{var h;return m((h=u.get(0).parentNode)!==null&&h!==void 0?h:u.get(0).host)};for(i=t.parent();i.length;i=d(i))l(i);return{scrollTo(u){T(a,(h,c)=>{c(u)})},dispose(){T(n,(u,h)=>{h()})}}}var gn=Cr.inherit(function(){var r={ctor(e,t,i){this._dataOptions=t,this.component=e,this._viewportSize=e.option(kr)===!1?15:0,this._viewportItemSize=20,this._viewportItemIndex=0,this._position=0,this._isScrollingBack=!1,this._contentSize=0,this._itemSizes={},this._sizeRatio=1,this._isVirtual=i,this.positionChanged=ye(),this._dataLoader=new xf(this,this._dataOptions)},getItemSizes(){return this._itemSizes},option(){return this.component.option.apply(this.component,arguments)},isVirtual(){return this._isVirtual},virtualItemsCount(){if(Zo(this)){var e=this._dataOptions,t=e.totalItemsCount();if(this.option(kr)===!1&&t!==-1){var i=this.getViewportParams(),a=e.loadedOffset(),n=e.loadedItemCount(),o=Math.max(i.skip,a),s=Math.min(i.take,n),l=Math.max(t-(o+s),0);return{begin:o,end:l}}return this._dataLoader.virtualItemsCount.apply(this._dataLoader,arguments)}},getScrollingTimeout(){var e,t=this.option("scrolling.renderAsync"),i=0;return _(t)?t&&(i=(e=this.option("scrolling.timeout"))!==null&&e!==void 0?e:0):(i=Math.min(this.option("scrolling.timeout")||0,this._dataOptions.changingDuration()),i<this.option("scrolling.renderingThreshold")&&(i=this.option("scrolling.minTimeout")||0)),i},setViewportPosition(e){var t=new O,i=this.getScrollingTimeout();return clearTimeout(this._scrollTimeoutID),i>0?this._scrollTimeoutID=setTimeout(()=>{this._setViewportPositionCore(e),t.resolve()},i):(this._setViewportPositionCore(e),t.resolve()),t.promise()},getViewportPosition(){return this._position},getItemIndexByPosition(e,t,i){e=e??this._position;for(var a=this.getItemSize(),n=0,o=0,s=Object.keys(this._itemSizes).concat(-1),l=0;l<s.length&&n<e;l++){var d=parseInt(s[l]),u=(e-n)/a;if(d<0||o+u<d){o+=u,this._sizeRatio<1&&_(t)&&(o=t+i/this._viewportItemSize);break}else u=d-o,n+=u*a,o+=u;var h=this._itemSizes[d];n+=h,o+=n<e?1:(e-n+h)/h}return Math.round(50*o)/50},isScrollingBack(){return this._isScrollingBack},_setViewportPositionCore(e){var t=this._position||0;this._position=e,t!==this._position&&(this._isScrollingBack=this._position<t);var i=this.getItemIndexByPosition(),a=this.setViewportItemIndex(i);return this.positionChanged.fire(),a},setContentItemSizes(e){var t=this.virtualItemsCount();if(this._contentSize=e.reduce((n,o)=>n+o,0),t){e.forEach((n,o)=>{this._itemSizes[t.begin+o]=n});var i=(t.begin+t.end+this.itemsCount())*this._viewportItemSize,a=I.getContentHeightLimit(te);i>a?this._sizeRatio=a/i:this._sizeRatio=1}},getItemSize(){return this._viewportItemSize*this._sizeRatio},getItemOffset(e,t){var i=this.virtualItemsCount(),a=e;if(!i)return 0;var n=0,o=this._dataOptions.totalItemsCount();return Object.keys(this._itemSizes).forEach(s=>{a&&(t?s>=o-e:s<e)&&(n+=this._itemSizes[s],a--)}),Math.floor(n+a*this._viewportItemSize*this._sizeRatio)},getContentOffset(e){var t=e==="end",i=this.virtualItemsCount();return i?this.getItemOffset(t?i.end:i.begin,t):0},getVirtualContentSize(){var e=this.virtualItemsCount();return e?this.getContentOffset("begin")+this.getContentOffset("end")+this._contentSize:0},getViewportItemIndex(){return this._viewportItemIndex},setViewportItemIndex(e){if(this._viewportItemIndex=e,this.option(kr)!==!1)return this._dataLoader.viewportItemIndexChanged.apply(this._dataLoader,arguments)},viewportItemSize(e){return e!==void 0&&(this._viewportItemSize=e),this._viewportItemSize},viewportSize(e){return e!==void 0&&(this._viewportSize=e),this._viewportSize},viewportHeight(e,t){var i=t??this._position,a=this.getItemIndexByPosition(i),n=this.getItemIndexByPosition(i+e,a,e);this.viewportSize(Math.ceil(n-a)),!_(t)&&this._viewportItemIndex!==a&&this._setViewportPositionCore(i)},reset(e){this._dataLoader.reset(),e||(this._itemSizes={})},subscribeToWindowScrollEvents(e){this._windowScroll=this._windowScroll||Id(e,t=>{this.viewportItemSize()&&this.setViewportPosition(t)})},dispose(){clearTimeout(this._scrollTimeoutID),this._windowScroll&&this._windowScroll.dispose(),this._windowScroll=null},scrollTo(e){this._windowScroll&&this._windowScroll.scrollTo(e)},isVirtualMode(){return Zo(this)},isAppendMode(){return Ef(this)},getViewportParams(){var e,t=this.option("scrolling.mode")===bd,i=this._dataOptions.totalItemsCount(),a=this._dataOptions.hasKnownLastPage(),n=a&&this._viewportItemIndex>i?i:this._viewportItemIndex,o=this._viewportSize+n,s=this.option("scrolling.prerenderedRowChunkSize")||1,l=this.isScrollingBack(),d=(e=this.option("scrolling.prerenderedRowCount"))!==null&&e!==void 0?e:1,u=l?d:0,h=l?0:d,c=Math.floor(Math.max(0,n-u)/s)*s,p=Math.ceil((o+h-c)/s)*s;if(t){var g=Math.max(0,i-c);p=Math.min(p,g)}return{skip:c,take:p}},itemsCount(){var e=0;return this.option(kr)?e=this._dataLoader.itemsCount.apply(this._dataLoader,arguments):e=this._dataOptions.itemsCount(),e}};return["pageIndex","beginPageIndex","endPageIndex","pageSize","load","loadIfNeed","handleDataChanged","getDelayDeferred"].forEach(e=>{r[e]=function(){return this._dataLoader[e].apply(this._dataLoader,arguments)}}),r}());const ey={VirtualScrollController:gn};var es="bottom-load-panel",Sf="group-space",ts="dx-freespace-row",bf="dx-column-lines",Mr="dx-virtual-row",If="dx-row-inserted",Tf="infinite",Rf="virtual",Td=300,M="scrolling.legacyMode",sa="paging.pageIndex",se=function(r){return r.option("scrolling.mode")===Rf},Pe=function(r){return r.option("scrolling.mode")===Tf},Se=function(r){return se(r)||Pe(r)},rs=function(r,e,t,i){for(var a=0;a<e+1;a++){var n=r[t?r.length-1-a:a];n&&!i(n,a===e,t)&&e++}return e},Zr=function(r,e){return r.rowType==="data"&&!r.isNewRow||r.rowType==="group"&&e.isGroupItemCountable(r.data)},Of=function(r){return r.forEach((e,t)=>{e.rowIndex=t}),r},Af=function(){var r=function(t){var i=t._virtualScrollController.beginPageIndex(-1);se(t)&&(i<0||t.viewportSize()>=0&&t.getViewportItemIndex()>=0&&(i*t.pageSize()>t.getViewportItemIndex()||i*t.pageSize()+t.itemsCount()<t.getViewportItemIndex()+t.viewportSize())&&t._dataSource.isLoading()?t._isLoading||(t._isLoading=!0,t.loadingChanged.fire(!0)):t._isLoading&&(t._isLoading=!1,t.loadingChanged.fire(!1)))},e={init(){this.callBase.apply(this,arguments),this._items=[],this._totalCount=-1,this._isLoaded=!0,this._loadPageCount=1,this._virtualScrollController=new gn(this.component,this._getVirtualScrollDataOptions())},_getVirtualScrollDataOptions(){var t=this;return{pageSize:()=>t.pageSize(),totalItemsCount:()=>t.totalItemsCount(),hasKnownLastPage:()=>t.hasKnownLastPage(),pageIndex:i=>t._dataSource.pageIndex(i),isLoading:()=>t._dataSource.isLoading()&&!t.isCustomLoading(),pageCount:()=>t.pageCount(),load:()=>t._dataSource.load(),updateLoading(){r(t)},itemsCount:()=>t.itemsCount(!0),items:()=>t._dataSource.items(),viewportItems(i){return i&&(t._items=i),t._items},onChanged(i){t.changed.fire(i)},changingDuration(){return t.isLoading()?Td:t._renderTime||0}}},_handleLoadingChanged(t){if(this.option(M)===!1){this.callBase.apply(this,arguments);return}(!se(this)||this._isLoadingAll)&&(this._isLoading=t,this.callBase.apply(this,arguments)),t?this._startLoadTime=new Date:this._startLoadTime=void 0},_handleLoadError(){this.option(M)!==!1&&(this._isLoading=!1,this.loadingChanged.fire(!1)),this.callBase.apply(this,arguments)},_handleDataChanged(t){if(this.option(M)===!1){this._items=this._dataSource.items().slice(),this._totalCount=this._dataSourceTotalCount(!0),this.callBase.apply(this,arguments);return}var i=this.callBase.bind(this);this._virtualScrollController.handleDataChanged(i,t)},_customizeRemoteOperations(t,i){var a=this.option(M)===!1,n=this.option("scrolling.renderAsync");_(n)||(n=this._renderTime>=this.option("scrolling.renderingThreshold")),(se(this)||Pe(this)&&a)&&!i.reload&&(i.skip||a)&&!n&&(t.delay=void 0),this.callBase.apply(this,arguments)},items(){return this._items},_dataSourceTotalCount(t){return this.option(M)===!1&&se(this)&&!t?this._totalCount:this.callBase()},itemsCount(t){return t||this.option(M)===!1?this.callBase():this._virtualScrollController.itemsCount()},load(t){return this.option(M)===!1||t?this.callBase(t):this._virtualScrollController.load()},isLoading(){return this.option(M)===!1?this._dataSource.isLoading():this._isLoading},isLoaded(){return this._dataSource.isLoaded()&&this._isLoaded},resetPagesCache(t){t||this._virtualScrollController.reset(!0),this.callBase.apply(this,arguments)},_changeRowExpandCore(){var t=this.callBase.apply(this,arguments);return this.option(M)===!1||(this.resetPagesCache(),r(this)),t},reload(){this._dataSource.pageIndex(this.pageIndex());var t=this._virtualScrollController;if(this.option(M)!==!1&&t){var i=new O;return this.callBase.apply(this,arguments).done(a=>{var n=t.getDelayDeferred();n?n.done(i.resolve).fail(i.reject):i.resolve(a)}).fail(i.reject),i}return this.callBase.apply(this,arguments)},refresh(t,i){if(this.option(M)!==!1){var{storeLoadOptions:a}=t,n=this._dataSource;i.reload?(this._virtualScrollController.reset(),n.items().length=0,this._isLoaded=!1,r(this),this._isLoaded=!0,Pe(this)?(this.pageIndex(0),n.pageIndex(0),a.pageIndex=0,t.pageIndex=0,a.skip=0):(n.pageIndex(this.pageIndex()),n.paginate()&&(t.pageIndex=this.pageIndex(),a.skip=this.pageIndex()*this.pageSize()))):Pe(this)&&a.skip&&this._totalCountCorrection<0&&(a.skip+=this._totalCountCorrection)}return this.callBase.apply(this,arguments)},dispose(){this._virtualScrollController.dispose(),this.callBase.apply(this,arguments)},loadPageCount(t){if(!_(t))return this._loadPageCount;this._loadPageCount=t},_handleDataLoading(t){var i=this.loadPageCount(),a=this.pageSize(),n=this.option(M)===!1,{storeLoadOptions:o}=t,s=_(o.take);t.loadPageCount=i,!t.isCustomLoading&&n&&s&&i>1&&a>0&&(o.take=i*a),this.callBase.apply(this,arguments)},_loadPageSize(){return this.callBase.apply(this,arguments)*this.loadPageCount()}};return["beginPageIndex","endPageIndex","pageIndex"].forEach(t=>{e[t]=function(){if(this.option(M)===!1){var i=this._dataSource;return i.pageIndex.apply(i,arguments)}var a=this._virtualScrollController;return a[t].apply(a,arguments)}}),["virtualItemsCount","getContentOffset","getVirtualContentSize","setContentItemSizes","setViewportPosition","getViewportItemIndex","setViewportItemIndex","getItemIndexByPosition","viewportSize","viewportItemSize","getItemSize","getItemSizes","loadIfNeed"].forEach(t=>{e[t]=function(){var i=this._virtualScrollController;return i[t].apply(i,arguments)}}),e}(),Df=function(){var r=function(e,t){var i=e.toArray().map(o=>m(o).parent(".".concat(t)).get(0)).filter(o=>o);i.length&&(e=m(i));for(var a=t===ts?e.length-1:e.length,n=0;n<a;n++)e.eq(n).remove()};return{init(){var e,t=this.getController("data");this.callBase(),t.pageChanged.add(i=>{var a=this._scrollTop;this.scrollToPage(i??t.pageIndex()),this.option(M)===!1&&this._scrollTop===a&&t.updateViewport()}),t.dataSourceChanged.add(()=>{!this._scrollTop&&this._scrollToCurrentPageOnResize()}),(e=t.stateLoaded)===null||e===void 0||e.add(()=>{this._scrollToCurrentPageOnResize()}),this._scrollToCurrentPageOnResize()},_scrollToCurrentPageOnResize(){var e=this.getController("data");if(e.pageIndex()>0){var t=()=>{this.resizeCompleted.remove(t),this.scrollToPage(e.pageIndex())};this.resizeCompleted.add(t)}},scrollToPage(e){var t=this._dataController,i=t?t.pageSize():0,a;if(se(this)||Pe(this)){var n=t.getItemSize(),o=t.getItemSizes(),s=e*i;a=s*n;for(var l in o)parseInt(l)<s&&(a+=o[l]-n)}else a=0;this.scrollTo({y:a,x:this._scrollLeft})},renderDelayedTemplates(){this.waitAsyncTemplates().done(()=>{this._updateContentPosition(!0)}),this.callBase.apply(this,arguments)},_renderCore(e){var t=new Date,i=this.callBase.apply(this,arguments),a=this._dataController._dataSource;if(a&&e){var n=e.items?e.items.length:20,o=this._dataController.viewportSize()||20;I.isVirtualRowRendering(this)&&n>0&&this.option(M)!==!1?a._renderTime=(new Date-t)*o/n:a._renderTime=new Date-t}return i},_getRowElements(e){var t=this.callBase(e);return t&&t.not(".".concat(Mr))},_removeRowsElements(e,t,i){var a=this._getRowElements(e).toArray();i==="append"?a=a.slice(0,t):a=a.slice(-t);var n=this.getController("errorHandling");a.map(o=>{var s=m(o);n&&n.removeErrorRow(s.next()),s.remove()})},_updateContent(e,t){var i,a=this._findContentElement(),n=t&&t.changeType,o=O();this.throwHeightWarningIfNeed();var s=a.children().first();return n==="append"||n==="prepend"?this.waitAsyncTemplates().done(()=>{var l=this._getBodies(e);l.length===1?this._getBodies(s)[n==="append"?"append":"prepend"](l.children()):l[n==="append"?"appendTo":"prependTo"](s),e.remove(),i=this._getFreeSpaceRowElements(s),r(i,ts),t.removeCount&&this._removeRowsElements(s,t.removeCount,n),this._restoreErrorRow(s),o.resolve()}).fail(o.reject):this.callBase.apply(this,arguments).done(()=>{n==="update"&&this._restoreErrorRow(s),o.resolve()}).fail(o.reject),o.promise().done(()=>{this._updateBottomLoading()})},_addVirtualRow(e,t,i,a){if(a){var n=this._createEmptyRow(Mr,t,a);n=this._wrapRowIfNeed(e,n),this._appendEmptyRow(e,n,i)}},_updateContentItemSizes(){var e=this._getRowHeights(),t=this._correctRowHeights(e);this._dataController.setContentItemSizes(t)},_updateViewportSize(e,t){_(e)||(e=this._hasHeight?le(this.element()):le(ne())),this._dataController.viewportHeight(e,t)},_getRowHeights(){var e,t,i=(t=(e=this.getController("editing"))===null||e===void 0?void 0:e.isPopupEditMode)===null||t===void 0?void 0:t.call(e),a=this._getRowElements(this._tableElement).toArray();return i&&(a=a.filter(n=>!m(n).hasClass(If))),a.map(n=>Ee(n).height)},_correctRowHeights(e){for(var t=this._dataController,i=t._dataSource,a=[],n=t.getVisibleRows(),o=0,s=!0,l=-1,d=0;d<e.length;d++){var u=n[d];_(u)&&(this.option(M)===!1?(l>=0&&l!==u.loadIndex&&(a.push(o),o=0),l=u.loadIndex):Zr(u,i)&&(s?s=!1:(a.push(o),o=0)),o+=e[d])}return o>0&&a.push(o),a},_updateContentPosition(e){var t=this._dataController,i=this._rowHeight||20;if(t.viewportItemSize(i),se(this)||I.isVirtualRowRendering(this)){e||this._updateContentItemSizes();var a=t.getContentOffset("begin"),n=t.getContentOffset("end"),o=this.getTableElements(),s=o.children("tbody").children(".".concat(Mr));r(s,Mr),o.each((l,d)=>{var u=l>0,h=this._isFixedTableRendering;this._isFixedTableRendering=u,this._addVirtualRow(m(d),u,"top",a),this._addVirtualRow(m(d),u,"bottom",n),this._isFixedTableRendering=h})}},_isTableLinesDisplaysCorrect(e){var t=e.find(".".concat(bf)).length>0;return t===this.option("showColumnLines")},_isColumnElementsEqual(e,t){var i=e.length===t.length;return i&&T(e,(a,n)=>{if(n.style.width!==t[a].style.width)return i=!1,i}),i},_getCellClasses(e){var t=[],{cssClass:i}=e,a=e.command==="expand";return i&&t.push(i),a&&t.push(this.addWidgetPrefix(Sf)),t},_findBottomLoadPanel(e){var t=e||this.element(),i=t&&t.find(".".concat(this.addWidgetPrefix(es)));if(i&&i.length)return i},_updateBottomLoading(){var e=se(this),t=Pe(this),i=!this._dataController.hasKnownLastPage()&&this._dataController.isLoaded()&&(e||t),a=this._findContentElement(),n=this._findBottomLoadPanel(a);i?n||m("<div>").addClass(this.addWidgetPrefix(es)).append(this._createComponent(m("<div>"),Oa).$element()).appendTo(a):n&&n.remove()},_handleScroll(e){var t=this.option(M)===!0,i=e.scrollOffset.top===0,a=this._scrollTop!==e.scrollOffset.top,n=a||e.forceUpdateScrollPosition,o=this._hasHeight||!t&&i;if(n&&o&&this._rowHeight){this._scrollTop=e.scrollOffset.top;var s=se(this)||this.option("scrolling.rowRenderingMode")!=="standard";s&&this.option(M)===!1&&(this._updateContentItemSizes(),this._updateViewportSize(null,this._scrollTop)),this._dataController.setViewportPosition(e.scrollOffset.top)}this.callBase.apply(this,arguments)},_needUpdateRowHeight(e){return this.callBase.apply(this,arguments)||e>0&&Pe(this)&&!I.isVirtualRowRendering(this)},_updateRowHeight(){if(this.callBase.apply(this,arguments),this._rowHeight){this._updateContentPosition();var e=this._hasHeight?le(this.element()):le(ne()),t=this._dataController;this.option(M)===!1?(this._updateViewportSize(e),t.updateViewport()):t.viewportSize(Math.ceil(e/this._rowHeight))}},updateFreeSpaceRowHeight(){var e=this.callBase.apply(this,arguments);return e&&this._updateContentPosition(),e},setLoading(e,t){var i=this._dataController,a=i.pageIndex()>0&&i.isLoaded()&&!!this._findBottomLoadPanel();this.option(M)===!1&&e&&i.isViewportChanging()||(a&&(e=!1),this.callBase.call(this,e,t))},throwHeightWarningIfNeed(){var e=!this._hasHeight&&Se(this);e&&!this._heightWarningIsThrown&&(this._heightWarningIsThrown=!0,q.log("W1025"))},_resizeCore(){var e=this,t=e.element();e.callBase(),e.component.$element()&&!e._windowScroll&&xi(t)&&(e._windowScroll=Id(t,i=>{!e._hasHeight&&e._rowHeight&&e._dataController.setViewportPosition(i)},e.component.$element()),e.on("disposing",()=>{e._windowScroll.dispose()})),this.option(M)!==!1&&e.loadIfNeed()},loadIfNeed(){var e,t=this._dataController;(e=t==null?void 0:t.loadIfNeed)===null||e===void 0||e.call(t)},_restoreErrorRow(){if(this.option(M)===!1){var e=this.getController("errorHandling");e==null||e.removeErrorRow()}this.callBase.apply(this,arguments)},dispose(){clearTimeout(this._scrollTimeoutID),this.callBase()}}}(),Rd={defaultOptions:()=>({scrolling:{timeout:300,updateTimeout:300,minTimeout:0,renderingThreshold:100,removeInvisiblePages:!0,rowPageSize:5,prerenderedRowChunkSize:1,mode:"standard",preloadEnabled:!1,rowRenderingMode:"standard",loadTwoPagesOnStart:!1,legacyMode:!1,prerenderedRowCount:1}}),extenders:{dataSourceAdapter:Af,controllers:{data:function(){var r={_refreshDataSource(){var e=this.callBase.apply(this,arguments)||new O().resolve().promise();return e.done(this.initVirtualRows.bind(this)),e},_loadDataSource(){var e;if(this._rowsScrollController&&Se(this)){var{loadPageCount:t}=_(this._loadViewportParams)?this.getLoadPageParams():{loadPageCount:void 0};t>=1&&((e=this._dataSource)===null||e===void 0||e.loadPageCount(t))}return this.callBase.apply(this,arguments)},getRowPageSize(){var e=this.option("scrolling.rowPageSize"),t=this.pageSize();return t&&t<e?t:e},reload(){var e=this._rowsScrollController||this._dataSource,t=e&&e.getItemIndexByPosition(),i=this.callBase.apply(this,arguments);return i&&i.done(()=>{var a;if(se(this)||I.isVirtualRowRendering(this)){var n=this.getRowIndexOffset(),o=Math.floor(t)-n,{component:s}=this,l=s.getScrollable&&s.getScrollable(),d=this.dataSource().operationTypes().sorting;if(l&&!d&&o>=0){var u=s.getRowElement(o),h=u&&u[0]&&m(u[0]),c=h&&h.position().top,p=te.chrome&&Number((a=te.version)!==null&&a!==void 0?a:0)>=91,g=te.mozilla||p?1:0;c>g&&(c=Math.round(c+le(h)*(t%1)),l.scrollTo({y:c}))}}})},initVirtualRows(){var e=I.isVirtualRowRendering(this);if(this._allItems=null,this._loadViewportParams=null,this.option("scrolling.mode")!=="virtual"&&!e||!e||this.option(M)!==!1&&!this.option("scrolling.rowPageSize")){this._visibleItems=null,this._rowsScrollController=null;return}var t=!se(this)&&this.pageIndex()>=this.pageCount()?this.pageCount()-1:this.pageIndex();this._rowPageIndex=Math.ceil(t*this.pageSize()/this.getRowPageSize()),this._visibleItems=this.option(M)===!1?null:[],this._viewportChanging=!1,this._needUpdateViewportAfterLoading=!1,this._rowsScrollController||(this._rowsScrollController=new gn(this.component,this._getRowsScrollDataOptions(),!0),this._rowsScrollController.positionChanged.add(()=>{var i;if(this.option(M)===!1){this._viewportChanging=!0,this.loadViewport(),this._viewportChanging=!1;return}(i=this._dataSource)===null||i===void 0||i.setViewportItemIndex(this._rowsScrollController.getViewportItemIndex())})),this.option(M)===!1&&this._updateLoadViewportParams(),this.isLoaded()&&this.option(M)!==!1&&this._rowsScrollController.load()},isViewportChanging(){return this._viewportChanging},_getRowsScrollDataOptions(){var e=this,t=function(i){return Zr(i,e._dataSource)};return{pageSize:()=>e.getRowPageSize(),loadedOffset(){var i;return se(e)&&((i=e._dataSource)===null||i===void 0?void 0:i.lastLoadOptions().skip)||0},loadedItemCount:()=>e._itemCount,totalItemsCount(){return Se(e)?e.totalItemsCount():e.option(M)===!1?e._itemCount:e._items.filter(t).length},hasKnownLastPage:()=>e.option(M)===!1?e.hasKnownLastPage():!0,pageIndex(i){return i!==void 0&&(e._rowPageIndex=i),e._rowPageIndex},isLoading:()=>e.isLoading(),pageCount(){var i=Math.ceil(this.totalItemsCount()/this.pageSize());return i||1},load(){e._rowsScrollController.pageIndex()>=this.pageCount()&&(e._rowPageIndex=this.pageCount()-1,e._rowsScrollController.pageIndex(e._rowPageIndex)),!(!this.items().length&&this.totalItemsCount())&&e._rowsScrollController.handleDataChanged(i=>{i=i||{},i.changeType=i.changeType||"refresh",i.items=i.items||e._visibleItems,e._visibleItems.forEach((a,n)=>{a.rowIndex=n}),e._fireChanged(i)})},updateLoading(){},itemsCount(){return this.items(!0).length},correctCount:(i,a,n)=>rs(i,a,n,(o,s,l)=>o.isNewRow?s&&!l:s&&l?!o.isNewRow:t(o)),items(i){var a=e._items;if(e.option(M)){var n=e.dataSource(),o=n==null?void 0:n.virtualItemsCount(),s=o?o.begin:0,l=e.getRowPageSize(),d=e._rowPageIndex*l-s,u=l;if(d<0)return[];d&&(d=this.correctCount(a,d),a=a.slice(d)),u&&(u=this.correctCount(a,u),a=a.slice(0,u))}return i?a.filter(t):a},viewportItems(i){return i&&e.option(M)!==!1&&(e._visibleItems=i),e._visibleItems},onChanged(){},changingDuration(){var i=e.dataSource();return i!=null&&i.isLoading()&&e.option(M)!==!1?Td:(i==null?void 0:i._renderTime)||0}}},_updateItemsCore(e){var t=this.getRowIndexDelta();if(this.callBase.apply(this,arguments),this.option(M)===!1&&I.isVirtualRowRendering(this)){e.changeType==="update"&&e.rowIndices.length===0&&e.cancelEmptyChanges&&(e.cancel=!0);return}var i=this._rowsScrollController;if(i){var a=this._visibleItems,n=e.changeType==="refresh"||e.isLiveUpdate;if(e.changeType==="append"&&e.items&&!e.items.length)return;n||e.changeType==="append"||e.changeType==="prepend"?(e.cancel=!0,n&&i.reset(!0),i.load()):(e.changeType==="update"?e.rowIndices.forEach((o,s)=>{var l=e.changeTypes[s],d=e.items[s];l==="update"?a[o]=d:l==="insert"?a.splice(o,0,d):l==="remove"&&a.splice(o,1)}):(a.forEach((o,s)=>{a[s]=this._items[s+t]||a[s]}),e.items=a),Of(a))}},_updateLoadViewportParams(){var e=this._rowsScrollController.getViewportParams(),t=this.pageSize();if(e&&!Se(this)&&t>0){var i=this.pageIndex()*t;e.skip+=i}this._loadViewportParams=e},_processItems(){var e,t=this.callBase.apply(this,arguments);if(this.option(M)===!1){var i=this._dataSource,a=(e=i==null?void 0:i.lastLoadOptions().skip)!==null&&e!==void 0?e:0,n,o,s,l=!1,d=[];t.forEach(u=>{var{rowType:h}=u,c=Zr(u,i),p=h==="group"&&(n||c||o!=="group"&&a>0),g=h==="data"&&c&&(n||o!=="group");if(!u.isNewRow&&_(n)){var v=s&&!l;(p||g)&&!v&&a++}(p||g)&&(l=!0),u.isNewRow?d.push(u):(d.forEach(f=>{f.loadIndex=a}),d=[]),u.loadIndex=a,n=c,o=h,s=u.isNewRow}),d.forEach(u=>{u.loadIndex=a})}return t},_afterProcessItems(e){if(this._itemCount=e.filter(o=>Zr(o,this._dataSource)).length,_(this._loadViewportParams)){this._updateLoadViewportParams();var t=e;if(this._allItems=e,e.length){var{skipForCurrentPage:i}=this.getLoadPageParams(!0),a=e[0].loadIndex+i,{take:n}=this._loadViewportParams;t=e.filter(o=>{var s=o.isNewRow&&o.loadIndex===a&&n===0,l=o.loadIndex>=a,d=o.loadIndex<a+n||s;return l&&d})}return t}return this.callBase.apply(this,arguments)},_applyChange(e){var t=this,{items:i}=e,{changeType:a}=e,{removeCount:n}=e;if(n){var o=a==="prepend";n=rs(t._items,n,o,(s,l)=>s.rowType==="data"&&!s.isNewRow||s.rowType==="group"&&(t._dataSource.isGroupItemCountable(s.data)||l)),e.removeCount=n}switch(a){case"prepend":t._items.unshift.apply(t._items,i),n&&t._items.splice(-n);break;case"append":t._items.push.apply(t._items,i),n&&t._items.splice(0,n);break;default:t.callBase(e)}},items(e){return e?this._allItems||this._items:this._visibleItems||this._items},getRowIndexDelta(){var e=0;if(this.option(M)){var t=this._visibleItems;t&&t[0]&&(e=this._items.indexOf(t[0]))}return e<0?0:e},getRowIndexOffset(e){var t,i=0,a=this.dataSource(),n=this._rowsScrollController,o=this.option(M)===!1,s=Se(this);if(n&&!e)if(o&&_(this._loadViewportParams)){var{skipForCurrentPage:l,pageIndex:d}=this.getLoadPageParams(!0),u=this.items(!0);if(i=s?d*this.pageSize():0,u.length){var h=u[0].loadIndex;i+=u.filter(c=>c.loadIndex<h+l).length}}else i=n.beginPageIndex()*n.pageSize();else s&&o&&a?i=(t=a.lastLoadOptions().skip)!==null&&t!==void 0?t:0:se(this)&&a&&(i=a.beginPageIndex()*a.pageSize());return i},getDataIndex(){return this.option(M)===!1?this.getRowIndexOffset(!0):this.callBase.apply(this,arguments)},viewportSize(){var e=this._rowsScrollController,t=this._dataSource,i=e==null?void 0:e.viewportSize.apply(e,arguments);return this.option(M)===!1?i:t==null?void 0:t.viewportSize.apply(t,arguments)},viewportHeight(e,t){var i;(i=this._rowsScrollController)===null||i===void 0||i.viewportHeight(e,t)},viewportItemSize(){var e=this._rowsScrollController,t=this._dataSource,i=e==null?void 0:e.viewportItemSize.apply(e,arguments);return this.option(M)===!1?i:t==null?void 0:t.viewportItemSize.apply(t,arguments)},setViewportPosition(){var e=this._rowsScrollController,t=this._dataSource;this._isPaging=!1,e?e.setViewportPosition.apply(e,arguments):t==null||t.setViewportPosition.apply(t,arguments)},setContentItemSizes(e){var t=this._rowsScrollController,i=this._dataSource,a=t==null?void 0:t.setContentItemSizes(e);return this.option(M)===!1?a:i==null?void 0:i.setContentItemSizes(e)},getPreloadedRowCount(){var e=this.option("scrolling.preloadedRowCount"),t=this.option("scrolling.preloadEnabled");if(_(e))return e;var i=this.viewportSize();return t?2*i:i},getLoadPageParams(e){var t,i,a=this.pageSize(),n=this._loadViewportParams,o=(t=this._dataSource)===null||t===void 0?void 0:t.lastLoadOptions(),s=(o==null?void 0:o.pageIndex)||0,l=(o==null?void 0:o.take)||0,d=this._rowsScrollController.isScrollingBack(),u=d?this.getPreloadedRowCount():0,h=d?0:this.getPreloadedRowCount(),c=((i=this._dataSource)===null||i===void 0?void 0:i.totalCountCorrection())||0,p=Math.max(0,n.skip-u),g=e?s:Math.floor(a?p/a:0),v=g*a,f=n.skip-v,C=n.take+f+h-c,w=e?l:C,x=Math.ceil(a?w/a:0);return{pageIndex:g,loadPageCount:Math.max(1,x),skipForCurrentPage:Math.max(0,f)}},_updateVisiblePageIndex(e){if(this._rowsScrollController){if(_(e)){this._silentOption(sa,e),this.pageChanged.fire();return}var t=this._rowsScrollController.getViewportItemIndex(),i=Math.floor(t/this.pageSize());this.pageIndex()!==i&&(this._silentOption(sa,i),this.updateItems({changeType:"pageIndex"}))}},_getChangedLoadParams(){var e=this.getLoadPageParams(!0),{pageIndex:t,loadPageCount:i}=this.getLoadPageParams(),a=this._pageIndexIsValid(t),n=null;return!this._isLoading&&a&&(t!==e.pageIndex||i!==e.loadPageCount)&&(n={pageIndex:t,loadPageCount:i}),n},_pageIndexIsValid(e){var t=!0;return(Pe(this)&&this.hasKnownLastPage()||se(this))&&(t=e*this.pageSize()<this.totalItemsCount()),t},_loadItems(e,t){var i,a,n=Se(this),o=this._dataSource,s=this._getChangedLoadParams(),l=(i=o==null?void 0:o.loadPageCount())!==null&&i!==void 0?i:0,d=this.pageSize()*l,u=(a=o==null?void 0:o.pageIndex())!==null&&a!==void 0?a:0,h=(s==null?void 0:s.pageIndex)===u,c=Pe(this)&&this.totalItemsCount()<d,p=this.option("editing.refreshMode")==="repaint",g=(s==null?void 0:s.pageIndex)>u,v=!1;if(!o||n&&e&&(p&&t||g||h&&c))return v;if(n&&this._isLoading&&(this._needUpdateViewportAfterLoading=!0),n&&s){v=!0,o.pageIndex(s.pageIndex),o.loadPageCount(s.loadPageCount),this._repaintChangesOnly=!0,this._needUpdateDimensions=!0;var f=this._viewportChanging;this.load().always(()=>{this._repaintChangesOnly=void 0,this._needUpdateDimensions=void 0}).done(()=>{var C=this.pageCount()>0&&this.pageIndex()===this.pageCount()-1;(f||C)&&this._updateVisiblePageIndex(),this._needUpdateViewportAfterLoading&&(this._needUpdateViewportAfterLoading=!1,this.loadViewport({checkLoadedParamsOnly:!0}))})}return v},loadViewport(e){var t,i,a,{checkLoadedParamsOnly:n,checkLoading:o,viewportIsNotFilled:s}=e??{},l=Se(this);if(l||I.isVirtualRowRendering(this)){this._updateLoadViewportParams();var d=this._loadItems(o,!s),u=(t=this._dataSource)===null||t===void 0?void 0:t.isCustomLoading(),h=o&&!u&&this._isLoading,c=!(d||h||n);if(c){var p=!(!((a=(i=this.getController("editing"))===null||i===void 0?void 0:i.getChanges())===null||a===void 0)&&a.length);this.updateItems({repaintChangesOnly:!0,needUpdateDimensions:!0,useProcessedItemsCache:p,cancelEmptyChanges:!0})}}},updateViewport(){var e,t,i=this.viewportSize(),a=this.items().length,n=i>a,o=(t=(e=this._loadViewportParams)===null||e===void 0?void 0:e.take)!==null&&t!==void 0?t:0,s=this._rowsScrollController,l=s==null?void 0:s.getViewportParams().take;(n||o<l)&&!this._isPaging&&a&&this.loadViewport({checkLoading:!0,viewportIsNotFilled:n})},loadIfNeed(){if(this.option(M)!==!1){var e=this._rowsScrollController;e&&e.loadIfNeed();var t=this._dataSource;return t&&t.loadIfNeed()}},getItemSize(){var e=this._rowsScrollController;if(e)return e.getItemSize.apply(e,arguments);var t=this._dataSource;return t&&t.getItemSize.apply(t,arguments)},getItemSizes(){var e=this._rowsScrollController;if(e)return e.getItemSizes.apply(e,arguments);var t=this._dataSource;return t&&t.getItemSizes.apply(t,arguments)},getContentOffset(){var e=this._rowsScrollController;if(e)return e.getContentOffset.apply(e,arguments);var t=this._dataSource;return t&&t.getContentOffset.apply(t,arguments)},refresh(e){var t=this._dataSource;return t&&e&&e.load&&Pe(this)&&t.resetCurrentTotalCount(),this.callBase.apply(this,arguments)},dispose(){var e=this._rowsScrollController;e&&e.dispose(),this.callBase.apply(this,arguments)},topItemIndex(){var e;return(e=this._loadViewportParams)===null||e===void 0?void 0:e.skip},bottomItemIndex(){var e=this._loadViewportParams;return e&&e.skip+e.take},virtualItemsCount(){var e=this._rowsScrollController;if(e)return e.virtualItemsCount.apply(e,arguments);var t=this._dataSource;return t==null?void 0:t.virtualItemsCount.apply(t,arguments)},pageIndex(e){var t,i=Se(this),a=this._rowsScrollController;return this.option(M)===!1&&i&&a&&e===void 0?(t=this.option(sa))!==null&&t!==void 0?t:0:this.callBase.apply(this,arguments)},_fireChanged(e){this.callBase.apply(this,arguments);var{operationTypes:t}=e;if(this.option(M)===!1&&Se(this)&&t){var{fullReload:i,pageIndex:a}=t;e.isDataChanged&&!i&&a&&this._updateVisiblePageIndex(this._dataSource.pageIndex())}},_getPagingOptionValue(e){var t=this.callBase.apply(this,arguments);return this.option(M)===!1&&Se(this)&&(t=this[e]()),t},isEmpty(){return this.option(M)===!1?!this.items(!0).length:this.callBase(this,arguments)},isLastPageLoaded(){var e=!1;if(this.option(M)===!1&&Se(this)){var{pageIndex:t,loadPageCount:i}=this.getLoadPageParams(!0),a=this.pageCount();e=t+i>=a}else e=this.callBase.apply(this,arguments);return e},reset(){this._itemCount=0,this._allItems=null,this.callBase.apply(this,arguments)},_applyFilter(){var e;(e=this._dataSource)===null||e===void 0||e.loadPageCount(1),this.callBase.apply(this,arguments)}};return I.proxyMethod(r,"getVirtualContentSize"),I.proxyMethod(r,"setViewportItemIndex"),r}(),resizing:{_updateMasterDataGridCore(r){return P(this.callBase.apply(this,arguments)).done(e=>{var t=se(r)&&r.option(M)===!1;if(!e&&t){var i=r.getScrollable();i&&r.updateDimensions()}})},hasResizeTimeout(){return!!this._resizeTimeout},resize(){var{callBase:r}=this,e;if(se(this)||I.isVirtualRowRendering(this)){clearTimeout(this._resizeTimeout),this._resizeTimeout=null;var t=new Date-this._lastTime,i=this.option("scrolling.updateTimeout");this._lastTime&&t<i?(e=new O,this._resizeTimeout=setTimeout(()=>{this._resizeTimeout=null,r.apply(this).done(e.resolve).fail(e.reject),this._lastTime=new Date},i),this._lastTime=new Date):(e=r.apply(this),this._dataController.isLoaded()&&(this._lastTime=new Date))}else e=r.apply(this);return e},dispose(){this.callBase.apply(this,arguments),clearTimeout(this._resizeTimeout)}}},views:{rowsView:Df}}};A.registerModule("virtualScrolling",Rd);Ir.extend(Rd.extenders.dataSourceAdapter);var la={"=":"filter-operation-equals","<>":"filter-operation-not-equals","<":"filter-operation-less","<=":"filter-operation-less-equal",">":"filter-operation-greater",">=":"filter-operation-greater-equal",default:"filter-operation-default",notcontains:"filter-operation-not-contains",contains:"filter-operation-contains",startswith:"filter-operation-starts-with",endswith:"filter-operation-ends-with",between:"filter-operation-between"},is={"=":"equal","<>":"notEqual","<":"lessThan","<=":"lessThanOrEqual",">":"greaterThan",">=":"greaterThanOrEqual",startswith:"startsWith",contains:"contains",notcontains:"notContains",endswith:"endsWith",between:"between"},Vf=700,Od=1,ir="filter-row",Nr="filter-range-overlay",zr="filter-range-start",Ff="filter-range-end",as="dx-menu",ns="dx-editor-with-menu",rt="dx-editor-container",Ma="dx-editor-cell",Pf="dx-filter-menu",Bf="dx-apply-button",da="dx-highlight-outline",os="dx-focused",Lf="dx-cell-focus-disabled",ua="dx-filter-range-content",ha="dx-filter-modified",$t="input:not([type='hidden'])",kf=["date","datetime","number"],Mf=y.format("dxDataGrid-ariaSearchBox");function It(r){return r.option("filterRow.applyFilter")==="onClick"}var ca=function(r){var e=r&&r.children(),t=e&&e.data("dxComponents"),i=t&&t.length&&e.data(t[0]);return i instanceof Oh?i:null},Nf=function(){var r=function(n,o){var s="",l="",d=e(n,o),u=I.getFormatOptionsByColumn(o,"filterRow");return Array.isArray(d)?(s=I.formatValue(d[0],u),l=I.formatValue(d[1],u),l!==""&&(s+=" - ".concat(l))):_(d)&&(s=I.formatValue(d,u)),s};function e(n,o){if(o)return It(n)&&o.bufferedFilterValue!==void 0?o.bufferedFilterValue:o.filterValue}var t=function(n,o){if(o)return It(n)&&o.bufferedSelectedFilterOperation!==void 0?o.bufferedSelectedFilterOperation:o.selectedFilterOperation},i=function(n,o,s){var l=n._columnsController.columnOption(o),d=e(n,l),u=s.closest(".".concat(n.addWidgetPrefix(Nr))).length,h=s.hasClass(n.addWidgetPrefix(zr));return d&&Array.isArray(d)&&t(n,l)==="between"?h?d[0]:d[1]:!u&&function(c,p){return p&&kf.includes(p.dataType)&&Array.isArray(c)?!1:c!==void 0}(d,l)?d:null},a=function(n,o){var s=o.value===""?null:o.value,l=o.container,d=n._columnsController.columnOption(o.column.index),u=i(n,d.index,l);if(!(!_(u)&&!_(s))){n._applyFilterViewController.setHighLight(l,u!==s);var h=It(n)?"bufferedFilterValue":"filterValue",c=function(v,f,C,w){if(t(v,C)==="between"){var x=e(v,C);return w.hasClass(v.addWidgetPrefix(zr))?[f,Array.isArray(x)?x[1]:void 0]:[Array.isArray(x)?x[0]:x,f]}return f}(n,s,d,l),p=t(n,d)==="between",g=o.notFireEvent||p&&Array.isArray(c)&&c.includes(void 0);n._columnsController.columnOption(d.index,h,c,g)}};return{_updateEditorValue(n,o){var s=ca(o);s&&s.option("value",i(this,n.index,o))},_columnOptionChanged(n){var{optionNames:o}=n,s,l,d,u;if(I.checkChanges(o,["filterValue","bufferedFilterValue","selectedFilterOperation","bufferedSelectedFilterOperation","filterValues","filterType"])&&n.columnIndex!==void 0){var h=this._columnsController.getVisibleIndex(n.columnIndex),c=this._columnsController.columnOption(n.columnIndex);if(s=this._getCellElement(this.element().find(".".concat(this.addWidgetPrefix(ir))).index(),h)||m(),l=s.find(".".concat(rt)).first(),o.filterValue||o.bufferedFilterValue){this._updateEditorValue(c,l);var p=s.find(".".concat(this.addWidgetPrefix(Nr))).data("dxOverlay");p&&(d=p.$content().find(".".concat(rt)),this._updateEditorValue(c,d.first()),this._updateEditorValue(c,d.last())),(!p||!p.option("visible"))&&this._updateFilterRangeContent(s,r(this,c))}(o.selectedFilterOperation||o.bufferedSelectedFilterOperation)&&h>=0&&c&&(u=s.find(".".concat(as)),u.length&&(this._updateFilterOperationChooser(u,c,l),t(this,c)==="between"?this._renderFilterRangeContent(s,c):l.find(".".concat(ua)).length&&(this._renderEditor(l,this._getEditorOptions(l,c)),this._hideFilterRange())));return}this.callBase(n)},_renderCore(){return this._filterRangeOverlayInstance=null,this.callBase.apply(this,arguments)},_resizeCore(){this.callBase.apply(this,arguments),this._filterRangeOverlayInstance&&this._filterRangeOverlayInstance.repaint()},isFilterRowVisible(){return this._isElementVisible(this.option("filterRow"))},isVisible(){return this.callBase()||this.isFilterRowVisible()},init(){this.callBase(),this._applyFilterViewController=this.getController("applyFilter")},_initFilterRangeOverlay(n,o){var s=this,l={},d=n.find(".dx-editor-container"),u=s.addWidgetPrefix(Nr),h=m("<div>").addClass(u).appendTo(n);return s._createComponent(h,Aa,{height:"auto",shading:!1,showTitle:!1,focusStateEnabled:!1,hideOnOutsideClick:!0,wrapperAttr:{class:u},animation:!1,position:{my:"top",at:"top",of:d.length&&d||n,offset:"0 -1"},contentTemplate(c){var p,g=m("<div>").addClass("".concat(rt," ").concat(s.addWidgetPrefix(zr))).appendTo(c);return o=s._columnsController.columnOption(o.index),p=s._getEditorOptions(g,o),p.sharedData=l,s._renderEditor(g,p),b.on(g.find($t),"keydown",v=>{var f=n.find("[tabindex]").not(v.target).first();Ie(v)==="tab"&&v.shiftKey&&(v.preventDefault(),s._hideFilterRange(),f.length||(f=n.prev().find("[tabindex]").last()),b.trigger(f,"focus"))}),g=m("<div>").addClass("".concat(rt," ").concat(s.addWidgetPrefix(Ff))).appendTo(c),p=s._getEditorOptions(g,o),p.sharedData=l,s._renderEditor(g,p),b.on(g.find($t),"keydown",v=>{Ie(v)==="tab"&&!v.shiftKey&&(v.preventDefault(),s._hideFilterRange(),b.trigger(n.next().find("[tabindex]").first(),"focus"))}),m(c).addClass(s.getWidgetContainerClass())},onShown(c){var p=c.component.$content().find(".".concat(rt)).first();b.trigger(p.find($t),"focus")},onHidden(){o=s._columnsController.columnOption(o.index),n.find(".".concat(as)).parent().addClass(ns),t(s,o)==="between"&&(s._updateFilterRangeContent(n,r(s,o)),s.component.updateDimensions())}})},_updateFilterRangeOverlay(n){var o=this._filterRangeOverlayInstance;o&&o.option(n)},_showFilterRange(n,o){var s=n.children(".".concat(this.addWidgetPrefix(Nr))),l=s.length&&s.data("dxOverlay");!l&&o&&(l=this._initFilterRangeOverlay(n,o)),l.option("visible")||(this._filterRangeOverlayInstance&&this._filterRangeOverlayInstance.hide(),this._filterRangeOverlayInstance=l,this._updateFilterRangeOverlay({width:Te(n,!0)+Od}),this._filterRangeOverlayInstance&&this._filterRangeOverlayInstance.show())},_hideFilterRange(){var n=this._filterRangeOverlayInstance;n&&n.hide()},getFilterRangeOverlayInstance(){return this._filterRangeOverlayInstance},_createRow(n){var o=this.callBase(n);return n.rowType==="filter"&&(o.addClass(this.addWidgetPrefix(ir)),this.option("useLegacyKeyboardNavigation")||b.on(o,"keydown",s=>on("filterRow",this,s))),o},_getRows(){var n=this.callBase();return this.isFilterRowVisible()&&n.push({rowType:"filter"}),n},_renderFilterCell(n,o){var{column:s}=o,l=m(n);this.component.option("showColumnHeaders")&&this.setAria("describedby",s.headerId,l),this.setAria("label",y.format("dxDataGrid-ariaFilterCell"),l),l.addClass(Ma);var d=m("<div>").appendTo(l),u=m("<div>").addClass(rt).appendTo(d);if(t(this,s)==="between")this._renderFilterRangeContent(l,s);else{var h=this._getEditorOptions(u,s);this._renderEditor(u,h)}var{alignment:c}=s;c&&c!=="center"&&l.find($t).first().css("textAlign",s.alignment),s.filterOperations&&s.filterOperations.length&&this._renderFilterOperationChooser(d,s,u)},_renderCellContent(n,o){var s=this,{column:l}=o;if(o.rowType==="filter"){if(l.command)n.html("&nbsp;");else if(l.allowFiltering){s.renderTemplate(n,s._renderFilterCell.bind(s),o).done(()=>{s._updateCell(n,o)});return}}this.callBase.apply(this,arguments)},_getEditorOptions(n,o){var s=this,l={editorOptions:{inputAttr:s._getFilterInputAccessibilityAttributes(o)}},d=S(l,o,{value:i(s,o.index,n),parentType:"filterRow",showAllText:s.option("filterRow.showAllText"),updateValueTimeout:s.option("filterRow.applyFilter")==="onClick"?0:Vf,width:null,setValue(u,h){a(s,{column:o,value:u,container:n,notFireEvent:h})}});return t(s,o)==="between"&&(n.hasClass(s.addWidgetPrefix(zr))?d.placeholder=s.option("filterRow.betweenStartText"):d.placeholder=s.option("filterRow.betweenEndText")),d},_getFilterInputAccessibilityAttributes(n){var o=y.format("dxDataGrid-ariaFilterCell");return this.component.option("showColumnHeaders")?{"aria-label":o,"aria-describedby":n.headerId}:{"aria-label":o}},_renderEditor(n,o){n.empty();var s=m("<div>").appendTo(n),l=this.getController("editorFactory"),d=this.getController("data").dataSource(),u=this.getController("applyFilter");if(o.lookup&&this.option("syncLookupFilterValues")){u.setCurrentColumnForFiltering(o);var h=this.getController("data").getCombinedFilter();u.setCurrentColumnForFiltering(null);var c=I.getWrappedLookupDataSource(o,d,h),p=L(L({},o),{lookup:L(L({},o.lookup),{dataSource:c})});return l.createEditor(s,p)}return l.createEditor(s,o)},_renderFilterRangeContent(n,o){var s=this,l=n.find(".".concat(rt)).first();l.empty();var d=m("<div>").addClass(ua).attr("tabindex",this.option("tabIndex"));b.on(d,"focusin",()=>{s._showFilterRange(n,o)}),d.appendTo(l),s._updateFilterRangeContent(n,r(s,o))},_updateFilterRangeContent(n,o){var s=n.find(".".concat(ua));s.length&&(o===""?s.html("&nbsp;"):s.text(o))},_updateFilterOperationChooser(n,o,s){var l=this,d,u=function(){var h=Ln.getInstance(n);h&&h.option("focusedElement",null),d&&l._focusEditor(s)};l._createComponent(n,Ln,{integrationOptions:{},activeStateEnabled:!1,selectionMode:"single",cssClass:"".concat(l.getWidgetContainerClass()," ").concat(Lf," ").concat(Pf),showFirstSubmenuMode:"onHover",hideSubmenuOnMouseLeave:!0,items:[{disabled:!(o.filterOperations&&o.filterOperations.length),icon:la[t(l,o)||"default"],selectable:!1,items:l._getFilterOperationMenuItems(o)}],onItemRendered:h=>{var{itemElement:c}=h;this.setAria("label",Mf,m(c))},onItemClick(h){var c=h.itemData.name,p=t(l,o),g=!1,v=It(l),f={};if(!(h.itemData.items||c&&c===p)){if(c?(f[v?"bufferedSelectedFilterOperation":"selectedFilterOperation"]=c,(c==="between"||p==="between")&&(g=c==="between",f[v?"bufferedFilterValue":"filterValue"]=null)):(f[v?"bufferedFilterValue":"filterValue"]=null,f[v?"bufferedSelectedFilterOperation":"selectedFilterOperation"]=o.defaultSelectedFilterOperation||null),l._columnsController.columnOption(o.index,f),l._applyFilterViewController.setHighLight(s,!0),!c){var C=ca(s);C&&C.NAME==="dxDateBox"&&!C.option("isValid")&&(C.reset(),C.option("isValid",!0))}g?l._showFilterRange(s.closest(".".concat(Ma)),o):l._focusEditor(s)}},onSubmenuShowing(){d=l._isEditorFocused(s),l.getController("editorFactory").loseFocus()},onSubmenuHiding(){b.trigger(n,"blur"),u()},onContentReady(h){b.on(n,"blur",()=>{var c=h.component;c._hideSubmenuAfterTimeout(),u()})},rtlEnabled:l.option("rtlEnabled")})},_isEditorFocused:n=>n.hasClass(os)||n.parents(".".concat(os)).length,_focusEditor(n){this.getController("editorFactory").focus(n),b.trigger(n.find($t),"focus")},_renderFilterOperationChooser(n,o,s){var l;this.option("filterRow.showOperationChooser")&&(n.addClass(ns),l=m("<div>").prependTo(n),this._updateFilterOperationChooser(l,o,s))},_getFilterOperationMenuItems(n){var o=this,s=[{}],l=o.option("filterRow"),d=l&&l.operationDescriptions||{};if(n.filterOperations&&n.filterOperations.length){var u=n.filterOperations.filter(h=>_(is[h]));s=wr(u,h=>{var c=is[h];return{name:h,selected:(t(o,n)||n.defaultFilterOperation)===h,text:d[c],icon:la[h]}}),s.push({name:null,text:l&&l.resetOperationText,icon:la.default})}return s},_handleDataChanged(n){var o,s,l;this.callBase.apply(this,arguments),(!((o=n.operationTypes)===null||o===void 0)&&o.filtering||!((s=n.operationTypes)===null||s===void 0)&&s.fullReload)&&this.updateLookupDataSource((l=n.operationTypes)===null||l===void 0?void 0:l.filtering)},updateLookupDataSource(n){if(this.option("syncLookupFilterValues")&&this.element()){var o=this._columnsController.getVisibleColumns(),s=this._dataController.dataSource(),l=this._applyFilterViewController,d=this.element().find(".".concat(this.addWidgetPrefix(ir))).index();d!==-1&&o.forEach((u,h)=>{if(!(!u.lookup||u.calculateCellValue!==u.defaultCalculateCellValue)){var c=this._getCellElement(d,h),p=ca(c==null?void 0:c.find(".dx-editor-container"));if(p){l.setCurrentColumnForFiltering(u);var g=this._dataController.getCombinedFilter()||null;l.setCurrentColumnForFiltering(null);var v=p.option("dataSource"),f=!n||!U(v.__dataGridSourceFilter,g);if(f){var C=I.getWrappedLookupDataSource(u,s,g);p.option("dataSource",C)}}}})}},optionChanged(n){switch(n.name){case"filterRow":case"showColumnLines":this._invalidate(!0,!0),n.handled=!0;break;case"syncLookupFilterValues":n.value?this.updateLookupDataSource():this.render(),n.handled=!0;break;default:this.callBase(n)}}}}(),zf={skipCalculateColumnFilters:()=>!1,_calculateAdditionalFilter(){if(this.skipCalculateColumnFilters())return this.callBase();var r=[this.callBase()],e=this._columnsController.getVisibleColumns(null,!0),t=this.getController("applyFilter");return T(e,function(){var i,a=((i=t.getCurrentColumnForFiltering())===null||i===void 0?void 0:i.index)===this.index;if(this.allowFiltering&&this.calculateFilterExpression&&_(this.filterValue)&&!a){var n=this.createFilterExpression(this.filterValue,this.selectedFilterOperation||this.defaultFilterOperation,"filterRow");r.push(n)}}),I.combineFilters(r)}},Hf=W.ViewController.inherit({_getHeaderPanel(){return this._headerPanel||(this._headerPanel=this.getView("headerPanel")),this._headerPanel},setHighLight(r,e){It(this)&&(r&&r.toggleClass(da,e)&&r.closest(".".concat(Ma)).toggleClass(ha,e),this._getHeaderPanel().enableApplyButton(e))},applyFilter(){var r=this.getController("columns"),e=r.getColumns();r.beginUpdate();for(var t=0;t<e.length;t++){var i=e[t];i.bufferedFilterValue!==void 0&&(r.columnOption(t,"filterValue",i.bufferedFilterValue),i.bufferedFilterValue=void 0),i.bufferedSelectedFilterOperation!==void 0&&(r.columnOption(t,"selectedFilterOperation",i.bufferedSelectedFilterOperation),i.bufferedSelectedFilterOperation=void 0)}r.endUpdate(),this.removeHighLights()},removeHighLights(){if(It(this)){var r=this.getView("columnHeadersView").element();r.find(".".concat(this.addWidgetPrefix(ir)," .").concat(da)).removeClass(da),r.find(".".concat(this.addWidgetPrefix(ir)," .").concat(ha)).removeClass(ha),this._getHeaderPanel().enableApplyButton(!1)}},setCurrentColumnForFiltering(r){this._currentColumn=r},getCurrentColumnForFiltering(){return this._currentColumn}}),Wf={defaultOptions:()=>({syncLookupFilterValues:!0,filterRow:{visible:!1,showOperationChooser:!0,showAllText:y.format("dxDataGrid-filterRowShowAllText"),resetOperationText:y.format("dxDataGrid-filterRowResetOperationText"),applyFilter:"auto",applyFilterText:y.format("dxDataGrid-applyFilterText"),operationDescriptions:{equal:y.format("dxDataGrid-filterRowOperationEquals"),notEqual:y.format("dxDataGrid-filterRowOperationNotEquals"),lessThan:y.format("dxDataGrid-filterRowOperationLess"),lessThanOrEqual:y.format("dxDataGrid-filterRowOperationLessOrEquals"),greaterThan:y.format("dxDataGrid-filterRowOperationGreater"),greaterThanOrEqual:y.format("dxDataGrid-filterRowOperationGreaterOrEquals"),startsWith:y.format("dxDataGrid-filterRowOperationStartsWith"),contains:y.format("dxDataGrid-filterRowOperationContains"),notContains:y.format("dxDataGrid-filterRowOperationNotContains"),endsWith:y.format("dxDataGrid-filterRowOperationEndsWith"),between:y.format("dxDataGrid-filterRowOperationBetween"),isBlank:y.format("dxFilterBuilder-filterOperationIsBlank"),isNotBlank:y.format("dxFilterBuilder-filterOperationIsNotBlank")},betweenStartText:y.format("dxDataGrid-filterRowOperationBetweenStartText"),betweenEndText:y.format("dxDataGrid-filterRowOperationBetweenEndText")}}),controllers:{applyFilter:Hf},extenders:{controllers:{data:zf,columnsResizer:{_startResizing(){if(this.callBase.apply(this,arguments),this.isResizing()){var r=this._columnHeadersView.getFilterRangeOverlayInstance();if(r){var e=r.$element().closest("td").index();(e===this._targetPoint.columnIndex||e===this._targetPoint.columnIndex+1)&&r.$content().hide()}}},_endResizing(){var r;if(this.isResizing()){var e=this._columnHeadersView.getFilterRangeOverlayInstance();e&&(r=e.$element().closest("td"),this._columnHeadersView._updateFilterRangeOverlay({width:Te(r,!0)+Od}),e.$content().show())}this.callBase.apply(this,arguments)}},editing:{updateFieldValue(r){return r.column.lookup&&(this._needUpdateLookupDataSource=!0),this.callBase.apply(this,arguments)},_afterSaveEditData(r){var e;return this._needUpdateLookupDataSource&&!r&&((e=this.getView("columnHeadersView"))===null||e===void 0||e.updateLookupDataSource()),this._needUpdateLookupDataSource=!1,this.callBase.apply(this,arguments)},_afterCancelEditData(){return this._needUpdateLookupDataSource=!1,this.callBase.apply(this,arguments)}}},views:{columnHeadersView:Nf,headerPanel:{_getToolbarItems(){var r=this.callBase(),e=this._prepareFilterItem(r);return e.concat(r)},_prepareFilterItem(){var r=this,e=[];if(r._isShowApplyFilterButton()){var t=r.option("filterRow.applyFilterText"),i=r._columnsController.getColumns(),a=!i.filter(o=>o.bufferedFilterValue!==void 0).length,n={widget:"dxButton",options:{icon:"apply-filter",disabled:a,onClick:function(){r._applyFilterViewController.applyFilter()},hint:t,text:t,onInitialized:function(o){m(o.element).addClass(r._getToolbarButtonClass(Bf))}},showText:"inMenu",name:"applyFilterButton",location:"after",locateInMenu:"auto",sortIndex:10};e.push(n)}return e},_isShowApplyFilterButton(){var r=this.option("filterRow");return r&&r.visible&&r.applyFilter==="onClick"},init(){this.callBase(),this._dataController=this.getController("data"),this._applyFilterViewController=this.getController("applyFilter")},enableApplyButton(r){this.setToolbarItemDisabled("applyFilterButton",!r)},isVisible(){return this.callBase()||this._isShowApplyFilterButton()},optionChanged(r){r.name==="filterRow"?(this._invalidate(),r.handled=!0):this.callBase(r)}}}}};A.registerModule("filterRow",Wf);var ss="dx-header-filter",ls="dx-header-filter-menu",Gf="text";function Ad(r){r=r||[];for(var e=0;e<r.length;e++)r[e].selected=!1,Ad(r[e].items)}function Dd(r){var e=r.NAME==="dxTreeView"?".dx-treeview-select-all-item":".dx-list-select-all-checkbox";return r.$element().find(e).dxCheckBox("instance")}function ds(r,e){if(!r.component.option("searchValue")){var t=Dd(r.component);t&&e&&e.length&&t.option("value",void 0)}}function Kf(r,e,t){if(e^t){if(r.selected=!0,t&&r.items){for(var i=0;i<r.items.length;i++)if(!r.items[i].selected){r.selected=void 0;break}}}else(t||r.selected)&&(r.selected=!1,Ad(r.items))}var Uf=W.View.inherit({getPopupContainer(){return this._popupContainer},getListComponent(){return this._listComponent},applyHeaderFilter(r){var e=this.getListComponent(),t=e.option("searchValue"),i=Dd(e),a=!t&&!r.isFilterBuilder&&(i==null?void 0:i.option("value")),n=[];a?(r.type==="tree"&&(r.filterType="exclude"),Array.isArray(r.filterValues)&&(r.filterValues=[])):r.type==="tree"&&(r.filterType&&(r.filterType="include"),function o(s,l,d){T(l,(u,h)=>{if(h.selected!==void 0&&!!h.selected^d){var c=e._getNode(h),p=e._hasChildren(c),g=p&&h.items&&h.items.some(v=>v.selected);if(!t||!g){s.push(h.value);return}}h.items&&h.items.length&&o(s,h.items,d)})}(n,e.option("items"),!1),r.filterValues=n),r.filterValues&&!r.filterValues.length&&(r.filterValues=null),r.apply(),this.hideHeaderFilterMenu()},showHeaderFilterMenu(r,e){if(e){this._initializePopupContainer(e);var t=this.getPopupContainer();this.hideHeaderFilterMenu(),this.updatePopup(r,e),t.show()}},hideHeaderFilterMenu(){var r=this.getPopupContainer();r&&r.hide()},updatePopup(r,e){var t=this.option("showColumnLines"),i=e.alignment==="right"^!t?"left":"right";this._popupContainer.setAria({role:"dialog",label:y.format("dxDataGrid-headerFilterLabel")}),this._popupContainer&&(this._cleanPopupContent(),this._popupContainer.option("position",{my:"".concat(i," top"),at:"".concat(i," bottom"),of:r,collision:"fit fit"}))},_getSearchExpr(r,e){var{lookup:t}=r,{useDefaultSearchExpr:i}=r,a=e.dataSource,n=e.search.searchExpr;if(n)return n;if(i||_(a)&&!H(a))return Gf;if(t)return t.displayExpr||"this";if(r.dataSource){var{group:o}=r.dataSource;if(Array.isArray(o)&&o.length>0)return o[0].selector;if(H(o)&&!r.remoteFiltering)return o}return r.dataField||r.selector},_cleanPopupContent(){this._popupContainer&&this._popupContainer.$content().empty()},_initializePopupContainer(r){var e=this,t=e.element(),i=this._normalizeHeaderFilterOptions(r),{height:a,width:n}=i,o={width:n,height:a,visible:!1,shading:!1,showTitle:!1,showCloseButton:!1,hideOnParentScroll:!1,dragEnabled:!1,hideOnOutsideClick:!0,wrapperAttr:{class:ls},focusStateEnabled:!1,toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:i.texts.ok,onClick(){e.applyHeaderFilter(r)}}},{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:i.texts.cancel,onClick(){e.hideHeaderFilterMenu()}}}],resizeEnabled:!0,onShowing(s){s.component.$content().parent().addClass("dx-dropdowneditor-overlay"),e._initializeListContainer(r,i),r.onShowing&&r.onShowing(s)},onShown(){e.getListComponent().focus()},onHidden:r.onHidden,onInitialized(s){var{component:l}=s;l.option("animation",l._getDefaultOptions().animation)}};_(e._popupContainer)?e._popupContainer.option(o):e._popupContainer=e._createComponent(t,vt,o)},_initializeListContainer(r,e){var t=this,i=t._popupContainer.$content(),a=!r.isFilterBuilder&&e.allowSelectAll,n={searchEnabled:e.search.enabled,searchTimeout:e.search.timeout,searchEditorOptions:e.search.editorOptions,searchMode:e.search.mode||"",dataSource:r.dataSource,onContentReady(){t.renderCompleted.fire()},itemTemplate(s,l,d){var u=m(d);return r.encodeHtml?u.text(s.text):u.html(s.text)}};function o(s){s.fullName==="searchValue"&&a&&t.option("headerFilter.hideSelectAllOnSearch")!==!1&&(r.type==="tree"?s.component.option("showCheckBoxesMode",s.value?"normal":"selectAll"):s.component.option("selectionMode",s.value?"multiple":"all"))}r.type==="tree"?t._listComponent=t._createComponent(m("<div>").appendTo(i),tn,S(n,{showCheckBoxesMode:a?"selectAll":"normal",onOptionChanged:o,keyExpr:"id"})):t._listComponent=t._createComponent(m("<div>").appendTo(i),an,S(n,{searchExpr:t._getSearchExpr(r,e),pageLoadMode:"scrollBottom",showSelectionControls:!0,selectionMode:a?"all":"multiple",onOptionChanged:o,onSelectionChanged(s){var l=s.component.option("items"),d=s.component.option("selectedItems");if(!s.component._selectedItemsUpdating&&!s.component.option("searchValue")&&!r.isFilterBuilder){var u=r.filterValues||[],h=r.filterType==="exclude";d.length===0&&l.length&&(u.length<=1||h&&u.length===l.length-1)?(r.filterType="include",r.filterValues=[]):d.length===l.length&&(r.filterType="exclude",r.filterValues=[])}T(l,(c,p)=>{var g=I.getIndexByKey(p,d,null)>=0,v=!!p.selected;if(v!==g){p.selected=g,r.filterValues=r.filterValues||[];var f=I.getIndexByKey(p.value,r.filterValues,null);f>=0&&r.filterValues.splice(f,1);var C=r.filterType==="exclude";g^C&&r.filterValues.push(p.value)}}),ds(s,r.filterValues)},onContentReady(s){var{component:l}=s,d=l.option("items"),u=[];T(d,function(){this.selected&&u.push(this)}),l._selectedItemsUpdating=!0,l.option("selectedItems",u),l._selectedItemsUpdating=!1,ds(s,r.filterValues)}}))},_normalizeHeaderFilterOptions(r){var e=this.option("headerFilter")||{},t=r.headerFilter||{},i={search:{enabled:e.allowSearch,timeout:e.searchTimeout}},a={search:{enabled:t.allowSearch,mode:t.searchMode,timeout:t.searchTimeout}};return S(!0,{},e,i,t,a)},_renderCore(){this.element().addClass(ls)}}),Ri=function(r){return _(r.allowHeaderFiltering)?r.allowHeaderFiltering:r.allowFiltering},Vd={_applyColumnState(r){var e,{rootElement:t}=r,{column:i}=r;if(r.name==="headerFilter"){if(t.find(".".concat(ss)).remove(),Ri(i)){e=this.callBase(r).toggleClass("dx-header-filter-empty",this._isHeaderFilterEmpty(i)),this.option("useLegacyKeyboardNavigation")||e.attr("tabindex",this.option("tabindex")||0);var a=y.format("dxDataGrid-headerFilterIndicatorLabel",i.caption);e.attr("aria-label",a),e.attr("aria-haspopup","dialog"),e.attr("role","button")}return e}return this.callBase(r)},_isHeaderFilterEmpty:r=>!r.filterValues||!r.filterValues.length,_getIndicatorClassName(r){return r==="headerFilter"?ss:this.callBase(r)},_renderIndicator(r){var e=r.container,t=r.indicator;if(r.name==="headerFilter"){var i=this.option("rtlEnabled");if(e.children().length&&(!i&&r.columnAlignment==="right"||i&&r.columnAlignment==="left")){e.prepend(t);return}}this.callBase(r)},optionChanged(r){if(r.name==="headerFilter"){var e=this.name==="columnHeadersView";this._invalidate(e,e),r.handled=!0}else this.callBase(r)}},$f={month:r=>ke.getMonthNames()[r-1],quarter:r=>ke.format(new Date(2e3,3*r-1),"quarter")};function Fd(r,e,t){return e=e||[],t=t||[],r.forEach(i=>{if(_(i.key)){var a=e.length===1;if(e.push(a?i.key-1:i.key),i.items)Fd(i.items,e,t);else{var n=new Date(Date.UTC.apply(Date,e));t.push(n)}e.pop()}else t.push(null)}),t}function qf(r,e){var t=Fd(r),i=Er(t),a=I.getHeaderFilterGroupParameters(L(L({},e),{calculateCellValue:n=>n}));return li.queryByOptions(i,{group:a}).toArray()}function Xf(r){return(r==null?void 0:r.slice(-1))==="Z"||(r==null?void 0:r.slice(-3))==="'Z'"}var jf=W.ViewController.inherit({init(){this._columnsController=this.getController("columns"),this._dataController=this.getController("data"),this._headerFilterView=this.getView("headerFilterView")},_updateSelectedState(r,e){for(var t=r.length,i=e.filterType==="exclude";t--;){var a=r[t];"items"in r[t]&&this._updateSelectedState(r[t].items,e),Kf(a,I.getIndexByKey(r[t].value,e.filterValues,null)>-1,i)}},_normalizeGroupItem(r,e,t){var i,a,{path:n}=t,{valueSelector:o}=t,{displaySelector:s}=t,{column:l}=t;return o&&s?(i=o(r),a=s(r)):(i=r.key,a=i),Q(r)?r=S({},r):r={},n.push(i),n.length===1?r.value=n[0]:r.value=n.join("/"),r.text=this.getHeaderItemText(a,l,e,t.headerFilterOptions),r},getHeaderItemText(r,e,t,i){var a=I.formatValue(r,function(n,o,s){var l=ct.getGroupInterval(o),d=I.getFormatOptionsByColumn(o,"headerFilter");return l&&(d.groupInterval=l[s],I.isDateType(o.dataType)?d.format=$f[l[s]]:o.dataType==="number"&&(d.getDisplayFormat=function(){var u={format:o.format,target:"headerFilter"},h=I.formatValue(n,u),c=n+l[s],p=I.formatValue(c,u);return h&&p?"".concat(h," - ").concat(p):""})),d}(r,e,t));return a||(a=i.texts.emptyValue),a},_processGroupItems(r,e,t,i){var a,n,{column:o}=i,{lookup:s}=o,{level:l}=i;t=t||[],e=e||0,s&&(a=de(s.displayExpr),n=de(s.valueExpr));for(var d=0;d<r.length;d++)r[d]=this._normalizeGroupItem(r[d],e,{column:i.column,headerFilterOptions:i.headerFilterOptions,displaySelector:a,valueSelector:n,path:t}),"items"in r[d]&&(e===l||!_(r[d].value)?delete r[d].items:this._processGroupItems(r[d].items,e+1,t,i)),t.pop()},getDataSource(r){var e,t=this._dataController.dataSource(),i=t==null?void 0:t.remoteOperations().grouping,a=I.getHeaderFilterGroupParameters(r,i),n=(e=r.headerFilter)===null||e===void 0?void 0:e.dataSource,o=this.option("headerFilter"),s=!1,l={component:this.component};if(t){if(_(n)&&!H(n))l.dataSource=Ei(n);else if(r.lookup)if(s=!0,this.option("syncLookupFilterValues")){this._currentColumn=r;var d=this._dataController.getCombinedFilter();this._currentColumn=null,l.dataSource=I.getWrappedLookupDataSource(r,t,d)}else l.dataSource=I.normalizeLookupDataSource(r.lookup);else{var u=Array.isArray(a)?a.length-1:0;this._currentColumn=r;var h=this._dataController.getCombinedFilter();this._currentColumn=null,l.dataSource={filter:h,group:a,useDefaultSearch:!0,load:g=>{var v=new O;return g.dataField=r.dataField||r.name,t.load(g).done(f=>{var C=i&&Xf(r.serializationFormat)&&u>3;C&&(f=qf(f,r)),p._processGroupItems(f,null,null,{level:u,column:r,headerFilterOptions:o}),v.resolve(f)}).fail(v.reject),v}}}H(n)&&n.call(r,l);var c=l.dataSource.postProcess,p=this;return l.dataSource.postProcess=function(g){var v=g;return s&&(v=v.filter(f=>f[r.lookup.valueExpr]!==null),this.pageIndex()===0&&!this.searchValue()&&(v=v.slice(0),v.unshift(null)),p._processGroupItems(v,null,null,{level:0,column:r,headerFilterOptions:o})),v=c&&c.call(this,v)||v,p._updateSelectedState(v,r),v},l.dataSource}},getCurrentColumn(){return this._currentColumn},showHeaderFilterMenu(r,e){var t=this._columnsController,i=S(!0,{},this._columnsController.getColumns()[r]);if(i){var a=t.getVisibleIndex(r),n=e?this.getView("headerPanel"):this.getView("columnHeadersView"),o=o||n.getColumnElements().eq(e?i.groupIndex:a);this.showHeaderFilterMenuBase({columnElement:o,column:i,applyFilter:!0,apply(){t.columnOption(r,{filterValues:this.filterValues,filterType:this.filterType})}})}},showHeaderFilterMenuBase(r){var e=this,{column:t}=r;if(t){var i=ct.getGroupInterval(t),a=e._dataController.dataSource(),n=a&&a.remoteOperations().filtering,o=r.onHidden;S(r,t,{type:i&&i.length>1?"tree":"list",remoteFiltering:n,onShowing(s){var l=s.component.$overlayContent().dxResizable("instance");l&&l.option("onResizeEnd",d=>{var u=e.getController("columns"),h=u.columnOption(r.dataField,"headerFilter");h=h||{},h.width=d.width,h.height=d.height,u.columnOption(r.dataField,"headerFilter",h,!0)})},onHidden:()=>{o==null||o(),nn(this)}}),r.dataSource=e.getDataSource(r),r.isFilterBuilder&&(r.dataSource.filter=null,r.alignment="right"),e._headerFilterView.showHeaderFilterMenu(r.columnElement,r)}},hideHeaderFilterMenu(){this._headerFilterView.hideHeaderFilterMenu()}}),Yf=S({},Vd,{_renderCellContent(r,e){var t,{column:i}=e;!i.command&&Ri(i)&&this.option("headerFilter.visible")&&e.rowType==="header"&&(t=this._applyColumnState({name:"headerFilter",rootElement:r,column:i,showColumnLines:this.option("showColumnLines")}),t&&this._subscribeToIndicatorEvent(t,i,"headerFilter")),this.callBase.apply(this,arguments)},_subscribeToIndicatorEvent(r,e,t){t==="headerFilter"&&b.on(r,re,this.createAction(i=>{i.event.stopPropagation(),Vl(r,this),this.getController("headerFilter").showHeaderFilterMenu(e.index,!1)}))},_updateIndicator(r,e,t){var i=this.callBase(r,e,t);i&&this._subscribeToIndicatorEvent(i,e,t)},_updateHeaderFilterIndicators(){this.option("headerFilter.visible")&&this._updateIndicators("headerFilter")},_needUpdateFilterIndicators:()=>!0,_columnOptionChanged(r){var{optionNames:e}=r;if(I.checkChanges(e,["filterValues","filterType"])){this._needUpdateFilterIndicators()&&this._updateHeaderFilterIndicators();return}this.callBase(r)}}),Qf=S({},Vd,{_createGroupPanelItem(r,e){var t=this,i=t.callBase.apply(t,arguments),a;return!e.command&&Ri(e)&&t.option("headerFilter.visible")&&(a=t._applyColumnState({name:"headerFilter",rootElement:i,column:{alignment:Bt(t.option("rtlEnabled")),filterValues:e.filterValues,allowHeaderFiltering:!0},showColumnLines:!0}),a&&b.on(a,re,t.createAction(n=>{var{event:o}=n;o.stopPropagation(),t.getController("headerFilter").showHeaderFilterMenu(e.index,!0)}))),i}}),Jf={skipCalculateColumnFilters:()=>!1,_calculateAdditionalFilter(){if(this.skipCalculateColumnFilters())return this.callBase();var r=[this.callBase()],e=this._columnsController.getVisibleColumns(null,!0),t=this.getController("headerFilter"),i=t.getCurrentColumn();return T(e,(a,n)=>{var o;if(!(i&&i.index===n.index)&&Ri(n)&&n.calculateFilterExpression&&Array.isArray(n.filterValues)&&n.filterValues.length){var s=[];T(n.filterValues,(l,d)=>{Array.isArray(d)?o=d:(n.deserializeValue&&!I.isDateType(n.dataType)&&n.dataType!=="number"&&(d=n.deserializeValue(d)),o=n.createFilterExpression(d,"=","headerFilter")),o&&(o.columnIndex=n.index),s.push(o)}),s=I.combineFilters(s,"or"),r.push(n.filterType==="exclude"?["!",s]:s)}}),I.combineFilters(r)}},Zf={defaultOptions:()=>({syncLookupFilterValues:!0,headerFilter:{visible:!1,width:252,height:325,allowSelectAll:!0,search:{enabled:!1,timeout:500,mode:"contains",editorOptions:{}},texts:{emptyValue:y.format("dxDataGrid-headerFilterEmptyValue"),ok:y.format("dxDataGrid-headerFilterOK"),cancel:y.format("dxDataGrid-headerFilterCancel")}}}),controllers:{headerFilter:jf},views:{headerFilterView:Uf},extenders:{controllers:{data:Jf},views:{columnHeadersView:Yf,headerPanel:Qf}}};A.registerModule("headerFilter",Zf);var Oi="dx-filterbuilder-range",em=Oi+"-start",tm=Oi+"-end",rm=Oi+"-separator",Pd="â";function im(r,e){var t=m("<div>").addClass(em),i=m("<div>").addClass(tm),a=r.value||[],n=function(s){return s&&s.length>0?s[0]:null},o=function(s){return s&&s.length===2?s[1]:null};e.append(t),e.append(m("<span>").addClass(rm).text(Pd)),e.append(i),e.addClass(Oi),this._editorFactory.createEditor.call(this,t,S({},r.field,r,{value:n(a),parentType:"filterBuilder",setValue:function(s){a=[s,o(a)],r.setValue(a)}})),this._editorFactory.createEditor.call(this,i,S({},r.field,r,{value:o(a),parentType:"filterBuilder",setValue:function(s){a=[n(a),s],r.setValue(a)}}))}function us(r,e){return{name:"between",caption:r,icon:"range",valueSeparator:Pd,dataTypes:["number","date","datetime"],editorTemplate:im.bind(e),notForLookup:!0}}var am={"=":"equal","<>":"notequal","<":"less","<=":"lessorequal",">":"greater",">=":"greaterorequal",notcontains:"doesnotcontain",contains:"contains",startswith:"startswith",endswith:"endswith",isblank:"isblank",isnotblank:"isnotblank"},nm={"=":"equal","<>":"notEqual","<":"lessThan","<=":"lessThanOrEqual",">":"greaterThan",">=":"greaterThanOrEqual",startswith:"startsWith",contains:"contains",notcontains:"notContains",endswith:"endsWith",isblank:"isBlank",isnotblank:"isNotBlank",between:"between"};const Bd={getIconByFilterOperation:function(r){return am[r]},getNameByFilterOperation:function(r){return nm[r]}};var vn="string",hs="icon-none",Je="and",fn="=",om="<>",sm={number:["=","<>","<",">","<=",">=","isblank","isnotblank"],string:["contains","notcontains","startswith","endswith","=","<>","isblank","isnotblank"],date:["=","<>","<",">","<=",">=","isblank","isnotblank"],datetime:["=","<>","<",">","<=",">=","isblank","isnotblank"],boolean:["=","<>","isblank","isnotblank"],object:["isblank","isnotblank"]},lm={date:"shortDate",datetime:"shortDateShortTime"},dm=["=","<>","isblank","isnotblank"],um=["caption","customizeText","dataField","dataType","editorTemplate","falseText","editorOptions","filterOperations","format","lookup","trueText","calculateFilterExpression","name"],hm="dx-filterbuilder",Ld=hm+"-text",cm=Ld+"-part",kd=Ld+"-separator",pm=kd+"-empty";function gm(r,e){var t=r.format||lm[r.dataType];return Ml.format(e,t)}function pt(r){return r&&r.length>1&&r[0]==="!"&&!ie(r)}function Ze(r){return pt(r)?r[1]:r}function vm(r,e){return pt(r)?r[1]=e:r=e,r}function fm(r,e){(function(t){return t.indexOf("!")!==-1})(e)?pt(r)||function(t){var i=t.slice(0);t.length=0,t.push("!",i)}(r):pt(r)&&function(t){var i=Ze(t);t.length=0,[].push.apply(t,i)}(r)}function mm(r,e){fm(r,e);var t=Ze(r),i;return e=function(a){return a.indexOf("!")===-1?a:a.substring(1)}(e),function(a,n){for(i=0;i<a.length;i++)Array.isArray(a[i])||(a[i]=n)}(t,e),r}function _m(r,e){var t=mt(r);return e.filter(function(i){return i.value===t})[0]}function Md(r){if(ie(r))return Je;for(var e="",t=0;t<r.length;t++){var i=r[t];if(!Array.isArray(i)){if(e&&e!==i)throw new si.Error("E4019");i!=="!"&&(e=i)}}return e}function mt(r){var e=Ze(r),t=Md(e);return t||(t=Je),e!==r&&(t="!"+t),t}function Cm(r){return r.lookup&&dm||sm[r.dataType||vn]}function wm(r){return Array.isArray(r)&&r.length}function Nd(r){var e=wm(r.filterOperations)?r.filterOperations:Cm(r);return S([],e)}function Na(r,e){var t=Bd.getNameByFilterOperation(r);return e&&e[t]?e[t]:t}function xm(r,e){for(var t=0;t<e.length;t++)if(e[t].value===r)return e[t];throw new q.Error("E1048",r)}function We(r,e){var t=r.filter(function(i){return i.name===e});return t.length?t[0]:null}function ym(r,e,t){var i=Nd(r),a=!!r.lookup;return t.forEach(function(n){if(!r.filterOperations&&i.indexOf(n.name)===-1){var o=n&&n.dataTypes,s=a?!!n.notForLookup:!1;!s&&o&&o.indexOf(r.dataType||vn)>=0&&i.push(n.name)}}),i.map(function(n){var o=We(t,n);return o?{icon:o.icon||hs,text:o.caption||hr(o.name),value:o.name,isCustom:!0}:{icon:Bd.getIconByFilterOperation(n)||hs,text:Na(n,e),value:n}})}function mn(r){return r.defaultFilterOperation||Nd(r)[0]}function Em(r,e){var t=[r.dataField,"",""],i=mn(r);return Ha(t,i,e),t}function za(r,e){var t=Ze(r),i=t.indexOf(e);return t.splice(i,1),t.length!==1&&t.splice(i,1),r}function zd(r){var e=_n(r),t=e?Cn(r):r;return e?["!",[t]]:[t]}function vi(r,e){var t=Ze(e),i=mt(t);return t.length===1?t.unshift(r):t.push(r,i),e}function fi(r,e){for(var t=0;t<e.length;t++)if(e[t].name===r||e[t].dataField.toLowerCase()===r.toLowerCase())return e[t];var i=$d(e,!0).filter(function(a){return a.dataField.toLowerCase()===r.toLowerCase()});if(i.length>0)return i[0];throw new q.Error("E1047",r)}function et(r){return Array.isArray(r)?r.length<2||Array.isArray(r[0])||Array.isArray(r[1]):!1}function ie(r){return Array.isArray(r)?r.length>1&&!Array.isArray(r[0])&&!Array.isArray(r[1]):!1}function cs(r,e,t){t=t||Je;for(var i=Md(r).toLowerCase()||t,a=[],n=0;n<r.length;n++)et(r[n])?(a.push(wn(r[n],e,t)),a=ga(a,i)):ie(r[n])&&(a.push(mi(r[n],e)),a=ga(a,i));return a.length===0&&(a=ga(a,i)),a}function Sm(r,e){var t=We(e,r[1]);return t&&t.name===r[1]}function mi(r,e){return Sm(r,e)||r.length<3&&(r[2]=r[1],r[1]=fn),r}function _n(r){return r.indexOf("not")!==-1}function Cn(r){return r.substring(3).toLowerCase()}function pa(r,e){var t=_n(e);return e=t?Cn(e):e,t?["!",r,e]:[r,e]}function ga(r,e){var t=_n(e);e=t?Cn(e):e,r.push(e);var i=r;return t&&(i=["!",i]),i}function wn(r,e,t){return t=t||Je,r?(r=S(!0,[],r),ie(r)?pa(mi(r,e),t):pt(r)?["!",ie(r[1])?pa(mi(r[1],e),t):pt(r[1])?pa(wn(r[1],e),t):cs(r[1],e,t)]:cs(r,e,t)):zd(t)}function bm(r){return r.reduce(function(e,t){if(_(t.dataField)){var i={};for(var a in t)t[a]&&um.indexOf(a)>-1&&(i[a]=t[a]);i.defaultCalculateFilterExpression=ct.defaultCalculateFilterExpression,_(i.dataType)||(i.dataType=vn),_(i.trueText)||(i.trueText=y.format("dxDataGrid-trueText")),_(i.falseText)||(i.falseText=y.format("dxDataGrid-falseText")),e.push(i)}return e},[])}function ps(r,e,t,i){var a=fi(r[0],e),n=mi(r,t),o=t.length&&We(t,n[1]);return o&&o.calculateFilterExpression?o.calculateFilterExpression.apply(o,[n[2],a,e]):a.createFilterExpression?a.createFilterExpression.apply(a,[n[2],n[1],i]):a.calculateFilterExpression?a.calculateFilterExpression.apply(a,[n[2],n[1],i]):a.defaultCalculateFilterExpression.apply(a,[n[2],n[1],i])}function Ft(r,e,t,i){if(!_(r))return null;if(pt(r)){var a=Ft(r[1],e,t,i);return["!",a]}var n=Ze(r);if(ie(n))return ps(n,e,t,i)||null;for(var o=[],s,l=mt(n),d=0;d<n.length;d++)et(n[d])?(s=Ft(n[d],e,t,i),s&&(d&&o.push(l),o.push(s))):ie(n[d])&&(s=ps(n[d],e,t,i),s&&(o.length&&o.push(l),o.push(s)));return o.length===1&&(o=o[0]),o.length?o:null}function ar(r){var e=Ze(r),t;if(e.length===0)return null;var i=[];for(t=0;t<e.length;t++)if(et(e[t])){var a=ar(e[t]);a?e[t]=a:i.push(e[t])}else ie(e[t])&&(Tm(e[t])||i.push(e[t]));for(t=0;t<i.length;t++)za(e,i[t]);return e.length===1||(e.splice(e.length-1,1),e.length===1&&(r=vm(r,e[0])),r.length===0)?null:r}function Hd(r,e,t){if(e===""){t("");return}var i=r.lookup;if(i.items)t(i.calculateCellValue(e)||"");else{var a=H(i.dataSource)?i.dataSource({}):i.dataSource,n=new yr(a);n.loadSingle(i.valueExpr,e).done(function(o){var s="";o&&(s=i.displayExpr?de(i.displayExpr)(o):o),r.customizeText&&(s=r.customizeText({value:e,valueText:s})),t(s)}).fail(function(){t("")})}}function Wd(r,e,t,i,a){var n;return e===!0?n=r.trueText||y.format("dxDataGrid-trueText"):e===!1?n=r.falseText||y.format("dxDataGrid-falseText"):n=gm(r,e),r.customizeText&&(n=r.customizeText.call(r,{value:e,valueText:n,target:i})),t&&t.customizeText&&(n=t.customizeText.call(t,{value:e,valueText:n,field:r,target:i},a)),n}function Im(r,e,t,i){var a={values:e};return e.map(n=>Wd(r,n,t,i,a))}function va(r){return r===""||r===null}function Gd(r,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"filterBuilder";if(va(e))return"";if(Array.isArray(e)){var a=new O;return P.apply(this,Im(r,e,t,i)).done(function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];var l=o.some(d=>!va(d))?o.map(d=>va(d)?"?":d):"";a.resolve(l)}),a}else return Wd(r,e,t,i)}function gs(r,e){return r.some(function(t){return t.dataField===e})}function Kd(r,e,t){var i=t.dataField;xn(i)&&(t.parentId=qd(i),!gs(e,t.parentId)&&!gs(r,t.parentId)&&Kd(r,e,{id:t.parentId,dataType:"object",dataField:t.parentId,caption:Ud(t.parentId,!0),filterOperations:["isblank","isnotblank"],defaultCalculateFilterExpression:ct.defaultCalculateFilterExpression})),e.push(t)}function Ud(r,e){var t="";if(e)r=r.substring(r.lastIndexOf(".")+1);else if(xn(r))return r.split(".").forEach(function(i,a,n){t+=hr(i),a!==n.length-1&&(t+=".")}),t;return hr(r)}function $d(r,e){for(var t=[],i=0;i<r.length;i++){var a=S(!0,{caption:Ud(r[i].dataField,e)},r[i]);a.id=a.name||a.dataField,e?Kd(r,t,a):t.push(a)}return t}function xn(r){return r.lastIndexOf(".")!==-1}function qd(r){return r.substring(0,r.lastIndexOf("."))}function Xd(r,e){if(xn(r.dataField)){for(var t=qd(r.dataField),i=0;i<e.length;i++)if(e[i].dataField===t)return Xd(e[i],e)+"."+r.caption}return r.caption}function Ha(r,e,t){var i=We(t,e);return i?(i.hasValue===!1?(r[1]=e,r.length=2):(r[1]=e,r[2]=""),r):(e==="isblank"?(r[1]=fn,r[2]=null):e==="isnotblank"?(r[1]=om,r[2]=null):(i=We(t,r[1]),(i||r.length===2||r[2]===null)&&(r[2]=""),r[1]=e),r)}function vs(r){var e;return r[2]===null?r[1]===fn?e="isblank":e="isnotblank":e=r[1],e}function Tm(r){return r[2]!==""}function Rm(r,e,t){var i=S(!0,[],r),a=-1;return i.some(function(n,o){if(n.name==="between")return a=o,!0}),a!==-1?i[a]=S(us(e,t),i[a]):i.unshift(us(e,t)),i}function vr(r,e){return r[0]===e}function Wa(r,e){if(!r||r.length===0)return null;if(ie(r)){var t=vr(r,e);return t?null:r}else return jd(r,[e],!1)}function jd(r,e,t){var i=[];return r.forEach(function(a){ie(a)?vr(a,e[0])?t?(i.push(e),t=!1):i.splice(i.length-1,1):i.push(a):(i.length||et(a))&&i.push(a)}),i.length===0?null:(t&&(i.push(Je),i.push(e)),i.length===1?i[0]:i)}function fs(r,e){if(r===null||r.length===0)return e;if(ie(r))return vr(r,e[0])?e:[r,Je,e];var t=mt(r);return t!==Je?[e,"and",r]:jd(r,e,!0)}function Om(r,e){if(r===null||r.length===0)return[];if(ie(r))return vr(r,e)?[r]:[];var t=mt(r);if(t!==Je)return[];var i=r.filter(function(a){return ie(a)&&vr(a,e)});return i}function Yd(r,e){return r===null||r.length===0?!1:ie(r)?r[0]===e:r.some(function(t){return(ie(t)||et(t))&&Yd(t,e)})}var Ga=function(r,e,t){if(Array.isArray(e)){var i=e.length-1;r.empty(),e.forEach((a,n)=>{m("<span>").addClass(cm).text(a).appendTo(r),n!==i&&m("<span>").addClass(kd).text(t&&t.valueSeparator?t.valueSeparator:"|").addClass(pm).appendTo(r)})}else e?r.text(e):r.text(y.format("dxFilterBuilder-enterValueText"))};function Qd(r){var e=function(i,a){return a?"".concat(a,"/").concat(i):i},t=r&&r.getController("headerFilter");return{dataTypes:["string","date","datetime","number","boolean","object"],calculateFilterExpression:function(i,a,n){var o=[],s=i.length-1;return i&&i.forEach((l,d)=>{if(ie(l)||et(l)){var u=Ft(l,n,[],"headerFilter");o.push(u)}else{var h=Ft([a.dataField,"=",l],n,[],"headerFilter");o.push(h)}d!==s&&o.push("or")}),o.length===1?o[0]:o},editorTemplate(i,a){var n=m("<div>").addClass("dx-filterbuilder-item-value-text").appendTo(a),o=S(!0,{},r.columnOption(i.field.dataField));return Ga(n,i.text&&i.text.split("|")),o.filterType="include",o.filterValues=i.value?i.value.slice():[],t.showHeaderFilterMenuBase({columnElement:n,column:o,apply(){s=this.filterValues,i.setValue(s);var s;t.hideHeaderFilterMenu(),i.closeEditor()},onHidden(){i.closeEditor()},isFilterBuilder:!0}),a},customizeText:function(i,a){a=a||{};var{value:n}=i,o=r.columnOption(i.field.dataField),s=o&&o.headerFilter,l=o&&o.lookup,d=a.values||[n];if(s&&s.dataSource||l&&l.dataSource){var u=new O,h=a.items||new O;if(!a.items){o=S({},o,{filterType:"include",filterValues:d});var c=t.getDataSource(o);c.paginate=!1;var p=new yr(c),g=p.store().key();if(g){var{values:v}=a;if(v&&v.length>1){var f=v.reduce((w,x)=>(w.length&&w.push("or"),w.push([g,"=",x]),w),[]);p.filter(f)}else p.filter([g,"=",i.value])}else i.field.calculateDisplayValue&&q.log("W1017");a.items=h,p.load().done(h.resolve)}return h.done(w=>{var x=d.indexOf(i.value);u.resolve(function E(R,D){var V=[];return R.forEach(F=>{if(F.items){var B=E(F.items,e(F.text,D));V=V.concat(B)}F.selected&&V.push(e(F.text,D))}),V}(w,null)[x])}),u}var C=t.getHeaderItemText(n,o,0,r.option("headerFilter"));return C}}}function Am(r){return S(Qd(r),{name:"anyof",icon:"selectall",caption:y.format("dxFilterBuilder-filterOperationAnyOf")})}function Dm(r){var e=Qd(r);return S({},e,{calculateFilterExpression(t,i,a){var n=e.calculateFilterExpression(t,i,a);return!n||n.length===0?null:n[0]==="!"?n:["!",n]},name:"noneof",icon:"unselectall",caption:y.format("dxFilterBuilder-filterOperationNoneOf")})}var Vm=["=","<>","<","<=",">",">=","notcontains","contains","startswith","endswith","between"],ms="include",nr="exclude";function De(r){return r.name||r.dataField}function Fm(r){r.forEach(e=>{var t=De(e);if(!_(t)&&e.allowFiltering)throw new q.Error("E1049",e.caption)})}var Pm=W.Controller.inherit(function(){var r=function(){return{filterType:ms,filterValues:void 0}},e=function(o){var s=o.filterValues||[];return!ct.getGroupInterval(o)&&!(o.headerFilter&&o.headerFilter.dataSource)||s.length===1&&s[0]===null},t=function(o){var s=o.filterValue;if(_(s)){var l=o.selectedFilterOperation||o.defaultFilterOperation||mn(o),d=[De(o),l,o.filterValue];return d}return null},i=function(o){var s,l,{filterValues:d}=o;return d?(d.length===1&&e(o)&&!Array.isArray(d[0])?(o.filterType===nr?s="<>":s="=",l=d[0]):(o.filterType===nr?s="noneof":s="anyof",l=d),[De(o),s,l]):null},a=function(o,s,l){var d=function(u,h){if(!u)return r();var c,p=u[1],g=u[2],v=Array.isArray(g);if(!v&&!e(h))return r();switch(p){case"anyof":case"=":c=ms;break;case"noneof":case"<>":c=nr;break;default:return r()}return{filterType:c,filterValues:v?g:[g]}}(l,s);o.columnOption(De(s),d)},n=function(o,s,l){var d,u=l==null?void 0:l[1],h=l==null?void 0:l[2],c=s.filterOperations||s.defaultFilterOperations;(!c||c.indexOf(u)>=0||u===s.defaultFilterOperation)&&Vm.includes(u)&&h!==null?(u===s.defaultFilterOperation&&!_(s.selectedFilterOperation)&&(u=s.selectedFilterOperation),d={filterValue:h,selectedFilterOperation:u}):d={filterValue:void 0,selectedFilterOperation:void 0},o.columnOption(De(s),d)};return{syncFilterValue(){var o=this,s=o.getController("columns"),l=s.getFilteringColumns();this._skipSyncColumnOptions=!0,l.forEach(d=>{var u=Om(o.option("filterValue"),De(d));if(u.length===1){var h=u[0];a(s,d,h),n(s,d,h)}else _(d.filterValues)&&a(s,d,null),_(d.filterValue)&&n(s,d,null)}),this._skipSyncColumnOptions=!1},_initSync(){var o=this.getController("columns").getColumns(),s=this.getController("data"),l=s.pageIndex();if(Fm(o),!this.option("filterValue")){var d=this.getController("columns").getFilteringColumns(),u=this.getFilterValueFromColumns(d);this.option("filterValue",u)}this.syncFilterValue(),s.pageIndex(l)},init(){var o=this.getController("data");o.isFilterSyncActive()&&(this.getController("columns").isAllDataTypesDefined()?this._initSync():o.dataSourceChanged.add(()=>this._initSync()))},_getSyncFilterRow(o,s){var l=t(s);return _(l)?fs(o,l):Wa(o,De(s))},_getSyncHeaderFilter(o,s){var l=i(s);return l?fs(o,l):Wa(o,De(s))},getFilterValueFromColumns(o){if(!this.getController("data").isFilterSyncActive())return null;var s=["and"];return o&&o.forEach(l=>{var d=i(l),u=t(l);d&&vi(d,s),u&&vi(u,s)}),ar(s)},syncFilterRow(o){this.option("filterValue",this._getSyncFilterRow(this.option("filterValue"),o))},syncHeaderFilter(o){this.option("filterValue",this._getSyncHeaderFilter(this.option("filterValue"),o))},getCustomFilterOperations(){var o=this.option("filterBuilder.customOperations")||[];return[Am(this.component),Dm(this.component)].concat(o)},publicMethods:()=>["getCustomFilterOperations"]}}()),Bm={isFilterSyncActive(){var r=this.option("filterSyncEnabled");return r==="auto"?this.option("filterPanel.visible"):r},skipCalculateColumnFilters(){var r=this.getController("filterSync");return(_(this.option("filterValue"))||r._skipSyncColumnOptions)&&this.isFilterSyncActive()},_calculateAdditionalFilter(){if(this.option("filterPanel.filterEnabled")===!1)return this.callBase();var r=[this.callBase()],e=this.getController("columns").getFilteringColumns(),t=this.option("filterValue");if(this.isFilterSyncActive()){var i=this.getController("headerFilter").getCurrentColumn(),a=this.getController("applyFilter").getCurrentColumnForFiltering(),n=i||a,o=i||_(a==null?void 0:a.filterValue);o&&t&&(t=Wa(t,De(n)))}var s=this.getController("filterSync").getCustomFilterOperations(),l=Ft(t,e,s,"filterBuilder");return l&&r.push(l),I.combineFilters(r)},_parseColumnPropertyName(r){var e=r.match(/.*\.(.*)/);return e?e[1]:null},clearFilter(r){this.component.beginUpdate(),arguments.length>0?(r==="filterValue"&&this.option("filterValue",null),this.callBase(r)):(this.option("filterValue",null),this.callBase()),this.component.endUpdate()},optionChanged(r){switch(r.name){case"filterValue":this._applyFilter(),this.isFilterSyncActive()&&this.getController("filterSync").syncFilterValue(),r.handled=!0;break;case"filterSyncEnabled":r.handled=!0;break;case"columns":if(this.isFilterSyncActive()){var e=this.getController("columns").getColumnByPath(r.fullName),t=this.getController("filterSync");if(e&&!t._skipSyncColumnOptions){var i=this._parseColumnPropertyName(r.fullName);t._skipSyncColumnOptions=!0,i==="filterType"?(nr===r.value||nr===r.previousValue)&&t.syncHeaderFilter(e):i==="filterValues"?t.syncHeaderFilter(e):["filterValue","selectedFilterOperation"].includes(i)&&t.syncFilterRow(e,e.filterValue),t._skipSyncColumnOptions=!1}}this.callBase(r);break;default:this.callBase(r)}}},Lm={_isHeaderFilterEmpty(r){return this.getController("data").isFilterSyncActive()?!Yd(this.option("filterValue"),De(r)):this.callBase(r)},_needUpdateFilterIndicators(){return!this.getController("data").isFilterSyncActive()},optionChanged(r){r.name==="filterValue"?this._updateHeaderFilterIndicators():this.callBase(r)}},km={defaultOptions:()=>({filterValue:null,filterSyncEnabled:"auto"}),controllers:{filterSync:Pm},extenders:{controllers:{data:Bm},views:{columnHeadersView:Lm}}};A.registerModule("filterSync",km);var Ce="dx-filterbuilder",Pt=Ce+"-group",_s=Pt+"-item",Cs=Pt+"-content",Mm=Pt+"-operations",Nm=Pt+"-operation",Ka=Ce+"-action",ws=Ka+"-icon",zm="dx-icon-plus",Hm="dx-icon-remove",qt=Ce+"-text",Wm=Ce+"-item-field",Gm=Ce+"-item-operation",xs=Ce+"-item-value",Km=Ce+"-item-value-text",Um=Ce+"-overlay",$m=Ce+"-operations",qm=Ce+"-fields",Xm=Ce+"-add-condition",Hr="dx-state-active",jm=Ce+"-menu-custom-operation",ys="filterBuilder",Ym="dx-state-disabled",Es="tab",fa="enter",Ss="escape",Qm=[{name:"onEditorPreparing",config:{excludeValidators:["disabled","readOnly"],category:"rendering"}},{name:"onEditorPrepared",config:{excludeValidators:["disabled","readOnly"],category:"rendering"}},{name:"onValueChanged",config:{excludeValidators:["disabled","readOnly"]}}],bs={and:"and",or:"or",notAnd:"!and",notOr:"!or"},Jm=Cr.inherit(hd),Jd=dr.inherit({_getDefaultOptions:function(){return S(this.callBase(),{onEditorPreparing:null,onEditorPrepared:null,onValueChanged:null,fields:[],groupOperations:["and","or","notAnd","notOr"],maxGroupLevel:void 0,value:null,allowHierarchicalFields:!1,groupOperationDescriptions:{and:y.format("dxFilterBuilder-and"),or:y.format("dxFilterBuilder-or"),notAnd:y.format("dxFilterBuilder-notAnd"),notOr:y.format("dxFilterBuilder-notOr")},customOperations:[],closePopupOnTargetScroll:!0,filterOperationDescriptions:{between:y.format("dxFilterBuilder-filterOperationBetween"),equal:y.format("dxFilterBuilder-filterOperationEquals"),notEqual:y.format("dxFilterBuilder-filterOperationNotEquals"),lessThan:y.format("dxFilterBuilder-filterOperationLess"),lessThanOrEqual:y.format("dxFilterBuilder-filterOperationLessOrEquals"),greaterThan:y.format("dxFilterBuilder-filterOperationGreater"),greaterThanOrEqual:y.format("dxFilterBuilder-filterOperationGreaterOrEquals"),startsWith:y.format("dxFilterBuilder-filterOperationStartsWith"),contains:y.format("dxFilterBuilder-filterOperationContains"),notContains:y.format("dxFilterBuilder-filterOperationNotContains"),endsWith:y.format("dxFilterBuilder-filterOperationEndsWith"),isBlank:y.format("dxFilterBuilder-filterOperationIsBlank"),isNotBlank:y.format("dxFilterBuilder-filterOperationIsNotBlank")}})},_optionChanged:function(r){switch(r.name){case"closePopupOnTargetScroll":break;case"onEditorPreparing":case"onEditorPrepared":case"onValueChanged":this._initActions();break;case"customOperations":this._initCustomOperations(),this._invalidate();break;case"fields":case"maxGroupLevel":case"groupOperations":case"allowHierarchicalFields":case"groupOperationDescriptions":case"filterOperationDescriptions":this._invalidate();break;case"value":if(r.value!==r.previousValue){var e=this._disableInvalidateForValue;e||(this._initModel(),this._invalidate()),this._disableInvalidateForValue=!1,this.executeAction("onValueChanged",{value:r.value,previousValue:r.previousValue}),this._disableInvalidateForValue=e}break;default:this.callBase(r)}},getFilterExpression:function(){var r=this._getNormalizedFields(),e=S(!0,[],this._model);return Ft(ar(e),r,this._customOperations,ys)},_getNormalizedFields:function(){return bm(this.option("fields"))},_updateFilter:function(){this._disableInvalidateForValue=!0;var r=S(!0,[],this._model),e=ar(r),t=ar(this._getModel(this.option("value")));JSON.stringify(t)!==JSON.stringify(e)&&this.option("value",e),this._disableInvalidateForValue=!1,this._fireContentReadyAction()},_init:function(){this._initCustomOperations(),this._initModel(),this._initEditorFactory(),this._initActions(),this.callBase()},_initEditorFactory:function(){this._editorFactory=new Jm},_initCustomOperations:function(){this._customOperations=Rm(this.option("customOperations"),this.option("filterOperationDescriptions.between"),this)},_getDefaultGroupOperation:function(){var r,e;return(r=(e=this.option("groupOperations"))===null||e===void 0?void 0:e[0])!==null&&r!==void 0?r:bs.and},_getModel:function(r){return wn(r,this._customOperations,this._getDefaultGroupOperation())},_initModel:function(){this._model=this._getModel(this.option("value"))},_initActions:function(){var r=this;r._actions={},Qm.forEach(function(e){var t=S({},e.config);r._actions[e.name]=r._createActionByOption(e.name,t)})},executeAction:function(r,e){var t=this._actions[r];return t&&t(e)},_initMarkup:function(){this.$element().addClass(Ce),this.callBase(),this._createGroupElementByCriteria(this._model).appendTo(this.$element())},_createConditionElement:function(r,e){return m("<div>").addClass(Pt).append(this._createConditionItem(r,e))},_createGroupElementByCriteria:function(r,e){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=this._createGroupElement(r,e,t),a=i.find("."+Cs),n=Ze(r),o=0;o<n.length;o++){var s=n[o];et(s)?this._createGroupElementByCriteria(s,r,t+1).appendTo(a):ie(s)&&this._createConditionElement(s,r).appendTo(a)}return i},_createGroupElement:function(r,e,t){var i=m("<div>").addClass(_s),a=m("<div>").addClass(Cs),n=m("<div>").addClass(Pt).append(i).append(a);return e!=null&&this._createRemoveButton(()=>{za(e,r),n.remove(),this._updateFilter()}).appendTo(i),this._createGroupOperationButton(r).appendTo(i),this._createAddButton(()=>{var o=zd(this._getDefaultGroupOperation());vi(o,r),this._createGroupElement(o,r,t+1).appendTo(a),this._updateFilter()},()=>{var o=this.option("fields")[0],s=Em(o,this._customOperations);vi(s,r),this._createConditionElement(s,r).appendTo(a),this._updateFilter()},t).appendTo(i),n},_createButton:function(r){return m("<div>").text(r)},_createGroupOperationButton:function(r){var e=this._getGroupOperations(r),t=_m(r,e),i=t.text,a=e&&e.length<2?this._createButton(i).addClass(Ym):this._createButtonWithMenu({caption:i,menu:{items:e,displayExpr:"text",keyExpr:"value",onItemClick:n=>{t!==n.itemData&&(mm(r,n.itemData.value),a.text(n.itemData.text),t=n.itemData,this._updateFilter())},onContentReady:function(n){n.component.selectItem(t)},cssClass:Mm}});return a.addClass(qt).addClass(Nm).attr("tabindex",0)},_createButtonWithMenu:function(r){var e=this,t=function(){e.$element().find("."+Hr).removeClass(Hr),e.$element().find(".dx-overlay .dx-treeview").remove(),e.$element().find(".dx-overlay").remove()},i=this.option("rtlEnabled"),a=i?"right":"left",n=this._createButton(r.caption);S(r.menu,{focusStateEnabled:!0,selectionMode:"single",onItemClick:(o=r.menu.onItemClick,function(s){o(s),s.event.type==="dxclick"&&t()}),onHiding:function(s){n.removeClass(Hr)},position:{my:a+" top",at:a+" bottom",offset:"0 1",of:n,collision:"flip"},animation:null,onHidden:function(){t()},cssClass:Um+" "+r.menu.cssClass,rtlEnabled:i});var o;return r.popup={onShown:function(s){var l=m(s.component.content()).find(".dx-treeview"),d=l.dxTreeView("instance");b.on(l,"keyup keydown",function(u){var h=Ie(u);(u.type==="keydown"&&h===Es||u.type==="keyup"&&(h===Ss||h===fa))&&(s.component.hide(),b.trigger(r.menu.position.of,"focus"))}),d.focus(),d.option("focusedElement",null)}},this._subscribeOnClickAndEnterKey(n,function(){t(),e._createPopupWithTreeView(r,e.$element()),n.addClass(Hr)}),n},_hasValueButton:function(r){var e=We(this._customOperations,r[1]);return e?e.hasValue!==!1:r[2]!==null},_createOperationButtonWithMenu:function(r,e){var t=this,i=ym(e,this.option("filterOperationDescriptions"),this._customOperations),a=xm(vs(r),i),n=this._createButtonWithMenu({caption:a.text,menu:{items:i,displayExpr:"text",onItemRendered:function(o){o.itemData.isCustom&&m(o.itemElement).addClass(jm)},onContentReady:function(o){o.component.selectItem(a)},onItemClick:o=>{if(a!==o.itemData){a=o.itemData,Ha(r,a.value,t._customOperations);var s=n.siblings().filter("."+xs);t._hasValueButton(r)?(s.length!==0&&s.remove(),t._createValueButton(r,e).appendTo(n.parent())):s.remove(),n.html(a.text),this._updateFilter()}},cssClass:$m}}).addClass(qt).addClass(Gm).attr("tabindex",0);return n},_createOperationAndValueButtons:function(r,e,t){this._createOperationButtonWithMenu(r,e).appendTo(t),this._hasValueButton(r)&&this._createValueButton(r,e).appendTo(t)},_createFieldButtonWithMenu:function(r,e,t){var i=this,a=this.option("allowHierarchicalFields"),n=$d(r,a),o=fi(t.name||t.dataField,n),s=function(d,u){return a?Xd(d,u):d.caption},l=this._createButtonWithMenu({caption:s(o,n),menu:{items:n,dataStructure:"plain",keyExpr:"id",parentId:"parentId",displayExpr:"caption",onItemClick:d=>{if(o!==d.itemData){o=d.itemData,e[0]=o.name||o.dataField,e[2]=o.dataType==="object"?null:"",Ha(e,mn(o),i._customOperations),l.siblings().filter("."+qt).remove(),i._createOperationAndValueButtons(e,o,l.parent());var u=s(o,d.component.option("items"));l.html(u),this._updateFilter()}},onContentReady:function(d){d.component.selectItem(o)},cssClass:qm}}).addClass(qt).addClass(Wm).attr("tabindex",0);return l},_createConditionItem:function(r,e){var t=m("<div>").addClass(_s),i=this._getNormalizedFields(),a=fi(r[0],i);return this._createRemoveButton(()=>{za(e,r);var n=t.parent().children().length===1;n?t.parent().remove():t.remove(),this._updateFilter()}).appendTo(t),this._createFieldButtonWithMenu(i,r,a).appendTo(t),this._createOperationAndValueButtons(r,a,t),t},_getGroupOperations:function(r){var e=this.option("groupOperations"),t=this.option("groupOperationDescriptions");return(!e||!e.length)&&(e=[mt(r).replace("!","not")]),e.map(i=>({text:t[i],value:bs[i]}))},_createRemoveButton:function(r){var e=m("<div>").addClass(ws).addClass(Hm).addClass(Ka).attr("tabindex",0);return this._subscribeOnClickAndEnterKey(e,r),e},_createAddButton:function(r,e,t){var i,a=this.option("maxGroupLevel");return _(a)&&t>=a?(i=this._createButton(),this._subscribeOnClickAndEnterKey(i,e)):i=this._createButtonWithMenu({menu:{items:[{caption:y.format("dxFilterBuilder-addCondition"),click:e},{caption:y.format("dxFilterBuilder-addGroup"),click:r}],displayExpr:"caption",onItemClick:function(n){n.itemData.click()},cssClass:Xm}}),i.addClass(ws).addClass(zm).addClass(Ka).attr("tabindex",0)},_createValueText:function(r,e,t){var i=this,a=m("<div>").html("&nbsp;").addClass(Km).attr("tabindex",0).appendTo(t),n=r[2],o=We(i._customOperations,r[1]);return!o&&e.lookup?Hd(e,n,function(s){Ga(a,s)}):P(Gd(e,n,o)).done(s=>{Ga(a,s,o)}),i._subscribeOnClickAndEnterKey(a,function(s){s.type==="keyup"&&s.stopPropagation(),i._createValueEditorWithEvents(r,e,t)}),a},_updateConditionValue:function(r,e,t){var i=r[2]!==e;i&&(r[2]=e),t(),this._updateFilter()},_addDocumentKeyUp:function(r,e){var t=!1,i=!1,a=z.getDocument(),n=s=>{if(t||i){i=!1;return}e(s)};b.on(a,"keyup",n);var o=r.find("input");b.on(o,"compositionstart",()=>{t=!0}),b.on(o,"compositionend",()=>{t=!1,i=!0}),b.on(o,"keydown",s=>{s.which!==229&&(i=!1)}),this._documentKeyUpHandler=n},_addDocumentClick:function(r,e){var t=z.getDocument(),i=a=>{this._isFocusOnEditorParts(r,a.target)||(b.trigger(r.find("input"),"change"),e())};b.on(t,"dxpointerdown",i),this._documentClickHandler=i},_isFocusOnEditorParts:function(r,e){var t=e||z.getActiveElement();return m(t).closest(r.children()).length||m(t).closest(".dx-dropdowneditor-overlay").length},_removeEvents:function(){var r=z.getDocument();_(this._documentKeyUpHandler)&&b.off(r,"keyup",this._documentKeyUpHandler),_(this._documentClickHandler)&&b.off(r,"dxpointerdown",this._documentClickHandler)},_dispose:function(){this._removeEvents(),this.callBase()},_createValueEditorWithEvents:function(r,e,t){var i=r[2],a=()=>(t.empty(),this._removeEvents(),this._createValueText(r,e,t)),n=()=>{this._updateConditionValue(r,i,function(){a()})},o={value:i===""?null:i,filterOperation:vs(r),setValue:function(l){i=l===null?"":l},closeEditor:n,text:t.text()};t.empty();var s=this._createValueEditor(t,e,o);b.trigger(s.find("input").not(":hidden").eq(0),"focus"),this._removeEvents(),this._addDocumentClick(s,n),this._addDocumentKeyUp(s,l=>{var d=Ie(l);if(d===Es){if(this._isFocusOnEditorParts(s))return;this._updateConditionValue(r,i,function(){a(),l.shiftKey&&b.trigger(t.prev(),"focus")})}d===Ss&&b.trigger(a(),"focus"),d===fa&&this._updateConditionValue(r,i,function(){b.trigger(a(),"focus")})}),this._fireContentReadyAction()},_createValueButton:function(r,e){var t=m("<div>").addClass(qt).addClass(xs);return this._createValueText(r,e,t),t},_createValueEditor:function(r,e,t){var i=m("<div>").attr("tabindex",0).appendTo(r),a=We(this._customOperations,t.filterOperation),n=a&&a.editorTemplate?a.editorTemplate:e.editorTemplate;if(n){var o=this._getTemplate(n);o.render({model:S({field:e},t),container:i})}else this._editorFactory.createEditor.call(this,i,S({},e,t,{parentType:ys}));return i},_createPopupWithTreeView:function(r,e){var t=this,i=m("<div>").addClass(r.menu.cssClass).appendTo(e);this._createComponent(i,vt,{onHiding:r.menu.onHiding,onHidden:r.menu.onHidden,rtlEnabled:r.menu.rtlEnabled,position:r.menu.position,animation:r.menu.animation,contentTemplate:function(a){var n=m("<div>").appendTo(a);t._createComponent(n,tn,r.menu),this.repaint()},_ignoreFunctionValueDeprecation:!0,maxHeight:function(){return mh(r.menu.position.of)},visible:!0,focusStateEnabled:!1,hideOnParentScroll:this.option("closePopupOnTargetScroll"),hideOnOutsideClick:!0,onShown:r.popup.onShown,shading:!1,width:"auto",height:"auto",showTitle:!1,_wrapperClassExternal:r.menu.cssClass})},_subscribeOnClickAndEnterKey:function(r,e){b.on(r,"dxclick",e),b.on(r,"keyup",function(t){Ie(t)===fa&&e(t)})}});_r("dxFilterBuilder",Jd);var Zm=W.View.inherit({_renderCore(){this._updatePopupOptions()},_updatePopupOptions(){this.option("filterBuilderPopup.visible")?this._initPopup():this._filterBuilderPopup&&this._filterBuilderPopup.hide()},_disposePopup(){this._filterBuilderPopup&&(this._filterBuilderPopup.dispose(),this._filterBuilderPopup=void 0),this._filterBuilder&&(this._filterBuilder.dispose(),this._filterBuilder=void 0)},_initPopup(){var r=this;r._disposePopup(),r._filterBuilderPopup=r._createComponent(r.element(),vt,S({title:y.format("dxDataGrid-filterBuilderPopupTitle"),contentTemplate:e=>r._getPopupContentTemplate(e),onOptionChanged(e){e.name==="visible"&&r.option("filterBuilderPopup.visible",e.value)},toolbarItems:r._getPopupToolbarItems()},r.option("filterBuilderPopup"),{onHidden(){nn(r),r._disposePopup()}}))},_getPopupContentTemplate(r){var e=m(r),t=m("<div>").appendTo(m(r));this._filterBuilder=this._createComponent(t,Jd,S({value:this.option("filterValue"),fields:this.getController("columns").getFilteringColumns()},this.option("filterBuilder"),{customOperations:this.getController("filterSync").getCustomFilterOperations()})),this._createComponent(e,Th,{direction:"both"})},_getPopupToolbarItems(){var r=this;return[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:y.format("OK"),onClick(){var e=r._filterBuilder.option("value");r.option("filterValue",e),r._filterBuilderPopup.hide()}}},{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:y.format("Cancel"),onClick(){r._filterBuilderPopup.hide()}}}]},optionChanged(r){switch(r.name){case"filterBuilder":case"filterBuilderPopup":this._invalidate(),r.handled=!0;break;default:this.callBase(r)}}}),e_={defaultOptions:()=>({filterBuilder:{groupOperationDescriptions:{and:y.format("dxFilterBuilder-and"),or:y.format("dxFilterBuilder-or"),notAnd:y.format("dxFilterBuilder-notAnd"),notOr:y.format("dxFilterBuilder-notOr")},filterOperationDescriptions:{between:y.format("dxFilterBuilder-filterOperationBetween"),equal:y.format("dxFilterBuilder-filterOperationEquals"),notEqual:y.format("dxFilterBuilder-filterOperationNotEquals"),lessThan:y.format("dxFilterBuilder-filterOperationLess"),lessThanOrEqual:y.format("dxFilterBuilder-filterOperationLessOrEquals"),greaterThan:y.format("dxFilterBuilder-filterOperationGreater"),greaterThanOrEqual:y.format("dxFilterBuilder-filterOperationGreaterOrEquals"),startsWith:y.format("dxFilterBuilder-filterOperationStartsWith"),contains:y.format("dxFilterBuilder-filterOperationContains"),notContains:y.format("dxFilterBuilder-filterOperationNotContains"),endsWith:y.format("dxFilterBuilder-filterOperationEndsWith"),isBlank:y.format("dxFilterBuilder-filterOperationIsBlank"),isNotBlank:y.format("dxFilterBuilder-filterOperationIsNotBlank")}},filterBuilderPopup:{}}),views:{filterBuilderView:Zm}};A.registerModule("filterBuilder",e_);var Tr="filter-panel",t_="".concat(Tr,"-text"),r_="".concat(Tr,"-checkbox"),i_="".concat(Tr,"-clear-filter"),a_="".concat(Tr,"-left"),n_="filterPanel",o_=W.View.inherit({isVisible(){return this.option("filterPanel.visible")&&this.getController("data").dataSource()},init(){this.getController("data").dataSourceChanged.add(()=>this.render()),this._columnsController=this.getController("columns")},_renderCore(){var r=this.element();r.empty();var e=!!this._columnsController.getColumns().length;if(e){r.addClass(this.addWidgetPrefix(Tr));var t=m("<div>").addClass(this.addWidgetPrefix(a_)).appendTo(r);this._renderFilterBuilderText(r,t)}},_renderFilterBuilderText(r,e){var t=this._getFilterElement(),i=this._getTextElement();if(this.option("filterValue")||this._filterValueBuffer){var a=this._getCheckElement(),n=this._getRemoveButtonElement();e.append(a).append(t).append(i),r.append(n);return}e.append(t).append(i)},_getCheckElement(){var r=this,e=m("<div>").addClass(this.addWidgetPrefix(r_));return r._createComponent(e,Dh,{value:r.option("filterPanel.filterEnabled"),onValueChanged(t){r.option("filterPanel.filterEnabled",t.value)}}),e.attr("title",this.option("filterPanel.texts.filterEnabledHint")),e},_getFilterElement(){var r=this,e=m("<div>").addClass("dx-icon-filter");return b.on(e,"click",()=>r._showFilterBuilder()),tr("filterPanel",r,e,void 0,()=>r._showFilterBuilder()),r._addTabIndexToElement(e),e},_getTextElement(){var r=this,e=m("<div>").addClass(r.addWidgetPrefix(t_)),t,i=r.option("filterValue");return i?P(r.getFilterText(i,r.getController("filterSync").getCustomFilterOperations())).done(a=>{var n=r.option("filterPanel.customizeText");if(n){var o=n({component:r.component,filterValue:i,text:a});typeof o=="string"&&(a=o)}e.text(a)}):(t=r.option("filterPanel.texts.createFilter"),e.text(t)),b.on(e,"click",()=>r._showFilterBuilder()),tr("filterPanel",r,e,void 0,()=>r._showFilterBuilder()),r._addTabIndexToElement(e),e},_showFilterBuilder(){this.option("filterBuilderPopup.visible",!0)},_getRemoveButtonElement(){var r=this,e=()=>r.option("filterValue",null),t=m("<div>").addClass(r.addWidgetPrefix(i_)).text(r.option("filterPanel.texts.clearFilter"));return b.on(t,"click",e),tr("filterPanel",this,t,void 0,e),r._addTabIndexToElement(t),t},_addTabIndexToElement(r){if(!this.option("useLegacyKeyboardNavigation")){var e=this.option("tabindex")||0;r.attr("tabindex",e)}},optionChanged(r){switch(r.name){case"filterValue":this._invalidate(),this.option("filterPanel.filterEnabled",!0),r.handled=!0;break;case"filterPanel":this._invalidate(),r.handled=!0;break;default:this.callBase(r)}},_getConditionText(r,e,t){var i="[".concat(r,"] ").concat(e);return _(t)&&(i+=t),i},_getValueMaskedText:r=>Array.isArray(r)?"('".concat(r.join("', '"),"')"):" '".concat(r,"'"),_getValueText(r,e,t){var i=new O,a=e&&e.customizeText;if(_(t)||a)if(!a&&r.lookup)Hd(r,t,o=>{i.resolve(this._getValueMaskedText(o))});else{var n=Array.isArray(t)?t:I.getDisplayValue(r,t,null);P(Gd(r,n,e,n_)).done(o=>{i.resolve(this._getValueMaskedText(o))})}else i.resolve("");return i.promise()},getConditionText(r,e){var t=this,i=r[1],a=new O,n=We(e.customOperations,i),o,s=fi(r[0],e.columns),l=s.caption||"",d=r[2];return n?o=n.caption||hr(n.name):d===null?o=Na(i==="="?"isblank":"isnotblank",e.filterOperationDescriptions):o=Na(i,e.filterOperationDescriptions),this._getValueText(s,n,d).done(u=>{a.resolve(t._getConditionText(l,o,u))}),a},getGroupText(r,e,t){var i=this,a=new O,n=[],o=mt(r);return r.forEach(s=>{ie(s)?n.push(i.getConditionText(s,e)):et(s)&&n.push(i.getGroupText(s,e,!0))}),P.apply(this,n).done(function(){for(var s,l=arguments.length,d=new Array(l),u=0;u<l;u++)d[u]=arguments[u];if(o.startsWith("!")){var h=e.groupOperationDescriptions["not".concat(o.substring(1,2).toUpperCase()).concat(o.substring(2))].split(" ");s="".concat(h[0]," ").concat(d[0])}else s=d.join(" ".concat(e.groupOperationDescriptions[o]," "));t&&(s="(".concat(s,")")),a.resolve(s)}),a},getFilterText(r,e){var t={customOperations:e,columns:this.getController("columns").getFilteringColumns(),filterOperationDescriptions:this.option("filterBuilder.filterOperationDescriptions"),groupOperationDescriptions:this.option("filterBuilder.groupOperationDescriptions")};return ie(r)?this.getConditionText(r,t):this.getGroupText(r,t)}}),s_={defaultOptions:()=>({filterPanel:{visible:!1,filterEnabled:!0,texts:{createFilter:y.format("dxDataGrid-filterPanelCreateFilter"),clearFilter:y.format("dxDataGrid-filterPanelClearFilter"),filterEnabledHint:y.format("dxDataGrid-filterPanelFilterEnabledHint")}}}),views:{filterPanelView:o_},extenders:{controllers:{data:{optionChanged(r){switch(r.name){case"filterPanel":this._applyFilter(),r.handled=!0;break;default:this.callBase(r)}}}}}};A.registerModule("filterPanel",s_);var Is="search-panel",Ts="search-text",l_="header-panel",d_=700;function Rs(r){return _(r.allowSearch)?r.allowSearch:r.allowFiltering}function Os(r,e){var{lookup:t}=r;return r.parseValue?t?r.parseValue.call(t,e):r.parseValue(e):e}var u_={defaultOptions:()=>({searchPanel:{visible:!1,width:160,placeholder:y.format("dxDataGrid-searchPanelPlaceholder"),highlightSearchText:!0,highlightCaseSensitive:!1,text:"",searchVisibleColumnsOnly:!1}}),extenders:{controllers:{data:{publicMethods(){return this.callBase().concat(["searchByText"])},_calculateAdditionalFilter(){var r=this.callBase(),e=function(t,i){var a,n,o=t._columnsController.getColumns(),s=t.option("searchPanel.searchVisibleColumnsOnly"),l,d=[];if(!i)return null;function u(c){for(var p=de(l.valueExpr),g=0;g<c.length;g++){var v=p(c[g]);d.push(n.createFilterExpression(v,null,"search"))}}for(a=0;a<o.length;a++)if(n=o[a],!(s&&!n.visible)&&Rs(n)&&n.calculateFilterExpression){l=n.lookup;var h=Os(n,i);l&&l.items?Er(l.items).filter(n.createFilterExpression.call({dataField:l.displayExpr,dataType:l.dataType,calculateFilterExpression:n.calculateFilterExpression},h,null,"search")).enumerate().done(u):h!==void 0&&d.push(n.createFilterExpression(h,null,"search"))}return d.length===0?["!"]:I.combineFilters(d,"or")}(this,this.option("searchPanel.text"));return I.combineFilters([r,e])},searchByText(r){this.option("searchPanel.text",r)},optionChanged(r){switch(r.fullName){case"searchPanel.text":case"searchPanel":this._applyFilter(),r.handled=!0;break;default:this.callBase(r)}}}},views:{headerPanel:function(){var r=function(e){return e.option("searchPanel")};return{_getToolbarItems(){var e=this.callBase();return this._prepareSearchItem(e)},_prepareSearchItem(e){var t=this,i=t.getController("data"),a=r(t);if(a&&a.visible){var n={template(o,s,l){var d=m("<div>").addClass(t.addWidgetPrefix(Is)).appendTo(l);t.getController("editorFactory").createEditor(d,{width:a.width,placeholder:a.placeholder,parentType:"searchPanel",value:t.option("searchPanel.text"),updateValueTimeout:d_,setValue(u){i.searchByText(u)},editorOptions:{inputAttr:{"aria-label":y.format("".concat(t.component.NAME,"-ariaSearchInGrid"))}}}),t.resize()},name:"searchPanel",location:"after",locateInMenu:"never",sortIndex:40};e.push(n)}return e},getSearchTextEditor(){var e=this,t=e.element(),i=t.find(".".concat(e.addWidgetPrefix(Is))).filter(function(){return m(this).closest(".".concat(e.addWidgetPrefix(l_))).is(t)});return i.length?i.dxTextBox("instance"):null},isVisible(){var e=r(this);return this.callBase()||e&&e.visible},optionChanged(e){if(e.name==="searchPanel"){if(e.fullName==="searchPanel.text"){var t=this.getSearchTextEditor();t&&t.option("value",e.value)}else this._invalidate();e.handled=!0}else this.callBase(e)}}}(),rowsView:{init(){this.callBase.apply(this,arguments),this._searchParams=[],this._dataController=this.getController("data")},_getFormattedSearchText(r,e){var t=Os(r,e),i=I.getFormatOptionsByColumn(r,"search");return I.formatValue(t,i)},_getStringNormalizer(){var r,e,t,i,a=this.option("searchPanel.highlightCaseSensitive"),n=(e=(r=this._dataController)===null||r===void 0?void 0:r.getDataSource)===null||e===void 0?void 0:e.call(r),o=(i=(t=n==null?void 0:n.loadOptions)===null||t===void 0?void 0:t.call(n))===null||i===void 0?void 0:i.langParams;return s=>Me(s,a,o)},_findHighlightingTextNodes(r,e,t){var i=e.parent(),a,n=this._getStringNormalizer(),o=n(t),s=[];if(!i.length)i=m("<div>").append(e);else if(r)if(r.groupIndex>=0&&!r.showWhenGrouped)a=e;else{var l=this._columnsController.getVisibleIndex(r.index);a=i.children("td").eq(l).find("*")}return a=a!=null&&a.length?a:i.find("*"),a.each((d,u)=>{for(var h=m(u).contents(),c=0;c<h.length;c++){var p=h.get(c);if(p.nodeType===3){var g=n(p.textContent||p.nodeValue);g.indexOf(o)>-1&&s.push(p)}}}),s},_highlightSearchTextCore(r,e){var t=m("<span>").addClass(this.addWidgetPrefix(Ts)),i=r.text(),a=r[0],n=this._getStringNormalizer(),o=n(i).indexOf(n(e));if(o>=0)return a.textContent?a.textContent=i.substr(0,o):a.nodeValue=i.substr(0,o),r.after(t.text(i.substr(o,e.length))),r=m(z.createTextNode(i.substr(o+e.length))).insertAfter(t),this._highlightSearchTextCore(r,e)},_highlightSearchText(r,e,t){var i=this,a=this._getStringNormalizer(),n=i.option("searchPanel.text");if(e&&t&&(n=n&&i._getFormattedSearchText(t,n)),n&&i.option("searchPanel.highlightSearchText")){var o=i._findHighlightingTextNodes(t,r,n);o.forEach(s=>{e?a(m(s).text())===a(n)&&m(s).replaceWith(m("<span>").addClass(i.addWidgetPrefix(Ts)).text(m(s).text())):i._highlightSearchTextCore(m(s),n)})}},_renderCore(){var r=this.callBase.apply(this,arguments);return(this.option().rowTemplate||this.option("dataRowTemplate"))&&(this.option("templatesRenderAsynchronously")?(clearTimeout(this._highlightTimer),this._highlightTimer=setTimeout(()=>{this._highlightSearchText(this.getTableElement())})):this._highlightSearchText(this.getTableElement())),r},_updateCell(r,e){var{column:t}=e,i=t.lookup&&t.lookup.dataType||t.dataType,a=i!=="string";Rs(t)&&!e.isOnForm&&(this.option("templatesRenderAsynchronously")?(this._searchParams.length||(clearTimeout(this._highlightTimer),this._highlightTimer=setTimeout(()=>{this._searchParams.forEach(n=>{this._highlightSearchText.apply(this,n)}),this._searchParams=[]})),this._searchParams.push([r,a,t])):this._highlightSearchText(r,a,t)),this.callBase(r,e)},dispose(){clearTimeout(this._highlightTimer),this.callBase()}}}}};A.registerModule("search",u_);class h_ extends wh{_optionChanged(e){switch(e.name){case"pageIndex":var t=this.option("pageIndexChanged");t&&t(e.value);break;case"pageSize":var i=this.option("pageSizeChanged");i&&i(e.value)}super._optionChanged(e)}}function Ge(r,e){var t,i=(t=Vh(e))!==null&&t!==void 0?t:{};return Rh(i[r])}function c_(r){var e=Ge("paddingLeft",r)+Ge("paddingRight",r),t=Ge("width",r);return t-e}function ei(r){var e=Ge("marginLeft",r)+Ge("marginRight",r),t=Ge("width",r);return e+t}function Zd(r){return Ge("minWidth",r)}var p_=["contentTemplate","pagerProps"],g_=r=>{var{contentAttributes:e,infoTextRef:t,infoTextVisible:i,isLargeDisplayMode:a,pageSizesRef:n,pagesRef:o,parentRef:s,props:{contentTemplate:l}}=r;return l(L({rootElementRef:s,pageSizesRef:n,infoTextRef:t,pagesRef:o,infoTextVisible:i,isLargeDisplayMode:a},e))};function v_(r){var{pageSizes:e,pages:t,parent:i}=r;return i-(e+t)>0}function f_(r){var{info:e,pageSizes:t,pages:i,parent:a}=r,n=t+i+e;return a-n>0}function m_(r){var{info:e,pageSizes:t,pages:i,parent:a}=r,n=c_(a),o=ei(t),s=ei(e),l=ei(i);return{parent:n,pageSizes:o,info:s+Ge("marginLeft",e)+Ge("marginRight",e),pages:l}}var __={},C_=r=>r&&(r.defaultProps?e=>Sr(Z(2,r,L({},e))):r);class eu extends kt{constructor(e){super(e),this.parentRef=qe(),this.pageSizesRef=qe(),this.infoTextRef=qe(),this.pagesRef=qe(),this.actualIsLargeDisplayMode=!0,this.actualInfoTextVisible=!0,this.state={infoTextVisible:!0,isLargeDisplayMode:!0},this.subscribeToResize=this.subscribeToResize.bind(this),this.effectUpdateChildProps=this.effectUpdateChildProps.bind(this),this.updateAdaptivityProps=this.updateAdaptivityProps.bind(this)}createEffects(){return[new je(this.subscribeToResize,[this.state.infoTextVisible,this.state.isLargeDisplayMode]),new je(this.effectUpdateChildProps,[this.props,this.state.infoTextVisible,this.state.isLargeDisplayMode,this.props.pagerProps,this.props.contentTemplate])]}updateEffects(){var e,t;(e=this._effects[0])===null||e===void 0||e.update([this.state.infoTextVisible,this.state.isLargeDisplayMode]),(t=this._effects[1])===null||t===void 0||t.update([this.props,this.state.infoTextVisible,this.state.isLargeDisplayMode,this.props.pagerProps,this.props.contentTemplate])}subscribeToResize(){var e=()=>{this.parentWidth>0&&this.updateAdaptivityProps()};return Tn.add(e),()=>{Tn.remove(e)}}effectUpdateChildProps(){this.parentWidth>0&&this.updateAdaptivityProps()}get contentAttributes(){var{className:e,displayMode:t,gridCompatibility:i,hasKnownLastPage:a,infoText:n,label:o,lightModeEnabled:s,maxPagesCount:l,onKeyDown:d,pageCount:u,pageIndex:h,pageIndexChange:c,pageSize:p,pageSizeChange:g,pageSizes:v,pagesCountText:f,pagesNavigatorVisible:C,rtlEnabled:w,showInfo:x,showNavigationButtons:E,showPageSizes:R,totalCount:D,visible:V}=this.props.pagerProps;return L({},this.restAttributes,{pageSize:p,pageIndex:h,pageIndexChange:c,pageSizeChange:g,gridCompatibility:i,className:e,showInfo:x,infoText:n,lightModeEnabled:s,displayMode:t,maxPagesCount:l,pageCount:u,pagesCountText:f,visible:V,hasKnownLastPage:a,pagesNavigatorVisible:C,showPageSizes:R,pageSizes:v,rtlEnabled:w,showNavigationButtons:E,totalCount:D,onKeyDown:d,label:o})}get parentWidth(){return this.parentRef.current?ei(this.parentRef.current):0}updateAdaptivityProps(){var e=m_({parent:this.parentRef.current,pageSizes:this.pageSizesRef.current,info:this.infoTextRef.current,pages:this.pagesRef.current});if(!(this.actualInfoTextVisible!==this.state.infoTextVisible||this.actualIsLargeDisplayMode!==this.state.isLargeDisplayMode)){var t=!_(this.elementsWidth);t&&(this.elementsWidth={}),(t||this.state.isLargeDisplayMode)&&(this.elementsWidth.pageSizes=e.pageSizes,this.elementsWidth.pages=e.pages),(t||this.state.infoTextVisible)&&(this.elementsWidth.info=e.info),this.actualIsLargeDisplayMode=v_(L({parent:e.parent},{pageSizes:this.elementsWidth.pageSizes,pages:this.elementsWidth.pages})),this.actualInfoTextVisible=f_(L({},e,{info:this.elementsWidth.info})),this.setState(i=>({infoTextVisible:this.actualInfoTextVisible})),this.setState(i=>({isLargeDisplayMode:this.actualIsLargeDisplayMode}))}}get restAttributes(){var e=this.props,t=ue(e,p_);return t}render(){var e=this.props;return g_({props:L({},e,{contentTemplate:C_(e.contentTemplate)}),infoTextVisible:this.state.infoTextVisible,isLargeDisplayMode:this.state.isLargeDisplayMode,parentRef:this.parentRef,pageSizesRef:this.pageSizesRef,infoTextRef:this.infoTextRef,pagesRef:this.pagesRef,contentAttributes:this.contentAttributes,parentWidth:this.parentWidth,updateAdaptivityProps:this.updateAdaptivityProps,restAttributes:this.restAttributes})}}eu.defaultProps=__;var tu={gridCompatibility:!0,showInfo:!1,displayMode:"adaptive",maxPagesCount:10,pageCount:10,visible:!0,hasKnownLastPage:!0,pagesNavigatorVisible:"auto",showPageSizes:!0,pageSizes:Object.freeze([5,10]),showNavigationButtons:!1,totalCount:0,get label(){return y.format("dxPager-ariaLabel")}},w_=Object.create(Object.prototype,L(Object.getOwnPropertyDescriptors(tu),Object.getOwnPropertyDescriptors({defaultPageSize:5,pageSizeChange:()=>{},defaultPageIndex:1,pageIndexChange:()=>{}}))),ee=Object.create(Object.prototype,L(Object.getOwnPropertyDescriptors(tu),Object.getOwnPropertyDescriptors({pageSize:5,pageIndex:1}))),x_=["infoText","pageCount","pageIndex","rootElementRef","totalCount"],ru="dx-info",y_=r=>{var{props:{rootElementRef:e},text:t}=r;return Ye(1,"div",ru,t,0,null,null,e)},E_={get pageIndex(){return ee.pageIndex},get pageCount(){return ee.pageCount},get totalCount(){return ee.totalCount}};class iu extends gt{constructor(e){super(e),this.state={}}get infoText(){var e;return((e=this.props.infoText)!==null&&e!==void 0?e:"")||y.getFormatter("dxPager-infoText")()}get text(){var{pageCount:e,pageIndex:t,totalCount:i}=this.props;return At(this.infoText,(t+1).toString(),e.toString(),i.toString())}get restAttributes(){var e=this.props,t=ue(e,x_);return t}render(){var e=this.props;return y_({props:L({},e),infoText:this.infoText,text:this.text,restAttributes:this.restAttributes})}}iu.defaultProps=E_;var or=xh(void 0),S_=["children","className","label","onClick","selected","tabIndex"],b_=r=>{var{props:{children:e,className:t,label:i,selected:a,tabIndex:n},widgetRef:o}=r;return Ye(1,"div",t,e,0,{tabIndex:n,role:"button","aria-label":i,"aria-current":a?"page":void 0},null,o)},I_={className:"",label:"",tabIndex:0,selected:!1};class fr extends kt{constructor(e){super(e),this.state={},this.widgetRef=qe(),this.keyboardEffect=this.keyboardEffect.bind(this),this.subscribeToClick=this.subscribeToClick.bind(this)}get keyboardContext(){return this.context[or.id]?this.context[or.id]:or.defaultValue}createEffects(){return[new je(this.keyboardEffect,[this.keyboardContext,this.props.onClick]),new je(this.subscribeToClick,[this.props.onClick])]}updateEffects(){var e,t;(e=this._effects[0])===null||e===void 0||e.update([this.keyboardContext,this.props.onClick]),(t=this._effects[1])===null||t===void 0||t.update([this.props.onClick])}keyboardEffect(){return this.keyboardContext.registerKeyboardAction(this.widgetRef.current,this.props.onClick)}subscribeToClick(){return yh(this.widgetRef.current,this.props.onClick)}get restAttributes(){var e=this.props,t=ue(e,S_);return t}render(){var e=this.props;return b_({props:L({},e),widgetRef:this.widgetRef,keyboardContext:this.keyboardContext,restAttributes:this.restAttributes})}}fr.defaultProps=I_;var T_="dx-pager",R_="dx-light-mode",O_="dx-pages",A_="dx-page-indexes",D_="dx-page",au="dx-selection",nu="dx-page-size",V_="dx-page-sizes",F_="".concat(nu," ").concat(au),P_="dx-first-child",B_=["className","index","onClick","selected"],L_=r=>{var{className:e,label:t,props:{onClick:i,selected:a},value:n}=r;return Z(2,fr,{className:e,label:t,onClick:i,selected:a,children:n})},k_={index:0,selected:!1,className:D_};class yn extends gt{constructor(e){super(e),this.state={}}get label(){return At(y.getFormatter("dxPager-page"),this.value)}get value(){return this.props.index+1}get className(){var{selected:e}=this.props;return Si({["".concat(this.props.className)]:!!this.props.className,[au]:!!e})}get restAttributes(){var e=this.props,t=ue(e,B_);return t}render(){var e=this.props;return L_({props:L({},e),label:this.label,value:this.value,className:this.className,restAttributes:this.restAttributes})}}yn.defaultProps=k_;var M_=["pageIndexes"],N_=["maxPagesCount","pageCount","pageIndex","pageIndexChange"],z_="dx-separator",H_=r=>{var{pages:e}=r,t=e.map(i=>{var{key:a,pageProps:n}=i;return n?Z(2,yn,{index:n.index,selected:n.selected,onClick:n.onClick},a):Ye(1,"div",z_,". . .",16,null,a)});return rn(t,0)},it=4;function As(r,e,t){return r===1?"high":r+e===t-1?"low":"both"}function ou(r,e,t){var i=[],a=[];switch(t){case"none":i=[...r];break;case"both":i=[0,"low",...r,"high",e-1],a=r.slice(1,-1);break;case"high":i=[0,...r,"high",e-1],a=r.slice(0,-1);break;case"low":i=[0,"low",...r,e-1],a=r.slice(1)}return{slidingWindowIndexes:r,indexesForReuse:a,pageIndexes:i}}function Ds(r,e,t,i){for(var a=[],n=0;n<e;n+=1)a.push(n+r);return ou(a,t,i)}var W_={get pageIndex(){return ee.pageIndex},get maxPagesCount(){return ee.maxPagesCount},get pageCount(){return ee.pageCount}};class su extends gt{constructor(e){super(e),this.state={},this.canReuseSlidingWindow=this.canReuseSlidingWindow.bind(this),this.generatePageIndexes=this.generatePageIndexes.bind(this),this.isSlidingWindowMode=this.isSlidingWindowMode.bind(this),this.onPageClick=this.onPageClick.bind(this)}get config(){return this.context[Ae.id]?this.context[Ae.id]:Ae.defaultValue}get slidingWindowState(){var e=this.slidingWindowStateHolder;return e||{indexesForReuse:[],slidingWindowIndexes:[]}}canReuseSlidingWindow(e,t){var{indexesForReuse:i}=this.slidingWindowState,a=i.slice(-1)[0]<e-1,n=i.includes(t);return a&&n}generatePageIndexes(){var{pageCount:e,pageIndex:t}=this.props,i=0,{slidingWindowIndexes:a}=this.slidingWindowState;t===a[0]?i=t-1:t===a[a.length-1]?i=t+2-it:t<it?i=1:t>=e-it?i=e-it-1:i=t-1;var n=it,o=As(i,n,e),s=Ds(i,n,e,o),{pageIndexes:l}=s,d=ue(s,M_);return this.slidingWindowStateHolder=d,l}isSlidingWindowMode(){var{maxPagesCount:e,pageCount:t}=this.props;return t<=it||t<=e}onPageClick(e){this.props.pageIndexChange(e)}get pageIndexes(){var{pageCount:e}=this.props;if(this.isSlidingWindowMode())return Ds(0,e,e,"none").pageIndexes;if(this.canReuseSlidingWindow(e,this.props.pageIndex)){var{slidingWindowIndexes:t}=this.slidingWindowState,i=As(t[0],it,e);return ou(t,e,i).pageIndexes}return this.generatePageIndexes()}get pages(){var e,{pageIndex:t}=this.props,i=n=>{var o=n==="low"||n==="high"?null:{index:n,onClick:()=>this.onPageClick(n),selected:t===n};return{key:n.toString(),pageProps:o}},a=(e=this.config)!==null&&e!==void 0&&e.rtlEnabled?[...this.pageIndexes].reverse():this.pageIndexes;return a.map(n=>i(n))}get restAttributes(){var e=this.props,t=ue(e,N_);return t}render(){var e=this.props;return H_({props:L({},e),config:this.config,pageIndexes:this.pageIndexes,pages:this.pages,restAttributes:this.restAttributes})}}su.defaultProps=W_;var Ot={hoverStateEnabled:!0,activeStateEnabled:!0,get focusStateEnabled(){return _e.real().deviceType==="desktop"&&!_e.isSimulator()}},_i={label:"",get labelMode(){return wi(ml())?"floating":"static"}},G_=["accessKey","activeStateEnabled","className","defaultValue","disabled","focusStateEnabled","height","hint","hoverStateEnabled","inputAttr","invalidValueMessage","isValid","label","labelMode","max","min","mode","name","onClick","onFocusIn","onKeyDown","readOnly","rtlEnabled","showSpinButtons","step","tabIndex","useLargeSpinButtons","validationError","validationErrors","validationMessageMode","validationMessagePosition","validationStatus","value","valueChange","visible","width"],K_=0,U_=r=>{var{componentProps:e,restAttributes:t}=r;return Sr(Z(2,Ol,L({componentType:ph,componentProps:e,templateNames:[]},t)))},ce=Object.create(Object.prototype,L(Object.getOwnPropertyDescriptors(Rl),Object.getOwnPropertyDescriptors({defaultValue:K_,isReactComponentWrapper:!0}))),$_={get defaultValue(){return ce.defaultValue},get readOnly(){return ce.readOnly},get name(){return ce.name},get validationError(){return ce.validationError},get validationErrors(){return ce.validationErrors},get validationMessageMode(){return ce.validationMessageMode},get validationMessagePosition(){return ce.validationMessagePosition},get validationStatus(){return ce.validationStatus},get isValid(){return ce.isValid},get inputAttr(){return ce.inputAttr},get className(){return ce.className},get activeStateEnabled(){return Ot.activeStateEnabled},get disabled(){return ce.disabled},get focusStateEnabled(){return Ot.focusStateEnabled},get hoverStateEnabled(){return Ot.hoverStateEnabled},get tabIndex(){return ce.tabIndex},get visible(){return ce.visible},get label(){return _i.label},get labelMode(){return _i.labelMode},isReactComponentWrapper:!0};class lu extends gt{constructor(e){super(e),this.state={value:this.props.value!==void 0?this.props.value:this.props.defaultValue}}get componentProps(){return L({},this.props,{value:this.props.value!==void 0?this.props.value:this.state.value})}get restAttributes(){var e=L({},this.props,{value:this.props.value!==void 0?this.props.value:this.state.value}),t=ue(e,G_);return t}render(){var e=this.props;return U_({props:L({},e,{value:this.props.value!==void 0?this.props.value:this.state.value}),componentProps:this.componentProps,restAttributes:this.restAttributes})}}lu.defaultProps=$_;var q_=10;function du(r,e){return r+q_*Math.max(...e).toString().length}var X_=["inputAttr","pageCount","pageIndex","pageIndexChange","pagesCountText"],j_="".concat(ru,"  dx-info-text"),uu="dx-page-index",Y_="dx-light-pages",Q_="dx-pages-count",J_=r=>{var{pageIndexRef:e,pagesCountText:t,props:{inputAttr:i,pageCount:a},selectLastPageIndex:n,value:o,valueChange:s,width:l}=r;return Ye(1,"div",Y_,[Z(2,lu,{className:uu,min:1,max:a,width:l,value:o,valueChange:s,inputAttr:i}),Ye(1,"span",j_,t,0),Z(2,yn,{className:Q_,selected:!1,index:a-1,onClick:n})],4,null,null,e)},Z_={inputAttr:Object.freeze({"aria-label":y.format("dxPager-ariaPageNumber")})},eC={get pageIndex(){return ee.pageIndex},get pageCount(){return ee.pageCount},get inputAttr(){return Z_.inputAttr}};class hu extends kt{constructor(e){super(e),this.pageIndexRef=qe(),this.state={minWidth:10},this.updateWidth=this.updateWidth.bind(this),this.selectLastPageIndex=this.selectLastPageIndex.bind(this),this.valueChange=this.valueChange.bind(this)}createEffects(){return[new je(this.updateWidth,[this.state.minWidth])]}updateEffects(){var e;(e=this._effects[0])===null||e===void 0||e.update([this.state.minWidth])}updateWidth(){var e,t=(e=this.pageIndexRef.current)===null||e===void 0?void 0:e.querySelector(".".concat(uu));this.setState(i=>({minWidth:t&&Zd(t)||i.minWidth}))}get value(){return this.props.pageIndex+1}get width(){var{pageCount:e}=this.props;return du(this.state.minWidth,[e])}get pagesCountText(){var e;return((e=this.props.pagesCountText)!==null&&e!==void 0?e:"")||y.getFormatter("dxPager-pagesCountText")()}selectLastPageIndex(){this.props.pageIndexChange(this.props.pageCount-1)}valueChange(e){this.props.pageIndexChange(e-1)}get restAttributes(){var e=this.props,t=ue(e,X_);return t}render(){var e=this.props;return J_({props:L({},e),pageIndexRef:this.pageIndexRef,value:this.value,width:this.width,pagesCountText:this.pagesCountText,selectLastPageIndex:this.selectLastPageIndex,valueChange:this.valueChange,restAttributes:this.restAttributes})}}hu.defaultProps=eC;var tC=["hasKnownLastPage","isLargeDisplayMode","maxPagesCount","pageCount","pageIndex","pageIndexChange","pagesCountText","showNavigationButtons","totalCount"],Wr="dx-navigate-button",Vs="dx-prev-button",Fs="dx-next-button",Ps="dx-button-disable",rC=()=>y.getFormatter("dxPager-nextPage")(),iC=()=>y.getFormatter("dxPager-prevPage")(),aC={nextEnabledClass:"".concat(Wr," ").concat(Fs),prevEnabledClass:"".concat(Wr," ").concat(Vs),nextDisabledClass:"".concat(Ps," ").concat(Wr," ").concat(Fs),prevDisabledClass:"".concat(Ps," ").concat(Wr," ").concat(Vs)},nC={next:"prev",prev:"next"},oC=r=>{var{nextButtonProps:e,pageIndexChange:t,prevButtonProps:i,props:{isLargeDisplayMode:a,maxPagesCount:n,pageCount:o,pageIndex:s,pagesCountText:l},renderNextButton:d,renderPrevButton:u}=r;return rn([u&&Z(2,fr,{label:iC(),className:i.className,tabIndex:i.tabIndex,onClick:i.navigate}),a&&Z(2,su,{maxPagesCount:n,pageCount:o,pageIndex:s,pageIndexChange:t}),!a&&Z(2,hu,{pageCount:o,pageIndex:s,pageIndexChange:t,pagesCountText:l}),d&&Z(2,fr,{label:rC(),className:e.className,tabIndex:e.tabIndex,onClick:e.navigate})],0)};function sC(r){return r==="next"?1:-1}var lC={isLargeDisplayMode:!0},dC={get pageIndex(){return ee.pageIndex},get maxPagesCount(){return ee.maxPagesCount},get pageCount(){return ee.pageCount},get hasKnownLastPage(){return ee.hasKnownLastPage},get showNavigationButtons(){return ee.showNavigationButtons},get totalCount(){return ee.totalCount},get isLargeDisplayMode(){return lC.isLargeDisplayMode}};class cu extends gt{constructor(e){super(e),this.state={},this.__getterCache={},this.pageIndexChange=this.pageIndexChange.bind(this),this.getButtonProps=this.getButtonProps.bind(this),this.canNavigateToPage=this.canNavigateToPage.bind(this),this.getNextPageIndex=this.getNextPageIndex.bind(this),this.canNavigateTo=this.canNavigateTo.bind(this),this.navigateToPage=this.navigateToPage.bind(this)}get config(){return this.context[Ae.id]?this.context[Ae.id]:Ae.defaultValue}pageIndexChange(e){this.canNavigateToPage(e)&&this.props.pageIndexChange(e)}getButtonProps(e){var t,i=(t=this.config)!==null&&t!==void 0&&t.rtlEnabled?nC[e]:e,a=this.canNavigateTo(i),n=aC["".concat(e).concat(a?"Enabled":"Disabled","Class")];return{className:n,tabIndex:a?0:-1,navigate:()=>this.navigateToPage(i)}}canNavigateToPage(e){return this.props.hasKnownLastPage?e>=0&&e<=this.props.pageCount-1:e>=0}getNextPageIndex(e){return this.props.pageIndex+sC(e)}canNavigateTo(e){return this.canNavigateToPage(this.getNextPageIndex(e))}navigateToPage(e){this.pageIndexChange(this.getNextPageIndex(e))}get renderPrevButton(){var{isLargeDisplayMode:e,showNavigationButtons:t}=this.props;return!e||t}get renderNextButton(){return this.renderPrevButton||!this.props.hasKnownLastPage}get prevButtonProps(){return this.__getterCache.prevButtonProps!==void 0?this.__getterCache.prevButtonProps:this.__getterCache.prevButtonProps=(()=>this.getButtonProps("prev"))()}get nextButtonProps(){return this.__getterCache.nextButtonProps!==void 0?this.__getterCache.nextButtonProps:this.__getterCache.nextButtonProps=(()=>this.getButtonProps("next"))()}get restAttributes(){var e=this.props,t=ue(e,tC);return t}componentWillUpdate(e,t,i){(this.context[Ae.id]!==i[Ae.id]||this.props.hasKnownLastPage!==e.hasKnownLastPage||this.props.pageCount!==e.pageCount||this.props.pageIndex!==e.pageIndex||this.props.pageIndexChange!==e.pageIndexChange)&&(this.__getterCache.prevButtonProps=void 0),(this.context[Ae.id]!==i[Ae.id]||this.props.hasKnownLastPage!==e.hasKnownLastPage||this.props.pageCount!==e.pageCount||this.props.pageIndex!==e.pageIndex||this.props.pageIndexChange!==e.pageIndexChange)&&(this.__getterCache.nextButtonProps=void 0)}render(){var e=this.props;return oC({props:L({},e),config:this.config,pageIndexChange:this.pageIndexChange,renderPrevButton:this.renderPrevButton,renderNextButton:this.renderNextButton,prevButtonProps:this.prevButtonProps,nextButtonProps:this.nextButtonProps,restAttributes:this.restAttributes})}}cu.defaultProps=dC;var uC=["accessKey","activeStateEnabled","className","dataSource","defaultValue","disabled","displayExpr","focusStateEnabled","height","hint","hoverStateEnabled","inputAttr","isValid","label","labelMode","name","onClick","onFocusIn","onKeyDown","placeholder","readOnly","rtlEnabled","searchEnabled","tabIndex","validationError","validationErrors","validationMessageMode","validationMessagePosition","validationStatus","value","valueChange","valueExpr","visible","width"],hC=r=>{var{componentProps:e,restAttributes:t}=r;return Sr(Z(2,Ol,L({componentType:gh,componentProps:e,templateNames:["dropDownButtonTemplate","groupTemplate","itemTemplate"]},t)))},oe=Object.create(Object.prototype,L(Object.getOwnPropertyDescriptors(Rl),Object.getOwnPropertyDescriptors({placeholder:"",hoverStateEnabled:!0,searchEnabled:!1,defaultValue:null,isReactComponentWrapper:!0}))),cC={get placeholder(){return oe.placeholder},get hoverStateEnabled(){return Ot.hoverStateEnabled},get searchEnabled(){return oe.searchEnabled},get defaultValue(){return oe.defaultValue},get readOnly(){return oe.readOnly},get name(){return oe.name},get validationError(){return oe.validationError},get validationErrors(){return oe.validationErrors},get validationMessageMode(){return oe.validationMessageMode},get validationMessagePosition(){return oe.validationMessagePosition},get validationStatus(){return oe.validationStatus},get isValid(){return oe.isValid},get inputAttr(){return oe.inputAttr},get className(){return oe.className},get activeStateEnabled(){return Ot.activeStateEnabled},get disabled(){return oe.disabled},get focusStateEnabled(){return Ot.focusStateEnabled},get tabIndex(){return oe.tabIndex},get visible(){return oe.visible},get label(){return _i.label},get labelMode(){return _i.labelMode},isReactComponentWrapper:!0};class pu extends gt{constructor(e){super(e),this.state={value:this.props.value!==void 0?this.props.value:this.props.defaultValue}}get componentProps(){return L({},this.props,{value:this.props.value!==void 0?this.props.value:this.state.value})}get restAttributes(){var e=L({},this.props,{value:this.props.value!==void 0?this.props.value:this.state.value}),t=ue(e,uC);return t}render(){var e=this.props;return hC({props:L({},e,{value:this.props.value!==void 0?this.props.value:this.state.value}),componentProps:this.componentProps,restAttributes:this.restAttributes})}}pu.defaultProps=cC;var pC=["inputAttr","pageSize","pageSizeChange","pageSizes","parentRef"],gC=r=>{var{props:{inputAttr:e,pageSize:t,pageSizeChange:i,pageSizes:a},width:n}=r;return Z(2,pu,{displayExpr:"text",valueExpr:"value",dataSource:a,value:t,valueChange:i,width:n,inputAttr:e})},vC={inputAttr:Object.freeze({"aria-label":y.format("dxPager-ariaPageSize")})},fC={get pageSize(){return ee.pageSize},get inputAttr(){return vC.inputAttr}};class gu extends kt{constructor(e){super(e),this.state={minWidth:10},this.updateWidth=this.updateWidth.bind(this)}createEffects(){return[new je(this.updateWidth,[this.props,this.state.minWidth,this.props.pageSize,this.props.pageSizeChange,this.props.pageSizes,this.props.inputAttr])]}updateEffects(){var e;(e=this._effects[0])===null||e===void 0||e.update([this.props,this.state.minWidth,this.props.pageSize,this.props.pageSizeChange,this.props.pageSizes,this.props.inputAttr])}updateWidth(){this.setState(e=>({minWidth:Zd(this.props.parentRef.current)||e.minWidth}))}get width(){return du(this.state.minWidth,this.props.pageSizes.map(e=>e.value))}get restAttributes(){var e=this.props,t=ue(e,pC);return t}render(){var e=this.props;return gC({props:L({},e),width:this.width,restAttributes:this.restAttributes})}}gu.defaultProps=fC;var mC=["pageSize","pageSizeChange","pageSizes"],_C=r=>{var{pageSizesText:e}=r;return rn(e.map(t=>{var{className:i,click:a,label:n,text:o}=t;return Z(2,fr,{className:i,label:n,onClick:a,children:o},o)}),0)},CC={get pageSize(){return ee.pageSize}};class vu extends gt{constructor(e){super(e),this.state={},this.__getterCache={},this.onPageSizeChange=this.onPageSizeChange.bind(this)}get pageSizesText(){return this.__getterCache.pageSizesText!==void 0?this.__getterCache.pageSizesText:this.__getterCache.pageSizesText=(()=>{var{pageSize:e,pageSizes:t}=this.props;return t.map((i,a)=>{var{text:n,value:o}=i,s=o===e,l=Si({[s?F_:nu]:!0,[P_]:a===0});return{className:l,click:this.onPageSizeChange(o),label:At(y.getFormatter("dxPager-pageSize"),o||y.getFormatter("dxPager-pageSizesAllText")),text:n}})})()}onPageSizeChange(e){return()=>(this.props.pageSizeChange(e),this.props.pageSize)}get restAttributes(){var e=this.props,t=ue(e,mC);return t}componentWillUpdate(e,t,i){(this.props.pageSize!==e.pageSize||this.props.pageSizes!==e.pageSizes||this.props.pageSizeChange!==e.pageSizeChange)&&(this.__getterCache.pageSizesText=void 0)}render(){var e=this.props;return _C({props:L({},e),pageSizesText:this.pageSizesText,restAttributes:this.restAttributes})}}vu.defaultProps=CC;var wC=["isLargeDisplayMode","pageSize","pageSizeChange","pageSizes","rootElementRef"],xC=r=>{var{htmlRef:e,normalizedPageSizes:t,props:{isLargeDisplayMode:i,pageSize:a,pageSizeChange:n}}=r;return Ye(1,"div",V_,[i&&Z(2,vu,{pageSizes:t,pageSize:a,pageSizeChange:n}),!i&&Z(2,gu,{parentRef:e,pageSizes:t,pageSize:a,pageSizeChange:n})],0,null,null,e)};function yC(){return y.getFormatter("dxPager-pageSizesAllText")()}var EC={isLargeDisplayMode:!0},SC={get pageSize(){return ee.pageSize},get pageSizes(){return ee.pageSizes},get isLargeDisplayMode(){return EC.isLargeDisplayMode}};class fu extends kt{constructor(e){super(e),this.state={},this.htmlRef=qe(),this.__getterCache={},this.setRootElementRef=this.setRootElementRef.bind(this)}createEffects(){return[new je(this.setRootElementRef,[])]}setRootElementRef(){var{rootElementRef:e}=this.props;e&&(e.current=this.htmlRef.current)}get normalizedPageSizes(){return this.__getterCache.normalizedPageSizes!==void 0?this.__getterCache.normalizedPageSizes:this.__getterCache.normalizedPageSizes=(()=>{var{pageSizes:e}=this.props;return e.map(t=>t==="all"||t===0?{text:yC(),value:0}:{text:String(t),value:t})})()}get restAttributes(){var e=this.props,t=ue(e,wC);return t}componentWillUpdate(e,t,i){super.componentWillUpdate(),this.props.pageSizes!==e.pageSizes&&(this.__getterCache.normalizedPageSizes=void 0)}render(){var e=this.props;return xC({props:L({},e),htmlRef:this.htmlRef,normalizedPageSizes:this.normalizedPageSizes,restAttributes:this.restAttributes})}}fu.defaultProps=SC;var bC=["className","displayMode","gridCompatibility","hasKnownLastPage","infoText","infoTextRef","infoTextVisible","isLargeDisplayMode","label","lightModeEnabled","maxPagesCount","onKeyDown","pageCount","pageIndex","pageIndexChange","pageSize","pageSizeChange","pageSizes","pageSizesRef","pagesCountText","pagesNavigatorVisible","pagesRef","rootElementRef","rtlEnabled","showInfo","showNavigationButtons","showPageSizes","totalCount","visible"],IC=r=>{var{aria:e,classes:t,infoVisible:i,isLargeDisplayMode:a,pageIndexSelectorVisible:n,pagesContainerVisibility:o,pagesContainerVisible:s,props:{hasKnownLastPage:l,infoText:d,infoTextRef:u,maxPagesCount:h,pageCount:c,pageIndex:p,pageIndexChange:g,pageSize:v,pageSizeChange:f,pageSizes:C,pageSizesRef:w,pagesCountText:x,pagesRef:E,rtlEnabled:R,showNavigationButtons:D,showPageSizes:V,totalCount:F,visible:B},restAttributes:k,widgetRootElementRef:N}=r;return Sr(Z(2,Sh,L({rootElementRef:N,rtlEnabled:R,classes:t,visible:B,aria:e},k,{children:[V&&Z(2,fu,{rootElementRef:w,isLargeDisplayMode:a,pageSize:v,pageSizeChange:f,pageSizes:C}),s&&Ye(1,"div",O_,[i&&Z(2,iu,{rootElementRef:u,infoText:d,pageCount:c,pageIndex:p,totalCount:F}),n&&Ye(1,"div",A_,Z(2,cu,{hasKnownLastPage:l,isLargeDisplayMode:a,maxPagesCount:h,pageCount:c,pageIndex:p,pageIndexChange:g,pagesCountText:x,showNavigationButtons:D,totalCount:F}),2,null,null,E)],0,{style:Eh({visibility:o})})]})))},TC=Object.create(Object.prototype,L(Object.getOwnPropertyDescriptors(ee),Object.getOwnPropertyDescriptors({infoTextVisible:!0,isLargeDisplayMode:!0})));class mu extends kt{constructor(e){super(e),this.state={},this.widgetRootElementRef=qe(),this.__getterCache={},this.setRootElementRef=this.setRootElementRef.bind(this),this.createFakeInstance=this.createFakeInstance.bind(this)}createEffects(){return[new je(this.setRootElementRef,[])]}getChildContext(){return L({},this.context,{[or.id]:this.keyboardAction||or.defaultValue})}setRootElementRef(){var{rootElementRef:e}=this.props;e&&(e.current=this.widgetRootElementRef.current)}createFakeInstance(){return{option:()=>!1,element:()=>this.widgetRootElementRef.current,_createActionByOption:()=>e=>{var t,i;(t=(i=this.props).onKeyDown)===null||t===void 0||t.call(i,e)}}}get keyboardAction(){return this.__getterCache.keyboardAction!==void 0?this.__getterCache.keyboardAction:this.__getterCache.keyboardAction=(()=>({registerKeyboardAction:(e,t)=>{var i=this.createFakeInstance();return Bl("pager",i,e,void 0,t)}}))()}get infoVisible(){var{infoTextVisible:e,showInfo:t}=this.props;return t&&e}get pageIndexSelectorVisible(){return this.props.pageSize!==0}get normalizedDisplayMode(){var{displayMode:e,lightModeEnabled:t}=this.props;return e==="adaptive"&&t!==void 0?t?"compact":"full":e}get pagesContainerVisible(){return!!this.props.pagesNavigatorVisible&&this.props.pageCount>0}get pagesContainerVisibility(){if(this.props.pagesNavigatorVisible==="auto"&&this.props.pageCount===1&&this.props.hasKnownLastPage)return"hidden"}get isLargeDisplayMode(){var e=this.normalizedDisplayMode,t=!1;return e==="adaptive"?t=this.props.isLargeDisplayMode:t=e==="full",t}get classes(){var e={["".concat(this.props.className)]:!!this.props.className,[T_]:!0,[R_]:!this.isLargeDisplayMode};return Si(e)}get aria(){return{role:"navigation",label:this.props.label}}get restAttributes(){var e=this.props,t=ue(e,bC);return t}componentWillUpdate(e,t,i){super.componentWillUpdate(),this.props.onKeyDown!==e.onKeyDown&&(this.__getterCache.keyboardAction=void 0)}render(){var e=this.props;return IC({props:L({},e),widgetRootElementRef:this.widgetRootElementRef,keyboardAction:this.keyboardAction,infoVisible:this.infoVisible,pageIndexSelectorVisible:this.pageIndexSelectorVisible,pagesContainerVisible:this.pagesContainerVisible,pagesContainerVisibility:this.pagesContainerVisibility,isLargeDisplayMode:this.isLargeDisplayMode,classes:this.classes,aria:this.aria,restAttributes:this.restAttributes})}}mu.defaultProps=TC;var RC=["className","defaultPageIndex","defaultPageSize","displayMode","gridCompatibility","hasKnownLastPage","infoText","label","lightModeEnabled","maxPagesCount","onKeyDown","pageCount","pageIndex","pageIndexChange","pageSize","pageSizeChange","pageSizes","pagesCountText","pagesNavigatorVisible","rtlEnabled","showInfo","showNavigationButtons","showPageSizes","totalCount","visible"],OC=r=>{var{pagerProps:e,restAttributes:t}=r;return Sr(Z(2,eu,L({contentTemplate:mu,pagerProps:e},t)))};let _u=class extends bh{constructor(e){super(e),this.__getterCache={},this.state={pageSize:this.props.pageSize!==void 0?this.props.pageSize:this.props.defaultPageSize,pageIndex:this.props.pageIndex!==void 0?this.props.pageIndex:this.props.defaultPageIndex},this.pageIndexChange=this.pageIndexChange.bind(this),this.pageSizeChange=this.pageSizeChange.bind(this)}createEffects(){return[Ih()]}pageIndexChange(e){if(this.props.gridCompatibility){var t;this.setState(a=>(t=e+1,{pageIndex:t})),this.props.pageIndexChange(t)}else{var i;this.setState(a=>(i=e,{pageIndex:i})),this.props.pageIndexChange(i)}}get pageIndex(){return this.props.gridCompatibility?(this.props.pageIndex!==void 0?this.props.pageIndex:this.state.pageIndex)-1:this.props.pageIndex!==void 0?this.props.pageIndex:this.state.pageIndex}pageSizeChange(e){var t;this.setState(i=>(t=e,{pageSize:t})),this.props.pageSizeChange(t)}get className(){return this.props.gridCompatibility?Si({"dx-datagrid-pager":!0,["".concat(this.props.className)]:!!this.props.className}):this.props.className}get pagerProps(){return this.__getterCache.pagerProps!==void 0?this.__getterCache.pagerProps:this.__getterCache.pagerProps=(()=>L({},L({},this.props,{pageSize:this.props.pageSize!==void 0?this.props.pageSize:this.state.pageSize,pageIndex:this.props.pageIndex!==void 0?this.props.pageIndex:this.state.pageIndex}),{className:this.className,pageIndex:this.pageIndex,pageIndexChange:e=>this.pageIndexChange(e),pageSizeChange:e=>this.pageSizeChange(e)}))()}get restAttributes(){var e=L({},this.props,{pageSize:this.props.pageSize!==void 0?this.props.pageSize:this.state.pageSize,pageIndex:this.props.pageIndex!==void 0?this.props.pageIndex:this.state.pageIndex}),t=ue(e,RC);return t}componentWillUpdate(e,t,i){super.componentWillUpdate(),(this.props!==e||this.props.gridCompatibility!==e.gridCompatibility||this.props.className!==e.className||this.state.pageIndex!==t.pageIndex||this.props.pageIndex!==e.pageIndex||this.props.pageIndexChange!==e.pageIndexChange||this.props.pageSizeChange!==e.pageSizeChange)&&(this.__getterCache.pagerProps=void 0)}render(){var e=this.props;return OC({props:L({},e,{pageSize:this.props.pageSize!==void 0?this.props.pageSize:this.state.pageSize,pageIndex:this.props.pageIndex!==void 0?this.props.pageIndex:this.state.pageIndex}),pageIndexChange:this.pageIndexChange,pageIndex:this.pageIndex,pageSizeChange:this.pageSizeChange,className:this.className,pagerProps:this.pagerProps,restAttributes:this.restAttributes})}};_u.defaultProps=w_;class Cu extends h_{getProps(){var e=super.getProps();return e.onKeyDown=this._wrapKeyDownHandler(e.onKeyDown),e}get _propsInfo(){return{twoWay:[["pageSize","defaultPageSize","pageSizeChange"],["pageIndex","defaultPageIndex","pageIndexChange"]],allowNull:[],elements:[],templates:[],props:["defaultPageSize","pageSizeChange","defaultPageIndex","pageIndexChange","gridCompatibility","className","showInfo","infoText","lightModeEnabled","displayMode","maxPagesCount","pageCount","pagesCountText","visible","hasKnownLastPage","pagesNavigatorVisible","showPageSizes","pageSizes","rtlEnabled","showNavigationButtons","totalCount","label","onKeyDown","pageSize","pageIndex"]}}get _viewComponent(){return _u}}_r("dxPager",Cu);var AC="pager",DC=10,Bs=function(r){return 1+(parseInt(r.pageIndex())||0)},VC=W.View.inherit({init(){var r=this.getController("data");r.changed.add(e=>{if(e&&e.repaintChangesOnly){var t=this._pager;t?t.option({pageIndex:Bs(r),pageSize:r.pageSize(),pageCount:r.pageCount(),totalCount:r.totalCount(),hasKnownLastPage:r.hasKnownLastPage()}):this.render()}else(!e||e.changeType!=="update"&&e.changeType!=="updateSelection"&&e.changeType!=="updateFocusedRow")&&(this._pager=null,this.render())})},_renderCore(){var r=this.element().addClass(this.addWidgetPrefix(AC)),e=this.option("pager")||{},t=this.getController("data"),i=this.getController("keyboardNavigation"),a={maxPagesCount:DC,pageIndex:Bs(t),pageCount:t.pageCount(),pageSize:t.pageSize(),showPageSizes:e.showPageSizeSelector,showInfo:e.showInfo,displayMode:e.displayMode,pagesNavigatorVisible:e.visible,showNavigationButtons:e.showNavigationButtons,label:e.label,pageSizes:this.getPageSizes(),totalCount:t.totalCount(),hasKnownLastPage:t.hasKnownLastPage(),pageIndexChanged(n){t.pageIndex()!==n-1&&t.pageIndex(n-1)},pageSizeChanged(n){t.pageSize(n)},onKeyDown:n=>i&&i.executeAction("onKeyDown",n),useLegacyKeyboardNavigation:this.option("useLegacyKeyboardNavigation"),useKeyboard:this.option("keyboardNavigation.enabled")};if(_(e.infoText)&&(a.infoText=e.infoText),this._pager){this._pager.repaint();return}ht()?this._pager=this._createComponent(r,Cu,a):r.addClass("dx-pager").html('<div class="dx-pages"><div class="dx-page"></div></div>')},getPager(){return this._pager},getPageSizes(){var r=this.getController("data"),e=this.option("pager"),t=e&&e.allowedPageSizes,i=r.pageSize();return(!_(this._pageSizes)||!this._pageSizes.includes(i))&&(this._pageSizes=[],e&&(Array.isArray(t)?this._pageSizes=t:t&&i>1&&(this._pageSizes=[Math.floor(i/2),i,2*i]))),this._pageSizes},isVisible(){var r=this.getController("data"),e=this.option("pager"),t=e&&e.visible,i=this.option("scrolling");return t==="auto"&&(i&&(i.mode==="virtual"||i.mode==="infinite")?t=!1:t=r.pageCount()>1||r.isLoaded()&&!r.hasKnownLastPage()),t},getHeight(){return this.getElementHeight()},optionChanged(r){var{name:e}=r,t=e==="pager",i=e==="paging",a=e==="dataSource",n=e==="scrolling",o=this.getController("data");if(t||i||n||a){if(r.handled=!0,o.skipProcessingPagingChange(r.fullName))return;(t||i)&&(this._pageSizes=null),a||(this._pager=null,this._invalidate(),ht()&&t&&this.component&&this.component.resize())}},dispose(){this._pager=null}}),FC={defaultOptions:()=>({pager:{visible:"auto",showPageSizeSelector:!1,allowedPageSizes:"auto",label:y.format("dxPager-ariaLabel")}}),views:{pagerView:VC}};A.registerModule("pager",FC);var PC="columns-separator",Ls="columns-separator-transparent",ks="drag-header",BC="text-content",Ua="drag-action",Ms="tracker",Ns="drop-highlight",zs="dx-block-separator",Hs="dx-header-row",LC="dx-widget",kC="dx-drag-command-cell",ge="dxDataGridResizingReordering",MC=10,Ws=5,ma=.5,sr=function(r){return r.option("allowColumnResizing")||r.getController("columns").isColumnOptionUsed("allowResizing")},wu=function(r){return r.option("allowColumnReordering")||r.getController("columns").isColumnOptionUsed("allowReordering")};class NC extends W.View{_renderCore(){var e=super._renderCore();return this.element().addClass(this.addWidgetPrefix(Ms)),this.hide(),e}_unsubscribeFromCallback(){this._positionChanged&&this._tablePositionController.positionChanged.remove(this._positionChanged)}_subscribeToCallback(){var e=this;e._positionChanged=function(t){var i=e.element();i&&i.hasClass(e.addWidgetPrefix(Ms))&&(i.css({top:t.top}),ur(i,t.height))},this._tablePositionController.positionChanged.add(e._positionChanged)}optionChanged(e){e.name==="allowColumnResizing"&&(this._unsubscribeFromCallback(),e.value&&(this._subscribeToCallback(),this._invalidate())),super.optionChanged(e)}init(){super.init(),this._tablePositionController=this.getController("tablePosition"),this._subscribeToCallback()}isVisible(){return sr(this)}show(){this.element().show()}hide(){this.element()&&this.element().hide()}setHeight(e){ur(this.element(),e)}dispose(){this._unsubscribeFromCallback(),super.dispose()}}class xu extends W.View{_renderSeparator(){}_renderCore(e){var t=super._renderCore(e);return this._isShown=!0,this._renderSeparator(),this.hide(),t}show(){this._isShown=!0}hide(){this._isShown=!1}height(e){var t=this.element();if(t)if(_(e))ur(t,e);else return J(t)}width(e){var t=this.element();if(t)if(_(e))wl(t,e);else return X(t)}}class zC extends xu{_renderSeparator(){super._renderSeparator();var e=this.element();e.addClass(this.addWidgetPrefix(PC))}_subscribeToCallback(){var e=this,t;e._positionChanged=function(i){t=e.element(),t&&(t.css({top:i.top}),ur(t,i.height))},e._tablePositionController.positionChanged.add(e._positionChanged)}_unsubscribeFromCallback(){this._positionChanged&&this._tablePositionController.positionChanged.remove(this._positionChanged)}_init(){this._isTransparent=sr(this),this.isVisible()&&this._subscribeToCallback()}isVisible(){return this.option("showColumnHeaders")&&(wu(this)||sr(this))}optionChanged(e){e.name==="allowColumnResizing"&&(e.value?(this._init(),this._invalidate(),this.hide(!0)):(this._unsubscribeFromCallback(),this._isTransparent=sr(this),this.hide(!0))),super.optionChanged(e)}init(){super.init(),this._tablePositionController=this.getController("tablePosition"),this._init()}show(){var e=this.element();e&&!this._isShown&&(this._isTransparent?e.removeClass(this.addWidgetPrefix(Ls)):e.show()),super.show()}hide(e){var t=this.element(),i=this.addWidgetPrefix(Ls);t&&(this._isShown||e)&&(this._isTransparent?(t.addClass(i),t.css("left",""),t.show()):(t.hasClass(i)&&t.removeClass(i),t.hide())),super.hide()}moveByX(e){var t=this.element();t&&t.css("left",e===null?0:e-this._parentElement().offset().left)}changeCursor(e){e=_(e)?e:"";var t=this.element();t&&t.css("cursor",e)}dispose(){this._unsubscribeFromCallback(),super.dispose()}}class HC extends xu{init(){var e=this;super.init(),this.getController("data").loadingChanged.add(t=>{t||e.hide()})}_renderSeparator(){super._renderSeparator(),this.element().addClass(zs).html("&nbsp;")}hide(){var e=this._parentElement(),t=this.element();t&&this._isShown&&t.css("display","none"),e&&!e.children(".".concat(zs)).length&&e.prepend(this.element()),super.hide()}isVisible(){var e=this.option("groupPanel"),t=this.option("columnChooser");return e&&e.visible||t&&t.enabled}show(e){var t=this.element(),i=function(a){Dn.stop(t,!0),Dn.animate(t,{type:"slide",from:{width:0,display:a.display},to:a,duration:300,easing:"swing"})};if(t&&!this._isShown)switch(e){case"group":i({width:"50px",display:"inline-block"});break;case"columnChooser":i({width:"100%",display:"block"});break;default:t.css("display","")}super.show()}}class WC extends W.View{isDragging(){return this._isDragging}_getDraggingPanelByPos(e){var t;return T(this._dragOptions.draggingPanels,(i,a)=>{if(a){var n=a.getBoundingRect();if(n&&(n.bottom===void 0||e.y<n.bottom)&&(n.top===void 0||e.y>n.top)&&(n.left===void 0||e.x>n.left)&&(n.right===void 0||e.x<n.right))return t=a,!1}}),t}_renderCore(){this.element().addClass("".concat(this.addWidgetPrefix(ks)," ").concat(this.addWidgetPrefix(BC)," ").concat(LC)).hide()}_resetTargetColumnOptions(){var e=this._dropOptions;e.targetColumnIndex=-1,delete e.targetColumnElement,delete e.isLast,delete e.posX,delete e.posY}_getVisibleIndexObject(e,t){return _(e)?{columnIndex:t,rowIndex:e}:t}dispose(){var e=this.element();this._dragOptions=null,e&&e.parent().find(".".concat(this.addWidgetPrefix(ks))).remove()}isVisible(){var e=this.getController("columns"),t=e.getCommonSettings();return this.option("showColumnHeaders")&&(wu(this)||t.allowGrouping||t.allowHiding)}init(){var e=this;super.init(),this._controller=this.getController("draggingHeader"),this._columnsResizerViewController=this.getController("columnsResizer"),this._isDragging=!1,this.getController("data").loadingChanged.add(t=>{var i=e.element();!t&&i&&i.hide()})}dragHeader(e){var{columnElement:t}=e,i=!!e.sourceColumn.type;this._isDragging=!0,this._dragOptions=e,this._dropOptions={sourceIndex:e.index,sourceColumnIndex:this._getVisibleIndexObject(e.rowIndex,e.columnIndex),sourceColumnElement:e.columnElement,sourceLocation:e.sourceLocation};var a=z.getDocument();this._onSelectStart=a.onselectstart,a.onselectstart=function(){return!1},this._controller.drag(this._dropOptions),this.element().css({textAlign:t&&t.css("textAlign"),height:t&&(i&&t.get(0).clientHeight||J(t)),width:t&&(i&&t.get(0).clientWidth||X(t)),whiteSpace:t&&t.css("whiteSpace")}).addClass(this.addWidgetPrefix(Ua)).toggleClass(kC,i).text(i?"":e.sourceColumn.caption),this.element().appendTo(Uu.getSwatchContainer(t))}moveHeader(e){var t=e.event,{that:i}=t.data,a=ni(t),n=i._columnsResizerViewController?i._columnsResizerViewController.isResizing():!1,o=i._dragOptions;if(i._isDragging&&!n){var s=i.element(),l=Math.abs(a.x-o.columnElement.offset().left-o.deltaX),d=Math.abs(a.y-o.columnElement.offset().top-o.deltaY);if(s.is(":visible")||l>Ws||d>Ws){s.show();var u=a.x-o.deltaX,h=a.y-o.deltaY;s.css({left:u,top:h}),i.dockHeader(a)}t.preventDefault()}}dockHeader(e){var t=this._getDraggingPanelByPos(e),i=this._controller,a=this._dropOptions,n=this._dragOptions;if(t){var o=this.option("rtlEnabled"),s=t.getName()==="columnChooser",l=s?"y":"x",d=t.getName(),u=d==="headers"?n.rowIndex:void 0,{sourceColumn:h}=n,c=t.getColumnElements(u,h==null?void 0:h.ownerBand)||[],p=n.pointsByTarget=n.pointsByTarget||{},g=d==="columnChooser"?[]:p[d]||i._generatePointsByColumns(S({},n,{targetDraggingPanel:t,columns:t.getColumns(u),columnElements:c,isVerticalOrientation:s,startColumnIndex:d==="headers"&&m(c[0]).index()}));if(p[d]=g,a.targetLocation=d,g.length>0)for(var v=0;v<g.length;v++){var f=g[v+1]&&(g[v][l]+g[v+1][l])/2;if(f===void 0||(o&&l==="x"?e[l]>f:e[l]<f)){a.targetColumnIndex=this._getVisibleIndexObject(u,g[v].columnIndex),c[v]?(a.targetColumnElement=c.eq(v),a.isLast=!1):(a.targetColumnElement=c.last(),a.isLast=!0),a.posX=g[v].x,a.posY=g[v].y,i.dock(a);break}}else this._resetTargetColumnOptions(),i.dock(a)}}dropHeader(e){var t=e.event,{that:i}=t.data,a=i._controller;i.element().hide(),a&&i._isDragging&&a.drop(i._dropOptions),i.element().appendTo(i._parentElement()),i._dragOptions=null,i._dropOptions=null,i._isDragging=!1,z.getDocument().onselectstart=i._onSelectStart||null}}var _a=function(r){return r.option("columnResizingMode")!=="widget"};class GC extends W.ViewController{_isHeadersRowArea(e){if(this._columnHeadersView){var t=this._columnHeadersView.element();if(t){var i=t.offset().top,a=this._columnHeadersView.getHeadersRowHeight();return e>=i&&e<=i+a}}return!1}_isRtlParentStyle(){var e;return this.option("rtlEnabled")&&((e=this._$parentContainer)===null||e===void 0?void 0:e.parent().css("direction"))==="rtl"}_pointCreated(e,t,i){var a=_a(this),n=this.option("rtlEnabled"),o=this._isRtlParentStyle(),s=!a&&n&&!o?0:1;if(e.index>=s&&e.index<t+(!a&&(!n||o)?1:0)){e.columnIndex-=s;var l=i[e.columnIndex]||{},d=i[e.columnIndex+1]||{};return!(a?l.allowResizing&&d.allowResizing:l.allowResizing)}return!0}_getTargetPoint(e,t,i){if(e){for(var a=0;a<e.length;a++)if(!(e[a].x===e[0].x&&e[a+1]&&e[a].x===e[a+1].x)&&e[a].x-i<=t&&t<=e[a].x+i)return e[a]}return null}_moveSeparator(e){var t,i=e.event,a=i.data,n=a._columnsSeparatorView.width(),o=_a(a),s=n/2,l=a._$parentContainer.offset(),d=l.left,u=ni(i),h=a.option("rtlEnabled"),c=this._isRtlParentStyle(),p=(t=a._draggingHeaderView)===null||t===void 0?void 0:t.isDragging();if(a._isResizing&&a._resizingInfo){if((d<=u.x||!o&&c)&&(!o||u.x<=d+X(a._$parentContainer))&&a._updateColumnsWidthIfNeeded(u.x)){var g=a._columnHeadersView.getColumnElements().eq(a._resizingInfo.currentColumnIndex),v=g[0];if(v){var f=v.getBoundingClientRect().width;a._columnsSeparatorView.moveByX(g.offset().left+((o||c)&&h?0:f)),a._tablePositionController.update(a._targetPoint.y),i.preventDefault()}}}else p||(a._isHeadersRowArea(u.y)?(a._previousParentOffset&&(a._previousParentOffset.left!==l.left||a._previousParentOffset.top!==l.top)&&a.pointsByColumns(null),a._targetPoint=a._getTargetPoint(a.pointsByColumns(),u.x,n),a._previousParentOffset=l,a._isReadyResizing=!1,a._targetPoint?(a._columnsSeparatorView.changeCursor("col-resize"),a._columnsSeparatorView.moveByX(a._targetPoint.x-s),a._tablePositionController.update(a._targetPoint.y),a._isReadyResizing=!0,i.preventDefault()):(a._columnsSeparatorView.changeCursor(),a._columnsSeparatorView.moveByX(null))):(a.pointsByColumns(null),a._isReadyResizing=!1,a._columnsSeparatorView.changeCursor(),a._columnsSeparatorView.moveByX(null)))}_endResizing(e){var t=e.event,i=t.data;i._isResizing&&(i.pointsByColumns(null),i._resizingInfo=null,i._columnsSeparatorView.hide(),i._columnsSeparatorView.changeCursor(),i._trackerView.hide(),i._isReadyResizing=!1,i._isResizing=!1)}_getNextColumnIndex(e){return e+1}_setupResizingInfo(e){var t=this._targetPoint.columnIndex,i=this._getNextColumnIndex(t),a=this._columnHeadersView.getHeaderElement(t),n=this._columnHeadersView.getHeaderElement(i);this._resizingInfo={startPosX:e,currentColumnIndex:t,currentColumnWidth:a&&a.length>0?Ee(a[0]).width:0,nextColumnIndex:i,nextColumnWidth:n&&n.length>0?Ee(n[0]).width:0}}_startResizing(e){var t=e.event,i=t.data,a=ni(t);if($u(t)&&(i._isHeadersRowArea(a.y)?(i._targetPoint=i._getTargetPoint(i.pointsByColumns(),a.x,MC),i._targetPoint&&(i._columnsSeparatorView.moveByX(i._targetPoint.x-i._columnsSeparatorView.width()/2),i._isReadyResizing=!0)):i._isReadyResizing=!1),i._isReadyResizing){i._setupResizingInfo(a.x),i._isResizing=!0,i._tablePositionController.update(i._targetPoint.y),i._columnsSeparatorView.show(),i._trackerView.show();var n=i.component.getScrollable();n&&i._isRtlParentStyle()&&(i._scrollRight=X(n.$content())-X(n.container())-n.scrollLeft()),t.preventDefault(),t.stopPropagation()}this.isResizing()&&this.getController("editorFactory").loseFocus()}_generatePointsByColumns(){var e=this,t=e._columnsController?e._columnsController.getVisibleColumns():[],i=e._columnHeadersView.getColumnElements(),a=[];i&&i.length>0&&(a=I.getPointsByColumns(i,n=>e._pointCreated(n,i.length,t))),e._pointsByColumns=a}_unsubscribeFromEvents(){this._moveSeparatorHandler&&b.off(z.getDocument(),$(Y.move,ge),this._moveSeparatorHandler),this._startResizingHandler&&b.off(this._$parentContainer,$(Y.down,ge),this._startResizingHandler),this._endResizingHandler&&(b.off(this._columnsSeparatorView.element(),$(Y.up,ge),this._endResizingHandler),b.off(z.getDocument(),$(Y.up,ge),this._endResizingHandler))}_subscribeToEvents(){this._moveSeparatorHandler=this.createAction(this._moveSeparator),this._startResizingHandler=this.createAction(this._startResizing),this._endResizingHandler=this.createAction(this._endResizing),b.on(z.getDocument(),$(Y.move,ge),this,this._moveSeparatorHandler),b.on(this._$parentContainer,$(Y.down,ge),this,this._startResizingHandler),b.on(this._columnsSeparatorView.element(),$(Y.up,ge),this,this._endResizingHandler),b.on(z.getDocument(),$(Y.up,ge),this,this._endResizingHandler)}_updateColumnsWidthIfNeeded(e){var t,i,a=this._rowsView.contentWidth(),n=this._resizingInfo,o=this._columnsController,s=o.getVisibleColumns(),l=this._columnsSeparatorView.width(),d=_a(this),u=d&&this.option("adaptColumnWidthByRatio")&&!this.option("columnAutoWidth"),h=this.option("rtlEnabled"),c=this._isRtlParentStyle(),p=s[n.currentColumnIndex],g=s[n.nextColumnIndex];function v(B){return G(B)&&B.endsWith("%")}function f(B,k,N,j){if(B){var K=B.width;K&&(j=v(K)),j?(o.columnOption(B.index,"visibleWidth",k),o.columnOption(B.index,"width","".concat((k/N*100).toFixed(3),"%"))):(o.columnOption(B.index,"visibleWidth",null),o.columnOption(B.index,"width",k))}}t=e-n.startPosX,(d||c)&&h&&(t=-t);var{cellWidth:C,nextCellWidth:w}=function(B){var k,N,j,K=n.currentColumnWidth+B,ae=p&&p.minWidth||l,he={};return K>=ae?he.cellWidth=K:(he.cellWidth=ae,j=!0),d&&(N=n.nextColumnWidth-B,k=g&&g.minWidth||l,N>=k?j?he.nextCellWidth=n.nextColumnWidth-(B+ae-K):he.nextCellWidth=N:(he.nextCellWidth=k,he.cellWidth=n.currentColumnWidth+(B-k+N))),he}(t);if(i=p.width!==C,i){if(o.beginUpdate(),C=Math.floor(C),a=function(B,k){var N=k.every(K=>K.width);if(N){var j=k.reduce((K,ae)=>(v(ae.width)&&(K+=parseFloat(ae.width)),K),0);j>100&&(B=B/j*100)}return B}(a,s),f(p,C,a,u),d)w=Math.floor(w),f(g,w,a,u);else{var x=this._columnHeadersView.getColumnWidths();x[n.currentColumnIndex]=C;var E=x.reduce((B,k)=>B+k,0)>this._rowsView.contentWidth();if(!E){var R=I.getLastResizableColumnIndex(s);R>=0&&o.columnOption(s[R].index,"visibleWidth","auto")}for(var D=0;D<x.length;D++)s[D]&&s[D]!==p&&s[D].width===void 0&&o.columnOption(s[D].index,"width",x[D])}if(o.endUpdate(),!d){this.component.updateDimensions();var V=this.component.getScrollable();if(V&&c){var F=X(V.$content())-X(V.container())-this._scrollRight;V.scrollTo({left:F})}}}return i}_subscribeToCallback(e,t){e.add(t),this._subscribesToCallbacks.push({callback:e,handler:t})}_unsubscribeFromCallbacks(){for(var e=0;e<this._subscribesToCallbacks.length;e++){var t=this._subscribesToCallbacks[e];t.callback.remove(t.handler)}this._subscribesToCallbacks=[]}_unsubscribes(){this._unsubscribeFromEvents(),this._unsubscribeFromCallbacks()}_init(){var e=this,t=function(){e._isResizing||e.pointsByColumns(null)},i=function(o){e._scrollLeft!==o.left&&(e._scrollLeft=o.left,e.pointsByColumns(null))};e._columnsSeparatorView=e.getView("columnsSeparatorView"),e._columnHeadersView=e.getView("columnHeadersView"),e._trackerView=e.getView("trackerView"),e._rowsView=e.getView("rowsView"),e._columnsController=e.getController("columns"),e._tablePositionController=e.getController("tablePosition"),e._$parentContainer=e.component.$element(),e._draggingHeaderView=e.component.getView("draggingHeaderView"),e._subscribeToCallback(e._columnHeadersView.renderCompleted,t),e._subscribeToCallback(e._columnHeadersView.resizeCompleted,t),e._subscribeToCallback(e._columnsSeparatorView.renderCompleted,()=>{e._unsubscribeFromEvents(),e._subscribeToEvents()}),e._subscribeToCallback(e._rowsView.renderCompleted,()=>{e._rowsView.scrollChanged.remove(i),e._rowsView.scrollChanged.add(i)});var a=e._rowsView.getScrollbarWidth()!==0,n=0;e._subscribeToCallback(e.getController("tablePosition").positionChanged,o=>{if(e._isResizing&&!e._rowsView.isResizing){var s=e._rowsView.getScrollbarWidth()!==0;a!==s||n&&n!==o.height?(a=s,n=o.height,e.component.updateDimensions()):e._rowsView.updateFreeSpaceRowHeight()}n=o.height})}optionChanged(e){super.optionChanged(e),e.name==="allowColumnResizing"&&(e.value?(this._init(),this._subscribeToEvents()):this._unsubscribes())}isResizing(){return this._isResizing}init(){this._subscribesToCallbacks=[],sr(this)&&this._init()}pointsByColumns(e){if(e!==void 0)this._pointsByColumns=e;else return this._pointsByColumns||this._generatePointsByColumns(),this._pointsByColumns}dispose(){this._unsubscribes(),super.dispose()}}class KC extends W.ViewController{constructor(e){super(e),this.positionChanged=ye()}update(e){var t={},i=this._columnHeadersView.element(),a=i&&i.offset(),n=a&&a.top||0,o=_(e)?Math.abs(e-n):0,s=this._columnHeadersView?this._columnHeadersView.getHeight():0,l=this._rowsView.getScrollbarWidth(!0),d=this._rowsView?this._rowsView.height()-l:0,u=this.component.getController("columnsResizer"),h=this.component.getView("draggingHeaderView");t.height=s;var c=u.isResizing()||h.isDragging();c&&(t.height+=d-o),e!==null&&i&&i.length&&(t.top=i[0].offsetTop+o),this.positionChanged.fire(t)}init(){var e=this;super.init(),e._columnHeadersView=this.getView("columnHeadersView"),e._rowsView=this.getView("rowsView"),e._pagerView=this.getView("pagerView"),e._rowsView.resizeCompleted.add(()=>{if(e.option("allowColumnResizing")){var t=e.getController("columnsResizer")._targetPoint;e.update(t?t.y:null)}})}}class UC extends W.ViewController{_generatePointsByColumns(e){var t=this;return this.isCustomGroupColumnPosition=this.checkIsCustomGroupColumnPosition(e),I.getPointsByColumns(e.columnElements,i=>t._pointCreated(i,e.columns,e.targetDraggingPanel.getName(),e.sourceColumn),e.isVerticalOrientation,e.startColumnIndex)}checkIsCustomGroupColumnPosition(e){for(var t=!0,i=0;i<e.columns.length;i+=1){var a=e.columns[i];if(a.command==="expand"&&!t)return!0;a.command||(t=!1)}return!1}_pointCreated(e,t,i,a){var n,o=t[e.columnIndex],s=t[e.columnIndex-1],l=(s==null?void 0:s.command)==="expand",d=(o==null?void 0:o.command)==="expand"&&(s==null?void 0:s.command)!=="expand",u=a&&!a.allowReordering,h=!(o!=null&&o.allowReordering)&&!(s!=null&&s.allowReordering);switch(i){case"columnChooser":return!0;case"headers":if(!d)return l||u||h;if(this.isCustomGroupColumnPosition)return!1;for(;((n=t[e.columnIndex])===null||n===void 0?void 0:n.command)==="expand";)e.columnIndex+=1;return!1;default:return t.length===0}}_subscribeToEvents(e,t){var i=this;T(t,(a,n)=>{if(n)for(var o,s=n.getRowCount?n.getRowCount():1,l=n.getName(),d=function(c,p){if(p){var g=m(p),v=o[c];v&&n.allowDragging(v)&&(g.addClass(i.addWidgetPrefix(Ua)),b.on(g,$(Rn,ge),i.createAction(f=>{var C=f.event,w=ni(C);e.dragHeader({deltaX:w.x-m(C.currentTarget).offset().left,deltaY:w.y-m(C.currentTarget).offset().top,sourceColumn:v,index:v.index,columnIndex:c,columnElement:g,sourceLocation:l,draggingPanels:t,rowIndex:i._columnsController.getRowIndex(v.index,!0)})})),b.on(g,$(On,ge),{that:e},i.createAction(e.moveHeader)),b.on(g,$(An,ge),{that:e},i.createAction(e.dropHeader)))}},u=0;u<s;u++){var h=n.getColumnElements(u)||[];h.length&&(o=n.getColumns(u)||[],T(h,d))}})}_unsubscribeFromEvents(e,t){var i=this;T(t,(a,n)=>{if(n){var o=n.getColumnElements()||[];T(o,(s,l)=>{var d=m(l);b.off(d,$(Rn,ge)),b.off(d,$(On,ge)),b.off(d,$(An,ge)),d.removeClass(i.addWidgetPrefix(Ua))})}})}_getSeparator(e){return e==="headers"?this._columnsSeparatorView:this._blockSeparatorView}hideSeparators(e){var t=this._blockSeparatorView,i=this._columnsSeparatorView;this._animationColumnIndex=void 0,t&&t.hide(),e!=="block"&&i&&i.hide()}init(){var e=this;super.init(),e._columnsController=e.getController("columns"),e._columnHeadersView=e.getView("columnHeadersView"),e._columnsSeparatorView=e.getView("columnsSeparatorView"),e._draggingHeaderView=e.getView("draggingHeaderView"),e._rowsView=e.getView("rowsView"),e._blockSeparatorView=e.getView("blockSeparatorView"),e._headerPanelView=e.getView("headerPanel"),e._columnChooserView=e.getView("columnChooserView");var t=function(){if(e._draggingHeaderView){var i=[e._columnChooserView,e._columnHeadersView,e._headerPanelView];e._unsubscribeFromEvents(e._draggingHeaderView,i),e._subscribeToEvents(e._draggingHeaderView,i)}};e._columnHeadersView.renderCompleted.add(t),e._headerPanelView&&e._headerPanelView.renderCompleted.add(t),e._columnChooserView&&e._columnChooserView.renderCompleted.add(t)}allowDrop(e){return this._columnsController.allowMoveColumn(e.sourceColumnIndex,e.targetColumnIndex,e.sourceLocation,e.targetLocation)}drag(e){var{sourceIndex:t}=e,{sourceLocation:i}=e,{sourceColumnElement:a}=e,n=this._columnHeadersView,o=this._rowsView;a&&(a.css({opacity:ma}),i==="headers"&&(n&&n.setRowsOpacity(t,ma),o&&o.setRowsOpacity(t,ma)))}dock(e){var t=this,i=Q(e.targetColumnIndex)?e.targetColumnIndex.columnIndex:e.targetColumnIndex,{sourceLocation:a}=e,{targetLocation:n}=e,o=t._getSeparator(n),s=i>=0;t._columnHeadersView.element().find(".".concat(Hs)).toggleClass(t.addWidgetPrefix(Ns),a!=="headers"&&n==="headers"&&!s),o&&(t.allowDrop(e)&&s?n==="group"||n==="columnChooser"?function(){t._animationColumnIndex!==i&&(t.hideSeparators(),o.element()[e.isLast?"insertAfter":"insertBefore"](e.targetColumnElement),t._animationColumnIndex=i,o.show(n))}():(t.hideSeparators("block"),t.getController("tablePosition").update(e.posY),o.moveByX(e.posX-o.width()),o.show()):t.hideSeparators())}drop(e){var{sourceColumnElement:t}=e;if(t&&(t.css({opacity:""}),this._columnHeadersView.setRowsOpacity(e.sourceIndex,""),this._rowsView.setRowsOpacity(e.sourceIndex,""),this._columnHeadersView.element().find(".".concat(Hs)).removeClass(this.addWidgetPrefix(Ns))),this.allowDrop(e)){var i=this._getSeparator(e.targetLocation);i&&i.hide(),this._columnsController.moveColumn(e.sourceColumnIndex,e.targetColumnIndex,e.sourceLocation,e.targetLocation)}}dispose(){this._draggingHeaderView&&this._unsubscribeFromEvents(this._draggingHeaderView,[this._columnChooserView,this._columnHeadersView,this._headerPanelView])}}var _t={views:{columnsSeparatorView:zC,blockSeparatorView:HC,draggingHeaderView:WC,trackerView:NC},controllers:{draggingHeader:UC,tablePosition:KC,columnsResizer:GC},extenders:{views:{rowsView:{_needUpdateRowHeight(r){var e=this.option("wordWrapEnabled"),t=this.getController("columnsResizer"),i=t.isResizing();return this.callBase.apply(this,arguments)||r>0&&e&&i}}},controllers:{editorFactory:{renderFocusOverlay(){if(!this.getController("columnsResizer").isResizing())return this.callBase.apply(this,arguments)}}}}};_t.views.draggingHeaderView;_t.controllers.draggingHeader;_t.views.columnsSeparatorView;_t.controllers.tablePosition;_t.controllers.columnsResizer;_t.views.trackerView;A.registerModule("columnsResizingReordering",_t);var $C=(r,e)=>r.length===e.length&&!Object.keys(r).some(t=>r[t]!==e[t]),qC=(r,e)=>U(r,e,{maxDepth:4}),XC=(r,e,t,i)=>{var a=r,n=e;return function(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];var d=i(s,a);return d||(a=s,n=t(...a)),n}},jC={compareType:"reference"},Gs=function(r){var{compareType:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:jC,t=null;return function(){for(var i=arguments.length,a=new Array(i),n=0;n<i;n++)a[n]=arguments[n];if(!t){var o=r(...a);return t=XC(a,o,r,e==="reference"?$C:qC),o}return t(...a)}},$a={ariaColIndex:"aria-colindex",dragCell:"dx-drag-cell"},Ca="rowsview",yu="dx-data-row",YC="dx-group-row",QC="dx-header-row",JC="edit-form-item",ZC="dx-master-detail-row",Eu="dx-freespace-row",ew="dx-virtual-row",Ks="dx-master-detail-cell",tw="dx-dropdowneditor-overlay",Gr="dx-command-expand",Su="dx-command-select",rw="dx-command-edit",Us="[class^=dx-command]",Kr="dx-cell-focus-disabled",iw="dxDateBox",$s="dx-state-focused",aw="dx-widget",nw="dx-revert-button",qs="dx-focused",wa="delete",ti=`
  input:not([type="hidden"]):not([disabled]),
  textarea:not([disabled]),
  a:not([disabled]),
  select:not([disabled]),
  button:not([disabled]),
  [tabindex]:not([disabled]),
  .dx-checkbox:not([disabled])
`,Xs="".concat(ti,", .dx-dropdowneditor-icon"),js="row",Ys="cell",Qs="columnHeadersView",ow=["shift","control","alt"],sw=r=>r.attr($a.dragCell)!==void 0,lw=(r,e)=>r.filter("[".concat($a.ariaColIndex,'="').concat(e+1,'"]:not([').concat($a.dragCell,"])")).first(),bu={isDragCell:sw,getCellToFocus:lw},dw="dx-datagrid-group-footer";function er(r){return r&&r.hasClass(YC)}function uw(r){return r&&r.hasClass(dw)}function xa(r){return r&&r.hasClass(ZC)}function Xt(r){return r&&r.hasClass(yu)}function hw(r){return!r||r.hasClass(Eu)||r.hasClass(ew)}function Js(r,e){return!r._isRowEditMode()&&e&&!e.hasClass(Su)&&e.hasClass(Ti)}function we(r){return _(r)&&r.length>0}function qa(){return _e.current().deviceType!=="desktop"}function Zs(r){return!!r.parent(".".concat(QC)).length}function cw(r,e){var t=r.option("rtlEnabled");return t?!(e.fixedPosition==="right"||_(e.command)&&!_(e.fixedPosition)):!(!_(e.fixedPosition)||e.fixedPosition==="left")}function pw(r){var e=r.getController("keyboardNavigation");return e._isVirtualScrolling()?r.option("focusedRowIndex")===e.getRowIndex():!1}class gw extends W.ViewController{init(){var e,t;this._dataController=this.getController("data"),this._selectionController=this.getController("selection"),this._editingController=this.getController("editing"),this._headerPanel=this.getView("headerPanel"),this._rowsView=this.getView("rowsView"),this._columnsController=this.getController("columns"),this._editorFactory=this.getController("editorFactory"),this._focusController=this.getController("focus"),this._memoFireFocusedCellChanged=Gs(this._memoFireFocusedCellChanged.bind(this),{compareType:"value"}),this._memoFireFocusedRowChanged=Gs(this._memoFireFocusedRowChanged.bind(this),{compareType:"value"}),this.focusedHandlerWithContext=this.focusedHandlerWithContext||this.focusedHandler.bind(this),this.renderCompletedWithContext=this.renderCompletedWithContext||this.renderCompleted.bind(this),this.rowsViewFocusHandlerContext=this.rowsViewFocusHandlerContext||this.rowsViewFocusHandler.bind(this),this._updateFocusTimeout=null,this._fastEditingStarted=!1,this._focusedCellPosition={},this._canceledCellPosition=null,this.isKeyboardEnabled()?(Nh(),(e=this._editorFactory)===null||e===void 0||e.focused.add(this.focusedHandlerWithContext),this.createAction("onKeyDown")):(zn(),(t=this._editorFactory)===null||t===void 0||t.focused.remove(this.focusedHandlerWithContext)),this.initViewHandlers(),this.initDocumentHandlers()}focusedHandler(e){this.setupFocusedView(),this._isNeedScroll&&e.is(":visible")&&this._focusedView&&this._focusedView.getScrollable&&(this._focusedView._scrollToElement(e),this._isNeedScroll=!1)}rowsViewFocusHandler(e){var t,i=m(e.target),a=m(e.relatedTarget).closest(this._rowsView.element()).length,n=i.is("a");if(e.relatedTarget&&n&&!a&&this._isEventInCurrentGrid(e)){var o=this._getFocusedCell();o=we(o)?o:this._rowsView.getCellElements(0).filter("[tabindex]").eq(0),i.closest(o).length||(e.preventDefault(),b.trigger(o,"focus"))}var s=i.is("td"),l=((t=this.option("focusedRowIndex"))!==null&&t!==void 0?t:-1)<0;s&&l&&this._updateFocusedCellPosition(i)}subscribeToRowsViewFocusEvent(){var e,t=(e=this._rowsView)===null||e===void 0?void 0:e.element();b.on(t,"focusin",this.rowsViewFocusHandlerContext)}unsubscribeFromRowsViewFocusEvent(){var e,t=(e=this._rowsView)===null||e===void 0?void 0:e.element();b.off(t,"focusin",this.rowsViewFocusHandlerContext)}renderCompleted(e){var t=this._rowsView.element(),i=!e||e.changeType==="refresh",a=this._focusedView&&this._focusedView.name===this._rowsView.name,n=!1,o=e&&(e.changeType==="append"||e.changeType==="prepend"),s=m(z.getRootNode(t.get&&t.get(0))),l=s.find(":focus"),d=!l.length||l.closest(t).length;this.unsubscribeFromRowsViewFocusEvent(),this.subscribeToRowsViewFocusEvent(),this.initPointerEventHandler(),this.initKeyDownHandler(),this._setRowsViewAttributes(),a&&d&&(n=this._isNeedFocus?!o:this._isHiddenFocus&&i&&!(e!=null&&e.virtualColumnsScrolling),n&&this._updateFocus(!0))}initViewHandlers(){var e,t;this.unsubscribeFromRowsViewFocusEvent(),this.unsubscribeFromPointerEvent(),this.unsubscribeFromKeyDownEvent(),(t=(e=this._rowsView)===null||e===void 0?void 0:e.renderCompleted)===null||t===void 0||t.remove(this.renderCompletedWithContext),this.isKeyboardEnabled()&&this._rowsView.renderCompleted.add(this.renderCompletedWithContext)}initDocumentHandlers(){var e=z.getDocument();this._documentClickHandler=this._documentClickHandler||this.createAction(t=>{var i=m(t.event.target),a=this._isEventInCurrentGrid(t.event)&&i.closest(".".concat(this.addWidgetPrefix(Ca))).length,n=i.closest(".".concat(tw)).length,o=this.getController("columnsResizer"),s=!!o&&o.isResizing();if(!a&&!n&&!s){var l=this._focusedView?i.parents().filter(this._focusedView.element()).length>0:!1;!l&&this._resetFocusedCell(!0),this._resetFocusedView()}}),b.off(e,$(Y.down,"dxDataGridKeyboardNavigation"),this._documentClickHandler),this.isKeyboardEnabled()&&b.on(e,$(Y.down,"dxDataGridKeyboardNavigation"),this._documentClickHandler)}_setRowsViewAttributes(){var e=this._getRowsViewElement(),t=!this._dataController.getVisibleRows().length;t&&this._applyTabIndexToElement(e)}unsubscribeFromPointerEvent(){var e=qa()?re:Y.down,t=this._getRowsViewElement();this._pointerEventAction&&b.off(t,$(e,"dxDataGridKeyboardNavigation"),this._pointerEventAction)}subscribeToPointerEvent(){var e=qa()?re:Y.down,t=this._getRowsViewElement(),i=".".concat($e," > td, .").concat($e);b.on(t,$(e,"dxDataGridKeyboardNavigation"),i,this._pointerEventAction)}initPointerEventHandler(){this._pointerEventAction=this._pointerEventAction||this.createAction(this._pointerEventHandler),this.unsubscribeFromPointerEvent(),this.subscribeToPointerEvent()}unsubscribeFromKeyDownEvent(){Di.off(this._keyDownListener)}subscribeToKeyDownEvent(){var e=this._getRowsViewElement();this._keyDownListener=Di.on(e,null,t=>this._keyDownHandler(t))}initKeyDownHandler(){this._keyDownListener&&this.unsubscribeFromKeyDownEvent(),this.subscribeToKeyDownEvent()}dispose(){super.dispose(),this._resetFocusedView(),Di.off(this._keyDownListener),b.off(z.getDocument(),$(Y.down,"dxDataGridKeyboardNavigation"),this._documentClickHandler),clearTimeout(this._updateFocusTimeout),zn()}optionChanged(e){switch(e.name){case"keyboardNavigation":case"useLegacyKeyboardNavigation":this.init(),e.handled=!0;break;default:super.optionChanged(e)}}isRowFocusType(){return this.focusType===js}isCellFocusType(){return this.focusType===Ys}setRowFocusType(){this.option("focusedRowEnabled")&&(this.focusType=js)}setCellFocusType(){this.focusType=Ys}_keyDownHandler(e){var t,i=!0;this._isNeedFocus=!0,this._isNeedScroll=!0;var a=this._processOnKeyDown(e),n=(t=this._editingController)===null||t===void 0?void 0:t.isEditing(),{originalEvent:o}=e;if(o.isDefaultPrevented()){this._isNeedFocus=!1,this._isNeedScroll=!1;return}if(!ow.includes(e.keyName)&&this._updateFocusedCellPositionByTarget(o.target),!a){switch(e.keyName){case"leftArrow":case"rightArrow":this._leftRightKeysHandler(e,n),a=!0;break;case"upArrow":case"downArrow":e.ctrl?on("rowsView",this,o):this._upDownKeysHandler(e,n),a=!0;break;case"pageUp":case"pageDown":this._pageUpDownKeyHandler(e),a=!0;break;case"space":a=this._spaceKeyHandler(e,n);break;case"A":ai(e.originalEvent)?(this._ctrlAKeyHandler(e,n),a=!0):a=this._beginFastEditing(e.originalEvent);break;case"tab":this._tabKeyHandler(e,n),a=!0;break;case"enter":this._enterKeyHandler(e,n),a=!0;break;case"escape":this._escapeKeyHandler(e,n),a=!0;break;case"F":ai(e.originalEvent)?(this._ctrlFKeyHandler(e),a=!0):a=this._beginFastEditing(e.originalEvent);break;case"F2":this._f2KeyHandler(),a=!0;break;case"del":case"backspace":this._isFastEditingAllowed()&&!this._isFastEditingStarted()&&(a=this._beginFastEditing(o,!0))}!a&&!this._beginFastEditing(o)&&(this._isNeedFocus=!1,this._isNeedScroll=!1,i=!1),i&&o.stopPropagation()}}_processOnKeyDown(e){var{originalEvent:t}=e,i={handled:!1,event:t};return this.executeAction("onKeyDown",i),e.ctrl=t.ctrlKey,e.alt=t.altKey,e.shift=t.shiftKey,!!i.handled}_closeEditCell(){setTimeout(()=>{this._editingController.closeEditCell()})}_leftRightKeysHandler(e,t){var i=this.getVisibleRowIndex(),a=e.originalEvent,n=this._focusedView&&this._focusedView.getRow(i),o=this._getDirectionCodeByKey(e.keyName),s=this._isFastEditingStarted(),l=(!t||s)&&Xt(n);if(l){this.setCellFocusType(),s&&this._closeEditCell(),this._isVirtualColumnRender()&&this._processVirtualHorizontalPosition(o);var d=this._getNextCell(o);we(d)&&this._arrowKeysHandlerFocusCell(a,d,o),a&&a.preventDefault()}}_upDownKeysHandler(e,t){var i,a,n=this.getVisibleRowIndex(),o=this._focusedView&&this._focusedView.getRow(n),s=e.originalEvent,l=e.keyName==="upArrow",d=this._dataController.dataSource(),u=(a=(i=this._editingController)===null||i===void 0?void 0:i.isEditRowByIndex)===null||a===void 0?void 0:a.call(i,n),h=this._isFastEditingStarted(),c=(!u||!t||h)&&o&&!xa(o);if(c){if(h&&this._closeEditCell(),!this._navigateNextCell(s,e.keyName)&&this._isVirtualRowRender()&&l&&d&&!d.isLoading()){var p=le(o),g=this._focusedCellPosition.rowIndex-1;this._scrollBy(0,-p,g,s)}s&&s.preventDefault()}}_pageUpDownKeyHandler(e){var t=this._dataController.pageIndex(),i=this._dataController.pageCount(),a=this.option("paging.enabled"),n=e.keyName==="pageUp",o=n?-1:1,s=this._rowsView.getScrollable();a&&!this._isVirtualScrolling()?(n?t>0:t<i-1)&&!this._isVirtualScrolling()&&(this._dataController.pageIndex(t+o),e.originalEvent.preventDefault()):s&&J(s.container())<J(s.$content())&&(this._scrollBy(0,J(s.container())*o),e.originalEvent.preventDefault())}_spaceKeyHandler(e,t){var i=this.getVisibleRowIndex(),a=m(e.originalEvent&&e.originalEvent.target);if(this.option("selection")&&this.option("selection").mode!=="none"&&!t){var n=this._getElementType(a)==="row"&&this.isRowFocusType()&&Xt(a),o=a.hasClass(Su);return o&&this.option("selection.showCheckBoxesMode")==="onClick"&&this._selectionController.startSelectionWithCheckboxes(),n||a.parent().hasClass(yu)||a.hasClass(this.addWidgetPrefix(Ca))?(this._selectionController.changeItemSelection(i,{shift:e.shift,control:e.ctrl}),e.originalEvent.preventDefault(),!0):!1}return this._beginFastEditing(e.originalEvent)}_ctrlAKeyHandler(e,t){!t&&!e.alt&&this.option("selection.mode")==="multiple"&&this.option("selection.allowSelectAll")&&(this._selectionController.selectAll(),e.originalEvent.preventDefault())}_tabKeyHandler(e,t){var i=this.option("editing"),a=e.shift?"previous":"next",n=_(this._focusedCellPosition)&&!xr(this._focusedCellPosition),o=!n||!e.shift&&this._isLastValidCell(this._focusedCellPosition)||e.shift&&this._isFirstValidCell(this._focusedCellPosition),s=e.originalEvent.target,l=this._focusedView&&this._focusedView.element();if(!this._handleTabKeyOnMasterDetailCell(s,a)){if(m(l).addClass($s),i&&s&&!o)if(m(s).hasClass(this.addWidgetPrefix(Ca))&&this._resetFocusedCell(),this._isVirtualColumnRender()&&this._processVirtualHorizontalPosition(a),t){if(!this._editingCellTabHandler(e,a))return}else this._targetCellTabHandler(e,a)&&(o=!0);o?(this._editorFactory.loseFocus(),this._editingController.isEditing()&&!this._isRowEditMode()&&(this._resetFocusedCell(!0),this._resetFocusedView(),this._closeEditCell())):e.originalEvent.preventDefault()}}_getMaxHorizontalOffset(){var e=this.component.getScrollable();return e?e.scrollWidth()-X(this._rowsView.element()):0}_isColumnRendered(e){var t=this._columnsController.getVisibleColumns(null,!0),i=this._columnsController.getVisibleColumns(),a=t[e],n=!1;return a&&(n=i.indexOf(a)>=0),n}_isFixedColumn(e){var t=this._columnsController.getVisibleColumns(null,!0),i=t[e];return!!i&&!!i.fixed}_isColumnVirtual(e){var t=e-this._columnsController.getColumnIndexOffset(),i=this._columnsController.getVisibleColumns(),a=i[t];return!!a&&a.command==="virtual"}_processVirtualHorizontalPosition(e){var t=this.component.getScrollable(),i=this.getColumnIndex(),a,n=0,o=!1;switch(e){case"next":case"nextInRow":var s=this._getVisibleColumnCount();a=i+1,n=this.option("rtlEnabled")?this._getMaxHorizontalOffset():0,e==="next"?o=s===a||this._isFixedColumn(i)&&!this._isColumnRendered(a):o=s>a&&this._isFixedColumn(i)&&!this._isColumnRendered(a);break;case"previous":case"previousInRow":if(a=i-1,n=this.option("rtlEnabled")?0:this._getMaxHorizontalOffset(),e==="previous"){var l=this._columnsController.getColumnIndexOffset(),d=a<0&&l===0;o=d||this._isFixedColumn(i)&&!this._isColumnRendered(a)}else o=a>=0&&this._isFixedColumn(i)&&!this._isColumnRendered(a)}o?t.scrollTo({left:n}):_(a)&&_(e)&&this._isColumnVirtual(a)&&(n=this._getHorizontalScrollPositionOffset(e),n!==0&&t.scrollBy({left:n,top:0}))}_getHorizontalScrollPositionOffset(e){var t=0,i=this._getCell(this._focusedCellPosition),a=i&&Te(i);if(a>0){var n=this.option("rtlEnabled")?-1:1;t=e==="nextInRow"||e==="next"?a*n:a*n*-1}return t}_editingCellTabHandler(e,t){var i=e.originalEvent.target,a=this._getCellElementFromTarget(i),n,o=e.originalEvent,s=this._getElementType(i);if(a.is(Us))return!this._targetCellTabHandler(e,t);this._updateFocusedCellPosition(a);var l=this._getNextCellByTabKey(o,t,s);if(a=l.$cell,!a||this._handleTabKeyOnMasterDetailCell(a,t))return!1;var d=this._columnsController,u=this._rowsView.getCellIndex(a),h=u+d.getColumnIndexOffset(),c=d.getVisibleColumns(null,!0)[h],p=a.parent(),g=this._getRowIndex(p),v=this._dataController.items()[g],f=this._editingController;if(c&&c.allowEditing){var C=!v||v.rowType==="data";n=f.allowUpdating({row:v})?C:v&&v.isNewRow}return n||this._closeEditCell(),this._focusCell(a,!l.isHighlighted)&&(!this._isRowEditMode()&&n?this._editFocusedCell():this._focusInteractiveElement(a,e.shift)),!0}_targetCellTabHandler(e,t){var i=e.originalEvent,a=i.target,n=this._getElementType(a),o=this._getCellElementFromTarget(a),s=n==="cell"&&this._getInteractiveElement(o,!e.shift),l=!1;if(!Js(this,o)&&(s!=null&&s.length)&&a!==s.get(0))l=!0;else{this._focusedCellPosition.rowIndex===void 0&&m(a).hasClass($e)&&this._updateFocusedCellPosition(o),n=this._getElementType(a),this.isRowFocusType()&&(this.setCellFocusType(),n==="row"&&Xt(m(a))&&(a=this.getFirstValidCellInRow(m(a)),n=this._getElementType(a)));var d=this._getNextCellByTabKey(i,t,n);if(o=d.$cell,!o||(o=this._checkNewLineTransition(i,o),!o))return!1;this._focusCell(o,!d.isHighlighted),Js(this,o)||this._focusInteractiveElement(o,e.shift)}return l}_getNextCellByTabKey(e,t,i){var a=this._getNextCell(t,i),n=a&&this._fireFocusedCellChanging(e,a,!0);return!n||n.cancel?{}:(n.$newCellElement&&(a=n.$newCellElement),{$cell:a,isHighlighted:n.isHighlighted})}_checkNewLineTransition(e,t){var i=this.getVisibleRowIndex(),a=t.parent();if(i!==this._getRowIndex(a)){var n=this._getCellPosition(t),o=this._fireFocusedRowChanging(e,a);if(o.cancel)return;o.rowIndexChanged&&n&&(this.setFocusedColumnIndex(n.columnIndex),t=this._getFocusedCell())}return t}_enterKeyHandler(e,t){var i=this._getFocusedCell(),a=this.getVisibleRowIndex(),n=this._focusedView&&this._focusedView.getRow(a);if(this.option("grouping.allowCollapsing")&&er(n)||this.option("masterDetail.enabled")&&i&&i.hasClass(Gr)){var o=this._dataController.getKeyByRowIndex(a),s=this._dataController.items()[a];o!==void 0&&s&&s.data&&!s.data.isContinuation&&this._dataController.changeRowExpand(o)}else this._processEnterKeyForDataCell(e,t)}_processEnterKeyForDataCell(e,t){var i=this._getEnterKeyDirection(e),a=this._allowEditingOnEnterKey();t||!a&&i?(this._handleEnterKeyEditingCell(e.originalEvent),i==="next"||i==="previous"?this._targetCellTabHandler(e,i):(i==="upArrow"||i==="downArrow")&&this._navigateNextCell(e.originalEvent,i)):a&&this._startEditing(e)}_getEnterKeyDirection(e){var t=this.option("keyboardNavigation.enterKeyDirection"),i=e.shift;if(t==="column")return i?"upArrow":"downArrow";if(t==="row")return i?"previous":"next"}_handleEnterKeyEditingCell(e){var{target:t}=e,i=this._getCellElementFromTarget(t),a=this._isRowEditMode();this._updateFocusedCellPosition(i),a?(this._focusEditFormCell(i),setTimeout(this._editingController.saveEditData.bind(this._editingController))):(b.trigger(m(t),"change"),this._closeEditCell(),e.preventDefault())}_escapeKeyHandler(e,t){var i=this._getCellElementFromTarget(e.originalEvent.target);t&&(this._updateFocusedCellPosition(i),this._isRowEditMode()?(this._focusEditFormCell(i),this._editingController.cancelEditData(),this._dataController.items().length===0&&(this._resetFocusedCell(),this._editorFactory.loseFocus())):this._editingController.getEditMode()==="cell"?this._editingController.cancelEditData():this._closeEditCell(),e.originalEvent.preventDefault())}_ctrlFKeyHandler(e){if(this.option("searchPanel.visible")){var t=this._headerPanel.getSearchTextEditor();t&&(t.focus(),e.originalEvent.preventDefault())}}_f2KeyHandler(){var e=this._editingController.isEditing(),t=this.getVisibleRowIndex(),i=this._focusedView&&this._focusedView.getRow(t);!e&&Xt(i)&&this._startEditing()}_navigateNextCell(e,t){var i=this._getNextCell(t),a=this._getDirectionCodeByKey(t),n=i&&this._isCellValid(i),o=n?this._arrowKeysHandlerFocusCell(e,i,a):!1;return o}_arrowKeysHandlerFocusCell(e,t,i){var a=i==="prevRow"||i==="nextRow",n=this._fireFocusChangingEvents(e,t,a,!0);return t=n.$newCellElement,!n.cancel&&this._isCellValid(t)?(this._focus(t,!n.isHighlighted),!0):!1}_beginFastEditing(e,t){if(!this._isFastEditingAllowed()||e.altKey||e.ctrlKey||this._editingController.isEditing())return!1;if(t)this._startEditing(e,wa);else{var{key:i}=e,a=e.keyCode||e.which,n=i||a&&String.fromCharCode(a);n&&(n.length===1||n===wa)&&this._startEditing(e,n)}return!0}_pointerEventHandler(e){var t,i=e.event||e,a=m(i.currentTarget),n=(t=this._rowsView)===null||t===void 0?void 0:t.element(),o=a.parent(),s=m(i.target).is(ti),l=!!m(i.target).closest(".".concat(nw)).length,d=a.hasClass(Gr);this._isEventInCurrentGrid(i)&&(!l&&(this._isCellValid(a,!s)||d)?(a=this._isInsideEditForm(a)?m(i.target):a,this._focusView(),m(n).removeClass($s),o.hasClass(Eu)?(this._updateFocusedCellPosition(a),this._applyTabIndexToElement(this._focusedView.element()),this._focusedView.focus(!0)):this._isMasterDetailCell(a)?this._updateFocusedCellPosition(a):this._clickTargetCellHandler(i,a)):a.is("td")&&this._resetFocusedCell())}_clickTargetCellHandler(e,t){var i=this._rowsView.getCellIndex(t),a=this._columnsController.getVisibleColumns()[i],n=this._isCellEditMode();this.setCellFocusType();var o=this._fireFocusChangingEvents(e,t,!0);if(t=o.$newCellElement,o.cancel)this.setRowFocusType(),this.setFocusedRowIndex(o.prevRowIndex),this._editingController.isEditing()&&n&&this._closeEditCell();else{if(o.resetFocusedRow){this.getController("focus")._resetFocusedRow();return}if(o.rowIndexChanged&&(t=this._getFocusedCell()),!o.isHighlighted&&!n&&this.setRowFocusType(),this._updateFocusedCellPosition(t),this._allowRowUpdating()&&n&&a&&a.allowEditing)this._isNeedFocus=!1,this._isHiddenFocus=!1;else{t=this._getFocusedCell();var s=e&&m(e.target).closest("".concat(Xs,", td")),l=s&&s.not(t).is(Xs),d=!!a&&!a.command&&t.hasClass(Ti),u=!d&&(!o.isHighlighted||l);this._focus(t,u,l)}}}_allowRowUpdating(){var e=this.getVisibleRowIndex(),t=this._dataController.items()[e];return this._editingController.allowUpdating({row:t},"click")}focus(e){var t,i=this.option("focusedRowEnabled"),a=this._isCellElement(m(e));e||(t=".dx-datagrid-rowsview .dx-row[tabindex]",i||(t+=", .dx-datagrid-rowsview .dx-row > td[tabindex]"),e=this.component.$element().find(t).first()),e&&this._focusElement(m(e),a)}getFocusedView(){return this._focusedView}setupFocusedView(){this.isKeyboardEnabled()&&!_(this._focusedView)&&this._focusView()}_focusElement(e,t){var i=m(this._getRowsViewElement()),a=e.closest(i),n=this.isRowFocusType(),o={};!a.length||this._isCellElement(e)&&!this._isCellValid(e)||(this._focusView(),this._isNeedFocus=!0,this._isNeedScroll=!0,(this._isCellElement(e)||er(e))&&(this.setCellFocusType(),o=this._fireFocusChangingEvents(null,e,!0,t),e=o.$newCellElement,n&&!o.isHighlighted&&this.setRowFocusType()),o.cancel||(this._focus(e,!o.isHighlighted),this._focusInteractiveElement(e)))}_getFocusedViewByElement(e){var t=this.getFocusedView(),i=t&&m(t.element());return e&&e.closest(i).length!==0}_focusView(){this._focusedView=this._rowsView}_resetFocusedView(){this.setRowFocusType(),this._focusedView=null}_focusInteractiveElement(e,t){if(e){var i=this._getInteractiveElement(e,t);I.focusAndSelectElement(this,i)}}_focus(e,t,i){var a=e&&!e.hasClass($e)?e.closest(".".concat($e)):e;if(!(a&&hw(a))){var n=this._focusedView,o=n&&n.element(),s;this._isHiddenFocus=t;var l=er(a)||uw(a)||this.isRowFocusType();l?(s=a,n&&this.setFocusedRowIndex(this._getRowIndex(a))):this._isCellElement(e)&&(s=e,this._updateFocusedCellPosition(e)),s&&(o&&o.find(".dx-row[tabindex], .dx-row > td[tabindex]").not(s).removeClass(Kr).removeClass(qs).removeAttr("tabindex"),b.one(s,"blur",d=>{d.relatedTarget&&s.removeClass(Kr).removeClass(qs)}),i||(this._applyTabIndexToElement(s),b.trigger(s,"focus")),t?(s.addClass(Kr),l&&e.addClass(Kr)):this._editorFactory.focus(s))}}_updateFocus(e){this._updateFocusTimeout=setTimeout(()=>{if(this._needFocusEditingCell()){this._editingController._focusEditingCell();return}var t=this._getFocusedCell(),i=this._editingController.isEditing();if(!this._isMasterDetailCell(t)||this._isRowEditMode()){if(this._hasSkipRow(t.parent())){var a=this._focusedCellPosition&&this._focusedCellPosition.rowIndex>0?"upArrow":"downArrow";t=this._getNextCell(a)}if(we(t))if(t.is("td")||t.hasClass(this.addWidgetPrefix(JC))){var n=t.is(Us),o=t.find(":focus"),s=we(o);if((e||!n)&&this._editorFactory.focus()){if(n&&s){I.focusAndSelectElement(this,o);return}!s&&this._focus(t)}else!s&&(this._isNeedFocus||this._isHiddenFocus)&&this._focus(t,this._isHiddenFocus);i&&this._focusInteractiveElement.bind(this)(t)}else b.trigger(t,"focus")}})}_needFocusEditingCell(){var e=this._editingController.getEditMode()===gr,t=this._editingController.getEditMode()===Vt,i=e&&this._editingController.hasChanges(),a=t&&this._editingController.isNewRowInEditMode(),n=this._getFocusedCell();return(n.children().length===0||n.find(cn).length>0)&&(i||a)}_getFocusedCell(){return m(this._getCell(this._focusedCellPosition))}_updateFocusedCellPositionByTarget(e){var t,i=this._getElementType(e);if(i==="row"&&_((t=this._focusedCellPosition)===null||t===void 0?void 0:t.columnIndex)){var a=m(e);this._focusedView&&er(a)&&this.setFocusedRowIndex(this._getRowIndex(a))}else this._updateFocusedCellPosition(this._getCellElementFromTarget(e))}_updateFocusedCellPosition(e,t){var i=this._getCellPosition(e,t);return i&&(!e.length||i.rowIndex>=0&&i.columnIndex>=0)&&this.setFocusedCellPosition(i.rowIndex,i.columnIndex),i}_getFocusedColumnIndexOffset(e){var t=0,i=this._columnsController.getVisibleColumns()[e];return i&&i.fixed?t=this._getFixedColumnIndexOffset(i):e>=0&&(t=this._columnsController.getColumnIndexOffset()),t}_getFixedColumnIndexOffset(e){var t=cw(this,e)?this._getVisibleColumnCount()-this._columnsController.getVisibleColumns().length:0;return t}_getCellPosition(e,t){var i,a=we(e)&&e.closest("tr");if(we(a)){var n=this._getRowIndex(a);return i=this._rowsView.getCellIndex(e,n),i+=this._getFocusedColumnIndexOffset(i),t&&(i=t==="previous"?i-1:i+1,i=this._applyColumnIndexBoundaries(i)),{rowIndex:n,columnIndex:i}}}_focusCell(e,t){if(this._isCellValid(e))return this._focus(e,t),!0}_focusEditFormCell(e){e.hasClass(Ks)&&this._editorFactory.focus(e,!0)}_resetFocusedCell(e){var t,i=this._getFocusedCell();we(i)&&i.removeAttr("tabindex"),this._isNeedFocus=!1,this._isNeedScroll=!1,this._focusedCellPosition={},clearTimeout(this._updateFocusTimeout),(t=this._focusedView)===null||t===void 0||t.renderFocusState({preventScroll:e})}restoreFocusableElement(e,t){var i,a,n=_(e),o=this._rowsView.element(),{columnIndex:s}=this._focusedCellPosition,l=this._dataController.getRowIndexOffset();e=n?e:this._rowsView.getTopVisibleItemIndex()+l,n?(a=this._rowsView.getRow(e-l),i=this._fireFocusedRowChanging(t,a),!i.cancel&&i.rowIndexChanged&&(e=i.newRowIndex)):(this._editorFactory.loseFocus(),this._applyTabIndexToElement(o),b.trigger(o,"focus")),(!n||!i.cancel)&&this.setFocusedCellPosition(e,s),n&&this._updateFocus()}_getNewPositionByCode(e,t,i){var{columnIndex:a}=e,{rowIndex:n}=e,o;if(e.rowIndex===void 0&&i==="next")return{columnIndex:0,rowIndex:0};switch(i){case"nextInRow":case"next":o=this._getVisibleColumnCount(),a<o-1&&t!=="row"&&this._hasValidCellAfterPosition({columnIndex:a,rowIndex:n})?a++:!this._isLastRow(n)&&i==="next"&&(a=0,n++);break;case"previousInRow":case"previous":a>0&&t!=="row"&&this._hasValidCellBeforePosition({columnIndex:a,rowIndex:n})?a--:n>0&&i==="previous"&&(n--,o=this._getVisibleColumnCount(),a=o-1);break;case"upArrow":n=n>0?n-1:n;break;case"downArrow":n=this._isLastRow(n)?n:n+1}return{columnIndex:a,rowIndex:n}}setFocusedCellPosition(e,t){this.setFocusedRowIndex(e),this.setFocusedColumnIndex(t)}setFocusedRowIndex(e){this._focusedCellPosition||(this._focusedCellPosition={}),this._focusedCellPosition.rowIndex=e}setFocusedColumnIndex(e){this._focusedCellPosition||(this._focusedCellPosition={}),this._focusedCellPosition.columnIndex=e}getRowIndex(){return this._focusedCellPosition?this._focusedCellPosition.rowIndex:-1}getColumnIndex(){return this._focusedCellPosition?this._focusedCellPosition.columnIndex:-1}getVisibleRowIndex(){var e,t=(e=this._focusedCellPosition)===null||e===void 0?void 0:e.rowIndex;return!_(t)||t<0?-1:t-this._dataController.getRowIndexOffset()}getVisibleColumnIndex(){var e,t=(e=this._focusedCellPosition)===null||e===void 0?void 0:e.columnIndex;return _(t)?t-this._columnsController.getColumnIndexOffset():-1}_applyColumnIndexBoundaries(e){var t=this._getVisibleColumnCount();return e<0?e=0:e>=t&&(e=t-1),e}_isCellByPositionValid(e){var t=m(this._getCell(e));return this._isCellValid(t)}_isLastRow(e){var t=this._dataController;if(this._isVirtualRowRender())return e>=t.getMaxRowIndex();var i=Math.max(...t.items().map((a,n)=>a.visible!==!1?n:-1));return e===i}_isFirstValidCell(e){var t=!1;return e.rowIndex===0&&e.columnIndex>=0&&(t=t||!this._hasValidCellBeforePosition(e)),t}_hasValidCellBeforePosition(e){for(var{columnIndex:t}=e,i=!1;t>0&&!i;){var a={columnIndex:--t,rowIndex:e.rowIndex};i=this._isCellByPositionValid(a)}return i}_hasValidCellAfterPosition(e){for(var{columnIndex:t}=e,i=!1,a=this._getVisibleColumnCount();t<a-1&&!i;){var n={columnIndex:++t,rowIndex:e.rowIndex};i=this._isCellByPositionValid(n)}return i}_isLastValidCell(e){var t=e.columnIndex>=0?e.columnIndex+1:0,{rowIndex:i}=e,a={columnIndex:t,rowIndex:i},n=this._dataController.getVisibleRows(),o=n&&n[i],s=this._isLastRow(i);return s?o&&o.rowType==="group"&&e.columnIndex>0||e.columnIndex===this._getVisibleColumnCount()-1?!0:this._isCellByPositionValid(a)?!1:this._isLastValidCell(a):!1}_isCellValid(e,t){if(we(e)){var i=e.parent(),a=this._columnsController,n=this._rowsView.getCellIndex(e)+a.getColumnIndexOffset(),o=a.getVisibleColumns(null,!0)[n],s=this._getVisibleColumnCount(),l=this._editingController,d=xa(i),u=o&&o.showWhenGrouped,h=o&&!e.hasClass(Gr)&&Xt(i),c=bu.isDragCell(e);if(c)return!1;if(this._isMasterDetailCell(e))return!0;if(s>n&&(!d&&o&&(!_(o.groupIndex)||u&&h)||parseInt(e.attr("colspan"),10)>1)){var p=this._dataController.items(),g=this._rowsView.getRowIndex(i),v=p[g],f=l&&this._isCellEditMode()&&l.isEditing(),C=l&&l.isEditRow(g),w=C||f;return o.command?this._isLegacyNavigation()?!w&&o.command==="expand":f?!1:C?o.command!=="select":!w:f&&v&&v.rowType!=="data"?!1:!w||o.allowEditing||t}}}getFirstValidCellInRow(e,t){var i=e.find("> td"),a,n;t=t||0;for(var o=t;o<i.length;++o)if(a=i.eq(o),this._isCellValid(a)){n=a;break}return n}_getNextCell(e,t,i){var a=i||this._focusedCellPosition,n=this.isRowFocusType(),o=n||["next","previous"].includes(e),s,l;if(this._focusedView&&a){var d=this._getNewPositionByCode(a,t,e);s=m(this._getCell(d));var u=e==="previous"?this._isFirstValidCell(d):this._isLastValidCell(d);if(we(s)&&!this._isCellValid(s)&&this._isCellInRow(d,o)&&!u&&(n?s=this.getFirstValidCellInRow(s.parent(),d.columnIndex):s=this._getNextCell(e,"cell",d)),l=we(s)&&s.parent(),this._hasSkipRow(l)){var h=this._getRowIndex(l);if(!this._isLastRow(h))s=this._getNextCell(e,"row",{columnIndex:a.columnIndex,rowIndex:h});else return null}return we(s)?s:null}return null}_startEditing(e,t){var i=this._focusedCellPosition,a=this.getVisibleRowIndex(),n=this.getVisibleColumnIndex(),o=this._dataController.items()[a],s=this._columnsController.getVisibleColumns()[n];this._isAllowEditing(o,s)&&(this._isRowEditMode()?this._editingController.editRow(a):i&&this._startEditCell(e,t))}_isAllowEditing(e,t){return this._editingController.allowUpdating({row:e})&&t&&t.allowEditing}_editFocusedCell(){var e=this.getVisibleRowIndex(),t=this.getVisibleColumnIndex();return this._editingController.editCell(e,t)}_startEditCell(e,t){this._fastEditingStarted=_(t);var i=this._editFocusedCell(),a=ah(i),n=this._isFastEditingStarted();if(!(!n||!a&&!i)){var o=a&&t===wa?"":t,s=a?i:O().resolve(),l=this._rowsView.waitAsyncTemplates(!0);P(s,l).done(()=>{this._editingCellHandler(e,o)})}}_editingCellHandler(e,t){var i,a,n=this._getFocusedCell().find(ti).eq(0),o=n.get(0);if(o){var s=jt(e,{type:"keydown",target:o}),l=jt(e,{type:"keypress",target:o}),d=jt(e,{type:"input",target:o});if(d.originalEvent&&(d.originalEvent=jt(d.originalEvent,{data:t})),(a=(i=o).select)===null||a===void 0||a.call(i),b.trigger(n,s),!s.isDefaultPrevented()&&(b.trigger(n,l),!l.isDefaultPrevented())){var u=te.mozilla?25:0;setTimeout(()=>{n.val(t);var h=n.closest(".".concat(aw));b.off(h,"focusout"),b.one(h,"focusout",()=>{b.trigger(n,"change")}),b.trigger(n,d)},u)}}}_fireFocusChangingEvents(e,t,i,a){var n,o={},s=(n=this._getCellPosition(t))!==null&&n!==void 0?n:{};return this.isCellFocusType()&&(o=this._fireFocusedCellChanging(e,t,a),o.cancel||(s.columnIndex=o.newColumnIndex,s.rowIndex=o.newRowIndex,a=o.isHighlighted,t=m(this._getCell(s)))),!o.cancel&&i&&t&&(o=this._fireFocusedRowChanging(e,t.parent()),o.cancel||(s.rowIndex=o.newRowIndex,o.isHighlighted=a)),o.$newCellElement=m(this._getCell(s)),o.$newCellElement.length||(o.$newCellElement=t),o}_fireFocusedCellChanging(e,t,i){var a=this.option("focusedColumnIndex"),n=this.option("focusedRowIndex"),o=this._getCellPosition(t),s=o?o.columnIndex:-1,l=o?o.rowIndex:-1,d=this._dataController.getVisibleRows(),u=this._columnsController.getVisibleColumns(),h={cellElement:t,prevColumnIndex:a,prevRowIndex:n,newColumnIndex:s,newRowIndex:l,rows:d,columns:u,event:e,isHighlighted:i||!1,cancel:!1};return this._canceledCellPosition=null,this.executeAction("onFocusedCellChanging",h),(h.newColumnIndex!==s||h.newRowIndex!==l)&&(h.$newCellElement=m(this._getCell({columnIndex:h.newColumnIndex,rowIndex:h.newRowIndex}))),h.cancel&&(this._canceledCellPosition={rowIndex:l,columnIndex:s}),h}_fireFocusedCellChanged(e){var t=this._rowsView.getCellIndex(e),i=e==null?void 0:e.parent().data("options"),a=i==null?void 0:i.key;this._memoFireFocusedCellChanged(a,t)}_memoFireFocusedCellChanged(e,t){var i=this._getFocusedCell(),a=this._getRowIndex(i==null?void 0:i.parent()),n=Math.min(a-this._dataController.getRowIndexOffset(),this._dataController.items().length-1),o=this._editingController.isEditCell(n,t);if(!o){var s=this._dataController.items()[n],l=this._columnsController.getVisibleColumns()[t];this.executeAction("onFocusedCellChanged",{cellElement:i?be(i):void 0,columnIndex:t,rowIndex:a,row:s,column:l})}}_fireFocusedRowChanging(e,t){var i=this._getRowIndex(t),a=this.option("focusedRowIndex"),n=this._dataController.loadingOperationTypes(),o={rowElement:t,prevRowIndex:a,newRowIndex:i,event:e,rows:this._dataController.getVisibleRows(),cancel:!1};return!this._dataController||this._dataController.isLoading()&&(n.reload||n.paging)?(o.cancel=!0,o):(this.option("focusedRowEnabled")&&(this.executeAction("onFocusedRowChanging",o),!o.cancel&&o.newRowIndex!==i&&(o.resetFocusedRow=o.newRowIndex<0,o.resetFocusedRow||this.setFocusedRowIndex(o.newRowIndex),o.rowIndexChanged=!0)),o)}_fireFocusedRowChanged(){var e,t=this.option("focusedRowEnabled"),i=this.option("focusedRowKey"),a=(e=this._focusController)===null||e===void 0?void 0:e.getFocusedRowIndexByKey(i);!t||_(i)&&a<0||this._memoFireFocusedRowChanged(i,a)}_memoFireFocusedRowChanged(e,t){var i=t-this._dataController.getRowIndexOffset();this.executeAction("onFocusedRowChanged",{rowElement:t<0?void 0:this._rowsView.getRowElement(i),rowIndex:t,row:t<0?void 0:this._dataController.getVisibleRows()[i]})}_isEventInCurrentGrid(e){return I.isElementInCurrentGrid(this,m(e.target))}_isRowEditMode(){var e=this._editingController.getEditMode();return e===Qe||e===Mt}_isCellEditMode(){var e=this._editingController.getEditMode();return e===gr||e===Vt}_isFastEditingAllowed(){return this._isCellEditMode()&&this.option("keyboardNavigation.editOnKeyPress")}_getInteractiveElement(e,t){var i=e.find(ti).filter(":visible");return t?i.last():i.first()}_applyTabIndexToElement(e){var t=this.option("tabIndex")||0;e.attr("tabindex",_(t)?t:0)}_getCell(e){if(this._focusedView&&e){var t=this._dataController.getRowIndexOffset(),i=this._columnsController.getVisibleColumns(null,!0)[e.columnIndex],a=i&&i.fixed?this._getFixedColumnIndexOffset(i):this._columnsController.getColumnIndexOffset(),n=e.rowIndex>=0?e.rowIndex-t:-1,o=e.columnIndex>=0?e.columnIndex-a:-1;return this._focusedView.getCell({rowIndex:n,columnIndex:o})}}_getRowIndex(e){var t=this._rowsView.getRowIndex(e);return t>=0&&(t+=this._dataController.getRowIndexOffset()),t}_hasSkipRow(e){var t=e&&e.get(0);return t&&(t.style.display==="none"||xa(e)&&!e.hasClass(this.addWidgetPrefix(pi)))}_allowEditingOnEnterKey(){return this.option("keyboardNavigation.enterKeyAction")==="startEdit"}_isLegacyNavigation(){return this.option("useLegacyKeyboardNavigation")}_getDirectionCodeByKey(e){var t;switch(e){case"upArrow":t="prevRow";break;case"downArrow":t="nextRow";break;case"leftArrow":t=this.option("rtlEnabled")?"nextInRow":"previousInRow";break;case"rightArrow":t=this.option("rtlEnabled")?"previousInRow":"nextInRow"}return t}_isVirtualScrolling(){var e=this.option("scrolling.mode");return e==="virtual"||e==="infinite"}_isVirtualRowRender(){return this._isVirtualScrolling()||I.isVirtualRowRendering(this)}_isVirtualColumnRender(){return this.option("scrolling.columnRenderingMode")==="virtual"}_scrollBy(e,t,i,a){var n=this,o=this._rowsView.getScrollable();return n._focusedCellPosition&&o.on("scroll",function s(){o.off("scroll",s),setTimeout(n.restoreFocusableElement.bind(n,i,a))}),o.scrollBy({left:e,top:t})}_isInsideEditForm(e){var t=m(e).closest(".".concat(this.addWidgetPrefix(pi)));return t.length&&this.elementIsInsideGrid(t)}_isMasterDetailCell(e){var t=m(e).closest(".".concat(Ks));return t.length&&this.elementIsInsideGrid(t)}_processNextCellInMasterDetail(e,t){!this._isInsideEditForm(e)&&e&&this._applyTabIndexToElement(e)}_handleTabKeyOnMasterDetailCell(e,t){if(this._isMasterDetailCell(e)){this._updateFocusedCellPosition(m(e),t);var i=this._getNextCell(t,"row");return this._processNextCellInMasterDetail(i,m(e)),!0}return!1}_getElementType(e){return m(e).is("tr")?"row":"cell"}_isFastEditingStarted(){return this._isFastEditingAllowed()&&this._fastEditingStarted}_getVisibleColumnCount(){return this._columnsController.getVisibleColumns(null,!0).length}_isCellInRow(e,t){var{columnIndex:i}=e,a=this._getVisibleColumnCount();return t?i>=0&&i<=a-1:i>0&&i<a-1}_isCellElement(e){return e.length&&e[0].tagName==="TD"}_getCellElementFromTarget(e){var t=this._getElementType(e),i=m(e),a;return t==="cell"?a=i.closest(".".concat($e," > td")):a=i.children().not(".".concat(Gr)).first(),a}_getRowsViewElement(){var e;return(e=this._rowsView)===null||e===void 0?void 0:e.element()}isKeyboardEnabled(){return this.option("keyboardNavigation.enabled")}_processCanceledEditCellPosition(e,t){if(this._canceledCellPosition){var i=this._canceledCellPosition.rowIndex===e&&this._canceledCellPosition.columnIndex===t;return this._canceledCellPosition=null,i}}updateFocusedRowIndex(){var e=this._dataController,t=this.getVisibleRowIndex(),i=e.items(),a=i.length?i.length-1:-1,n=e.getRowIndexOffset();a>=0&&t>a&&this.setFocusedRowIndex(a+n)}}var vw={defaultOptions:()=>({useLegacyKeyboardNavigation:!1,keyboardNavigation:{enabled:!0,enterKeyAction:"startEdit",enterKeyDirection:"none",editOnKeyPress:!1}}),controllers:{keyboardNavigation:gw},extenders:{views:{rowsView:{_rowClick(r){var e=this.getController("editing").getEditRowIndex(),t=this.getController("keyboardNavigation"),i=t.isKeyboardEnabled();e===r.rowIndex&&t.setCellFocusType();var a=(qa()||!i)&&this.option("focusedRowEnabled");a&&this._triggerPointerDownEventHandler(r,!i),this.callBase.apply(this,arguments)},_triggerPointerDownEventHandler(r,e){var{originalEvent:t}=r.event;if(t){var i=this.getController("keyboardNavigation"),a=m(t.target),n=this.getCellIndex(a),o=this.getController("columns").getVisibleColumns()[n],s=this.getController("data").items()[r.rowIndex];if(i._isAllowEditing(s,o)||e){var l=jt(t,{currentTarget:t.target});i._pointerEventHandler(l)}}},renderFocusState(r){var{preventScroll:e,pageSizeChanged:t}=r??{},i=this.getController("keyboardNavigation"),a=this.element();a&&!Cl(a)&&a.attr("tabindex",null),t&&i.updateFocusedRowIndex();var n=i.getVisibleRowIndex();(!_(n)||n<0)&&(n=0);var o=this.getCellElements(n);i.isKeyboardEnabled()&&(o!=null&&o.length)&&this.updateFocusElementTabIndex(o,e)},updateFocusElementTabIndex(r){var e=this.getController("keyboardNavigation"),t=r.eq(0).parent();if(er(t))e._applyTabIndexToElement(t);else{var i=e.getColumnIndex();(!_(i)||i<0)&&(i=0),this._updateFocusedCellTabIndex(r,i)}},_updateFocusedCellTabIndex(r,e){var t=this.getController("keyboardNavigation"),i=r?r.length:-1,a=function(s){var l=t._isMasterDetailCell(s),d=t._isCellValid(s);if(!l&&d&&t._isCellElement(s))return t._applyTabIndexToElement(s),t.setCellFocusType(),!0},n=bu.getCellToFocus(r,e);if(n.length)a(n);else{i<=e&&(e=i-1);for(var o=e;o<i&&!a(m(r[o]));++o);}},renderDelayedTemplates(r){this.callBase.apply(this,arguments),this._renderFocusByChange(r)},_renderFocusByChange(r){var{operationTypes:e,repaintChangesOnly:t}=r??{},{fullReload:i,pageSize:a}=e??{};if(!r||!t||i||a){var n=pw(this);this.renderFocusState({preventScroll:n,pageSizeChanged:a})}},_renderCore(r){var e=this.callBase.apply(this,arguments);return this._renderFocusByChange(r),e},_editCellPrepared(r){var e=this._getEditorInstance(r),t=this.getController("keyboardNavigation"),i=t&&t._isFastEditingStarted();e&&i&&this._handleEditingNavigationMode(e),this.callBase.apply(this,arguments)},_handleEditingNavigationMode(r){["downArrow","upArrow"].forEach(t=>{var i=r._supportedKeys()[t];r.registerKeyHandler(t,a=>{var n=r._input().attr("aria-expanded")==="true";if(n)return i&&i.call(r,a)})}),r.registerKeyHandler("leftArrow",me),r.registerKeyHandler("rightArrow",me);var e=r.NAME===iw&&r.option("useMaskBehavior");e&&r.registerKeyHandler("enter",me)},_getEditorInstance(r){var e=r.find(".dx-texteditor").eq(0);return I.getWidgetInstance(e)}}},controllers:{editing:{editCell(r,e){var t=this.getController("keyboardNavigation");if(t._processCanceledEditCellPosition(r,e))return!1;var i=this.callBase(r,e);return i&&t.setupFocusedView(),i},editRow(r){var e=this.getController("keyboardNavigation"),t=e.getVisibleColumnIndex(),i=this._columnsController.getVisibleColumns()[t];(i&&i.type||this.option("editing.mode")===Mt)&&e._resetFocusedCell(),this.callBase(r)},addRow(r){var e=this.getController("keyboardNavigation");return e.setupFocusedView(),e.setCellFocusType(),this.callBase.apply(this,arguments)},getFocusedCellInRow(r){var e=this.getController("keyboardNavigation"),t=this.callBase(r),i=this._dataController.getRowIndexOffset(),a=e._focusedCellPosition.rowIndex-i;if(e.isKeyboardEnabled()&&a===r){var n=e._getFocusedCell();we(n)&&!n.hasClass(rw)&&(t=n)}return t},_processCanceledEditingCell(){this.closeEditCell().done(()=>{var r=this.getController("keyboardNavigation");r._updateFocus()})},init(){this.callBase(),this._keyboardNavigationController=this.getController("keyboardNavigation")},closeEditCell(){var r=this._keyboardNavigationController;r._fastEditingStarted=!1;var e=this.callBase.apply(this,arguments);return r._updateFocus(),e},_delayedInputFocus(){this._keyboardNavigationController._isNeedScroll=!0,this.callBase.apply(this,arguments)},_isEditingStart(){var r=this.getController("keyboardNavigation"),e=this.callBase.apply(this,arguments);if(e&&!r._isNeedFocus){var t=r._getFocusedCell();r._focus(t,!0)}return e}},data:{_correctRowIndices(r){var e=this.getController("keyboardNavigation"),t=this.getController("editorFactory"),i=e._focusedCellPosition;if(this.callBase.apply(this,arguments),i&&i.rowIndex>=0){var a=r(i.rowIndex);a&&(i.rowIndex+=a,t.refocus())}},getMaxRowIndex(){var r=this.items().length-1,e=this.virtualItemsCount();if(e){var t=this.getRowIndexOffset();r+=t+e.end}return r}},adaptiveColumns:{_showHiddenCellsInView(r){var{viewName:e,$cells:t,isCommandColumn:i}=r;this.callBase.apply(this,arguments),e===Qs&&!i&&t.each((a,n)=>{var o=m(n);Zs(o)&&o.attr("tabindex",0)})},_hideVisibleCellInView(r){var{viewName:e,$cell:t,isCommandColumn:i}=r;this.callBase.apply(this,arguments),e===Qs&&!i&&Zs(t)&&t.removeAttr("tabindex")}}}}};A.registerModule("keyboardNavigation",vw);function Xa(r,e,t,i){var a=0;if(r<e)for(;a<t.items.length;a++)Xa(r+1,e,t.items[a],i);r===e&&i(t)}function Ur(r,e){var t;if("map"in r)return r.map(e);var i=new Array(r.length);for(t in r)i[t]=e(r[t],t);return i}function fw(r){return r!==r||r===""||r===null||r===void 0}function mw(r){return r===bl.count}function el(r){var e=de(r.selector),t="skipEmptyValues"in r?r.skipEmptyValues:!0,{aggregator:i}=r;if(typeof i=="string"&&(i=bl[i],!i))throw si.Error("E4001",r.aggregator);return{selector:e,aggregator:i,skipEmptyValues:t}}const _w=Cr.inherit({ctor(r){this._data=r.data,this._groupLevel=r.groupLevel||0,this._totalAggregates=Ur(r.totalAggregates||[],el),this._groupAggregates=Ur(r.groupAggregates||[],el),this._totals=[]},calculate(){this._totalAggregates.length&&this._calculateTotals(0,{items:this._data}),this._groupAggregates.length&&this._groupLevel>0&&this._calculateGroups({items:this._data})},totalAggregates(){return this._totals},_aggregate(r,e,t){for(var i=e.items?e.items.length:0,a=0;a<r.length;a++){if(mw(r[a].aggregator)){t[a]=(t[a]||0)+i;continue}for(var n=0;n<i;n++)this._accumulate(a,r[a],t,e.items[n])}},_calculateTotals(r,e){if(r===0&&(this._totals=this._seed(this._totalAggregates)),r===this._groupLevel)this._aggregate(this._totalAggregates,e,this._totals);else for(var t=0;t<e.items.length;t++)this._calculateTotals(r+1,e.items[t]);r===0&&(this._totals=this._finalize(this._totalAggregates,this._totals))},_calculateGroups(r){var e=this._groupLevel,t=e+1,i=this._seed.bind(this,this._groupAggregates),a=this._aggregate.bind(this,this._groupAggregates),n=this._finalize.bind(this,this._groupAggregates);function o(s){s.aggregates=i(t-1),t===e?a(s,s.aggregates):Xa(t,e,s,l=>{a(l,s.aggregates)}),s.aggregates=n(s.aggregates)}for(;--t>0;)Xa(0,t,r,o)},_seed:(r,e)=>Ur(r,t=>{var{aggregator:i}=t,a="seed"in i?H(i.seed)?i.seed(e):i.seed:NaN;return a}),_accumulate(r,e,t,i){var a=e.selector(i),{aggregator:n}=e,{skipEmptyValues:o}=e;o&&fw(a)||(t[r]!==t[r]?t[r]=a:t[r]=n.step(t[r],a))},_finalize:(r,e)=>Ur(r,(t,i)=>{var a=t.aggregator.finalize;return a?a(e[i]):e[i]})});var Cw="dx-datagrid-total-footer",ww="dx-datagrid-summary-item",xw="dx-datagrid-text-content",yw="dx-datagrid-group-footer",Ew="dx-datagrid-group-text-content",Sw="dx-datagrid-nowrap",bw="dx-footer-row",ya="groupFooter",Iu="totalFooter",Tu=function(r,e){var t=m(r),{column:i}=e,{summaryItems:a}=e,n=[];if(!i.command&&a){for(var o=0;o<a.length;o++){var s=a[o];n.push(m("<div>").css("textAlign",s.alignment||i.alignment).addClass(ww).addClass(xw).addClass(s.cssClass).toggleClass(Ew,e.rowType==="group").text(A.getSummaryText(s,e.summaryTexts)))}t.append(n)}},Ru=function(r,e){var t=r.option("summary.texts")||{};return{totalItem:e.row,summaryItems:e.row.summaryCells[e.columnIndex],summaryTexts:t}},Ea=function(r){return r.summary||r.aggregates||[]},ja=function(r){return r.option("summary.recalculateWhileEditing")},Iw=br.inherit({_getRows(){return this._dataController.footerItems()},_getCellOptions(r){return S(this.callBase(r),Ru(this,r))},_renderCellContent(r,e){Tu(r,e),this.callBase.apply(this,arguments)},_renderCore(r){var e=!1,t=this._dataController.footerItems()[0];(!r||!r.columnIndices)&&(this.element().empty().addClass(Cw).toggleClass(Sw,!this.option("wordWrapEnabled")),e=!0),t&&t.summaryCells&&t.summaryCells.length&&(this._updateContent(this._renderTable({change:r}),r),e&&this._updateScrollLeftPosition())},_updateContent(r,e){return e&&e.changeType==="update"&&e.columnIndices?this.waitAsyncTemplates().done(()=>{var t=this.getTableElement().find(".dx-row"),i=r.find(".dx-row");this._updateCells(t,i,e.columnIndices[0])}):this.callBase.apply(this,arguments)},_rowClick(r){var e=this._dataController.footerItems()[r.rowIndex]||{};this.executeAction("onRowClick",S({},r,e))},_columnOptionChanged(r){var{optionNames:e}=r;r.changeTypes.grouping||(e.width||e.visibleWidth)&&this.callBase(r)},_handleDataChanged(r){var{changeType:e}=r;r.changeType==="update"&&r.repaintChangesOnly?r.totalColumnIndices?r.totalColumnIndices.length&&this.render(null,{changeType:"update",columnIndices:[r.totalColumnIndices]}):this.render():(e==="refresh"||e==="append"||e==="prepend")&&this.render()},_createRow(r){var e=this.callBase.apply(this,arguments);return r.rowType===Iu&&e.addClass(bw),e},getHeight(){return this.getElementHeight()},isVisible(){return!!this._dataController.footerItems().length}}),Tw={init(){this.callBase.apply(this,arguments),this._totalAggregates=[],this._summaryGetter=me},summaryGetter(r){if(!arguments.length)return this._summaryGetter;H(r)&&(this._summaryGetter=r)},summary(r){if(!arguments.length)return this._summaryGetter();this._summaryGetter=function(){return r}},totalAggregates(){return this._totalAggregates},isLastLevelGroupItemsPagingLocal(){var r=this.summary(),e=r&&r.sortByGroups();return e&&e.length},sortLastLevelGroupItems(r,e,t){var i=li.multiLevelGroup(Er(r),e).toArray(),a=[];return t.forEach(n=>{(function o(s,l,d,u){u=u||[];for(var h=0;h<s.length;h++)u.push(s[h].key),l===1?d(u,s[h].items):o(s[h].items,l-1,d,u),u.pop()})(i,e.length,(o,s)=>{n.toString()===o.toString()&&(a=a.concat(s))})}),a}},Rw=function(){var r=function(t,i,a,n){var o;if(ja(t)){var s=t.getController("editing");if(s){var l=s.getInsertedData();l.length&&(a=function u(h,c,p){return p?u(h,c.map(g=>({items:[g]}),p-1)):h.concat(c)}(a,l,n));var d=s.getRemovedData();d.length&&(a=function u(h,c,p){return p?h.map(g=>{var v={},f=u(g.items||[],c,p-1);return Object.defineProperty(v,"aggregates",{get:()=>g.aggregates,set:C=>{g.aggregates=C}}),S(v,g,{items:f})}):h.filter(g=>c.indexOf(g)<0)}(a,d,n))}}return i&&(o=new _w({totalAggregates:i.totalAggregates,groupAggregates:i.groupAggregates,data:a,groupLevel:n}),o.calculate()),o?o.totalAggregates():[]},e=function(t,i,a){var n=a&&a.sortByGroups&&a.sortByGroups();return n&&n.length?function o(s,l,d){if(!s||!l.length)return s;var u=l[0],h=d[0],c;return u&&h&&h.length&&(c=Er(s),T(h,function(p){p===0?c=c.sortBy(this.selector,this.desc):c=c.thenBy(this.selector,this.desc)}),c.enumerate().done(p=>{s=p})),l=l.slice(1),d=d.slice(1),l.length&&d.length&&T(s,function(){this.items=o(this.items,l,d)}),s}(t,i,n):t};return{_customizeRemoteOperations(t){var i=this.summary();i&&(t.remoteOperations.summary?(!t.isCustomLoading||t.storeLoadOptions.isLoadingAll)&&(t.storeLoadOptions.group&&(t.remoteOperations.grouping?t.storeLoadOptions.groupSummary=i.groupAggregates:i.groupAggregates.length&&(t.remoteOperations.paging=!1)),t.storeLoadOptions.totalSummary=i.totalAggregates):(i.totalAggregates.length||i.groupAggregates.length&&t.storeLoadOptions.group)&&(t.remoteOperations.paging=!1)),this.callBase.apply(this,arguments);var a=t.cachedData.extra;a&&a.summary&&!t.isCustomLoading&&(t.storeLoadOptions.totalSummary=void 0)},_handleDataLoadedCore(t){var i,a,n=Dt(t.storeLoadOptions.group||t.loadOptions.group||[]),o=t.remoteOperations||{},s=this.summaryGetter()(o);if(!t.isCustomLoading||t.storeLoadOptions.isLoadingAll){if(o.summary)!o.paging&&n.length&&s&&(o.grouping||r(this,{groupAggregates:s.groupAggregates},t.data,n.length),t.data=e(t.data,n,s));else if(!o.paging&&s){var l=t.operationTypes||{},d=Object.keys(l).some(h=>l[h]);if(!d||!(!((a=(i=t.cachedData)===null||i===void 0?void 0:i.extra)===null||a===void 0)&&a.summary)||n.length&&s.groupAggregates.length){var u=r(this,s,t.data,n.length);t.extra=He(t.extra)?t.extra:{},t.extra.summary=u,t.cachedData&&(t.cachedData.extra=t.extra)}t.data=e(t.data,n,s)}}t.isCustomLoading||(this._totalAggregates=t.extra&&t.extra.summary||this._totalAggregates),this.callBase(t)}}}();Ir.extend(Tw);Ir.extend(Rw);A.registerModule("summary",{defaultOptions:()=>({summary:{groupItems:void 0,totalItems:void 0,calculateCustomSummary:void 0,skipEmptyValues:!0,recalculateWhileEditing:!1,texts:{sum:y.format("dxDataGrid-summarySum"),sumOtherColumn:y.format("dxDataGrid-summarySumOtherColumn"),min:y.format("dxDataGrid-summaryMin"),minOtherColumn:y.format("dxDataGrid-summaryMinOtherColumn"),max:y.format("dxDataGrid-summaryMax"),maxOtherColumn:y.format("dxDataGrid-summaryMaxOtherColumn"),avg:y.format("dxDataGrid-summaryAvg"),avgOtherColumn:y.format("dxDataGrid-summaryAvgOtherColumn"),count:y.format("dxDataGrid-summaryCount")}},sortByGroupSummaryInfo:void 0}),views:{footerView:Iw},extenders:{controllers:{data:{_isDataColumn:r=>r&&(!_(r.groupIndex)||r.showWhenGrouped),_isGroupFooterVisible(){for(var r=this.option("summary.groupItems")||[],e=0;e<r.length;e++){var t=r[e],i=this._columnsController.columnOption(t.showInColumn||t.column);if(t.showInGroupFooter&&this._isDataColumn(i))return!0}return!1},_processGroupItems(r,e,t){var i=t&&t.data,a=this.callBase.apply(this,arguments);return t&&(t.isGroupFooterVisible===void 0&&(t.isGroupFooterVisible=this._isGroupFooterVisible()),i&&i.items&&t.isGroupFooterVisible&&(t.collectContinuationItems||!i.isContinuationOnNextPage)&&a.push({rowType:ya,key:t.path.slice(),data:i,groupIndex:t.path.length-1,values:[]})),a},_processGroupItem(r,e){var t=this;if(e.summaryGroupItems||(e.summaryGroupItems=t.option("summary.groupItems")||[]),r.rowType==="group"){var i=-1,a=-1;T(e.visibleColumns,function(n){var o=e.visibleColumns[n-1];r.groupIndex===this.groupIndex&&(i=this.index),n>0&&o.command==="expand"&&this.command!=="expand"&&(a=this.index)}),r.summaryCells=this._calculateSummaryCells(e.summaryGroupItems,Ea(r.data),e.visibleColumns,(n,o)=>n.showInGroupFooter?-1:n.alignByColumn&&o&&!_(o.groupIndex)&&o.index!==a?o.index:i,!0)}return r.rowType===ya&&(r.summaryCells=this._calculateSummaryCells(e.summaryGroupItems,Ea(r.data),e.visibleColumns,(n,o)=>n.showInGroupFooter&&t._isDataColumn(o)?o.index:-1)),r},_calculateSummaryCells(r,e,t,i,a){var n=this,o=[],s={};return T(r,(l,d)=>{var u=n._columnsController.columnOption(d.column),h=d.showInColumn&&n._columnsController.columnOption(d.showInColumn)||u,c=i(d,h);if(c>=0){s[c]||(s[c]=[]);var p=e[l];if(p===p){var g;_(d.valueFormat)?g=d.valueFormat:d.summaryType!=="count"&&(g=A.getFormatByDataType(u&&u.dataType)),s[c].push(S({},d,{value:G(p)&&u&&u.deserializeValue?u.deserializeValue(p):p,valueFormat:g,columnCaption:u&&u.index!==c?u.caption:void 0}))}}}),xr(s)||t.forEach((l,d)=>{var u=t[d-1],h=a&&((u==null?void 0:u.command)==="expand"||l.command==="expand")?u==null?void 0:u.index:l.index;o.push(s[h]||[])}),o},_getSummaryCells(r,e){var t=this,i=t._columnsController;return t._calculateSummaryCells(r,e,i.getVisibleColumns(),(a,n)=>t._isDataColumn(n)?n.index:-1)},_updateItemsCore(r){var e,t=this._dataSource,i=this._footerItems,a=i&&i[0]&&i[0].summaryCells,n=this.option("summary.totalItems");if(this._footerItems=[],t&&n&&n.length){var o=t.totalAggregates();e=this._getSummaryCells(n,o),r&&r.repaintChangesOnly&&a&&(r.totalColumnIndices=e.map((s,l)=>JSON.stringify(s)!==JSON.stringify(a[l])?l:-1).filter(s=>s>=0)),e.length&&this._footerItems.push({rowType:Iu,summaryCells:e})}this.callBase(r)},_prepareUnsavedDataSelector(r){if(ja(this)){var e=this.getController("editing");if(e)return function(t){return t=e.getUpdatedData(t),r(t)}}return r},_prepareAggregateSelector(r,e){return r=this._prepareUnsavedDataSelector(r),e==="avg"||e==="sum"?function(t){var i=r(t);return _(i)?Number(i):i}:r},_getAggregates(r,e){var t=this,i=t.getController("columns"),a=t.option("summary.calculateCustomSummary"),n=t.option("summary.skipEmptyValues");return wr(r||[],o=>{var s=i.columnOption(o.column),l=s&&s.calculateCellValue?s.calculateCellValue.bind(s):de(s?s.dataField:o.column),d=o.summaryType||"count",u=_(o.skipEmptyValues)?o.skipEmptyValues:n;if(e)return{selector:o.column,summaryType:d};var h=t._prepareAggregateSelector(l,d);if(d==="custom"){a||(q.log("E1026"),a=function(){});var c={component:t.component,name:o.name};a(c),c.summaryProcess="calculate",d={seed(p){return c.summaryProcess="start",c.totalValue=void 0,c.groupIndex=p,delete c.value,a(c),c.totalValue},step(p,g){return c.summaryProcess="calculate",c.totalValue=p,c.value=g,a(c),c.totalValue},finalize(p){return c.summaryProcess="finalize",c.totalValue=p,delete c.value,a(c),c.totalValue}}}return{selector:h,aggregator:d,skipEmptyValues:u}})},_addSortInfo(r,e,t,i){if(e){var{groupIndex:a}=e;i=i||e.sortOrder,_(a)&&(r[a]=r[a]||[],r[a].push({selector:t,desc:i==="desc"}))}},_findSummaryItem(r,e){var t=-1;return _(e)&&T(r||[],function(i){if(this.name===e||i===e||this.summaryType===e||this.column===e||function(a){var{summaryType:n}=a,{column:o}=a;return n&&o&&"".concat(n,"_").concat(o)}(this)===e)return t=i,!1}),t},_getSummarySortByGroups(r,e){var t=this,i=t._columnsController,a=i.getGroupColumns(),n=[];if(!(!e||!e.length))return T(r||[],function(){var{sortOrder:o}=this,{groupColumn:s}=this,l=t._findSummaryItem(e,this.summaryItem);if(!(l<0)){var d=function(u){return Ea(u)[l]};_(s)?(s=i.columnOption(s),t._addSortInfo(n,s,d,o)):T(a,(u,h)=>{t._addSortInfo(n,h,d,o)})}}),n},_createDataSourceAdapterCore(r,e){var t=this,i=this.callBase(r,e);return i.summaryGetter(a=>t._getSummaryOptions(a||e)),i},_getSummaryOptions(r){var e=this,t=e.option("summary.groupItems"),i=e.option("summary.totalItems"),a=e.option("sortByGroupSummaryInfo"),n=e._getAggregates(t,r&&r.grouping&&r.summary),o=e._getAggregates(i,r&&r.summary);if(n.length||o.length)return{groupAggregates:n,totalAggregates:o,sortByGroups:function(){return e._getSummarySortByGroups(a,t)}}},publicMethods(){var r=this.callBase();return r.push("getTotalSummaryValue"),r},getTotalSummaryValue(r){var e=this._findSummaryItem(this.option("summary.totalItems"),r),t=this._dataSource.totalAggregates();if(t.length&&e>-1)return t[e]},optionChanged(r){(r.name==="summary"||r.name==="sortByGroupSummaryInfo")&&(r.name="dataSource"),this.callBase(r)},init(){this._footerItems=[],this.callBase()},footerItems(){return this._footerItems}},editing:{_refreshSummary(){ja(this)&&!this.isSaving()&&this._dataController.refresh({load:!0,changesOnly:!0})},_addChange(r){var e=this.callBase.apply(this,arguments);return r.type&&this._refreshSummary(),e},_removeChange(){var r=this.callBase.apply(this,arguments);return this._refreshSummary(),r},cancelEditData(){var r=this.callBase.apply(this,arguments);return this._refreshSummary(),r}}},views:{rowsView:{_createRow(r){var e=this.callBase.apply(this,arguments);return r&&e.addClass(r.rowType===ya?yw:""),e},_renderCells(r,e){this.callBase.apply(this,arguments),e.row.rowType==="group"&&e.row.summaryCells&&e.row.summaryCells.length&&this._renderGroupSummaryCells(r,e)},_hasAlignByColumnSummaryItems:(r,e)=>!_(e.columns[r].groupIndex)&&e.row.summaryCells[r].length,_getAlignByColumnCellCount(r,e){for(var t=0,i=1;i<r;i++){var a=e.row.summaryCells.length-i;t=this._hasAlignByColumnSummaryItems(a,e)?i:t}return t},_renderGroupSummaryCells(r,e){var t=r.children().last(),i=Number(t.attr("colSpan"))||1,a=this._getAlignByColumnCellCount(i,e);this._renderGroupSummaryCellsCore(t,e,i,a)},_renderGroupSummaryCellsCore(r,e,t,i){if(i>0){r.attr("colSpan",t-i);for(var a=0;a<i;a++){var n=e.columns.length-i+a;this._renderCell(r.parent(),S({column:e.columns[n],columnIndex:this._getSummaryCellIndex(n,e.columns)},e))}}},_getSummaryCellIndex:r=>r,_getCellTemplate(r){return!r.column.command&&!_(r.column.groupIndex)&&r.summaryItems&&r.summaryItems.length?Tu:this.callBase(r)},_getCellOptions(r){var e=this.callBase(r);return r.row.summaryCells?S(e,Ru(this,r)):e}}}}});var tl="content",Ci="content-fixed",Ow="dx-master-detail-cell",rl="dx-first-cell",Aw="dx-last-cell",il="dx-state-hover",al="dx-col-fixed",Dw="dx-fixed-columns",Sa="dx-pointer-events-none",ot="transparent",nl="dx-group-row",Vw="dx-master-detail-row",ze=function(r){var e=-1;return T(r,(t,i)=>{if(i.command===ot)return e=t,!1}),e},Ou=function(r,e,t){var i=0;if(r&&e&&t)for(var a=0;a<r.length;a++)r[a].command===ot?i+=r[a].colspan:(e[i]<t[a]&&(e[i]=t[a]),i++);return e},En={init(){this.callBase(),this._isFixedTableRendering=!1,this._isFixedColumns=!1},_createCol(r){return this.callBase(r).toggleClass(al,!!(this._isFixedTableRendering&&(r.fixed||r.command&&r.command!==ot)))},_correctColumnIndicesForFixedColumns(r,e){var t=ze(r),i=r[t].colspan,a=e&&e.columnIndices;a&&(e.columnIndices=a.map(n=>{if(n)return n.map(o=>o<t?o:o>=t+i?o-i+1:-1).filter(o=>o>=0)}))},_partialUpdateFixedTable(r){var e=this._fixedTableElement,t=this._getRowElementsCore(e),i=e.children("colgroup");i.replaceWith(this._createColGroup(r));for(var a=0;a<t.length;a++)this._partialUpdateFixedRow(m(t[a]),r)},_partialUpdateFixedRow(r,e){var t,i=r.get(0).childNodes,a=ze(e),n=e[a],o=this._columnsController.getColumnIndexOffset(),s,l=o+1,{colspan:d}=n;if(r.hasClass(Vw)){i[0].setAttribute("colspan",(t=this._columnsController.getVisibleColumns())===null||t===void 0?void 0:t.length);return}r.hasClass(nl)&&(s=this._getGroupCellOptions({row:r.data("options"),columns:this._columnsController.getVisibleColumns()}),d=s.colspan-Math.max(0,i.length-(s.columnIndex+2)));for(var u=0;u<i.length;u++){var h=s?u===s.columnIndex+1:u===a;i[u].setAttribute("aria-colindex",l),h?(i[u].setAttribute("colspan",d),l+=d):l++}},_renderTable(r){var e,t,i=this.getFixedColumns();this._isFixedColumns=!!i.length;var a=this.callBase(r);if(this._isFixedColumns){var n=r==null?void 0:r.change,o=this._getRowElements(this._fixedTableElement),s=(n==null?void 0:n.virtualColumnsScrolling)&&o.length===((e=n==null?void 0:n.items)===null||e===void 0?void 0:e.length);if(this._isFixedTableRendering=!0,s&&this.option("scrolling.legacyMode")!==!0)this._partialUpdateFixedTable(i),this._isFixedTableRendering=!1;else{var l=n==null?void 0:n.columnIndices;this._correctColumnIndicesForFixedColumns(i,n),t=this._createTable(i),this._renderRows(t,S({},r,{columns:i})),this._updateContent(t,n,!0),l&&(n.columnIndices=l),this._isFixedTableRendering=!1}}else this._fixedTableElement&&this._fixedTableElement.parent().remove(),this._fixedTableElement=null;return a},_renderRow(r,e){var t,{cells:i}=e.row;if(this.callBase.apply(this,arguments),this._isFixedTableRendering&&i&&i.length){t=0;var a=e.row.cells||[];i=i.slice(),e.row.cells=i;for(var n=0;n<a.length;n++){if(a[n].column&&a[n].column.command===ot){t=(a[n].column.colspan||1)-1;continue}i[n+t]=a[n]}}},_createCell(r){var{column:e}=r,t=e&&e.command,{rowType:i}=r,a=this.callBase.apply(this,arguments),n,o,s;(this._isFixedTableRendering||i==="filter")&&(n=this.getFixedColumns(),s=ze(n),o=n[s-1]),this._isFixedTableRendering?t===ot&&(a.addClass(Sa).toggleClass(rl,s===0||o&&o.command==="expand").toggleClass(Aw,n.length&&s===n.length-1),i!=="freeSpace"&&I.setEmptyText(a)):i==="filter"&&a.toggleClass(rl,r.columnIndex===s);var l=this.option("rowAlternationEnabled")&&r.isAltRow,d=this.option("selection.mode")==="multiple"&&r.columnIndex===0&&r.rowType==="header";return te.mozilla&&r.column.fixed&&r.rowType!=="group"&&!l&&!d&&a.addClass(al),a},_getContent(r){var e;return r?(e=this._fixedTableElement)===null||e===void 0?void 0:e.parent():this.callBase.apply(this,arguments)},_wrapTableInScrollContainer(r,e){var t=this.callBase.apply(this,arguments);return(this._isFixedTableRendering||e)&&t.addClass(this.addWidgetPrefix(Ci)),t},_renderCellContent(r,e){var t,{column:i}=e,a=this._isFixedTableRendering,n=e.rowType==="group"&&_(i.groupIndex);if(a&&n&&!i.command&&!i.groupCellTemplate&&r.css("pointerEvents","none"),!a&&this._isFixedColumns){if(t=i.fixed||i.command&&i.fixed!==!1,n&&(t=!1,e.row.summaryCells&&e.row.summaryCells.length)){var o=this._columnsController.getVisibleColumns(),s=this._getAlignByColumnCellCount?this._getAlignByColumnCellCount(i.colspan,{columns:o,row:e.row,isFixed:!0}):0;if(s>0){var l=ze(this._columnsController.getFixedColumns());t=o.length-s<l}}if(t){if(i.command&&i.type!=="buttons"||e.rowType==="group"){r.html("&nbsp;").addClass(i.cssClass);return}r.addClass("dx-hidden-cell")}}i.command!==ot&&this.callBase.apply(this,arguments)},_getCellElementsCore(r){var e=this.callBase.apply(this,arguments),t=e==null?void 0:e.parent().hasClass(nl),i=this.name==="columnHeadersView"?r:void 0;if(this._fixedTableElement&&e){var a=this.getFixedColumns(i),n=this._getRowElements(this._fixedTableElement).eq(r).children("td");T(n,(o,s)=>{if(t)e[o]&&s.style.visibility!=="hidden"&&(e[o]=s);else{var l=a[o];if(l)if(l.command===ot)n.eq(o).hasClass(Ow)&&(e[o]=s||e[o]);else{var d=this._columnsController.getVisibleIndexByColumn(l,i);e[d]=s||e[d]}}})}return e},getColumnWidths(){var r=this.callBase(),e=this.getFixedColumns(),t=this._fixedTableElement&&r.length?this.callBase(this._fixedTableElement):void 0;return Ou(e,r,t)},getTableElement(r){r=this._isFixedTableRendering||r;var e=r?this._fixedTableElement:this.callBase();return e},setTableElement(r,e){this._isFixedTableRendering||e?this._fixedTableElement=r.addClass(Sa):this.callBase(r)},getColumns(r){var e=this.getTableElement();return this._isFixedTableRendering?this.getFixedColumns(r):this.callBase(r,e)},getRowIndex(r){var e=this._fixedTableElement;return e&&e.find(r).length?this._getRowElements(e).index(r):this.callBase(r)},getTableElements(){var r=this.callBase.apply(this,arguments);return this._fixedTableElement&&(r=m([r.get(0),this._fixedTableElement.get(0)])),r},getFixedColumns(r){return this._columnsController.getFixedColumns(r)},getFixedColumnsOffset(){var r={left:0,right:0},e;if(this._fixedTableElement){e=this.getTransparentColumnElement();var t=e.position();r={left:t.left,right:Te(this.element(),!0)-(Te(e,!0)+t.left)}}return r},getTransparentColumnElement(){return this._fixedTableElement&&this._fixedTableElement.find(".".concat(Sa)).first()},getFixedTableElement(){return this._fixedTableElement},isFixedColumns(){return this._isFixedColumns},_resizeCore(){this.callBase(),this.synchronizeRows()},setColumnWidths(r){var e,{widths:t}=r,i=this._columnsController.getVisibleColumns(),a=(t==null?void 0:t.length)&&i.some(h=>_(h.visibleWidth)),n=(e=r.optionNames)===null||e===void 0?void 0:e.width;if(this.callBase(r),this._fixedTableElement){var o=t==null?void 0:t.some(h=>h==="auto"||!_(h)),s=o&&(!a||!this.isScrollbarVisible(!0)),l=s?i:this.getFixedColumns();this.setFixedTableColumnWidths(l,t)}var d=this.option("wordWrapEnabled"),u=a||n&&d;u&&this.synchronizeRows()},setFixedTableColumnWidths(r,e){if(!(!this._fixedTableElement||!e)){var t=this._fixedTableElement.children("colgroup").children("col");t.toArray().forEach(a=>a.removeAttribute("style"));var i=0;r.forEach(a=>{if(a.colspan){i+=a.colspan;return}var n=Wl(e[i]);_(n)&&Ta(t.eq(i),n),i+=1})}},_getClientHeight(r){var e=r.getBoundingClientRect&&Ee(r);return e&&e.height?e.height:r.clientHeight},synchronizeRows(){var r=[],e=[],t,i,a,n;this.waitAsyncTemplates(!0).done(()=>{if(this._isFixedColumns&&this._tableElement&&this._fixedTableElement){var o=this._getClientHeight(this._tableElement.get(0)),s=this._getClientHeight(this._fixedTableElement.get(0));if(i=this._getRowElements(this._tableElement),a=this._getRowElements(this._fixedTableElement),n=this._findContentElement(),o!==s){for(n&&n.css("height",o),i.css("height",""),a.css("height",""),t=0;t<i.length;t++)r.push(this._getClientHeight(i.get(t))),e.push(this._getClientHeight(a.get(t)));for(t=0;t<i.length;t++){var l=r[t],d=e[t];l>d?a.eq(t).css("height",l):l<d&&i.eq(t).css("height",d)}n&&n.css("height","")}}})},setScrollerSpacing(r){var e=this.option("rtlEnabled");this.callBase(r),this.element().children(".".concat(this.addWidgetPrefix(Ci))).css({paddingLeft:e?r:"",paddingRight:e?"":r})}},Fw=S({},En,{_getRowVisibleColumns(r){return this._isFixedTableRendering?this.getFixedColumns(r):this.callBase(r)},getContextMenuItems(r){var{column:e}=r,t=this.option("columnFixing"),i=this.callBase(r);if(r.row&&r.row.rowType==="header"&&t.enabled===!0&&e&&e.allowFixing){var a=n=>{switch(n.itemData.value){case"none":this._columnsController.columnOption(e.index,"fixed",!1);break;case"left":this._columnsController.columnOption(e.index,{fixed:!0,fixedPosition:"left"});break;case"right":this._columnsController.columnOption(e.index,{fixed:!0,fixedPosition:"right"})}};i=i||[],i.push({text:t.texts.fix,beginGroup:!0,items:[{text:t.texts.leftPosition,value:"left",disabled:e.fixed&&(!e.fixedPosition||e.fixedPosition==="left"),onItemClick:a},{text:t.texts.rightPosition,value:"right",disabled:e.fixed&&e.fixedPosition==="right",onItemClick:a}]},{text:t.texts.unfix,value:"none",disabled:!e.fixed,onItemClick:a})}return i},getFixedColumnElements(r){if(_(r))return this._fixedTableElement&&this._getRowElements(this._fixedTableElement).eq(r).children();var e=this.getColumnElements(),t=this.getTransparentColumnElement();if(e&&t&&t.length){var i=ze(this.getFixedColumns());e.splice(i,t.get(0).colSpan,t.get(0))}return e},getColumnWidths(){var r,e=this.callBase(),t=this.getFixedColumnElements(),i=this.getFixedColumns();return this._fixedTableElement&&(t&&t.length?r=this._getWidths(t):r=this.callBase(this._fixedTableElement)),Ou(i,e,r)}}),Pw=S({},En,{_detachHoverEvents(){var r=this.element();this._fixedTableElement&&this._tableElement&&b.off(r,"mouseover mouseout",".dx-data-row")},_attachHoverEvents(){this._fixedTableElement&&this._tableElement&&b.on(this.element(),"mouseover mouseout",".dx-data-row",this.createAction(r=>{var{event:e}=r,t=this.getRowIndex(m(e.target).closest(".dx-row")),i=e.type==="mouseover";t>=0&&(this._tableElement&&this._getRowElements(this._tableElement).eq(t).toggleClass(il,i),this._fixedTableElement&&this._getRowElements(this._fixedTableElement).eq(t).toggleClass(il,i))}))},_getScrollDelay(){var r,e=(r=this.getController("resizing"))===null||r===void 0?void 0:r.hasResizeTimeout();return e?this.option("scrolling.updateTimeout"):te.mozilla?60:0},_findContentElement(r){var e,t,i=this.addWidgetPrefix(tl),a=this.element();if(r=this._isFixedTableRendering||r,a&&r){e=a.children(".".concat(i));var n=this.getScrollable();return!e.length&&n&&(e=m("<div>").addClass(i),b.on(e,"scroll",o=>{var{target:s}=o,l=this._getScrollDelay();clearTimeout(this._fixedScrollTimeout),this._fixedScrollTimeout=setTimeout(()=>{t=m(s).scrollTop(),n.scrollTo({y:t})},l)}),b.on(e,qu,o=>{var s=m(o.target).closest(".dx-scrollable"),l=!1;if(n&&n.$element().is(s))l=!0;else{var d=s.length&&Rt.getInstance(s.get(0)),u=d&&d.scrollHeight()-d.clientHeight()>0;l=d&&!u}if(l){t=n.scrollTop(),n.scrollTo({y:t-o.delta});var h=n.scrollTop()+n.clientHeight(),c=n.scrollHeight()+this.getScrollbarWidth(),p=n.scrollTop()>0&&h<c;if(p)return!1}}),e.appendTo(a)),e}return this.callBase()},_updateScrollable(){this.callBase();var r=this.getScrollable();if(!(r!=null&&r._disposed)){var e=r&&r.scrollOffset().top;this._updateFixedTablePosition(e)}},_renderContent(r,e,t){return this._isFixedTableRendering||t?r.empty().addClass("".concat(this.addWidgetPrefix(tl)," ").concat(this.addWidgetPrefix(Ci))).append(e):this.callBase(r,e)},_getGroupCellOptions(r){return this._isFixedTableRendering?this.callBase(S({},r,{columns:this._columnsController.getVisibleColumns()})):this.callBase(r)},_renderGroupedCells(r,e){return this.callBase(r,S({},e,{columns:this._columnsController.getVisibleColumns()}))},_renderGroupSummaryCells(r,e){this._isFixedTableRendering?this.callBase(r,S({},e,{columns:this._columnsController.getVisibleColumns()})):this.callBase(r,e)},_hasAlignByColumnSummaryItems(r,e){var t=this.callBase.apply(this,arguments),i=e.columns[r];return e.isFixed?i.fixed&&(t||i.fixedPosition==="right"):t&&(!this._isFixedColumns||!i.fixed)},_renderGroupSummaryCellsCore(r,e,t,i){var a;if(this._isFixedTableRendering){e.isFixed=!0,a=this._getAlignByColumnCellCount(t,e),e.isFixed=!1;var n=e.columns.length-a;e=S({},e,{columns:this.getFixedColumns()});var o=ze(e.columns);n<o?(a-=e.columns[o].colspan-1||0,t-=e.columns[o].colspan-1||0):i>0&&r.css("visibility","hidden"),i=a}this.callBase(r,e,t,i)},_getSummaryCellIndex(r,e){if(this._isFixedTableRendering){var t=ze(e);return r>t&&(r+=e[t].colspan-1),r}return this.callBase.apply(this,arguments)},_renderCore(r){this._detachHoverEvents();var e=this.callBase(r),t=this._isFixedColumns;return this.element().toggleClass(Dw,t),this.option("hoverStateEnabled")&&t&&this._attachHoverEvents(),e},setRowsOpacity(r,e){this.callBase(r,e);var t=this._getRowElements(this._fixedTableElement);this._setRowsOpacityCore(t,this.getFixedColumns(),r,e)},optionChanged(r){this.callBase(r),r.name==="hoverStateEnabled"&&this._isFixedColumns&&(r.value?this._attachHoverEvents():this._detachHoverEvents())},getCellIndex(r){var e=this._fixedTableElement,t=0;if(e&&r.is("td")&&r.closest(e).length){var i=this.getFixedColumns();return T(i,(a,n)=>{if(a===r[0].cellIndex)return!1;if(n.colspan){t+=n.colspan;return}t++}),t}return this.callBase.apply(this,arguments)},_updateFixedTablePosition(r,e){if(this._fixedTableElement&&this._tableElement){var t,i=this.getController("editorFactory");this._fixedTableElement.parent().scrollTop(r),e&&i&&(t=i.focus(),t&&i.focus(t))}},setScrollerSpacing(r,e){var t={marginBottom:0},i=this.element().children(".".concat(this.addWidgetPrefix(Ci)));if(i.length&&this._fixedTableElement){i.css(t),this._fixedTableElement.css(t),t[this.option("rtlEnabled")?"marginLeft":"marginRight"]=r,t.marginBottom=e;var a=this._scrollable&&this._scrollable.option("useNative");(a?i:this._fixedTableElement).css(t)}},_getElasticScrollTop(r){var e=0;if(r.scrollOffset.top<0)e=-r.scrollOffset.top;else if(r.reachedBottom){var t=m(r.component.content()),i=m(r.component.container()),a=Math.max(t.get(0).clientHeight-i.get(0).clientHeight,0);e=Math.min(a-r.scrollOffset.top,0)}return Math.floor(e)},_applyElasticScrolling(r){if(this._fixedTableElement){var e=this._getElasticScrollTop(r);Math.ceil(e)!==0?Xu(this._fixedTableElement,{top:e}):this._fixedTableElement.css("transform","")}},_handleScroll(r){this._updateFixedTablePosition(r.scrollOffset.top,!0),this._applyElasticScrolling(r),this.callBase(r)},_updateContentPosition(r){this.callBase.apply(this,arguments),r||this._updateFixedTablePosition(this._scrollTop)},_afterRowPrepared(r){this._isFixedTableRendering||this.callBase(r)},_scrollToElement(r){this.callBase(r,this.getFixedColumnsOffset())},dispose(){this.callBase.apply(this,arguments),clearTimeout(this._fixedScrollTimeout)}}),Bw=En,Lw={defaultOptions:()=>({columnFixing:{enabled:!1,texts:{fix:y.format("dxDataGrid-columnFixingFix"),unfix:y.format("dxDataGrid-columnFixingUnfix"),leftPosition:y.format("dxDataGrid-columnFixingLeftPosition"),rightPosition:y.format("dxDataGrid-columnFixingRightPosition")}}}),extenders:{views:{columnHeadersView:Fw,rowsView:Pw,footerView:Bw},controllers:{draggingHeader:{_generatePointsByColumns(r){var e=r.columns,{targetDraggingPanel:t}=r;if(t&&t.getName()==="headers"&&t.isFixedColumns()&&r.sourceColumn.fixed){r.rowIndex||(r.columnElements=t.getFixedColumnElements(0)),r.columns=t.getFixedColumns(r.rowIndex);var i=this.callBase(r);return function(a,n,o){var s=ze(n),l=a.length-n.length;return T(o,(d,u)=>{u.index>s&&(u.columnIndex+=l,u.index+=l)}),o}(e,r.columns,i),i}return this.callBase(r)},_pointCreated(r,e,t,i){var a=this.callBase.apply(this,arguments),n=e[r.columnIndex],o=this._columnHeadersView.getTransparentColumnElement();if(!a&&t==="headers"&&o&&o.length){var s=Ee(o.get(0));return i&&i.fixed?i.fixedPosition==="right"?r.x<s.right:r.x>s.left:n&&n.fixed&&n.fixedPosition!=="right"?!0:r.x<s.left||r.x>s.right}return a}},columnsResizer:{_generatePointsByColumns(){var r=this,e=r._columnsController,t=e&&r._columnsController.getVisibleColumns(),i=e&&r._columnsController.getFixedColumns(),a=ze(i),n=t.length-i.length,o=r._columnHeadersView.getFixedColumnElements();r.callBase(),o&&o.length>0&&(r._pointsByFixedColumns=I.getPointsByColumns(o,s=>(s.index>a&&(s.columnIndex+=n,s.index+=n),r._pointCreated(s,t.length,t))))},_getTargetPoint(r,e,t){var i=this._columnHeadersView.getTransparentColumnElement();if(i&&i.length){var a=Ee(i.get(0));if(e<=a.left||e>=a.right)return this.callBase(this._pointsByFixedColumns,e,t)}return this.callBase(r,e,t)}}}}};A.registerModule("columnFixing",Lw);var Au="columnHeadersView",Du="rowsView",kw="footerView",ba=[Au,Du,kw],Mw="dxDataGridAdaptivity",Ne="adaptiveHidden",at="detailAdaptive",Ya="dx-field-item-content",Nw="dx-item-modified",lr="hidden-column",zw="adaptive-more",Vu="dx-command-adaptive",ri="dx-command-adaptive-hidden",Hw="dx-adaptive-detail-row",Qa="dx-adaptive-item-text",Ww="dx-master-detail-cell",Gw="dx-last-data-cell",$r="adaptive",Kw="batch",Ja="row",Uw="form",$w="popup",qw="revert-tooltip",ol="dx-group-cell",Xw="dx-group-row",sl="dxDataGrid-ariaAdaptiveExpand",jw="dxDataGrid-ariaAdaptiveCollapse",Yw="scrolling.legacyMode";function qr(r,e){return r._columnsController.getColumnId(e)}function Qw(r){return r.find("td:not(.dx-datagrid-hidden-column):not([class*='dx-command-'])")}function Jw(r,e){var t,i=m(r),a=e.component.getController("adaptiveColumns");e.rowType==="data"?(t=m("<span>").addClass(a.addWidgetPrefix(zw)),b.on(t,$(re,Mw),a.createAction(()=>{a.toggleExpandAdaptiveDetailRow(e.key)})),t.appendTo(i)):I.setEmptyText(i)}function Za(r){var e,t=(e=r.data)===null||e===void 0?void 0:e.$nextCell;b.off(t,"focus",Za),b.trigger(t,"dxclick")}var Zw={_isRowEditMode(){var r=this._getEditMode();return r===Ja},_isItemModified(r,e){var t=this._columnsController.getVisibleIndex(r.column.index),i=this._dataController.getRowIndexByKey(e.key),a=this._dataController.items()[i+1];return a&&a.modifiedValues&&_(a.modifiedValues[t])},_renderFormViewTemplate(r,e,t){var i=this,{column:a}=r,n=i.createAction(()=>{i._editingController.isEditing()&&b.trigger(t,re)}),o=e.row.data,s=a.calculateCellValue(o),l=I.getDisplayValue(a,s,o,e.rowType),d=I.formatValue(l,a),u=this._editingController.isCellOrBatchEditMode(),h=i._rowsView;if(a.allowEditing&&i.getController("keyboardNavigation").isKeyboardEnabled()&&(t.attr("tabIndex",i.option("tabIndex")),u&&(b.off(t,"focus",n),b.on(t,"focus",n))),a.cellTemplate){var c=S({},e,{value:s,displayValue:l,text:d,column:a});h.renderTemplate(t,a.cellTemplate,c,xi(t)).done(()=>{h._cellPrepared(t,e)})}else{var p=t.get(0);a.encodeHtml?p.textContent=d:p.innerHTML=d,t.addClass(Qa),(!_(d)||d==="")&&t.html("&nbsp;"),i._isRowEditMode()||i._isItemModified(r,e)&&t.addClass(Nw),h._cellPrepared(t,e)}},_getTemplate(r,e){var t=this,{column:i}=r,a=this.getController("editing");return function(n,o){var s=m(o),l=t._columnsController.getVisibleIndex(i.index),d=S({},e),u=function(){var h=t._isItemEdited(r);d.value=e.row.values[l],h||i.showEditorAlways?a.renderFormEditorTemplate(d,r,n,s,!h):(d.column=i,d.columnIndex=l,t._renderFormViewTemplate(r,d,s))};u(),d.watch&&d.watch(()=>({isItemEdited:t._isItemEdited(r),value:e.row.values[l]}),()=>{s.contents().remove(),s.removeClass(Qa),u()})}},_isVisibleColumnsValid(r){return!(r<2||r.length-function(){for(var e=0,t=0;t<r.length;t++){var i=r[t];i.command&&e++}return e}()<=1)},_calculatePercentWidths(r,e){var t=this,i=0;return e.forEach((a,n)=>{r[n]!==Ne&&(i+=t._getItemPercentWidth(a))}),i},_isPercentWidth:r=>G(r)&&r.endsWith("%"),_isColumnHidden(r){return this._hiddenColumns.filter(e=>e.index===r.index).length>0},_getAverageColumnsWidth(r,e,t){var i=this,a=0,n=0;return e.forEach(o=>{if(!i._isColumnHidden(o)){var{width:s}=o;_(s)&&!isNaN(parseFloat(s))?a+=i._isPercentWidth(s)?i._calculatePercentWidth({visibleIndex:o.visibleIndex,columnsCount:e.length,columnsCanFit:t,bestFitWidth:o.bestFitWidth,columnWidth:s,containerWidth:r}):parseFloat(s):n++}}),(r-a)/n},_calculateColumnWidth(r,e,t,i){var a=qr(this,r),n=this._columnsController.columnOption(a,"width"),o=this._columnsController.columnOption(a,"bestFitWidth"),s=t.length,l;if(n&&n!=="auto")if(this._isPercentWidth(n))l=this._calculatePercentWidth({visibleIndex:r.visibleIndex,columnsCount:s,columnsCanFit:i,bestFitWidth:o,columnWidth:n,containerWidth:e});else return parseFloat(n);else{var d=this.option("columnAutoWidth");l=d||r.command?o:this._getAverageColumnsWidth(e,t,i)}return l},_calculatePercentWidth(r){var e=r.visibleIndex<r.columnsCount-1&&r.columnsCanFit,t=r.containerWidth*parseFloat(r.columnWidth)/100,i=r.columnsCanFit&&t<r.bestFitWidth?r.bestFitWidth:t;return e?r.containerWidth*parseFloat(r.columnWidth)/100:i},_getNotTruncatedColumnWidth(r,e,t,i){var a=qr(this,r),n=this._columnsController.columnOption(a,"width"),o=this._columnsController.columnOption(a,"bestFitWidth");if(n&&n!=="auto"&&!this._isPercentWidth(n))return parseFloat(n);var s=this._calculateColumnWidth(r,e,t,i);return s<o?null:s},_getItemPercentWidth(r){var e=0;return r.width&&this._isPercentWidth(r.width)&&(e=parseFloat(r.width)),e},_getCommandColumnsWidth(){var r=this,e=r._columnsController.getVisibleColumns(),t=0;return T(e,(i,a)=>{(a.index<0||a.command)&&(t+=r._columnsController.columnOption(qr(r,a),"bestFitWidth")||0)}),t},_isItemEdited(r){if(this.isFormOrPopupEditMode())return!1;if(this._isRowEditMode()){var e=this.option("editing.editRowKey");if(U(e,this._dataController.adaptiveExpandedKey()))return!0}else{var t=this._dataController.getRowIndexByKey(this._dataController.adaptiveExpandedKey())+1,i=this._columnsController.getVisibleIndex(r.column.index);return this._editingController.isEditCell(t,i)}},_getFormItemsByHiddenColumns(r){var e=[];return T(r,(t,i)=>{e.push({column:i,name:i.name,dataField:i.dataField,visibleIndex:i.visibleIndex})}),e},_getAdaptiveColumnVisibleIndex(r){for(var e=0;e<r.length;e++){var t=r[e];if(t.command===$r)return e}},_hideAdaptiveColumn(r,e){var t=this._getAdaptiveColumnVisibleIndex(e);_(t)&&(r[t]=Ne,this._hideVisibleColumn({isCommandColumn:!0,visibleIndex:t}))},_showHiddenCellsInView(r){var{$cells:e,isCommandColumn:t}=r,i=this.addWidgetPrefix(lr);t?(i=ri,e.attr({tabIndex:0,"aria-hidden":null}).removeClass(i)):e.removeClass(i)},_showHiddenColumns(){for(var r=0;r<ba.length;r++){var e=this.getView(ba[r]);if(e&&e.isVisible()&&e.element()){var t=e.name,i=e.element().find(".".concat(ri));this._showHiddenCellsInView({viewName:t,$cells:i,isCommandColumn:!0});var a=e.element().find(".".concat(this.addWidgetPrefix(lr)));this._showHiddenCellsInView({viewName:t,$cells:a})}}},_isCellValid:r=>r&&r.length&&!r.hasClass(Ww)&&!r.hasClass(ol),_hideVisibleColumn(r){var{isCommandColumn:e,visibleIndex:t}=r,i=this;ba.forEach(a=>{var n=i.getView(a);n&&i._hideVisibleColumnInView({view:n,isCommandColumn:e,visibleIndex:t})})},_hideVisibleColumnInView(r){var{view:e,isCommandColumn:t,visibleIndex:i}=r,a=e.name,n,o=this._columnsController.getVisibleColumns()[i],s=this._editingController&&this._editingController.getEditFormRowIndex();if(e&&e.isVisible()&&o)for(var l=e.getRowsCount(),d=e._getRowElements(),u=0;u<l;u++){var h=u===s&&a===Du&&this.option("editing.mode")!=="popup";if(!h){var c=a===Au?this._columnsController.getVisibleIndex(o.index,u):i;if(c>=0){var p=d.eq(u);n=this._findCellElementInRow(p,c),this._isCellValid(n)&&this._hideVisibleCellInView({viewName:a,isCommandColumn:t,$cell:n})}}}},_findCellElementInRow(r,e){var t=r.children(),i=e,a=!1;if(r.hasClass(Xw)){var n=r.find(".".concat(ol)),o=n.attr("colspan");if(n.length&&_(o)){var s=parseInt(o),l=n.index()+s-1;e>l?i=e-s+1:a=!0}}var d=a?void 0:t.eq(i);return d},_hideVisibleCellInView(r){var{$cell:e,isCommandColumn:t}=r,i=t?ri:this.addWidgetPrefix(lr);e.attr({tabIndex:-1,"aria-hidden":!0}).addClass(i)},_getEditMode(){return this._editingController.getEditMode()},isFormOrPopupEditMode(){var r=this._getEditMode();return r===Uw||r===$w},hideRedundantColumns(r,e,t){if(this._hiddenColumns=[],this._isVisibleColumnsValid(e)&&t.length){var i=0,a=this.component.$element(),n=X(a)-this._getCommandColumnsWidth(),o=(function(){return e.filter(D=>!D.command&&this._hiddenColumns.filter(V=>V.index===D.index).length===0)}).bind(this),s=o(),l=s.length,d,u,h;do{h=!1,i=0;var c=this._calculatePercentWidths(r,e),p=c<100&&c!==0;for(d=0;d<e.length;d++){var g=e[d],v=this._getNotTruncatedColumnWidth(g,n,s,p),f=qr(this,g),C=this._columnsController.columnOption(f,"width"),w=this._columnsController.columnOption(f,"minWidth"),x=this._columnsController.columnOption(f,"bestFitWidth");if(r[d]===Ne){u=!0;continue}if(!v&&!g.command&&!g.fixed){h=!0;break}(!C||C==="auto")&&(v=Math.max(x||0,w||0)),(g.command!==$r||u)&&(i+=v)}if(h=h||i>X(a),h){var E=t.pop(),R=this._columnsController.getVisibleIndex(E.index);n+=this._calculateColumnWidth(E,n,s,p),this._hideVisibleColumn({visibleIndex:R}),r[R]=Ne,this._hiddenColumns.push(E),s=o()}}while(h&&s.length>1&&t.length);l===s.length&&this._hideAdaptiveColumn(r,e)}else this._hideAdaptiveColumn(r,e)},getAdaptiveDetailItems(){return this._$itemContents},getItemContentByColumnIndex(r){for(var e,t=0;t<this._$itemContents.length;t++){e=this._$itemContents.eq(t);var i=e.data("dx-form-item");if(i&&i.column&&this._columnsController.getVisibleIndex(i.column.index)===r)return e}},toggleExpandAdaptiveDetailRow(r,e){this.isFormOrPopupEditMode()&&this._editingController.isEditing()||this.getController("data").toggleExpandAdaptiveDetailRow(r,e)},createFormByHiddenColumns(r,e){var t=this,i=m(r),a={items:t._getFormItemsByHiddenColumns(t._hiddenColumns),formID:"dx-".concat(new Lt)},n=wi()?{colCount:2}:{};this.executeAction("onAdaptiveDetailRowPreparing",{formOptions:a}),t._$itemContents=null,t._form=t._createComponent(m("<div>").appendTo(i),Il,S(n,a,{customizeItem(o){var s=o.column||t._columnsController.columnOption(o.name||o.dataField);s&&(o.label=o.label||{},o.label.text=o.label.text||s.caption,o.column=s,o.template=t._getTemplate(o,e,t.updateForm.bind(t))),a.customizeItem&&a.customizeItem.call(this,o)},onContentReady(o){a.onContentReady&&a.onContentReady.call(this,o),t._$itemContents=i.find(".".concat(Ya))}}))},hasAdaptiveDetailRowExpanded(){return _(this._dataController.adaptiveExpandedKey())},updateForm(r){this.hasAdaptiveDetailRowExpanded()&&this._form&&_(this._form._contentReadyAction)&&(r&&r.length?this._form.option("items",this._getFormItemsByHiddenColumns(r)):this._form.repaint())},updateHidingQueue(r){var e=r.filter(n=>n.visible&&!n.type&&!n.fixed&&!(_(n.groupIndex)&&n.groupIndex>=0)),t,i;if(this._hidingColumnsQueue=[],this.option("allowColumnResizing")&&this.option("columnResizingMode")==="widget")return this._hidingColumnsQueue;for(i=0;i<e.length;i++)_(e[i].hidingPriority)&&e[i].hidingPriority>=0&&(t=!0,this._hidingColumnsQueue[e[i].hidingPriority]=e[i]);if(t)this._hidingColumnsQueue.reverse();else if(this.option("columnHidingEnabled"))for(i=0;i<e.length;i++){var a=this._columnsController.getVisibleIndex(e[i].index);this._hidingColumnsQueue[a]=e[i]}return this._hidingColumnsQueue=this._hidingColumnsQueue.filter(Object),this._hidingColumnsQueue},getHiddenColumns(){return this._hiddenColumns},hasHiddenColumns(){return this._hiddenColumns.length>0},getHidingColumnsQueue(){return this._hidingColumnsQueue},init(){var r=this;r._columnsController=r.getController("columns"),r._dataController=r.getController("data"),r._rowsView=r.getView("rowsView"),r._columnsController.addCommandColumn({type:$r,command:$r,visible:!0,adaptiveHidden:!0,cssClass:Vu,alignment:"center",width:"auto",cellTemplate:Jw,fixedPosition:"right"}),r._columnsController.columnsChanged.add(()=>{var e=!!r.updateHidingQueue(r._columnsController.getColumns()).length;r._columnsController.columnOption("command:adaptive","adaptiveHidden",!e,!0)}),r._editingController=r.getController("editing"),r._hidingColumnsQueue=[],r._hiddenColumns=[],r.createAction("onAdaptiveDetailRowPreparing"),r.callBase()},optionChanged(r){r.name==="columnHidingEnabled"&&this._columnsController.columnOption("command:adaptive","adaptiveHidden",!r.value),this.callBase(r)},publicMethods:()=>["isAdaptiveDetailRowExpanded","expandAdaptiveDetailRow","collapseAdaptiveDetailRow"],isAdaptiveDetailRowExpanded(r){var e=this._dataController;return e.adaptiveExpandedKey()&&U(e.adaptiveExpandedKey(),r)},expandAdaptiveDetailRow(r){this.hasAdaptiveDetailRowExpanded()||this.toggleExpandAdaptiveDetailRow(r)},collapseAdaptiveDetailRow(){this.hasAdaptiveDetailRowExpanded()&&this.toggleExpandAdaptiveDetailRow()},updateCommandAdaptiveAriaLabel(r,e){var t=this._dataController.getRowIndexByKey(r);if(t!==-1){var i=m(this.component.getRowElement(t));this.setCommandAdaptiveAriaLabel(i,e)}},setCommandAdaptiveAriaLabel(r,e){var t=r.find(".dx-command-adaptive");t.attr("aria-label",y.format(e))}},ex=W.ViewController.inherit(Zw),tx=r=>class extends r{_isCellValid(e,t){return super._isCellValid(e,t)&&!e.hasClass(this.addWidgetPrefix(lr))&&!e.hasClass(ri)}_processNextCellInMasterDetail(e,t){super._processNextCellInMasterDetail(e,t);var i=this._editingController.isCellOrBatchEditMode(),a=this._editingController.isEditing();a&&e&&i&&!this._isInsideEditForm(e)&&(b.off(e,"focus",Za),b.on(e,"focus",{$nextCell:e},Za),b.trigger(t,"focus"))}_isCellElement(e){return super._isCellElement(e)||e.hasClass(Qa)}init(){super.init(),this._adaptiveController=this.getController("adaptiveColumns")}},rx={defaultOptions:()=>({columnHidingEnabled:!1,onAdaptiveDetailRowPreparing:null}),controllers:{adaptiveColumns:ex},extenders:{views:{rowsView:{_getCellTemplate(r){var e=this,{column:t}=r;return r.rowType===at&&t.command==="detail"?function(i,a){e._adaptiveColumnsController.createFormByHiddenColumns(m(i),a)}:e.callBase(r)},_createRow(r){var e=this.callBase.apply(this,arguments);return r&&r.rowType===at&&r.key===this._dataController.adaptiveExpandedKey()&&e.addClass(Hw),e},_renderCells(r,e){this.callBase(r,e);var t=this._adaptiveColumnsController,i=t.getHidingColumnsQueue().length,a=t.getHiddenColumns().length;i&&!a&&Qw(r).last().addClass(Gw),e.row.rowType==="data"&&t.setCommandAdaptiveAriaLabel(r,sl)},_getColumnIndexByElementCore(r){var e=r.closest(".".concat(Ya));if(e.length&&e.closest(this.component.$element()).length){var t=e.length?e.first().data("dx-form-item"):null;return t&&t.column&&this._columnsController.getVisibleIndex(t.column.index)}return this.callBase(r)},_cellPrepared(r,e){this.callBase.apply(this,arguments),e.row.rowType!==at&&e.column.visibleWidth===Ne&&r.addClass(this.addWidgetPrefix(lr))},getCell(r,e){var t=this._dataController.items()[r==null?void 0:r.rowIndex];if((t==null?void 0:t.rowType)===at){var i=this._adaptiveColumnsController.getAdaptiveDetailItems();return this.callBase(r,e,i)}return this.callBase.apply(this,arguments)},_getCellElement(r,e){var t=this._dataController.items()[r];return t&&t.rowType===at?this._adaptiveColumnsController.getItemContentByColumnIndex(e):this.callBase.apply(this,arguments)},getContextMenuItems(r){if(r.row&&r.row.rowType==="detailAdaptive"){var e=this.component.getView("columnHeadersView"),t=m(r.targetElement).closest(".dx-field-item-label").next().data("dx-form-item");return r.column=t?t.column:r.column,e.getContextMenuItems&&e.getContextMenuItems(r)}return this.callBase&&this.callBase(r)},isClickableElement(r){var e=this.callBase?this.callBase(r):!1;return e||!!r.closest(".".concat(Vu)).length},init(){this.callBase(),this._adaptiveColumnsController=this.getController("adaptiveColumns")}}},controllers:{export:{_updateColumnWidth(r,e){this.callBase(r,r.visibleWidth===Ne?r.bestFitWidth:e)}},columnsResizer:{_pointCreated(r,e,t){var i=this.callBase(r,e,t),a=t[r.columnIndex]||{},n=this._getNextColumnIndex(r.columnIndex),o=t[n]||{},s=n!==r.columnIndex+1&&o.command,l=a.visibleWidth===Ne||s;return i||l},_getNextColumnIndex(r){for(var e=this._columnsController.getVisibleColumns(),t=this.callBase(r);e[t]&&e[t].visibleWidth===Ne;)t++;return t}},draggingHeader:{_pointCreated(r,e,t,i){var a=this.callBase(r,e,t,i),n=e[r.columnIndex-1]||{},o=n.visibleWidth===Ne;return a||o}},editing:{_isRowEditMode(){return this.getEditMode()===Ja},_getFormEditItemTemplate(r,e){return this.getEditMode()!==Ja&&r.rowType==="detailAdaptive"?(r.columnIndex=this._columnsController.getVisibleIndex(e.index),this.getColumnTemplate(r)):this.callBase(r,e)},_closeEditItem(r){var e=r.closest(".".concat(Ya)),t=this._dataController.getRowIndexByKey(this._dataController.adaptiveExpandedKey())+1,i=e.length?e.first().data("dx-form-item"):null,a=i&&i.column&&this._columnsController.getVisibleIndex(i.column.index);this.isEditCell(t,a)||this.callBase(r)},_beforeUpdateItems(r,e){if(!this._adaptiveController.isFormOrPopupEditMode()&&this._adaptiveController.hasHiddenColumns()){var t=this._dataController.items(),i=t[e],a=I.getIndexByKey(this._dataController.adaptiveExpandedKey(),t);this._isForceRowAdaptiveExpand=!this._adaptiveController.hasAdaptiveDetailRowExpanded(),a>=0&&r.push(a+1),r.push(e+1),this._dataController.adaptiveExpandedKey(i.key)}},_afterInsertRow(r){this.callBase.apply(this,arguments),this._adaptiveController.hasHiddenColumns()&&(this._adaptiveController.toggleExpandAdaptiveDetailRow(r,this.isRowEditMode()),this._isForceRowAdaptiveExpand=!0)},_collapseAdaptiveDetailRow(){this._isRowEditMode()&&this._isForceRowAdaptiveExpand&&(this._adaptiveController.collapseAdaptiveDetailRow(),this._isForceRowAdaptiveExpand=!1)},_cancelEditAdaptiveDetailRow(){this._adaptiveController.hasHiddenColumns()&&this._collapseAdaptiveDetailRow()},_afterSaveEditData(){this.callBase.apply(this,arguments);var r=new O;return this._isRowEditMode()&&this._adaptiveController.hasHiddenColumns()?P(this.getController("validating").validate(!0)).done(e=>{e&&this._cancelEditAdaptiveDetailRow(),r.resolve()}):r.resolve(),r.promise()},_beforeCancelEditData(){this.callBase(),this._cancelEditAdaptiveDetailRow()},_getRowIndicesForCascadeUpdating(r){var e=this.callBase.apply(this,arguments);return this._adaptiveController.isAdaptiveDetailRowExpanded(r.key)&&e.push(r.rowType===at?r.rowIndex-1:r.rowIndex+1),e},_beforeCloseEditCellInBatchMode(r){var e=this._dataController._adaptiveExpandedKey;if(e){var t=I.getIndexByKey(e,this._dataController.items());t>-1&&r.unshift(t)}},editRow(r){this._adaptiveController.isFormOrPopupEditMode()&&this._adaptiveController.collapseAdaptiveDetailRow(),this.callBase(r)},deleteRow(r){var e=this._dataController.getKeyByRowIndex(r);this.getEditMode()===Kw&&this._adaptiveController.isAdaptiveDetailRowExpanded(e)&&this._adaptiveController.collapseAdaptiveDetailRow(),this.callBase(r)},init(){this.callBase(),this._adaptiveController=this.getController("adaptiveColumns")}},resizing:{_needBestFit(){return this.callBase()||!!this._adaptiveColumnsController.getHidingColumnsQueue().length},_correctColumnWidths(r,e){var t=this._adaptiveColumnsController,i=t.getHiddenColumns(),a=t.updateHidingQueue(this._columnsController.getColumns());t.hideRedundantColumns(r,e,a);var n=t.getHiddenColumns();return t.hasAdaptiveDetailRowExpanded()&&i.length!==n.length&&t.updateForm(n),!n.length&&t.collapseAdaptiveDetailRow(),this.callBase.apply(this,arguments)},_toggleBestFitMode(r){r&&this._adaptiveColumnsController._showHiddenColumns(),this.callBase(r)},_needStretch(){var r=this._adaptiveColumnsController;return this.callBase.apply(this,arguments)||r.getHidingColumnsQueue().length||r.hasHiddenColumns()},init(){this._adaptiveColumnsController=this.getController("adaptiveColumns"),this.callBase()},dispose(){this.callBase.apply(this,arguments),clearTimeout(this._updateScrollableTimeoutID)}},data:{_processItems(r,e){var{changeType:t}=e;if(r=this.callBase.apply(this,arguments),t==="loadingAll"||!_(this._adaptiveExpandedKey))return r;var i=I.getIndexByKey(this._adaptiveExpandedKey,r),a=this.option(Yw)===!1;if(i>=0){var n=r[i];r.splice(i+1,0,{visible:!0,rowType:at,key:n.key,data:n.data,node:n.node,modifiedValues:n.modifiedValues,isNewRow:n.isNewRow,values:n.values})}else t==="refresh"&&!(a&&e.repaintChangesOnly)&&(this._adaptiveExpandedKey=void 0);return r},_getRowIndicesForExpand(r){var e=this.callBase.apply(this,arguments);if(this.getController("adaptiveColumns").isAdaptiveDetailRowExpanded(r)){var t=e[e.length-1];e.push(t+1)}return e},adaptiveExpandedKey(r){if(_(r))this._adaptiveExpandedKey=r;else return this._adaptiveExpandedKey},toggleExpandAdaptiveDetailRow(r,e){var t=I.getIndexByKey(this._adaptiveExpandedKey,this._items),i=I.getIndexByKey(r,this._items);t>=0&&t===i&&!e&&(r=void 0,i=-1);var a=this._adaptiveExpandedKey;this._adaptiveExpandedKey=r,t>=0&&t++,i>=0&&i++;var n=this.getRowIndexDelta();this.updateItems({allowInvisibleRowIndices:!0,changeType:"update",rowIndices:[t-n,i-n]});var o=this.getController("adaptiveColumns");o.updateCommandAdaptiveAriaLabel(r,jw),o.updateCommandAdaptiveAriaLabel(a,sl)},init(){this.callBase(),this._adaptiveExpandedKey=void 0}},editorFactory:{_needHideBorder(r){return this.callBase(r)||(r==null?void 0:r.hasClass("dx-field-item-content"))&&(r==null?void 0:r.find(".dx-checkbox").length)},_getFocusCellSelector(){return"".concat(this.callBase(),", .dx-adaptive-detail-row .dx-field-item > .dx-field-item-content")},_getRevertTooltipsSelector(){return"".concat(this.callBase(),", .dx-field-item-content .").concat(this.addWidgetPrefix(qw))}},columns:{_isColumnVisible(r){return this.callBase(r)&&!r.adaptiveHidden}},keyboardNavigation:tx}}};A.registerModule("adaptivity",rx);function Fu(r,e,t,i,a,n){t=t||0,i=i||[],n=n||[],i[t]=i[t]||0;var o=r[t],s=n[t]+1||0,l=0,d;if(o){for(d=s;d<o.length;d++){var u=o[d],h=d+i[t],c=u.colspan||1;if(Fu(r,e,t+(u.rowspan||1),i,c,n),i[t]+=c-1,l+=c,u.rowspan)for(var p=t+1;p<t+u.rowspan;p++)i[p]=i[p]||0,i[p]+=u.colspan||1;if(e(u,h,t,d)===!1||a!==void 0&&l>=a)break}n[t]=d}}function Ia(r,e,t){var i=[];Fu(r,(n,o,s)=>{var l=n,d,u=l.colspan||1,h=o+u-1>=e&&o<t;if(i[s]=i[s]||[],h)o<e?(d=u-(e-o),o=e):d=u,o+d>t&&(d=t-o),d!==u&&(l=S({},l,{colspan:d})),i[s].push(l);else if(o>t)return!1});for(var a=0;a<i.length;a++)i[a]=i[a]||[];return i}var ix=50,ax={_resizeCore(){this.callBase.apply(this,arguments),this._columnsController.resize()},_handleScroll(r){var e=this.getScrollable(),{left:t}=r.scrollOffset;this.callBase.apply(this,arguments),this.option("rtlEnabled")&&e&&(t=X(e.$content())-X(e.$element())-t),this._columnsController.setScrollPosition(t)},_restoreScrollTop(){var r=this.getScrollable(),e=r==null?void 0:r.scrollTop();this._scrollTop>0&&e!==this._scrollTop&&r.scrollTo({y:this._scrollTop})},_renderCore(r){if(r!=null&&r.virtualColumnsScrolling){var e=()=>{this.resizeCompleted.remove(e),this._restoreScrollTop()};this.resizeCompleted.add(e)}return this.callBase.apply(this,arguments)}},nx={_renderCore(){var r=this.callBase.apply(this,arguments);return this._columnsController.isVirtualMode()&&this._updateScrollLeftPosition(),r}},ox=function(){var r=function(t){return t.map(i=>i.visibleWidth||parseFloat(i.width)||ix)},e={init(){this.callBase.apply(this,arguments),this._beginPageIndex=null,this._endPageIndex=null,this._position=0,this._virtualVisibleColumns={}},resetColumnsCache(){this.callBase(),this._virtualVisibleColumns={}},getBeginPageIndex(t){for(var i=this.getVisibleColumns(void 0,!0),a=r(i),n=0,o=0;o<a.length;o++){if(n>=t)return Math.floor(o/this.getColumnPageSize());n+=a[o]}return 0},getTotalWidth(){var t=this.option("width");return typeof t=="number"?t:this.getController("resizing")._lastWidth||Te(this.component.$element())},getEndPageIndex(t){var i=this.getVisibleColumns(void 0,!0),a=r(i),n=0;t+=this.getTotalWidth();for(var o=0;o<a.length;o++){if(n>=t)return Math.ceil(o/this.getColumnPageSize());n+=a[o]}return Math.ceil(a.length/this.getColumnPageSize())},getColumnPageSize(){return this.option("scrolling.columnPageSize")},_fireColumnsChanged(){var t=new Date;this.columnsChanged.fire({optionNames:{all:!0,length:1},changeTypes:{columns:!0,virtualColumnsScrolling:!0,length:2}}),this._renderTime=new Date-t},getScrollingTimeout(){var t=this.option("scrolling.columnRenderingThreshold"),i=this.option("scrolling.renderAsync"),a=0;return(!_(i)&&this._renderTime>t||i)&&(a=this.option("scrolling.timeout")),a},setScrollPosition(t){var i=this.getScrollingTimeout();i>0?(clearTimeout(this._changedTimeout),this._changedTimeout=setTimeout(()=>{this._setScrollPositionCore(t)},i)):this._setScrollPositionCore(t)},isVirtualMode(){return ht()&&this.option("scrolling.columnRenderingMode")==="virtual"},resize(){this._setScrollPositionCore(this._position)},_setScrollPositionCore(t){if(this.isVirtualMode()){var i=this.getBeginPageIndex(t),a=this.getEndPageIndex(t),n=t<this._position?this._beginPageIndex>i:this._endPageIndex<a;this._position=t,n&&(this._beginPageIndex=i,this._endPageIndex=a,this._fireColumnsChanged())}},getFixedColumns(t,i){var a=this.callBase(t);if(this.isVirtualMode()&&!i&&a.length){var n=a.map(o=>o.command).indexOf("transparent");return a[n].colspan=this.getVisibleColumns().length-this.callBase().length+1,a}return a},_compileVisibleColumns(t,i){var a;if(i||!this.isVirtualMode()||!this._shouldReturnVisibleColumns())return this.callBase(t);!((a=this._columns)===null||a===void 0)&&a.length&&!_(this._beginPageIndex)&&!_(this._endPageIndex)&&(this._beginPageIndex=this.getBeginPageIndex(this._position),this._endPageIndex=this.getEndPageIndex(this._position));var n=this._beginPageIndex,o=this._endPageIndex,s="".concat(t,"-").concat(n,"-").concat(o);if(this._virtualVisibleColumns[s])return this._virtualVisibleColumns[s];var l=this.callBase(),d=this.getRowCount(),u=this.getColumnPageSize(),h=n*u,c=o*u,p=this.getFixedColumns(void 0,!0),g=p.map(B=>B.command).indexOf("transparent"),v=p.length?g:0,f=l.slice(0,v),C=l.slice(v,h),w=r(C).reduce((B,k)=>B+k,0);w||(h=0);var x=p.length?p.length-g-1:0,E=l.slice(l.length-x),R=l.slice(c,l.length-x),D=r(R).reduce((B,k)=>B+k,0);if(D||(c=l.length),d>1&&typeof t=="number"){for(var V=[],F=0;F<=d;F++)V.push(this.callBase(F));f=Ia(V,0,f.length)[t]||[],E=Ia(V,l.length-E.length,l.length)[t]||[],l=Ia(V,h,c)[t]||[]}else l=l.slice(h,c);return w&&(l.unshift({command:"virtual",width:w}),l=f.concat(l)),D&&(l.push({command:"virtual",width:D}),l=l.concat(E)),this._virtualVisibleColumns[s]=l,l},getColumnIndexOffset(){var t=0;if(this._beginPageIndex>0){var i=this.getFixedColumns(),a=i.map(o=>o.command).indexOf("transparent"),n=a>=0?a:0;t=this._beginPageIndex*this.getColumnPageSize()-n-1}return t>0?t:0},dispose(){clearTimeout(this._changedTimeout),this.callBase.apply(this,arguments)}};return e}(),sx={defaultOptions:()=>({scrolling:{columnRenderingMode:"standard",columnPageSize:5,columnRenderingThreshold:300}}),extenders:{controllers:{columns:ox},views:{columnHeadersView:nx,rowsView:ax}}};A.registerModule("virtualColumns",sx);var Rr="dx-buttongroup",lx=Rr+"-wrapper",Pu=Rr+"-item",dx=Rr+"-first-item",ux=Rr+"-last-item",ll=Pu+"-has-width",hx="dx-shape-standard",cx=uh.inherit({_initTemplates(){this.callBase(),this._templateManager.addDefaultTemplates({item:new hh((r,e,t)=>{this._prepareItemStyles(r);var i=this.option("buttonTemplate");this._createComponent(r,pr,S({},t,e,this._getBasicButtonOptions(),{_templateData:this._hasCustomTemplate(i)?t:{},template:t.template||i}))},["text","type","icon","disabled","visible","hint"],this.option("integrationOptions.watchMethod"))})},_getBasicButtonOptions(){return{focusStateEnabled:!1,onClick:null,hoverStateEnabled:this.option("hoverStateEnabled"),activeStateEnabled:this.option("activeStateEnabled"),stylingMode:this.option("stylingMode")}},_getDefaultOptions:function(){return S(this.callBase(),{itemTemplateProperty:null})},_hasCustomTemplate(r){return H(r)||this.option("integrationOptions.templates")[r]},_prepareItemStyles(r){var e=r.data("dxItemIndex");e===0&&r.addClass(dx);var t=this.option("items");t&&e===t.length-1&&r.addClass(ux),r.addClass(hx)},_renderItemContent(r){return r.container=m(r.container).parent(),this.callBase(r)},_setAriaSelectionAttribute:function(r,e){this.setAria("pressed",e,r)},_renderItemContentByNode:function(r,e){return r.container=m(r.container.children().first()),this.callBase(r,e)},_focusTarget(){return this.$element().parent()},_keyboardEventBindingTarget(){return this._focusTarget()},_refreshContent(){this._prepareContent(),this._renderContent()},_itemClass:()=>Pu,_itemSelectHandler:function(r){this.option("selectionMode")==="single"&&this.isItemSelected(r.currentTarget)||this.callBase(r)}}),Sn=dr.inherit({_getDefaultOptions(){return S(this.callBase(),{hoverStateEnabled:!0,focusStateEnabled:!0,selectionMode:"single",selectedItems:[],selectedItemKeys:[],stylingMode:"contained",keyExpr:"text",items:[],buttonTemplate:"content",onSelectionChanged:null,onItemClick:null})},_init(){this.callBase(),this._createItemClickAction()},_createItemClickAction(){this._itemClickAction=this._createActionByOption("onItemClick")},_initMarkup(){this.setAria("role","group"),this.$element().addClass(Rr),this._renderButtons(),this._syncSelectionOptions(),this.callBase()},_fireSelectionChangeEvent:function(r,e){this._createActionByOption("onSelectionChanged",{excludeValidators:["disabled","readOnly"]})({addedItems:r,removedItems:e})},_renderButtons(){var r=m("<div>").addClass(lx).appendTo(this.$element()),e=this.option("selectedItems"),t={selectionMode:this.option("selectionMode"),items:this.option("items"),keyExpr:this.option("keyExpr"),buttonTemplate:this.option("buttonTemplate"),scrollingEnabled:!1,selectedItemKeys:this.option("selectedItemKeys"),focusStateEnabled:this.option("focusStateEnabled"),hoverStateEnabled:this.option("hoverStateEnabled"),activeStateEnabled:this.option("activeStateEnabled"),stylingMode:this.option("stylingMode"),accessKey:this.option("accessKey"),tabIndex:this.option("tabIndex"),noDataText:"",selectionRequired:!1,onItemRendered:i=>{var a=this.option("width");_(a)&&m(i.itemElement).addClass(ll)},onSelectionChanged:i=>{this._syncSelectionOptions(),this._fireSelectionChangeEvent(i.addedItems,i.removedItems)},onItemClick:i=>{this._itemClickAction(i)}};_(e)&&e.length&&(t.selectedItems=e),this._buttonsCollection=this._createComponent(r,cx,t)},_syncSelectionOptions(){this._setOptionWithoutOptionChange("selectedItems",this._buttonsCollection.option("selectedItems")),this._setOptionWithoutOptionChange("selectedItemKeys",this._buttonsCollection.option("selectedItemKeys"))},_optionChanged(r){switch(r.name){case"stylingMode":case"selectionMode":case"keyExpr":case"buttonTemplate":case"items":case"activeStateEnabled":case"focusStateEnabled":case"hoverStateEnabled":case"tabIndex":this._invalidate();break;case"selectedItemKeys":case"selectedItems":this._buttonsCollection.option(r.name,r.value);break;case"onItemClick":this._createItemClickAction();break;case"onSelectionChanged":break;case"width":this.callBase(r),this._buttonsCollection.itemElements().toggleClass(ll,!!r.value);break;default:this.callBase(r)}}});_r("dxButtonGroup",Sn);const ry=Object.freeze(Object.defineProperty({__proto__:null,default:Sn},Symbol.toStringTag,{value:"Module"}));var dl="dx-dropdownbutton",px="dx-dropdownbutton-content",ul="dx-dropdownbutton-action",hl="dx-dropdownbutton-toggle",gx="dx-dropdownbutton-has-arrow",vx="dx-dropdownbutton-popup-wrapper",fx="dx-dropdowneditor-overlay",mx="dx-button",_x="dx-button-text",Cx="dx-icon-right",Bu=dr.inherit({_getDefaultOptions(){return S(this.callBase(),{itemTemplate:"item",keyExpr:"this",displayExpr:void 0,selectedItem:null,selectedItemKey:null,stylingMode:"outlined",deferRendering:!0,noDataText:y.format("dxCollectionWidget-noDataText"),useSelectMode:!1,splitButton:!1,showArrowIcon:!0,text:"",icon:void 0,onButtonClick:null,onSelectionChanged:null,onItemClick:null,opened:!1,items:null,dataSource:null,focusStateEnabled:!0,hoverStateEnabled:!0,dropDownOptions:{},dropDownContentTemplate:"content",wrapItemText:!1,useItemTextAsTitle:!0,grouped:!1,groupTemplate:"group",buttonGroupOptions:{}})},_setOptionsByReference(){this.callBase(),S(this._optionsByReference,{selectedItem:!0})},_init(){this.callBase(),this._createItemClickAction(),this._createActionClickAction(),this._createSelectionChangedAction(),this._initDataSource(),this._compileKeyGetter(),this._compileDisplayGetter(),this._itemsToDataSource(this.option("items")),this._options.cache("buttonGroupOptions",this.option("buttonGroupOptions")),this._options.cache("dropDownOptions",this.option("dropDownOptions"))},_initTemplates(){this._templateManager.addDefaultTemplates({content:new ju(r=>{var e=m(r.container),t=m("<div>").appendTo(e);this._list=this._createComponent(t,an,this._listOptions()),this._list.registerKeyHandler("escape",this._escHandler.bind(this)),this._list.registerKeyHandler("tab",this._escHandler.bind(this)),this._list.registerKeyHandler("leftArrow",this._escHandler.bind(this)),this._list.registerKeyHandler("rightArrow",this._escHandler.bind(this))})}),this.callBase()},_itemsToDataSource:function(r){this._dataSource||(this._dataSource=new yr({store:new en({key:this._getKey(),data:r}),pageSize:0}))},_getKey:function(){var r,e=this.option("keyExpr"),t=(r=this._dataSource)===null||r===void 0?void 0:r.key();return _(t)&&(!_(e)||e==="this")?t:e},_compileKeyGetter(){this._keyGetter=de(this._getKey())},_compileDisplayGetter(){this._displayGetter=de(this.option("displayExpr"))},_initMarkup(){this.callBase(),this.$element().addClass(dl),this._renderButtonGroup(),this._updateArrowClass(),_(this.option("selectedItemKey"))&&this._loadSelectedItem().done(this._updateActionButton.bind(this))},_renderFocusTarget:me,_render(){(!this.option("deferRendering")||this.option("opened"))&&this._renderPopup(),this.callBase()},_renderContentImpl(){return this._popup&&this._renderPopupContent(),this.callBase()},_loadSelectedItem(){var r;(r=this._loadSingleDeferred)===null||r===void 0||r.reject();var e=new O;if(this._list&&this._lastSelectedItemData!==void 0){var t=this.option("useSelectMode")?this._list.option("selectedItem"):this._lastSelectedItemData;return e.resolve(t)}this._lastSelectedItemData=void 0;var i=this.option("selectedItemKey");return this._loadSingle(this._getKey(),i).done(e.resolve).fail(()=>{e.resolve(null)}),this._loadSingleDeferred=e,e.promise()},_createActionClickAction(){this._actionClickAction=this._createActionByOption("onButtonClick")},_createSelectionChangedAction(){this._selectionChangedAction=this._createActionByOption("onSelectionChanged")},_createItemClickAction(){this._itemClickAction=this._createActionByOption("onItemClick")},_fireSelectionChangedAction(r){var{previousValue:e,value:t}=r;this._selectionChangedAction({item:t,previousItem:e})},_fireItemClickAction(r){var{event:e,itemElement:t,itemData:i}=r;return this._itemClickAction({event:e,itemElement:t,itemData:this._actionItem||i})},_actionButtonConfig(){return{text:this.option("text"),icon:this.option("icon"),elementAttr:{class:ul}}},_getButtonGroupItems(){var r=[];return r.push(this._actionButtonConfig()),this.option("splitButton")&&r.push({icon:"spindown",elementAttr:{class:hl}}),r},_buttonGroupItemClick(r){var{event:e,itemData:t}=r,i=t.elementAttr.class===ul,a=t.elementAttr.class===hl;a?this.toggle():i&&(this._actionClickAction({event:e,selectedItem:this.option("selectedItem")}),this.option("splitButton")||this.toggle())},_buttonGroupOptions(){var{splitButton:r,showArrowIcon:e,focusStateEnabled:t,hoverStateEnabled:i,stylingMode:a,accessKey:n,tabIndex:o}=this.option(),s=r||!e?"content":(l,d)=>{var{text:u,icon:h}=l,c=Va(h),p=u?m("<span>").text(u).addClass(_x):void 0,g=Va("spindown").addClass(Cx);m(d).append(c,p,g)};return S({items:this._getButtonGroupItems(),onItemClick:this._buttonGroupItemClick.bind(this),width:"100%",height:"100%",selectionMode:"none",onKeyboardHandled:l=>this._keyboardHandler(l),buttonTemplate:s,focusStateEnabled:t,hoverStateEnabled:i,stylingMode:a,accessKey:n,tabIndex:o},this._options.cache("buttonGroupOptions"))},_renderPopupContent(){var r=this._popup.$content(),e=this._getTemplateByOption("dropDownContentTemplate");return r.empty(),this._popupContentId="dx-"+new Lt,this.setAria("id",this._popupContentId,r),e.render({container:be(r),model:this.option("items")||this._dataSource})},_popupOptions(){var r=this.option("rtlEnabled")?"right":"left";return S({dragEnabled:!1,focusStateEnabled:!1,deferRendering:this.option("deferRendering"),hideOnOutsideClick:e=>{var t=this.$element(),i=m(e.target).closest(".".concat(dl));return!i.is(t)},showTitle:!1,animation:{show:{type:"fade",duration:0,from:0,to:1},hide:{type:"fade",duration:400,from:1,to:0}},_ignoreFunctionValueDeprecation:!0,width:()=>Bn(this.$element()),height:"auto",shading:!1,position:{of:this.$element(),collision:"flipfit",my:r+" top",at:r+" bottom"},_wrapperClassExternal:fx},this._options.cache("dropDownOptions"),{visible:this.option("opened")})},_listOptions(){var r=this.option("selectedItemKey"),e=this.option("useSelectMode");return{selectionMode:e?"single":"none",wrapItemText:this.option("wrapItemText"),focusStateEnabled:this.option("focusStateEnabled"),hoverStateEnabled:this.option("hoverStateEnabled"),useItemTextAsTitle:this.option("useItemTextAsTitle"),onContentReady:()=>this._fireContentReadyAction(),selectedItemKeys:_(r)&&e?[r]:[],grouped:this.option("grouped"),groupTemplate:this.option("groupTemplate"),keyExpr:this._getKey(),noDataText:this.option("noDataText"),displayExpr:this.option("displayExpr"),itemTemplate:this.option("itemTemplate"),items:this.option("items"),dataSource:this._dataSource,onItemClick:t=>{this.option("useSelectMode")||(this._lastSelectedItemData=t.itemData),this.option("selectedItemKey",this._keyGetter(t.itemData));var i=this._fireItemClickAction(t);i!==!1&&(this.toggle(!1),this._buttonGroup.focus())}}},_upDownKeyHandler(){return this._popup&&this._popup.option("visible")&&this._list?this._list.focus():this.open(),!0},_escHandler(){return this.close(),this._buttonGroup.focus(),!0},_tabHandler(){return this.close(),!0},_renderPopup(){var r=m("<div>");this.$element().append(r),this._popup=this._createComponent(r,vt,this._popupOptions()),this._popup.$content().addClass(px),this._popup.$wrapper().addClass(vx),this._popup.on("hiding",this._popupHidingHandler.bind(this)),this._popup.on("showing",this._popupShowingHandler.bind(this)),this._bindInnerWidgetOptions(this._popup,"dropDownOptions")},_popupHidingHandler(){this.option("opened",!1),this._updateAriaAttributes(!1)},_popupOptionChanged:function(r){var e=dr.getOptionsFromContainer(r);this._setPopupOption(e);var t=Object.keys(e);(t.indexOf("width")!==-1||t.indexOf("height")!==-1)&&this._dimensionChanged()},_dimensionChanged:function(){var r=vh(this.option("dropDownOptions.width"));r===void 0&&this._setPopupOption("width",()=>Bn(this.$element()))},_setPopupOption:function(r,e){this._setWidgetOption("_popup",arguments)},_popupShowingHandler(){this.option("opened",!0),this._updateAriaAttributes(!0)},_setElementAria(r){var e={owns:r?this._popupContentId:void 0};this.setAria(e,this.$element())},_setButtonsAria(r){var e={expanded:r,haspopup:"listbox"},t={};this.option("text")||(t.label="dropdownbutton"),this._getButtons().each((i,a)=>{i===0?this.setAria(L({},t,e),m(a)):this.setAria(e,m(a))})},_updateAriaAttributes(r){this._setElementAria(r),this._setButtonsAria(r)},_getButtons(){return this._buttonGroup.$element().find(".".concat(mx))},_renderButtonGroup(){var r=this._buttonGroup&&this._buttonGroup.$element()||m("<div>");this._buttonGroup||this.$element().append(r),this._buttonGroup=this._createComponent(r,Sn,this._buttonGroupOptions()),this._buttonGroup.registerKeyHandler("downArrow",this._upDownKeyHandler.bind(this)),this._buttonGroup.registerKeyHandler("tab",this._tabHandler.bind(this)),this._buttonGroup.registerKeyHandler("upArrow",this._upDownKeyHandler.bind(this)),this._buttonGroup.registerKeyHandler("escape",this._escHandler.bind(this)),this._bindInnerWidgetOptions(this._buttonGroup,"buttonGroupOptions"),this._updateAriaAttributes(this.option("opened"))},_updateArrowClass(){var r=this.option("splitButton")||this.option("showArrowIcon");this.$element().toggleClass(gx,r)},toggle(r){return this._popup||(this._renderPopup(),this._renderContent()),this._popup.toggle(r)},open(){return this.toggle(!0)},close(){return this.toggle(!1)},_setListOption(r,e){this._list&&this._list.option(r,e)},_getDisplayValue(r){var e=!He(r),t=e?r:this._displayGetter(r);return He(t)?"":String(Da(t,""))},_updateActionButton(r){this.option("useSelectMode")&&this.option({text:this._getDisplayValue(r),icon:He(r)?r.icon:void 0}),this._setOptionWithoutOptionChange("selectedItem",r),this._setOptionWithoutOptionChange("selectedItemKey",this._keyGetter(r))},_clean(){this._list&&this._list.$element().remove(),this._popup&&this._popup.$element().remove()},_selectedItemKeyChanged(r){this._setListOption("selectedItemKeys",this.option("useSelectMode")&&_(r)?[r]:[]);var e=this.option("selectedItem");this._loadSelectedItem().done(t=>{this._updateActionButton(t),this._displayGetter(e)!==this._displayGetter(t)&&this._fireSelectionChangedAction({previousValue:e,value:t})})},_updateButtonGroup(r,e){this._buttonGroup.option(r,e),this._updateAriaAttributes(this.option("opened"))},_actionButtonOptionChanged(r){var{name:e,value:t}=r,i={};i[e]=t,this._updateButtonGroup("items[0]",S({},this._actionButtonConfig(),i)),this._popup&&this._popup.repaint()},_selectModeChanged(r){if(r){this._setListOption("selectionMode","single");var e=this.option("selectedItemKey");this._setListOption("selectedItemKeys",_(e)?[e]:[]),this._selectedItemKeyChanged(this.option("selectedItemKey"))}else this._setListOption("selectionMode","none"),this.option({selectedItemKey:void 0,selectedItem:void 0}),this._actionButtonOptionChanged({text:this.option("text")})},_updateItemCollection(r){var e=this.option("selectedItemKey");this._setListOption("selectedItem",null),this._setWidgetOption("_list",[r]),_(e)&&this._loadSelectedItem().done(t=>{this._setListOption("selectedItemKeys",[e]),this._setListOption("selectedItem",t)}).fail(t=>{this._setListOption("selectedItemKeys",[])}).always(this._updateActionButton.bind(this))},_updateDataSource:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._dataSource.items();this._dataSource=void 0,this._itemsToDataSource(r),this._updateKeyExpr()},_updateKeyExpr:function(){this._compileKeyGetter(),this._setListOption("keyExpr",this._getKey())},focus:function(){this._buttonGroup.focus()},_optionChanged(r){var e,{name:t,value:i}=r;switch(t){case"useSelectMode":this._selectModeChanged(i);break;case"splitButton":this._updateArrowClass(),this._renderButtonGroup();break;case"displayExpr":this._compileDisplayGetter(),this._setListOption(t,i),this._updateActionButton(this.option("selectedItem"));break;case"keyExpr":this._updateDataSource();break;case"buttonGroupOptions":this._innerWidgetOptionChanged(this._buttonGroup,r);break;case"dropDownOptions":if(r.fullName==="dropDownOptions.visible")break;r.value.visible!==void 0&&delete r.value.visible,this._popupOptionChanged(r),this._innerWidgetOptionChanged(this._popup,r);break;case"opened":this.toggle(i);break;case"focusStateEnabled":case"hoverStateEnabled":this._setListOption(t,i),this._updateButtonGroup(t,i),this.callBase(r);break;case"items":this._updateDataSource(this.option("items")),this._updateItemCollection(t);break;case"dataSource":Array.isArray(i)?this._updateDataSource(this.option("dataSource")):(this._initDataSource(),this._updateKeyExpr()),this._updateItemCollection(t);break;case"icon":case"text":this._actionButtonOptionChanged(r);break;case"showArrowIcon":this._updateArrowClass(),this._renderButtonGroup(),this._popup&&this._popup.repaint();break;case"width":case"height":this.callBase(r),(e=this._popup)===null||e===void 0||e.repaint();break;case"stylingMode":this._updateButtonGroup(t,i);break;case"itemTemplate":case"grouped":case"noDataText":case"groupTemplate":case"wrapItemText":case"useItemTextAsTitle":this._setListOption(t,i);break;case"dropDownContentTemplate":this._renderContent();break;case"selectedItemKey":this._selectedItemKeyChanged(i);break;case"selectedItem":break;case"onItemClick":this._createItemClickAction();break;case"onButtonClick":this._createActionClickAction();break;case"onSelectionChanged":this._createSelectionChangedAction();break;case"deferRendering":this.toggle(this.option("opened"));break;case"tabIndex":this._updateButtonGroup(t,i);break;default:this.callBase(r)}}}).include(El);_r("dxDropDownButton",Bu);const iy=Object.freeze(Object.defineProperty({__proto__:null,default:Bu},Symbol.toStringTag,{value:"Module"}));function wx(r,e){for(var t=u=>u||1,i=[],a=(r[0]||[]).reduce((u,h)=>u+t(h.colspan),0),n=(u=>{var h=0,c=0;return()=>{var p=u[h]||[],g=p[c++];return c>=p.length&&(h++,c=0),g&&(g.colspan=t(g.colspan),g.rowspan=t(g.rowspan)),g}})(r),o=(u,h,c)=>{var p=i[u]=i[u]||[];if(p[h]=c,c.colspan>1||c.rowspan>1){for(var g=(w=>S({},w,e))(c),v=1;v<c.colspan;v++)o(u,h+v,g);for(var f=1;f<c.rowspan;f++)for(var C=0;C<c.colspan;C++)o(u+f,h+C,g)}},s=n(),l=0;s;){for(var d=0;d<a&&s;d++)i[l]&&i[l][d]||(o(l,d,s),d+=s.colspan-1,s=n());l++}return i}var xx="dx-datagrid-export-menu",cl="dx-datagrid-export-button",yx="exportButton",pl="export",Ex="xlsxfile",Sx="exportselected",bx="pdffile";class Ix{constructor(e,t,i){this._exportController=e,this._initialColumnWidthsByColumnIndex=t,this._selectedRowsOnly=i}_getGroupValue(e){var{key:t,data:i,rowType:a,groupIndex:n,summaryCells:o}=e,s=this._options.groupColumns[n],l=A.getDisplayValue(s,s.deserializeValue?s.deserializeValue(t[n]):t[n],i,a),d="".concat(s.caption,": ").concat(A.formatValue(l,s));return o&&o[0]&&o[0].length&&(d+=" ".concat(A.getGroupRowSummaryText(o[0],this._options.summaryTexts))),d}_correctCellIndex(e){return e}_initOptions(){var e=this._exportController,t=e._columnsController.getGroupColumns();this._options={columns:e._getColumns(this._initialColumnWidthsByColumnIndex),groupColumns:t,items:this._selectedRowsOnly||e._selectionOnly?e._getSelectedItems():e._getAllItems(),isHeadersVisible:e.option("showColumnHeaders"),summaryTexts:e.option("summary.texts"),rtlEnabled:e.option("rtlEnabled")}}getHeaderStyles(){return[{bold:!0,alignment:"center"},{bold:!0,alignment:"left"},{bold:!0,alignment:"right"}]}getGroupRowStyle(){return{bold:!0,alignment:Bt(this._options.rtlEnabled)}}getColumnStyles(){var e=[];return this.getColumns().forEach(t=>{e.push({alignment:t.alignment||"left",format:t.format,dataType:t.dataType})}),e}getStyles(){return[...this.getHeaderStyles(),...this.getColumnStyles(),this.getGroupRowStyle()]}_getTotalCellStyleId(e){var t,i=((t=this.getColumns()[e])===null||t===void 0?void 0:t.alignment)||"right";return this.getHeaderStyles().map(a=>a.alignment).indexOf(i)}getStyleId(e,t){return e<this.getHeaderRowCount()?0:this.isTotalCell(e-this.getHeaderRowCount(),t)?this._getTotalCellStyleId(t):this.isGroupRow(e-this.getHeaderRowCount())?this.getHeaderStyles().length+this.getColumns().length:t+this.getHeaderStyles().length}getColumns(e){var{columns:t}=this._options;return e?t:t[t.length-1]}getColumnsWidths(){var e=this.getColumns();return _(e)?e.map(t=>t.width):void 0}getRowsCount(){return this._options.items.length+this.getHeaderRowCount()}getHeaderRowCount(){return this.isHeadersVisible()?this._options.columns.length-1:0}isGroupRow(e){return e<this._options.items.length&&this._options.items[e].rowType==="group"}getGroupLevel(e){var t=this._options.items[e-this.getHeaderRowCount()],i=t&&t.groupIndex;return t&&t.rowType==="totalFooter"?0:_(i)?i:this._options.groupColumns.length}getCellType(e,t){var i=this.getColumns();if(e<this.getHeaderRowCount())return"string";if(e-=this.getHeaderRowCount(),t<i.length){var a=this._options.items.length&&this._options.items[e],n=i[t];return a&&a.rowType==="data"&&isFinite(a.values[this._correctCellIndex(t)])&&!_(n.customizeText)?_(n.lookup)?n.lookup.dataType:n.dataType:"string"}}ready(){this._initOptions();var e=this._options;return P(e.items).done(t=>{e.items=t}).fail(()=>{e.items=[]})}_convertFromGridGroupSummaryItems(e){if(_(e)&&e.length>0)return e.map(t=>({value:t.value,name:t.name}))}getCellData(e,t,i){var a,n,o={cellSourceData:{},value:a},s=this.getColumns(),l=this._correctCellIndex(t);if(e<this.getHeaderRowCount()){var d=this.getColumns(!0)[e];n=d[t],o.cellSourceData.rowType="header",o.cellSourceData.column=n&&n.gridColumn,o.value=n&&n.caption}else{e-=this.getHeaderRowCount();var u=this._options.items.length&&this._options.items[e];if(u){var h=u.values;switch(o.cellSourceData.rowType=u.rowType,o.cellSourceData.column=s[t]&&s[t].gridColumn,u.rowType){case"groupFooter":case"totalFooter":l<h.length&&(a=h[l],_(a)?(o.cellSourceData.value=a.value,o.cellSourceData.totalSummaryItemName=a.name,o.value=A.getSummaryText(a,this._options.summaryTexts)):o.cellSourceData.value=void 0);break;case"group":if(o.cellSourceData.groupIndex=u.groupIndex,t<1)o.cellSourceData.column=this._options.groupColumns[u.groupIndex],o.cellSourceData.value=u.key[u.groupIndex],o.cellSourceData.groupSummaryItems=this._convertFromGridGroupSummaryItems(u.summaryCells[0]),o.value=this._getGroupValue(u);else{var c=u.values[l];if(Array.isArray(c)){o.cellSourceData.groupSummaryItems=this._convertFromGridGroupSummaryItems(c),a="";for(var p=0;p<c.length;p++)a+=(p>0?i?`
`:` 
 `:"")+A.getSummaryText(c[p],this._options.summaryTexts);o.value=a}else o.cellSourceData.value=void 0}break;default:if(n=s[t],n){var g=h[l],v=A.getDisplayValue(n,g,u.data,u.rowType);!isFinite(v)||_(n.customizeText)?i&&_(n.customizeText)&&n.customizeText===this._exportController._columnsController.getCustomizeTextByDataType("boolean")?o.value=v:o.value=A.formatValue(v,n):o.value=v,o.cellSourceData.value=g}o.cellSourceData.data=u.data}}}return o}isHeadersVisible(){return this._options.isHeadersVisible}isTotalCell(e,t){var{items:i}=this._options,a=i[e],n=this._correctCellIndex(t),o=a.summaryCells&&a.summaryCells[n]&&a.summaryCells[n].length>0&&a.summaryCells[n][0].alignByColumn;return a&&a.rowType==="groupFooter"||a.rowType==="totalFooter"||o}getCellMerging(e,t){var{columns:i}=this._options,a=i[e]&&i[e][t];return a?{colspan:(a.exportColspan||1)-1,rowspan:(a.rowspan||1)-1}:{colspan:0,rowspan:0}}getFrozenArea(){return{x:0,y:this.getHeaderRowCount()}}}class Tx extends A.ViewController{_getEmptyCell(){return{caption:"",colspan:1,rowspan:1}}_updateColumnWidth(e,t){e.width=t}_getColumns(e){var t=[],i,a,n=this._columnsController,o=n.getRowCount();for(i=0;i<=o;i++){var s=[];a=n.getVisibleColumns(i,!0);var l=void 0;if(i===o)if(this._updateLockCount)l=e;else{var d=this._getColumnWidths(this._headersView,this._rowsView);if(d&&d.length){l={};for(var u=0;u<a.length;u++)l[a[u].index]=d[u]}}for(var h=0;h<a.length;h++){var c=S({},a[h],{dataType:a[h].dataType==="datetime"?"date":a[h].dataType,gridColumn:a[h]});if(this._needColumnExporting(c)){var p=this._calculateExportColspan(c);_(p)&&(c.exportColspan=p),l&&this._updateColumnWidth(c,l[c.index]),s.push(c)}}t.push(s)}return a=t[o],t=wx(t.slice(0,-1),this._getEmptyCell()),t.push(a),t}_calculateExportColspan(e){if(e.isBand){var t=this._columnsController.getChildrenByBandColumn(e.index,!0);if(_(t))return t.reduce((i,a)=>this._needColumnExporting(a)?i+(this._calculateExportColspan(a)||1):i,0)}}_needColumnExporting(e){return!e.command&&(e.allowExporting||e.allowExporting===void 0)}_getFooterSummaryItems(e,t){var i=[],a=1,n=0;do{for(var o=[],s=0;s<e.length;s++){var l=e[s],d=l.length;a<d&&(a=d),o.push(l[n])}i.push({values:o,rowType:t?"totalFooter":"groupFooter"})}while(n++<a-1);return i}_hasSummaryGroupFooters(){var e=this.option("summary.groupItems");if(_(e)){for(var t=0;t<e.length;t++)if(e[t].showInGroupFooter)return!0}return!1}_getItemsWithSummaryGroupFooters(e){for(var t=[],i=[],a=[],n=0;n<e.length;n++){var o=e[n];o.rowType==="groupFooter"?(a=this._getFooterSummaryItems(o.summaryCells),t=t.concat(i,a),i=[]):i.push(o)}return t.length?t:i}_updateGroupValuesWithSummaryByColumn(e){for(var t=[],i=0;i<e.length;i++){var a=e[i],{summaryCells:n}=a;if(a.rowType==="group"&&n&&n.length>1){for(var o=a.values.length,s=1;s<n.length;s++)for(var l=0;l<n[s].length;l++){var d=n[s][l];d&&d.alignByColumn&&(Array.isArray(t[s-o])||(t[s-o]=[]),t[s-o].push(d))}t.length>0&&(a.values.push(...t),t=[])}}}_processUnExportedItems(e){for(var t=this._columnsController.getVisibleColumns(null,!0),i=this._columnsController.getGroupColumns(),a,n,o=0;o<e.length;o++){var s=e[o],l=!1;a=[],n=[];for(var d=0;d<t.length;d++){var u=t[d];if(l||(l=["detailExpand","buttons"].includes(u.type)),this._needColumnExporting(u)&&(s.values&&(s.rowType==="group"&&!a.length?a.push(s.key[s.groupIndex]):a.push(s.values[d])),s.summaryCells))if(s.rowType==="group"&&!n.length){var h=d-i.length+s.groupIndex;n.push(s.summaryCells[l?h:h+1])}else n.push(s.summaryCells[d])}a.length&&(s.values=a),n.length&&(s.summaryCells=n)}}_getAllItems(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this,a=new O,n=this.getController("data"),o=n.footerItems(),s=o.length&&o[0],l=i.option("summary.totalItems"),d;return P(e).done(u=>{n.loadAll(u,t).done((h,c)=>{i._updateGroupValuesWithSummaryByColumn(h),i._hasSummaryGroupFooters()&&(h=i._getItemsWithSummaryGroupFooters(h)),d=s&&s.summaryCells,_(c)&&l&&(d=i._getSummaryCells(l,c));var p=s&&i._getFooterSummaryItems(d,!0);p&&(h=h.concat(p)),i._processUnExportedItems(h),a.resolve(h)}).fail(a.reject)}).fail(a.reject),a}_getSummaryCells(e,t){var i=this.getController("data"),a=i._columnsController;return i._calculateSummaryCells(e,t,a.getVisibleColumns(null,!0),(n,o)=>i._isDataColumn(o)?o.index:-1)}_getSelectedItems(){var e=this.getController("selection");return this.needLoadItemsOnExportingSelectedItems()?this._getAllItems(e.loadSelectedItemsWithFilter(),!0):this._getAllItems(e.getSelectedRowsData())}_getColumnWidths(e,t){return e&&e.isVisible()?e.getColumnWidths():t.getColumnWidths()}throwWarningIfNoOnExportingEvent(){var e,t,i=(t=(e=this.component).hasActionSubscription)===null||t===void 0?void 0:t.call(e,"onExporting");this.option("export.enabled")&&!i&&q.log("W1024")}init(){this.throwWarningIfNoOnExportingEvent(),this._columnsController=this.getController("columns"),this._rowsView=this.getView("rowsView"),this._headersView=this.getView("columnHeadersView"),this.createAction("onExporting",{excludeValidators:["disabled","readOnly"]})}callbackNames(){return["selectionOnlyChanged"]}getDataProvider(e){var t=this._getColumnWidths(this._headersView,this._rowsView),i;if(t&&t.length){i={};for(var a=this._columnsController.getVisibleColumns(this._columnsController.getRowCount(),!0),n=0;n<a.length;n++)i[a[n].index]=t[n]}return new Ix(this,i,e)}exportTo(e,t){this._selectionOnly=e;var i=this.getAction("onExporting"),a={rtlEnabled:this.option("rtlEnabled"),selectedRowsOnly:!!e,format:t,fileName:"DataGrid",cancel:!1};H(i)&&i(a)}publicMethods(){return["getDataProvider"]}selectionOnly(e){if(_(e))this._isSelectedRows=e,this.selectionOnlyChanged.fire();else return this._isSelectedRows}optionChanged(e){super.optionChanged(e),e.name==="export"&&this.throwWarningIfNoOnExportingEvent()}needLoadItemsOnExportingSelectedItems(){var e;return(e=this.option("loadItemsOnExportingSelectedItems"))!==null&&e!==void 0?e:this.getController("data")._dataSource.remoteOperations().filtering}}A.registerModule("export",{defaultOptions:()=>({export:{enabled:!1,fileName:"DataGrid",formats:["xlsx"],allowExportSelectedData:!1,texts:{exportTo:y.format("dxDataGrid-exportTo"),exportAll:y.format("dxDataGrid-exportAll"),exportSelectedRows:y.format("dxDataGrid-exportSelectedRows")}}}),controllers:{export:Tx},extenders:{controllers:{editing:{callbackNames(){var r=this.callBase();return _(r)?r.push("editingButtonsUpdated"):["editingButtonsUpdated"]},_updateEditButtons(){this.callBase(),this.editingButtonsUpdated.fire()}}},views:{headerPanel:{_getToolbarItems(){var r=this.callBase(),e=this._getExportToolbarButton();return e&&(r.push(e),this._correctItemsPosition(r)),r},_getExportToolbarButton(){var r=this._getExportToolbarItems();if(r.length===0)return null;var e=this._needDisableExportButton(),t={name:yx,location:"after",locateInMenu:"auto",sortIndex:30,options:{items:r},disabled:e};if(r.length===1){var i=L(L({},r[0]),{hint:r[0].text,elementAttr:{class:cl}});t.widget="dxButton",t.showText="inMenu",t.options=i}else{var a={icon:pl,displayExpr:"text",items:r,hint:this.option("export.texts.exportTo"),elementAttr:{class:cl},dropDownOptions:{width:"auto",_wrapperClassExternal:xx}};t.options=a,t.widget="dxDropDownButton",t.menuItemTemplate=(n,o,s)=>{this._createComponent(m(s),an,{items:r})}}return t},_getExportToolbarItems(){var r,e=this.option("export"),t=this.option("export.texts"),i=(r=this.option("export.formats"))!==null&&r!==void 0?r:[];if(!e.enabled)return[];var a=[];return i.forEach(n=>{var o=n.toUpperCase(),s=pl,l=Sx;n==="xlsx"&&(o="Excel",s=Ex),n==="pdf"&&(s=bx),a.push({text:At(t.exportAll,o),icon:s,onClick:()=>{this._exportController.exportTo(!1,n)}}),e.allowExportSelectedData&&a.push({text:At(t.exportSelectedRows,o),icon:l,onClick:()=>{this._exportController.exportTo(!0,n)}})}),a},_correctItemsPosition(r){r.sort((e,t)=>e.sortIndex-t.sortIndex)},_isExportButtonVisible(){return this.option("export.enabled")},optionChanged(r){this.callBase(r),r.name==="export"&&(r.handled=!0,this._invalidate())},_needDisableExportButton(){var r=!this._columnsController.hasVisibleDataColumns(),e=this._editingController.hasChanges();return r||e},_columnOptionChanged(r){this.callBase(r);var e=A.checkChanges(r.optionNames,["groupIndex","visible","all"]);if(e){var t=this._needDisableExportButton();this.setToolbarItemDisabled("exportButton",t)}},init(){this.callBase(),this._exportController=this.getController("export"),this._editingController=this.getController("editing"),this._editingController.editingButtonsUpdated.add(()=>{var r=this._needDisableExportButton();this.setToolbarItemDisabled("exportButton",r)})},isVisible(){return this.callBase()||this._isExportButtonVisible()}}}}});var Rx=(r,e,t)=>{var{isRemoteFiltering:i,dateSerializationFormat:a,getSelector:n}=t,{selector:o}=r,s=H(o)?o:n(o),l=s?s(e):e[o],d=i&&oi(l)?di.serializeDate(l,a):l;return{getter:s,rawValue:l,safeValue:d}},Ox={getSortFilterValue:Rx},mr="dx-row-focused",Ax=".dx-row.".concat(mr),Dx="table",gl="dx-cell-focus-disabled",Vx=W.ViewController.inherit(function(){var r={init(){this._dataController=this.getController("data"),this._keyboardController=this.getController("keyboardNavigation"),this.component._optionsByReference.focusedRowKey=!0},optionChanged(e){var{name:t,value:i,previousValue:a}=e;switch(t){case"focusedRowIndex":this._focusRowByIndex(i),this._keyboardController._fireFocusedRowChanged(),e.handled=!0;break;case"focusedRowKey":if(Array.isArray(i)&&JSON.stringify(i)===JSON.stringify(a))return;this._focusRowByKey(i),this._keyboardController._fireFocusedRowChanged(),e.handled=!0;break;case"focusedColumnIndex":case"focusedRowEnabled":case"autoNavigateToFocusedRow":e.handled=!0;break;default:this.callBase(e)}},isAutoNavigateToFocusedRow(){return this.option("scrolling.mode")!=="infinite"&&this.option("autoNavigateToFocusedRow")},_focusRowByIndex(e,t){this.option("focusedRowEnabled")&&(e=e!==void 0?e:this.option("focusedRowIndex"),e<0?this.isAutoNavigateToFocusedRow()&&this._resetFocusedRow():this._focusRowByIndexCore(e,t))},_focusRowByIndexCore(e,t){var i=this.getController("data"),a=i.pageSize(),n=()=>{if(this._isValidFocusedRowIndex(e)){var s=e-i.getRowIndexOffset(!0);if(!t||t.paging&&!t.filtering){var l=i._getLastItemIndex();s=Math.min(s,l)}var d=i.getKeyByRowIndex(s,!0);_(d)&&!this.isRowFocused(d)&&this.option("focusedRowKey",d)}};if(a>=0)if(this._isLocalRowIndex(e))n();else{var o=Math.floor(e/i.pageSize());P(i.pageIndex(o),i.waitReady()).done(()=>{n()})}},_isLocalRowIndex(e){var t=this.getController("data"),i=this.getController("keyboardNavigation")._isVirtualScrolling();if(i){var a=Math.floor(e/t.pageSize()),n=t.virtualItemsCount(),o=n?n.begin:-1,s=t.getVisibleRows().length+t.getRowIndexOffset(),l=Math.ceil(s/t.pageSize());return o<=e&&l>a}return!0},_setFocusedRowKeyByIndex(e){var t=this.getController("data");if(this._isValidFocusedRowIndex(e)){var i=Math.min(e-t.getRowIndexOffset(),t.items().length-1),a=t.getKeyByRowIndex(i);_(a)&&!this.isRowFocused(a)&&this.option("focusedRowKey",a)}},_focusRowByKey(e){_(e)?this._navigateToRow(e,!0):this._resetFocusedRow()},_resetFocusedRow(){var e=this.option("focusedRowKey"),t=_(e);if(!(!t&&this.option("focusedRowIndex")<0)){var i=this.getController("keyboardNavigation");t&&this.option("focusedRowKey",null),i.setFocusedRowIndex(-1),this.option("focusedRowIndex",-1),this.getController("data").updateItems({changeType:"updateFocusedRow",focusedRowKey:null}),i._fireFocusedRowChanged(void 0,-1)}},_isValidFocusedRowIndex(e){var t=this.getController("data"),i=t.getVisibleRows()[e];return!i||i.rowType==="data"||i.rowType==="group"},publicMethods:()=>["navigateToRow","isRowFocused"],navigateToRow(e){return this.isAutoNavigateToFocusedRow()||this.option("focusedRowIndex",-1),this._navigateToRow(e)},_navigateToRow(e,t){var i=this,a=i.getController("data"),n=i.isAutoNavigateToFocusedRow(),o=new O;if(e===void 0||!a.dataSource())return o.reject().promise();var s=i.getFocusedRowIndexByKey(e);return!n&&t||s>=0?i._navigateTo(e,o,t):a.getPageIndexByKey(e).done(l=>{if(l<0){o.resolve(-1);return}l===a.pageIndex()?a.reload().done(()=>{i.isRowFocused(e)&&a.getRowIndexByKey(e)>=0?o.resolve(i.getFocusedRowIndexByKey(e)):i._navigateTo(e,o,t)}).fail(o.reject):a.pageIndex(l).done(()=>{i._navigateTo(e,o,t)}).fail(o.reject)}).fail(o.reject),o.promise()},_navigateTo(e,t,i){var a=this.getController("data").getRowIndexByKey(e),n=I.isVirtualRowRendering(this),o=this.isAutoNavigateToFocusedRow();o&&n&&a<0?this._navigateToVirtualRow(e,t,i):this._navigateToVisibleRow(e,t,i)},_navigateToVisibleRow(e,t,i){if(i)this._triggerUpdateFocusedRow(e,t);else{var a=this.getFocusedRowIndexByKey(e);this.getView("rowsView").scrollToRowElement(e,t).done(()=>{t.resolve(a)})}},_navigateToVirtualRow(e,t,i){var a=this.getController("data"),n=a._rowsScrollController,o=I.getIndexByKey(e,a.items(!0)),s=this.getView("rowsView").getScrollable();if(n&&s&&o>=0){var l=o+a.getRowIndexOffset(!0),d=n.getItemOffset(l),u=()=>{a.totalCount()&&!a.items().length||(this.component.off("contentReady",u),i?this._triggerUpdateFocusedRow(e,t):t.resolve(l))};this.component.on("contentReady",u),this.getView("rowsView").scrollTopPosition(d)}else t.resolve(-1)},_triggerUpdateFocusedRow(e,t){var i=this.getController("data"),a=this.getFocusedRowIndexByKey(e);if(this._isValidFocusedRowIndex(a)){var n;this.option("focusedRowEnabled")?i.updateItems({changeType:"updateFocusedRow",focusedRowKey:e}):n=this.getView("rowsView").scrollToRowElement(e),P(n).done(()=>{this.getController("keyboardNavigation").setFocusedRowIndex(a),t&&t.resolve(a)})}else t&&t.resolve(-1)},getFocusedRowIndexByKey(e){var t=this.getController("data"),i=t.getRowIndexByKey(e,!0);return i>=0?i+t.getRowIndexOffset(!0):-1},_focusRowByKeyOrIndex(){var e=this.option("focusedRowKey"),t=this.option("focusedRowIndex"),i=this.getController("keyboardNavigation"),a=this.getController("data");if(_(e)){var n=a.getRowIndexByKey(e);n>=0?(i._isVirtualScrolling()&&(t=n+a.getRowIndexOffset()),i.setFocusedRowIndex(t),this._triggerUpdateFocusedRow(e)):this._navigateToRow(e,!0).done(o=>{t>=0&&o<0?this._focusRowByIndex():t<0&&o>=0&&i.setFocusedRowIndex(o)})}else t>=0&&this.getController("focus")._focusRowByIndex(t)},isRowFocused(e){var t=this.option("focusedRowKey");if(_(t))return U(e,this.option("focusedRowKey"))},updateFocusedRow(e){var{focusedRowKey:t}=e,i=this,a=i._dataController.getRowIndexByKey(t),n=i.getView("rowsView"),o,s;T(n.getTableElements(),(l,d)=>{var u=l===0;o=m(d),i._clearPreviousFocusedRow(o,a);var h=i._prepareFocusedRow({changedItem:i._dataController.getVisibleRows()[a],$tableElement:o,focusedRowIndex:a});u&&(s=h)}),s&&n.scrollToElementVertically(s)},_clearPreviousFocusedRow(e,t){var i=e.find(Ax).filter((n,o)=>{var s=m(o).closest(".".concat(this.addWidgetPrefix(Dx)));return e.is(s)});if(i.removeClass(mr).removeClass(gl).removeAttr("tabindex"),i.children("td").removeAttr("tabindex"),t!==0){var a=m(this.getView("rowsView").getRowElement(0));a.removeClass(gl).removeAttr("tabIndex")}},_prepareFocusedRow(e){var t,{changedItem:i}=e;if(i&&(i.rowType==="data"||i.rowType==="group")){var{focusedRowIndex:a}=e,{$tableElement:n}=e,o=this.option("tabindex")||0,s=this.getView("rowsView");t=m(s._getRowElements(n).eq(a)),t.addClass(mr).attr("tabindex",o)}return t}};return r}()),vl={defaultOptions:()=>({focusedRowEnabled:!1,autoNavigateToFocusedRow:!0,focusedRowKey:null,focusedRowIndex:-1,focusedColumnIndex:-1}),controllers:{focus:Vx},extenders:{controllers:{keyboardNavigation:{init(){var r=this.option("focusedRowIndex"),e=this.option("focusedColumnIndex");this.createAction("onFocusedRowChanging",{excludeValidators:["disabled","readOnly"]}),this.createAction("onFocusedRowChanged",{excludeValidators:["disabled","readOnly"]}),this.createAction("onFocusedCellChanging",{excludeValidators:["disabled","readOnly"]}),this.createAction("onFocusedCellChanged",{excludeValidators:["disabled","readOnly"]}),this.callBase(),this.setRowFocusType(),this._focusedCellPosition={},_(r)&&r>=0&&(this._focusedCellPosition.rowIndex=r),_(e)&&e>=0&&(this._focusedCellPosition.columnIndex=e)},setFocusedRowIndex(r){this.callBase(r),this.option("focusedRowIndex",r)},setFocusedColumnIndex(r){this.callBase(r),this.option("focusedColumnIndex",r)},_escapeKeyHandler(r,e){if(e||!this.option("focusedRowEnabled")){this.callBase(r,e);return}this.isCellFocusType()&&(this.setRowFocusType(),this._focus(this._getCellElementFromTarget(r.originalEvent.target),!0))},_updateFocusedCellPosition(r,e){var t=this.callBase(r,e);t&&t.columnIndex>=0&&this._fireFocusedCellChanged(r)}},editorFactory:{renderFocusOverlay(r,e){var t=this.getController("keyboardNavigation"),i=this.option("focusedRowEnabled"),a=this.getController("editing"),n;if(!i||!(t!=null&&t.isRowFocusType())||a.isEditing())this.callBase(r,e);else if(i){var o=t._getElementType(r)==="row";o&&!r.hasClass(mr)&&(n=t.getFirstValidCellInRow(r),t.focus(n))}}},columns:{getSortDataSourceParameters(r,e){var t=this.callBase.apply(this,arguments),i=this.getController("data"),a=i._dataSource,n=i.store(),o=n&&n.key(),s=a&&a.remoteOperations()||{},l=Object.keys(s).every(u=>!s[u]);if(o&&(this.option("focusedRowEnabled")&&this.getController("focus").isAutoNavigateToFocusedRow()!==!1||e)){o=Array.isArray(o)?o:[o];var d=o.filter(u=>!this.columnOption(u,"sortOrder"));d.length&&(t=t||[],l?t.push({selector:a.getDataIndexGetter(),desc:!1}):d.forEach(u=>t.push({selector:u,desc:!1})))}return t}},data:{_applyChange(r){if(!(r&&r.changeType==="updateFocusedRow"))return this.callBase.apply(this,arguments)},_fireChanged(r){if(this.callBase(r),this.option("focusedRowEnabled")&&this._dataSource){var e=r.changeType==="update"&&r.repaintChangesOnly,t=e&&r.changeTypes&&r.changeTypes.indexOf("remove")>=0;r.changeType==="refresh"&&r.items.length||t?(this._updatePageIndexes(),this._updateFocusedRow(r)):r.changeType==="append"||r.changeType==="prepend"?this._updatePageIndexes():r.changeType==="update"&&r.repaintChangesOnly&&this._updateFocusedRow(r)}},_updatePageIndexes(){var r=this._lastRenderingPageIndex||0,e=this._rowsScrollController?this._rowsScrollController.pageIndex():0;this._lastRenderingPageIndex=e,this._isPagingByRendering=e!==r},isPagingByRendering(){return this._isPagingByRendering},_updateFocusedRow(r){var e=r.operationTypes||{},t=this.getController("focus"),{reload:i,fullReload:a,pageIndex:n,paging:o}=e,s=this.getController("keyboardNavigation"),l=s._isVirtualScrolling(),d=o&&!l,u=this.option("focusedRowKey"),h=t.isAutoNavigateToFocusedRow(),c=i&&n===!1;if(c&&!a&&_(u))t._navigateToRow(u,!0).done(w=>{w<0&&t._focusRowByIndex(void 0,e)});else if(d&&h){var p=this.getRowIndexByKey(u),g=this.option("focusedRowIndex"),v=p>=0,f=g>=0,C=g===p;f&&(C||!v)&&t._focusRowByIndex(g,e)}else d&&!h&&this.getRowIndexByKey(u)<0?this.option("focusedRowIndex",-1):e.fullReload&&t._focusRowByKeyOrIndex()},getPageIndexByKey(r){var e=this,t=new O;return e.getGlobalRowIndexByKey(r).done(i=>{t.resolve(i>=0?Math.floor(i/e.pageSize()):-1)}).fail(t.reject),t.promise()},getGlobalRowIndexByKey(r){return this._dataSource.group()?this._calculateGlobalRowIndexByGroupedData(r):this._calculateGlobalRowIndexByFlatData(r)},_calculateGlobalRowIndexByFlatData(r,e,t){var i=this,a=new O,n=i._dataSource;if(Array.isArray(r)||Yv(r))return a.resolve(-1).promise();var o=i._generateFilterByKey(r);return n.load({filter:i._concatWithCombinedFilter(o),skip:0,take:1}).done(s=>{s.length>0?(o=i._generateOperationFilterByKey(r,s[0],t),n.load({filter:i._concatWithCombinedFilter(o,e),skip:0,take:1,requireTotalCount:!0}).done((l,d)=>{a.resolve(d.totalCount)})):a.resolve(-1)}),a.promise()},_concatWithCombinedFilter(r,e){var t=this.getCombinedFilter();return I.combineFilters([r,t,e])},_generateBooleanFilter(r,e,t){var{desc:i}=t;switch(!0){case(e===!1&&i):return[r,"=",!0];case(e===!1&&!i):return[r,"=",null];case(e===!0&&!i):case(!Pn(e)&&i):return[r,"<>",e];default:return}},_generateOperationFilterByKey(r,e,t){var i=this,a=i.option("dateSerializationFormat"),n=i._dataSource.remoteOperations().filtering,o=i._generateFilterByKey(r,"<"),s=i._columnsController.getSortDataSourceParameters(!n,!0);if(t){var l=i._columnsController.getGroupDataSourceParameters(!n);l&&(s=s?l.concat(s):l)}return s&&s.slice().reverse().forEach(d=>{var{selector:u,desc:h,compare:c}=d,{getter:p,rawValue:g,safeValue:v}=Ox.getSortFilterValue(d,e,{isRemoteFiltering:n,dateSerializationFormat:a,getSelector:x=>i._columnsController.columnOption(x,"selector")});if(o=[[u,"=",v],"and",o],g===null||Pn(g)){var f=i._generateBooleanFilter(u,v,h);f&&(o=[f,"or",o])}else{var C=h?">":"<",w;c?w=x=>C==="<"?c(g,p(x))>=1:c(g,p(x))<=-1:(w=[u,C,v],h||(w=[w,"or",[u,"=",null]])),o=[w,"or",o]}}),o},_generateFilterByKey(r,e){var t=this._dataSource.key(),i=[];if(e||(e="="),Array.isArray(t))for(var a=0;a<t.length;++a){var n=r[t[a]];n&&(i.length>0&&i.push("and"),i.push([t[a],e,n]))}else i=[t,e,r];return i},_getLastItemIndex(){return this.items(!0).length-1}},editing:{_deleteRowCore(r){var e=this.callBase.apply(this,arguments),t=this.getController("data"),i=t.getKeyByRowIndex(r);e.done(()=>{var a=t.getRowIndexByKey(i),n=t.getVisibleRows();a===-1&&!n.length&&this.getController("focus")._resetFocusedRow()})}}},views:{rowsView:{_createRow(r){var e=this.callBase.apply(this,arguments);return this.option("focusedRowEnabled")&&r&&this.getController("focus").isRowFocused(r.key)&&e.addClass(mr),e},_checkRowKeys(r){if(this.callBase.apply(this,arguments),this.option("focusedRowEnabled")&&this.option("dataSource")){var e=this._dataController.store();e&&!e.key()&&this._dataController.fireError("E1042","Row focusing")}},_update(r){r.changeType==="updateFocusedRow"?this.option("focusedRowEnabled")&&this.getController("focus").updateFocusedRow(r):this.callBase(r)},updateFocusElementTabIndex(r,e){this.option("focusedRowEnabled")?this._setFocusedRowElementTabIndex(e):this.callBase(r)},_setFocusedRowElementTabIndex(r){var e=this.option("focusedRowKey"),t=this.option("tabIndex")||0,i=this._dataController,a=this._columnsController,n=i.getRowIndexByKey(e),o=this.option("focusedColumnIndex"),s=this._findRowElementForTabIndex();if(_(this._scrollToFocusOnResize)||(this._scrollToFocusOnResize=()=>{this.scrollToElementVertically(this._findRowElementForTabIndex()),this.resizeCompleted.remove(this._scrollToFocusOnResize)}),s.attr("tabIndex",t),n>=0&&!r&&(o<0&&(o=0),n+=i.getRowIndexOffset(),o+=a.getColumnIndexOffset(),this.getController("keyboardNavigation").setFocusedCellPosition(n,o),this.getController("focus").isAutoNavigateToFocusedRow())){var l=i.dataSource(),d=l&&l.operationTypes();d&&!d.paging&&!i.isPagingByRendering()&&(this.resizeCompleted.remove(this._scrollToFocusOnResize),this.resizeCompleted.add(this._scrollToFocusOnResize))}},_findRowElementForTabIndex(){var r=this.option("focusedRowKey"),e=this._dataController.getRowIndexByKey(r);return m(this.getRowElement(e>=0?e:0))},scrollToRowElement(r){var e=this.getController("data").getRowIndexByKey(r),t=m(this.getRow(e));return this.scrollToElementVertically(t)},scrollToElementVertically(r){var e=this.getScrollable();if(e&&r.length){var t=e.getScrollElementPosition(r,"vertical");return this.scrollTopPosition(t)}return new O().resolve()},scrollTopPosition(r){var e=new O,t=this.getScrollable();if(t){var i=t.scrollTop(),a=()=>{t.off("scroll",a),e.resolve()};if(r!==i)return t.on("scroll",a),this._dataController.resetFilterApplying(),t.scrollTo({top:r}),e.promise()}return e.resolve()}}}}},Fx=Number.MAX_SAFE_INTEGER||9007199254740991;A.registerModule("focus",S(!0,{},vl,{extenders:{controllers:{data:r=>class extends r.inherit(vl.extenders.controllers.data){changeRowExpand(e,t){if(this.option("focusedRowEnabled")&&Array.isArray(e)&&this.isRowExpanded(e)){var i=this.getController("keyboardNavigation");(!t||!i.isKeyboardEnabled())&&this._isFocusedRowInsideGroup(e)&&this.option("focusedRowKey",e)}return super.changeRowExpand(e,t)}_isFocusedRowInsideGroup(e){var t=this.getController("columns"),i=this.option("focusedRowKey"),a=this.getRowIndexByKey(i),n=a>=0&&this.getVisibleRows()[a],o=t.getGroupDataSourceParameters(!0);if(n)for(var s=0;s<e.length;++s){var l=de(o[s]&&o[s].selector);if(l(n.data)!==e[s])return!1}return!0}_getGroupPath(e,t){for(var i=[],a=[e];a&&a[0]&&t;){var n=a[0];n.key!==void 0&&i.push(n.key),a=n.items,t--}return i}_expandGroupByPath(e,t,i){var a=new O;return i++,e.expandRow(t.slice(0,i)).done(()=>{i===t.length?a.resolve():e._expandGroupByPath(e,t,i).done(a.resolve).fail(a.reject)}).fail(a.reject),a.promise()}_calculateGlobalRowIndexByGroupedData(e){var t=this,i=t._dataSource,a=t._generateFilterByKey(e),n=new O,o=Array.isArray(e),s=i.group();return o?n.resolve(-1).promise():i._grouping._updatePagingOptions?(i.load({filter:t._concatWithCombinedFilter(a),group:s}).done(l=>{if(!l||l.length===0||!_(l[0].key)||l[0].key===-1)return n.resolve(-1).promise();var d=t._getGroupPath(l[0],s.length);t._expandGroupByPath(t,d,0).done(()=>{t._calculateExpandedRowGlobalIndex(n,e,d,s)}).fail(n.reject)}).fail(n.reject),n.promise()):(t._calculateGlobalRowIndexByFlatData(e,null,!0).done(n.resolve).fail(n.reject),n)}_calculateExpandedRowGlobalIndex(e,t,i,a){var n=dt(i,{group:a}),o=this._dataSource,s=this.option("scrolling.mode"),l=s==="virtual"||s==="infinite",d=o.pageSize(),u;o._grouping._updatePagingOptions({skip:0,take:Fx},(h,c)=>{U(h.path,i)&&(u=c)}),this._calculateGlobalRowIndexByFlatData(t,n).done(h=>{var c,p;if(h<0){e.resolve(-1);return}var g=u%d||d;c=g+h-i.length,l?p=0:p=Math.floor(c/(d-i.length))*i.length,c=u+h+p,e.resolve(c)}).fail(e.reject)}}}}}));var Px={dragCell:"dx-drag-cell"},Tt={cellFocusDisabled:"dx-cell-focus-disabled",handleIcon:"drag-icon",commandDrag:"dx-command-drag",sortableWithoutHandle:"dx-sortable-without-handle",rowsView:"rowsview"},Bx=r=>(e,t)=>{var i=m(e);if(t.rowType==="data")return i.addClass(Tt.cellFocusDisabled),m("<span>").addClass(r(Tt.handleIcon));I.setEmptyText(i)},Lx={createHandleTemplateFunc:Bx},kx={init(){this.callBase.apply(this,arguments),this._updateHandleColumn()},_allowReordering(){var r=this.option("rowDragging");return!!(r&&(r.allowReordering||r.allowDropInsideItem||r.group))},_updateHandleColumn(){var r=this.option("rowDragging"),e=this._allowReordering(),t=this._columnsController,i=e&&r.showDragIcons;t==null||t.addCommandColumn({type:"drag",command:"drag",visibleIndex:-2,alignment:"center",elementAttr:[{name:Px.dragCell,value:""}],cssClass:Tt.commandDrag,width:"auto",cellTemplate:this._getHandleTemplate(),visible:i}),t==null||t.columnOption("type:drag","visible",i)},_renderContent(){var r=this.option("rowDragging"),e=this._allowReordering(),t=this.callBase.apply(this,arguments),i=this._isFixedTableRendering,a=i?"_sortableFixed":"_sortable",n=i?"_sortable":"_sortableFixed",o=d=>{var u;(u=this._sortableFixed)===null||u===void 0||u.$element().css("pointerEvents",d?"auto":"")},s=".dx-row:not(.dx-freespace-row):not(.dx-virtual-row):not(.dx-header-row):not(.dx-footer-row)",l=this.option("dataRowTemplate")?"> table > tbody".concat(s):"> table > tbody > ".concat(s);return(e||this[a])&&t.length&&(this[a]=this._createComponent(t,Ah,S({component:this.component,contentTemplate:null,filter:l,cursorOffset:d=>{var{event:u}=d,h=m(this.element()).offset();return{x:u.pageX-h.left}},onDraggableElementShown:d=>{if(!r.dragTemplate){var u=m(d.dragElement),h=u.children(".dx-widget").data(this.component.NAME);this._synchronizeScrollLeftPosition(h)}},dragTemplate:this._getDraggableRowTemplate(),handle:r.showDragIcons&&".".concat(Tt.commandDrag),dropFeedbackMode:"indicate"},r,{onDragStart:d=>{var u,h;(u=this.getController("keyboardNavigation"))===null||u===void 0||u._resetFocusedCell();var c=d.component.getVisibleRows()[d.fromIndex];d.itemData=c&&c.data;var p=c&&c.rowType==="data";d.cancel=!e||!p,(h=r.onDragStart)===null||h===void 0||h.call(r,d)},onDragEnter:()=>{o(!0)},onDragLeave:()=>{o(!1)},onDragEnd:d=>{var u;o(!1),(u=r.onDragEnd)===null||u===void 0||u.call(r,d)},onAdd:d=>{var u;o(!1),(u=r.onAdd)===null||u===void 0||u.call(r,d)},dropFeedbackMode:r.dropFeedbackMode,onOptionChanged:d=>{var u=this._sortableFixed;u&&(d.name==="fromIndex"||d.name==="toIndex")&&this[n].option(d.name,d.value)}})),t.toggleClass("dx-scrollable-container",i),t.toggleClass(Tt.sortableWithoutHandle,e&&!r.showDragIcons)),t},_renderCore(r){this.callBase.apply(this,arguments),r&&r.changeType==="update"&&r.repaintChangesOnly&&I.isVirtualRowRendering(this)&&xe(()=>{this._updateSortable()})},_updateSortable(){var r=this._dataController.getRowIndexOffset();[this._sortable,this._sortableFixed].forEach(e=>{e==null||e.option("offset",r),e==null||e.update()})},_resizeCore(){this.callBase.apply(this,arguments),this._updateSortable()},_getDraggableGridOptions(r){var e=this.option(),t=this.getColumns(),i=m(this.getRowElement(r.rowIndex));return{dataSource:[{id:1,parentId:0}],showBorders:!0,showColumnHeaders:!1,scrolling:{useNative:!1,showScrollbar:"never"},pager:{visible:!1},loadingTimeout:null,columnFixing:e.columnFixing,columnAutoWidth:e.columnAutoWidth,showColumnLines:e.showColumnLines,columns:t.map(a=>({width:a.width||a.visibleWidth,fixed:a.fixed,fixedPosition:a.fixedPosition})),onRowPrepared:a=>{var n=a.component.getView("rowsView");m(a.rowElement).replaceWith(i.eq(n._isFixedTableRendering?1:0).clone())}}},_synchronizeScrollLeftPosition(r){var e=r==null?void 0:r.getScrollable();e==null||e.scrollTo({x:this._scrollLeft})},_getDraggableRowTemplate(){return r=>{var e=this.component.$element(),t=m("<div>");wl(t,X(e));var i=this._dataController.items(),a=i&&i[r.fromIndex],n=this._getDraggableGridOptions(a);return this._createComponent(t,this.component.NAME,n),t.find(".dx-gridbase-container").children(":not(.".concat(this.addWidgetPrefix(Tt.rowsView),")")).hide(),t}},_getHandleTemplate(){return Lx.createHandleTemplateFunc(r=>this.addWidgetPrefix(r))},optionChanged(r){r.name==="rowDragging"&&(this._updateHandleColumn(),this._invalidate(!0,!0),r.handled=!0),this.callBase.apply(this,arguments)}},Mx={defaultOptions:()=>({rowDragging:{showDragIcons:!0,dropFeedbackMode:"indicate",allowReordering:!1,allowDropInsideItem:!1}}),extenders:{views:{rowsView:kx}}};A.registerModule("rowDragging",Mx);export{td as $,km as A,e_ as B,s_ as C,mp as D,FC as E,Jd as F,_t as G,Lw as H,rx as I,Ig as J,u_ as K,vw as L,sx as M,vl as N,Mx as O,Sn as P,pg as Q,Fu as R,Ia as S,wx as T,Uf as U,ey as V,Gh as W,Yl as X,Vd as Y,Kf as Z,gv as _,ho as a,ry as b,Gl as c,iy as d,jl as e,Ml as f,I as g,Gp as h,qp as i,ag as j,ed as k,_g as l,W as m,un as n,Qg as o,ov as p,ef as q,Ql as r,Ip as s,rf as t,nf as u,sf as v,mf as w,Rd as x,Wf as y,Zf as z};
