import{$ as a,T as L,v as N,r as R,u as I,a as p,C as M,e as h,m as K}from"./index.94f86987.js";import{Z as u,Y as S,T as v,a7 as k,U as d,ai as W}from"./entry.f47474d7.js";import{P as F,s as G,q as V}from"./ui.collection_widget.edit.95cdfece.js";import{L as U,a as q,b as z,c as X}from"./ui.popup.81669a77.js";import{s as T,C as x}from"./check_box.j.64bc2370.js";import{E as Y}from"./text_box.08b8e7e6.js";var j="dx-list-item",B="dx-list-group",C=20,Z=(1<<C)-1,y=function(e){return(e.group<<C)+e.item},f=function(e){return{group:e>>C,item:e&Z}},J=F.inherit({_groupElements:function(){return this._collectionWidget._itemContainer().find("."+B)},_groupItemElements:function(e){return e.find("."+j)},getIndexByItemData:function(e){var t=this._collectionWidget.option("items"),i=!1;return e?(e.items&&e.items.length&&(e=e.items[0]),u(t,function(r,n){if(!n.items||(u(n.items,function(l,s){return s!==e?!0:(i={group:r,item:l},!1)}),i))return!1}),i):!1},getItemDataByIndex:function(e){var t=this._collectionWidget.option("items");return S(e)?this.itemsGetter()[e]:e&&t[e.group]&&t[e.group].items[e.item]||null},itemsGetter:function(){for(var e=[],t=this._collectionWidget.option("items"),i=0;i<t.length;i++)t[i]&&t[i].items?e=e.concat(t[i].items):e.push(t[i]);return e},deleteItemAtIndex:function(e){var t=f(e),i=this._collectionWidget.option("items")[t.group].items;i.splice(t.item,1)},getKeysByItems:function(e){var t=[],i;for(i=0;i<e.length;i++)e[i]&&e[i].items?t=t.concat(e[i].items):t.push(e[i]);var r=[];for(i=0;i<t.length;i++)r.push(this._collectionWidget.keyOf(t[i]));return r},getIndexByKey:function(e,t){var i=t||this._collectionWidget.option("items"),r=-1,n=this;return u(i,function(l,s){if(s.items&&(u(s.items,function(o,c){var _=n._collectionWidget.keyOf(c);if(n._equalKeys(_,e))return r={group:l,item:o},!1}),r!==-1))return!1}),r},_getGroups:function(e){var t=this._collectionWidget._dataController,i=t.group();return i?G.queryByOptions(V(e),{group:i}).toArray():this._collectionWidget.option("items")},getItemsByKeys:function(e,t){var i=[],r=this._getGroups(t),n={},l=s=>{var o=this.getIndexByKey(s,r),c=o&&r[o.group];if(c)return{groupKey:c.key,item:c.items[o.item]}};return u(e,function(s,o){var c=l(o);if(c){var _=c.groupKey,g=c.item,m=n[_];m||(m={key:_,items:[]},n[_]=m,i.push(m)),m.items.push(g)}}),i},moveItemAtIndexToIndex:function(e,t){var i=this._collectionWidget.option("items"),r=f(e),n=f(t),l=i[r.group].items,s=i[n.group].items,o=l[r.item];l.splice(r.item,1),s.splice(n.item,0,o)},_isItemIndex:function(e){return e&&S(e.group)&&S(e.item)},_getNormalizedItemIndex:function(e){var t=a(e),i=t.closest("."+B);return i.length?y({group:this._groupElements().index(i),item:this._groupItemElements(i).index(t)}):-1},_normalizeItemIndex:function(e){return y(e)},_denormalizeItemIndex:function(e){return f(e)},_getItemByNormalizedIndex:function(e){var t=f(e),i=this._groupElements().eq(t.group);return this._groupItemElements(i).eq(t.item)},_itemsFromSameParent:function(e,t){return f(e).group===f(t).group}}),P={};function Q(e,t,i){var r=P,n={};n[e]=r[e]?r[e]:{},n[e][t]=i,v(r,n)}var w=[],E=function(e,t,i){w.push({enabled:e,decoratorType:t,decoratorSubType:i})};E(function(){return this.option("menuItems").length},function(){return"menu"},function(){return this.option("menuMode")});E(function(){return!this.option("menuItems").length&&this.option("allowItemDeleting")},function(){var e=this.option("itemDeleteMode");return e==="toggle"||e==="slideButton"||e==="swipe"||e==="static"?"delete":"menu"},function(){var e=this.option("itemDeleteMode");return e==="slideItem"&&(e="slide"),e});E(function(){return this.option("selectionMode")!=="none"&&this.option("showSelectionControls")},function(){return"selection"},function(){return"default"});E(function(){return this.option("itemDragging.allowReordering")||this.option("itemDragging.allowDropInsideItem")||this.option("itemDragging.group")},function(){return"reorder"},function(){return"default"});var ee="dx-list-item-before-bag",te="dx-list-item-after-bag",ie="beforeBag",re="afterBag",ne="modifyElement",se="afterRender",le="getExcludedSelectors",ae=k.inherit({ctor:function(e){this._list=e,this._fetchRequiredDecorators()},dispose:function(){this._decorators&&this._decorators.length&&u(this._decorators,function(e,t){t.dispose()})},_fetchRequiredDecorators:function(){this._decorators=[],u(w,(function(e,t){var i=t.enabled.call(this._list);if(i){var r=t.decoratorType.call(this._list),n=t.decoratorSubType.call(this._list),l=this._createDecorator(r,n);this._decorators.push(l)}}).bind(this))},_createDecorator:function(e,t){var i=this._findDecorator(e,t);return new i(this._list)},_findDecorator:function(e,t){var i,r=(i=P[e])===null||i===void 0?void 0:i[t];if(!r)throw L.Error("E1012",e,t);return r},modifyItemElement:function(e){var t=a(e.itemElement),i={$itemElement:t};this._prependBeforeBags(t,i),this._appendAfterBags(t,i),this._applyDecorators(ne,i)},afterItemsRendered:function(){this._applyDecorators(se)},_prependBeforeBags:function(e,t){var i=this._collectDecoratorsMarkup(ie,t,ee);e.prepend(i)},_appendAfterBags:function(e,t){var i=this._collectDecoratorsMarkup(re,t,te);e.append(i)},_collectDecoratorsMarkup:function(e,t,i){var r=a("<div>");return u(this._decorators,function(){var n=a("<div>").addClass(i);this[e](v({$container:n},t)),n.children().length&&r.append(n)}),r.children()},_applyDecorators:function(e,t){u(this._decorators,function(){this[e](t)})},_handlerExists:function(e){if(!this._decorators)return!1;for(var t=this._decorators,i=t.length,r=0;r<i;r++)if(t[r][e]!==d)return!0;return!1},_eventHandler:function(e,t,i){if(!this._decorators)return!1;for(var r=!1,n=this._decorators,l=n.length,s=0;s<l&&(r=n[s][e](t,i),!r);s++);return r},handleClick:function(e,t){return this._eventHandler("handleClick",e,t)},handleKeyboardEvents:function(e,t){return this._eventHandler("handleKeyboardEvents",e,t)},handleEnterPressing:function(e){return this._eventHandler("handleEnterPressing",e)},contextMenuHandlerExists:function(){return this._handlerExists("handleContextMenu")},handleContextMenu:function(e,t){return this._eventHandler("handleContextMenu",e,t)},getExcludedItemSelectors:function(){var e=[];return this._applyDecorators(le,e),e.join(",")}}),oe="dx-list-item-selected",de="dx-list-item-response-wait",ce=U.inherit({_supportedKeys(){var e=this,t=this.callBase(),i=(r,n)=>{var l=this._editStrategy,s=this.option("focusedElement"),o=l.getNormalizedIndex(s),c=o===this._getLastItemIndex();if(!(c&&this._dataController.isLoading()))if(r.shiftKey&&e.option("itemDragging.allowReordering")){var _=o+(n?-1:1),g=l.getItemElement(_);this.reorderItem(s,g),this.scrollToItem(s),r.preventDefault()}else{var m=this._editProvider,H=m.handleKeyboardEvents(o,n);H||(n?t.upArrow(r):t.downArrow(r))}};return v({},t,{del:r=>{e.option("allowItemDeleting")&&(r.preventDefault(),e.deleteItem(e.option("focusedElement")))},upArrow:r=>i(r,!0),downArrow:r=>i(r),enter:function(r){this._editProvider.handleEnterPressing(r)||t.enter.apply(this,arguments)},space:function(r){this._editProvider.handleEnterPressing(r)||t.space.apply(this,arguments)}})},_updateSelection(){this._editProvider.afterItemsRendered(),this.callBase()},_getLastItemIndex(){return this._itemElements().length-1},_refreshItemElements(){this.callBase();var e=this._editProvider.getExcludedItemSelectors();e.length&&(this._itemElementsCache=this._itemElementsCache.not(e))},_isItemStrictEquals:function(e,t){var i=e&&e.__dx_key__;return i&&!this.key()&&this._selection.isItemSelected(i)?!1:this.callBase(e,t)},_getDefaultOptions(){return v(this.callBase(),{showSelectionControls:!1,selectionMode:"none",selectAllMode:"page",onSelectAllValueChanged:null,selectAllText:W.format("dxList-selectAll"),menuItems:[],menuMode:"context",allowItemDeleting:!1,itemDeleteMode:"static",itemDragging:{}})},_defaultOptionsRules(){return this.callBase().concat([{device:e=>e.platform==="ios",options:{menuMode:"slide",itemDeleteMode:"slideItem"}},{device:{platform:"android"},options:{itemDeleteMode:"swipe"}}])},_init(){this.callBase(),this._initEditProvider()},_initDataSource(){this.callBase(),this._isPageSelectAll()||this._dataSource&&this._dataSource.requireTotalCount(!0)},_isPageSelectAll(){return this.option("selectAllMode")==="page"},_initEditProvider(){this._editProvider=new ae(this)},_disposeEditProvider(){this._editProvider&&this._editProvider.dispose()},_refreshEditProvider(){this._disposeEditProvider(),this._initEditProvider()},_initEditStrategy(){this.option("grouped")?this._editStrategy=new J(this):this.callBase()},_initMarkup(){this._refreshEditProvider(),this.callBase()},_renderItems(){this.callBase(...arguments),this._editProvider.afterItemsRendered()},_selectedItemClass:()=>oe,_itemResponseWaitClass:()=>de,_itemClickHandler(e){var t=a(e.currentTarget);if(!t.is(".dx-state-disabled, .dx-state-disabled *")){var i=this._editProvider.handleClick(t,e);i||(this._saveSelectionChangeEvent(e),this.callBase(...arguments))}},_shouldFireContextMenuEvent(){return this.callBase(...arguments)||this._editProvider.contextMenuHandlerExists()},_itemHoldHandler(e){var t=a(e.currentTarget);if(!t.is(".dx-state-disabled, .dx-state-disabled *")){var i=N(e)&&this._editProvider.handleContextMenu(t,e);if(i){e.handledByEditProvider=!0;return}this.callBase(...arguments)}},_getItemContainer:function(e){if(this.option("grouped")){var t,i=(t=this._editStrategy.getIndexByItemData(e))===null||t===void 0?void 0:t.group;return this._getGroupContainerByIndex(i)}else return this.callBase(e)},_itemContextMenuHandler(e){var t=a(e.currentTarget);if(!t.is(".dx-state-disabled, .dx-state-disabled *")){var i=!e.handledByEditProvider&&this._editProvider.handleContextMenu(t,e);if(i){e.preventDefault();return}this.callBase(...arguments)}},_postprocessRenderItem(e){this.callBase(...arguments),this._editProvider.modifyItemElement(e)},_clean(){this._disposeEditProvider(),this.callBase()},focusListItem(e){var t=this._editStrategy.getItemElement(e);this.option("focusedElement",t),this.focus(),this.scrollToItem(this.option("focusedElement"))},_optionChanged(e){switch(e.name){case"selectAllMode":this._initDataSource(),this._dataController.pageIndex(0),this._dataController.load();break;case"grouped":this._clearSelectedItems(),delete this._renderingGroupIndex,this._initEditStrategy(),this.callBase(e);break;case"showSelectionControls":case"menuItems":case"menuMode":case"allowItemDeleting":case"itemDeleteMode":case"itemDragging":case"selectAllText":this._invalidate();break;case"onSelectAllValueChanged":break;default:this.callBase(e)}},selectAll(){return this._selection.selectAll(this._isPageSelectAll())},unselectAll(){return this._selection.deselectAll(this._isPageSelectAll())},isSelectAll(){return this._selection.getSelectAllState(this._isPageSelectAll())},getFlatIndexByItemElement(e){return this._itemElements().index(e)},getItemElementByFlatIndex(e){var t=this._itemElements();return e<0||e>=t.length?a():t.eq(e)},getItemByIndex(e){return this._editStrategy.getItemDataByIndex(e)}}),ue=ce.inherit(T).inherit({_addWidgetPrefix:function(e){return"dx-list-"+e},_getCombinedFilter:function(){var e=this._dataController,t={filter:e.filter()};e.addSearchFilter(t);var i=t.filter;return i},_initDataSource:function(){var e=this.option("searchValue"),t=this.option("searchExpr"),i=this.option("searchMode");this.callBase();var r=this._dataController;e&&e.length&&r.searchValue(e),i.length&&r.searchOperation(T.getOperationBySearchMode(i)),t&&r.searchExpr(t)}});R("dxList",ue);var he="dx-radiobutton",D="dx-radiobutton-icon",_e="dx-radiobutton-icon-dot",me="dx-radiobutton-checked",fe="dx-radiobutton-icon-checked",$=Y.inherit({_supportedKeys:function(){return v(this.callBase(),{space:function(e){e.preventDefault(),this._clickAction({event:e})}})},_getDefaultOptions:function(){return v(this.callBase(),{hoverStateEnabled:!0,activeStateEnabled:!0,value:!1})},_canValueBeChangedByClick:function(){return!0},_defaultOptionsRules:function(){return this.callBase().concat([{device:function(){return I.real().deviceType==="desktop"&&!I.isSimulator()},options:{focusStateEnabled:!0}}])},_init:function(){this.callBase(),this.$element().addClass(he)},_initMarkup:function(){this.callBase(),this._renderIcon(),this._renderCheckedState(this.option("value")),this._renderClick(),this.setAria("role","radio")},_renderIcon:function(){this._$icon=a("<div>").addClass(D),a("<div>").addClass(_e).appendTo(this._$icon),this.$element().append(this._$icon)},_renderCheckedState:function(e){this.$element().toggleClass(me,e).find("."+D).toggleClass(fe,e),this.setAria("checked",e)},_renderClick:function(){var e=p(M,this.NAME);this._clickAction=this._createAction((function(t){this._clickHandler(t.event)}).bind(this)),h.off(this.$element(),e),h.on(this.$element(),e,(function(t){this._clickAction({event:t})}).bind(this))},_clickHandler:function(e){this._saveValueChangeEvent(e),this.option("value",!0)},_optionChanged:function(e){switch(e.name){case"value":this._renderCheckedState(e.value),this.callBase(e);break;default:this.callBase(e)}}});R("dxRadioButton",$);var A="dxListEditDecorator",ve=p(q,A),pe=p(z,A),Ee=p(X,A),ge=k.inherit({ctor:function(e){this._list=e,this._init()},_init:d,_shouldHandleSwipe:!1,_attachSwipeEvent:function(e){var t={itemSizeFunc:(function(){return this._clearSwipeCache&&(this._itemWidthCache=K(this._list.$element()),this._clearSwipeCache=!1),this._itemWidthCache}).bind(this)};h.on(e.$itemElement,ve,t,this._itemSwipeStartHandler.bind(this)),h.on(e.$itemElement,pe,this._itemSwipeUpdateHandler.bind(this)),h.on(e.$itemElement,Ee,this._itemSwipeEndHandler.bind(this))},_itemSwipeStartHandler:function(e){var t=a(e.currentTarget);if(t.is(".dx-state-disabled, .dx-state-disabled *")){e.cancel=!0;return}clearTimeout(this._list._inkRippleTimer),this._swipeStartHandler(t,e)},_itemSwipeUpdateHandler:function(e){var t=a(e.currentTarget);this._swipeUpdateHandler(t,e)},_itemSwipeEndHandler:function(e){var t=a(e.currentTarget);this._swipeEndHandler(t,e),this._clearSwipeCache=!0},beforeBag:d,afterBag:d,_commonOptions:function(){return{activeStateEnabled:this._list.option("activeStateEnabled"),hoverStateEnabled:this._list.option("hoverStateEnabled"),focusStateEnabled:this._list.option("focusStateEnabled")}},modifyElement:function(e){this._shouldHandleSwipe&&(this._attachSwipeEvent(e),this._clearSwipeCache=!0)},afterRender:d,handleClick:d,handleKeyboardEvents:d,handleEnterPressing:d,handleContextMenu:d,_swipeStartHandler:d,_swipeUpdateHandler:d,_swipeEndHandler:d,visibilityChange:d,getExcludedSelectors:d,dispose:d}),b="dx-list-select-decorator-enabled",Se="dx-list-select-all",Ce="dx-list-select-all-checkbox",Ae="dx-list-select-all-label",Ie="dx-list-select-checkbox-container",Te="dx-list-select-checkbox",xe="dx-list-select-radiobutton-container",Be="dx-list-select-radiobutton",ye="dx-state-focused",O=p(M,"dxListEditDecorator");Q("selection","default",ge.inherit({_init:function(){this.callBase.apply(this,arguments);var e=this._list.option("selectionMode");this._singleStrategy=e==="single",this._containerClass=this._singleStrategy?xe:Ie,this._controlClass=this._singleStrategy?Be:Te,this._controlWidget=this._singleStrategy?$:x,this._list.$element().addClass(b)},beforeBag:function(e){var t=e.$itemElement,i=e.$container.addClass(this._containerClass),r=a("<div>").addClass(this._controlClass).appendTo(i);new this._controlWidget(r,v(this._commonOptions(),{value:this._isSelected(t),elementAttr:{"aria-label":"Check State"},focusStateEnabled:!1,hoverStateEnabled:!1,onValueChanged:(function(n){n.event&&this._list._saveSelectionChangeEvent(n.event),this._processCheckedState(t,n.value),n.event&&n.event.stopPropagation()}).bind(this)}))},modifyElement:function(e){this.callBase.apply(this,arguments);var t=e.$itemElement,i=this._controlWidget.getInstance(t.find("."+this._controlClass));h.on(t,"stateChanged",(function(r,n){i.option("value",n)}).bind(this))},_updateSelectAllState:function(){this._$selectAll&&this._selectAllCheckBox.option("value",this._list.isSelectAll())},afterRender:function(){this._list.option("selectionMode")==="all"&&(this._$selectAll?this._updateSelectAllState():this._renderSelectAll())},handleKeyboardEvents:function(e,t){var i=!t,r=this._list,n=this._$selectAll,l=r._getLastItemIndex(),s=t&&e===0||i&&e===l,o=!!n;return o&&s?(r.option("focusedElement",n),r.scrollToItem(r.option("focusedElement")),!0):!1},handleEnterPressing:function(e){if(this._$selectAll&&this._$selectAll.hasClass(ye))return e.target=this._$selectAll.get(0),this._list._saveSelectionChangeEvent(e),this._selectAllCheckBox.option("value",!this._selectAllCheckBox.option("value")),!0},_renderSelectAll:function(){var e=this._$selectAll=a("<div>").addClass(Se),t=this._list,i=t._supportedKeys().downArrow.bind(t);this._selectAllCheckBox=t._createComponent(a("<div>").addClass(Ce).appendTo(e),x,{elementAttr:{"aria-label":"Select All"},focusStateEnabled:!1,hoverStateEnabled:!1}),this._selectAllCheckBox.registerKeyHandler("downArrow",i),a("<div>").addClass(Ae).text(this._list.option("selectAllText")).appendTo(e),this._list.itemsContainer().prepend(e),this._updateSelectAllState(),this._attachSelectAllHandler()},_attachSelectAllHandler:function(){this._selectAllCheckBox.option("onValueChanged",this._selectAllHandler.bind(this)),h.off(this._$selectAll,O),h.on(this._$selectAll,O,this._selectAllClickHandler.bind(this))},_selectAllHandler:function(e){e.event&&e.event.stopPropagation();var t=this._selectAllCheckBox.option("value");e.event&&this._list._saveSelectionChangeEvent(e.event),t===!0?this._selectAllItems():t===!1&&this._unselectAllItems(),this._list._createActionByOption("onSelectAllValueChanged")({value:t})},_checkSelectAllCapability:function(){var e=this._list,t=e._dataController;return e.option("selectAllMode")==="allPages"&&e.option("grouped")&&!t.group()?(L.log("W1010"),!1):!0},_selectAllItems:function(){this._checkSelectAllCapability()&&this._list._selection.selectAll(this._list.option("selectAllMode")==="page")},_unselectAllItems:function(){this._checkSelectAllCapability()&&this._list._selection.deselectAll(this._list.option("selectAllMode")==="page")},_selectAllClickHandler:function(e){this._list._saveSelectionChangeEvent(e),this._selectAllCheckBox.option("value",!this._selectAllCheckBox.option("value"))},_isSelected:function(e){return this._list.isItemSelected(e)},_processCheckedState:function(e,t){t?this._list.selectItem(e):this._list.unselectItem(e)},dispose:function(){this._disposeSelectAll(),this._list.$element().removeClass(b),this.callBase.apply(this,arguments)},_disposeSelectAll:function(){this._$selectAll&&(this._$selectAll.remove(),this._$selectAll=null)}}));export{ge as E,ue as L,ce as a,Q as r};
