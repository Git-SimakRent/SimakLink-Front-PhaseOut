import{$ as u,m as c,V as $,r as B,W as R,u as S,M as N,aj as P,L as O,g as U}from"./index.94f86987.js";import{Z as C,T as h,aJ as T,as as M,aB as x}from"./entry.f47474d7.js";import{L as W,P as E,T as V}from"./ui.popup.81669a77.js";import{B as H}from"./resize_observer.3c2fa9a2.js";var F="dx-buttongroup",G=["dxAutocomplete","dxButton","dxCheckBox","dxDateBox","dxMenu","dxSelectBox","dxTabs","dxTextBox","dxButtonGroup","dxDropDownButton"],K=function(r){var e=r.data&&r.data(),t=e&&e.dxComponents,i=t&&t[0];return i&&e[i]};function v(r,e){var t;if(r){var i=r._findItemElementByItem(e);if(i.length){var n=r._getItemData(i),o=!!((t=n.options)!==null&&t!==void 0&&t.disabled||n.disabled||r.option("disabled")),{widget:a}=n;if(a&&G.indexOf(a)!==-1){var s=i.find(a.toLowerCase().replace("dx",".dx-"));if(s.length){var l,d,p=K(s);if(!p)return;var _=(l=p._focusTarget)===null||l===void 0?void 0:l.call(p);if(a==="dxDropDownButton")_=_&&_.find(".".concat(F));else{var b;_=(b=_)!==null&&b!==void 0?b:u(p.element())}var g=(d=n.options)===null||d===void 0?void 0:d.tabIndex;o?_.attr("tabIndex",-1):_.attr("tabIndex",g??0)}}}}}var q="dx-toolbar-label";class z{constructor(e){this._toolbar=e}_initMarkup(){}_updateMenuVisibility(){}_renderMenuItems(){}_renderItem(){}_getMenuItems(){}_getToolbarItems(){var e;return(e=this._toolbar.option("items"))!==null&&e!==void 0?e:[]}_getItemsWidth(){return this._toolbar._getSummaryItemsWidth(this._toolbar.itemElements(),!0)}_arrangeItems(){var e=this._toolbar._$toolbarItemsContainer.find(".".concat(q)).eq(0);if(e.length){var t=c(this._toolbar.$element()),i=$(e)-c(e);e.css("maxWidth",t-i)}}_hideOverflowItems(){}_dimensionChanged(){}_itemOptionChanged(){}_optionChanged(){}}var f="dx-toolbar-menu-action",J="dx-toolbar-hidden-button",A="dx-toolbar-hidden-button-group",L="dx-toolbar-menu-section",X="dx-toolbar-menu-custom",k="dx-toolbar-menu-last-section",Y="dx-scrollview-content";class Z extends W{_init(){super._init(),this._activeStateUnit=".".concat(f,":not(.").concat(A,")")}_initMarkup(){this._renderSections(),super._initMarkup(),this._setMenuRole()}_getSections(){return this._itemContainer().children()}_itemElements(){return this._getSections().children(this._itemSelector())}_renderSections(){var e=this._itemContainer();C(["before","center","after","menu"],(t,i)=>{var n="_$".concat(i,"Section");this[n]||(this[n]=u("<div>").addClass(L)),this[n].appendTo(e)})}_renderItems(){super._renderItems.apply(this,arguments),this._updateSections()}_setMenuRole(){var e=this.$element().find(".".concat(Y));e.attr("role","menu")}_updateSections(){var e=this.$element().find(".".concat(L));e.removeClass(k),e.not(":empty").eq(-1).addClass(k)}_renderItem(e,t,i,n){var o,a=(o=t.location)!==null&&o!==void 0?o:"menu",s=this["_$".concat(a,"Section")],l=super._renderItem(e,t,s,n);return this._getItemTemplateName({itemData:t})&&l.addClass(X),(a==="menu"||t.widget==="dxButton"||t.widget==="dxButtonGroup"||t.isAction)&&l.addClass(f),t.widget==="dxButton"&&l.addClass(J),t.widget==="dxButtonGroup"&&l.addClass(A),l.addClass(t.cssClass),l}_getItemTemplateName(e){var t=super._getItemTemplateName(e),i=e.itemData,n=i&&i.menuItemTemplate;return n||t}_dataSourceOptions(){return{paginate:!1}}_itemClickHandler(e,t,i){u(e.target).closest(".".concat(f)).length&&super._itemClickHandler(e,t,i)}_clean(){this._getSections().empty(),super._clean()}}class D extends E{_getDefaultOptions(){return h(super._getDefaultOptions(),{preventScrollEvents:!1})}_getToolbarName(){return"dxToolbar"}}D.defaultOptions=function(r){E.defaultOptions(r)};B("dxPopup",D);var j="dx-dropdownmenu",Q="dx-dropdownmenu-popup",ee="dx-dropdownmenu-popup-wrapper",te="dx-dropdownmenu-list",ie="dx-dropdownmenu-button",ne=10,w=3;class oe extends R{_supportedKeys(){var e={};return(!this.option("opened")||!this._list.option("focusedElement"))&&(e=this._button._supportedKeys()),h(super._supportedKeys(),e,{tab:function(){this._popup&&this._popup.hide()}})}_getDefaultOptions(){return h(super._getDefaultOptions(),{items:[],onItemClick:null,dataSource:null,itemTemplate:"item",onButtonClick:null,activeStateEnabled:!0,hoverStateEnabled:!0,opened:!1,onItemRendered:null,closeOnClick:!0,useInkRipple:!1,container:void 0,animation:{show:{type:"fade",from:0,to:1},hide:{type:"fade",to:0}}})}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:function(){return S.real().deviceType==="desktop"&&!S.isSimulator()},options:{focusStateEnabled:!0}},{device:function(){return N()},options:{useInkRipple:!0,animation:{show:{type:"pop",duration:200,from:{scale:0},to:{scale:1}},hide:{type:"pop",duration:200,from:{scale:1},to:{scale:0}}}}}])}_init(){super._init(),this.$element().addClass(j),this._initItemClickAction(),this._initButtonClickAction()}_initItemClickAction(){this._itemClickAction=this._createActionByOption("onItemClick")}_initButtonClickAction(){this._buttonClickAction=this._createActionByOption("onButtonClick")}_initTemplates(){this._templateManager.addDefaultTemplates({content:new P("content")}),super._initTemplates()}_initMarkup(){this._renderButton(),super._initMarkup()}_render(){super._render(),this.setAria({haspopup:!0,expanded:this.option("opened")})}_renderContentImpl(){this.option("opened")&&this._renderPopup()}_clean(){this._cleanFocusState(),this._list&&this._list.$element().remove(),this._popup&&this._popup.$element().remove(),delete this._list,delete this._popup}_renderButton(){var e=this.$element().addClass(ie);this._button=this._createComponent(e,H,{icon:"overflow",template:"content",useInkRipple:this.option("useInkRipple"),hoverStateEnabled:!1,focusStateEnabled:!1,onClick:t=>{this.option("opened",!this.option("opened")),this._buttonClickAction(t)}})}_toggleActiveState(e,t,i){this._button._toggleActiveState(e,t,i)}_toggleMenuVisibility(e){var t=e??!this._popup.option("visible");e&&this._renderPopup(),this._popup.toggle(t),this.setAria("expanded",t)}_renderPopup(){if(!this._$popup){this._$popup=u("<div>").appendTo(this.$element());var{rtlEnabled:e,container:t,animation:i}=this.option();this._popup=this._createComponent(this._$popup,"dxPopup",{onInitialized(n){var{component:o}=n;o.$wrapper().addClass(ee).addClass(Q)},deferRendering:!1,contentTemplate:n=>this._renderList(n),_ignoreFunctionValueDeprecation:!0,maxHeight:()=>this._getMaxHeight(),position:{my:"top ".concat(e?"left":"right"),at:"bottom ".concat(e?"left":"right"),collision:"fit flip",offset:{v:w},of:this.$element()},animation:i,onOptionChanged:n=>{var{name:o,value:a}=n;o==="visible"&&this.option("opened",a)},container:t,autoResizeEnabled:!1,height:"auto",width:"auto",hideOnOutsideClick:n=>this._closeOutsideDropDownHandler(n),hideOnParentScroll:!0,shading:!1,dragEnabled:!1,showTitle:!1,fullScreen:!1,_fixWrapperPosition:!0})}}_getMaxHeight(){var e=this.$element(),t=e.offset().top,i=O(U()),n=Math.max(t,i-t-O(e));return Math.min(i,n-w-ne)}_closeOutsideDropDownHandler(e){var t=!u(e.target).closest(this.$element()).length;return t}_renderList(e){var t=u(e);t.addClass(te),this._list=this._createComponent(t,Z,{dataSource:this._getListDataSource(),pageLoadMode:"scrollBottom",indicateLoading:!1,noDataText:"",itemTemplate:this.option("itemTemplate"),onItemClick:i=>{this.option("closeOnClick")&&this.option("opened",!1),this._itemClickAction(i)},tabIndex:-1,focusStateEnabled:!1,activeStateEnabled:!0,onItemRendered:this.option("onItemRendered"),_itemAttributes:{role:"menuitem"}})}_itemOptionChanged(e,t,i){var n;(n=this._list)===null||n===void 0||n._itemOptionChanged(e,t,i),v(this._list,e)}_getListDataSource(){var e;return(e=this.option("dataSource"))!==null&&e!==void 0?e:this.option("items")}_setListDataSource(){var e;(e=this._list)===null||e===void 0||e.option("dataSource",this._getListDataSource()),delete this._deferRendering}_getKeyboardListeners(){return super._getKeyboardListeners().concat([this._list])}_toggleVisibility(e){super._toggleVisibility(e),this._button.option("visible",e)}_optionChanged(e){var t,i,n,{name:o,value:a}=e;switch(o){case"items":case"dataSource":this.option("opened")?this._setListDataSource():this._deferRendering=!0;break;case"itemTemplate":(t=this._list)===null||t===void 0||t.option(o,this._getTemplate(a));break;case"onItemClick":this._initItemClickAction();break;case"onButtonClick":this._buttonClickAction();break;case"useInkRipple":this._invalidate();break;case"focusStateEnabled":(i=this._list)===null||i===void 0||i.option(o,a),super._optionChanged(e);break;case"onItemRendered":(n=this._list)===null||n===void 0||n.option(o,a);break;case"opened":this._deferRendering&&this._setListDataSource(),this._toggleMenuVisibility(a),this._updateFocusableItemsTabIndex();break;case"closeOnClick":break;case"container":this._popup&&this._popup.option(o,a);break;case"disabled":this._list&&this._updateFocusableItemsTabIndex();break;default:super._optionChanged(e)}}_updateFocusableItemsTabIndex(){this.option("items").forEach(e=>v(this._list,e))}}var y="dx-state-invisible",ae="dx-toolbar-menu-container",se="dx-toolbar-button",m="dx-toolbar-item-auto-hide",I="dx-toolbar-item-invisible";class re{constructor(e){this._toolbar=e}_initMarkup(){T(()=>{this._renderOverflowMenu(),this._renderMenuItems()})}_renderOverflowMenu(){if(this._hasVisibleMenuItems()){this._renderMenuButtonContainer();var e=u("<div>").appendTo(this._overflowMenuContainer()),t=this._toolbar._createActionByOption("onItemClick"),i=this._toolbar._getTemplateByOption("menuItemTemplate");this._menu=this._toolbar._createComponent(e,oe,{disabled:this._toolbar.option("disabled"),itemTemplate:()=>i,onItemClick:n=>{t(n)},container:this._toolbar.option("menuContainer"),onOptionChanged:n=>{var{name:o,value:a}=n;o==="opened"&&this._toolbar.option("overflowMenuVisible",a),o==="items"&&this._updateMenuVisibility(a)}})}}renderMenuItems(){this._menu||this._renderOverflowMenu(),this._menu&&this._menu.option("items",this._getMenuItems()),this._menu&&!this._menu.option("items").length&&this._menu.option("opened",!1)}_renderMenuButtonContainer(){this._$overflowMenuContainer=u("<div>").appendTo(this._toolbar._$afterSection).addClass(se).addClass(ae)}_overflowMenuContainer(){return this._$overflowMenuContainer}_updateMenuVisibility(e){var t=e??this._getMenuItems(),i=t.length&&this._hasVisibleMenuItems(t);this._toggleMenuVisibility(i)}_toggleMenuVisibility(e){this._overflowMenuContainer()&&this._overflowMenuContainer().toggleClass(y,!e)}_renderMenuItems(){T(()=>{this.renderMenuItems()})}_dimensionChanged(){this.renderMenuItems()}_getToolbarItems(){var e;return M((e=this._toolbar.option("items"))!==null&&e!==void 0?e:[],t=>!this._toolbar._isMenuItem(t))}_getHiddenItems(){return this._toolbar._itemContainer().children(".".concat(m,".").concat(I)).not(".".concat(y))}_getMenuItems(){var e,t,i=M((e=this._toolbar.option("items"))!==null&&e!==void 0?e:[],a=>this._toolbar._isMenuItem(a)),n=this._getHiddenItems();this._restoreItems=(t=this._restoreItems)!==null&&t!==void 0?t:[];var o=[].slice.call(n).map(a=>{var s=this._toolbar._getItemData(a),l=u(a),d=l.children();return h({menuItemTemplate:()=>{this._restoreItems.push({container:l,item:d});var p=u("<div>").addClass(m);return p.append(d)}},s)});return[...o,...i]}_hasVisibleMenuItems(e){var t=e??this._toolbar.option("items"),i=!1,n=x("visible"),o=x("locateInMenu");return C(t,function(a,s){var l=n(s,{functionsAsIs:!0}),d=o(s,{functionsAsIs:!0});(l!==!1&&(d==="auto"||d==="always")||s.location==="menu")&&(i=!0)}),i}_arrangeItems(){var e;this._toolbar._$centerSection.css({margin:"0 auto",float:"none"}),C((e=this._restoreItems)!==null&&e!==void 0?e:[],function(i,n){u(n.container).append(n.item)}),this._restoreItems=[];var t=c(this._toolbar.$element());return this._hideOverflowItems(t),t}_hideOverflowItems(e){var t,i=this._toolbar.$element().find(".".concat(m));if(i.length){e=(t=e)!==null&&t!==void 0?t:c(this._toolbar.$element()),u(i).removeClass(I);for(var n=this._getItemsWidth();i.length&&e<n;){var o=i.eq(-1);o.addClass(I),n=this._getItemsWidth(),i.splice(-1,1)}}}_getItemsWidth(){return this._toolbar._getSummaryItemsWidth([this._toolbar._$beforeSection,this._toolbar._$centerSection,this._toolbar._$afterSection])}_itemOptionChanged(e,t,i){if((t==="disabled"||t==="options.disabled")&&this._toolbar._isMenuItem(e)){var n;(n=this._menu)===null||n===void 0||n._itemOptionChanged(e,t,i);return}this.renderMenuItems()}_renderItem(e,t){e.locateInMenu==="auto"&&t.addClass(m)}_optionChanged(e,t){var i,n,o,a,s;switch(e){case"disabled":(i=this._menu)===null||i===void 0||i.option(e,t);break;case"overflowMenuVisible":(n=this._menu)===null||n===void 0||n.option("opened",t);break;case"onItemClick":(o=this._menu)===null||o===void 0||o.option(e,t);break;case"menuContainer":(a=this._menu)===null||a===void 0||a.option("container",t);break;case"menuItemTemplate":(s=this._menu)===null||s===void 0||s.option("itemTemplate",t)}}}var le="dx-toolbar-multiline",ue="dx-toolbar-text-auto-hide";class de extends V{_getDefaultOptions(){return h(super._getDefaultOptions(),{menuItemTemplate:"menuItem",menuContainer:void 0,overflowMenuVisible:!1,multiline:!1})}_isMultiline(){return this.option("multiline")}_dimensionChanged(e){e!=="height"&&(super._dimensionChanged(),this._layoutStrategy._dimensionChanged())}_initMarkup(){super._initMarkup(),this._updateFocusableItemsTabIndex(),this._layoutStrategy._initMarkup()}_renderToolbar(){super._renderToolbar(),this._renderLayoutStrategy()}_itemContainer(){return this._isMultiline()?this._$toolbarItemsContainer:super._itemContainer()}_renderLayoutStrategy(){this.$element().toggleClass(le,this._isMultiline()),this._layoutStrategy=this._isMultiline()?new z(this):new re(this)}_renderSections(){if(!this._isMultiline())return super._renderSections()}_postProcessRenderItems(){this._layoutStrategy._hideOverflowItems(),this._layoutStrategy._updateMenuVisibility(),super._postProcessRenderItems(),this._layoutStrategy._renderMenuItems()}_renderItem(e,t,i,n){var o=super._renderItem(e,t,i,n);this._layoutStrategy._renderItem(t,o);var{widget:a,showText:s}=t;return a==="dxButton"&&s==="inMenu"&&o.toggleClass(ue),o}_getItemsWidth(){return this._layoutStrategy._getItemsWidth()}_getMenuItems(){return this._layoutStrategy._getMenuItems()}_getToolbarItems(){return this._layoutStrategy._getToolbarItems()}_arrangeItems(){if(!this.$element().is(":hidden")){var e=this._layoutStrategy._arrangeItems();this._isMultiline()||super._arrangeItems(e)}}_itemOptionChanged(e,t,i){this._isMenuItem(e)||super._itemOptionChanged(e,t,i),this._layoutStrategy._itemOptionChanged(e,t,i),(t==="disabled"||t==="options.disabled")&&v(this,e),t==="location"&&this.repaint()}_updateFocusableItemsTabIndex(){this._getToolbarItems().forEach(e=>v(this,e))}_isMenuItem(e){return e.location==="menu"||e.locateInMenu==="always"}_isToolbarItem(e){return e.location===void 0||e.locateInMenu==="never"}_optionChanged(e){var{name:t,value:i}=e;switch(this._layoutStrategy._optionChanged(t,i),t){case"menuContainer":case"menuItemTemplate":case"overflowMenuVisible":break;case"multiline":this._invalidate();break;case"disabled":super._optionChanged.apply(this,arguments),this._updateFocusableItemsTabIndex();break;default:super._optionChanged.apply(this,arguments)}}updateDimensions(){this._dimensionChanged()}}B("dxToolbar",de);export{D as P,de as T};
